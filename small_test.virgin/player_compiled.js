function Elapsed(){return(new Date).getTime()-g_nStartTime}function ParseXML(){}function TaskQueue(){this.tasks=[],this.timeout=50,this.tick()}function MatrixTransform(){this.reset()}function Point(t,e){this.x=t,this.y=e}function bwAnimation(t){this.m_strEasing=bwAnimation.EASE_CUBIC,this.m_nAnimationType=this.m_nCurrentTime=this.m_nDuration=this.m_nStartTime=this.m_nTriggerTime=0,this.m_bTransitionIn=!0,this.m_nStartY=this.m_nStartX=0,this.m_nSpinCount=1,this.m_nCurRotation=this.m_nCurYPos=this.m_nCurXPos=0,this.m_nCurYScale=this.m_nCurXScale=1,this.m_nEndY=this.m_nEndX=3735928495,this.m_nStartScaleY=this.m_nStartScaleX=this.m_nEndRotation=0,this.m_nEndScaleY=this.m_nEndScaleX=1,this.m_nStartAlpha=0,this.m_nEndAlpha=1,this.m_aoTarget=null,this.m_bAdjustRotation=!0,this.m_bTimelineAnimating=this.m_bAnimating=!1,this.m_aoTarget=t}function Scoring(){this.scorerefs={}}function AOClient(){this.endpoint="http://"+window.location.host+"/services/content/api.asmx",this.apiVersion="0.0",this.sendcount=0}function LMSClient(){}function LMSManager(){this.hasTinCan=this.hasLMS=this.hasAO=!1,this.viewedSlides={}}function QuizData(t,e){this.strQuizId=t,this.strQuizName=e,this.arrQuestions=[],this.dtmFinished=new Date,this.strStatus="",this.nScore=0,this.nPassingScore=80,this.nMinScore=0,this.nMaxScore=100,this.nPtScore=0,this.nPtMax=100,this.AddQuestionResult=function(t){for(var e=!1,i=0;i<this.arrQuestions.length;i++)this.arrQuestions[i].nQuestionNumber==t.nQuestionNumber&&(this.arrQuestions[i]=t,e=!0);e||this.arrQuestions.push(t)}}function ContentResults(){this.dtmFinished=new Date,this.nPassingScore=80,this.nScore=0,this.strStatus="incomplete",this.strType="quiz"}function QuestionResults(t,e,i,r,n,a,s,o,l,h,p,c,d){this.strId=t,this.strLMSId=e,this.strType=i,this.strCorrectResponse=r,this.strUserResponse=n,this.nLatency=a,this.strStatus=s,this.nPoints=o,this.strCompletedTime=l,this.nWeight=h,this.nQuestionNumber=p,this.strDescription=c,this.bTracked=d}function GetTime(t){var e="",e=t.getHours(),i=t.getMinutes(),r=""+i,t=t.getSeconds(),n=""+t;return 10>i&&(r="0"+i),10>t&&(n="0"+t),e+":"+r+":"+n}function GetDate(t){var e="";return e=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()}function AlertError(t){console.log("TinCan error: "+t)}function ppTinCanRequest(t,e,i,r,n){this.MessageType=t,this.Method=e,this.Data=i,this.Url=r,this.Callback=n}function ppTinCanComm(t){this.m_listParams={},this.m_listCustomParams={},this.m_jsActor={},this.m_strQueryString=t,this.ParseQueryString(this.m_strQueryString),this.m_bStopPosting=this.m_bWaitingTinCanResponse=!1,this.m_arrTinCanMsgQueue=[],this.m_pfnFatalError=AlertError,this.m_bIE=document.all&&-1!=navigator.appVersion.indexOf("MSIE")?!0:!1}function ppResponsePair(t,e){this.Choice=t,this.Statement=e}function ppTinCanApi(t){this.m_tcComm=new ppTinCanComm(t)}function TinCanClient(){}function bwChunk(t){this.m_strRemainder="",this.m_nLength=-1,this.m_strChunkData=this.m_strData="",this.m_nOffset=0,this.isNothing=""==t;var e="",i=0,e=0,r=t,e=t.charAt(0);"~"==e?(i=parseInt(t.charAt(1)),e=t.substr(2,i),e=bwChunk.UBaseNto10(e),t=t.substr(2+i),this.m_nLength=2+i+e):(t=t.substr(1),e=bwChunk.UBaseNto10(e),this.m_nLength=1+e),e>0&&(this.m_strData=t.substr(0,e),t=t.substr(e)),this.m_strChunkData=r.substr(0,r.length-t.length),this.m_strRemainder=t}function PathLib(){}function BezierPath(t){t?this.setPoints(t):this.points=[]}function BitMask(t,e,i,r,n){this.isOpaque=t,this.width=e||0,this.height=i||0,this.sourceWidth=r||this.width,this.sourceHeight=n||this.height}function ppRect(t,e,i,r){this.left=t,this.top=e,this.right=i,this.bottom=r}function ppGraphics(t){ppArt.currentFudge=0,this.m_nXOffset=-t.left,this.m_nYOffset=-t.top,this.m_nWidth=t.right-t.left+1,this.m_nHeight=t.bottom-t.top+1,this.m_bForMask=!1,this.m_nFillYPos=this.m_nFillXPos=this.m_nFillRotation=0,this.m_nFillScaleY=this.m_nFillScaleX=1,this.m_bRotatedFill=!1,0>=this.m_nWidth&&(this.m_nWidth=1),0>=this.m_nHeight&&(this.m_nHeight=1),this.m_ptOffset={x:0,y:0},this.m_bLineDrawn=this.m_bStrokeStarted=this.m_bFillStarted=!1,this.m_nCurYPos=this.m_nCurXPos=0,this.m_arrShadows=[],this.m_bHasInnerShadow=this.m_bHasShadow=!1,this.m_arrStrokeCanvases=[],this.m_oFillCanvas=document.createElement("canvas"),this.m_oStrokeCanvas=document.createElement("canvas"),this.m_oFillCanvas.width=this.m_nWidth,this.m_oFillCanvas.height=this.m_nHeight,this.m_oStrokeCanvas.width=this.m_nWidth,this.m_oStrokeCanvas.height=this.m_nHeight,this.m_oFillContext=this.m_oFillCanvas.getContext("2d"),this.m_oStrokeContext=this.m_oStrokeCanvas.getContext("2d"),this.m_arrStrokeCanvases.push(this.m_oStrokeCanvas),this.lineJoin=this.lineWidth=this.strokeStyle=this.fillStyle=null}function AddFont(t,e){var i=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",$(r).load(function(){e(t)}),r.src=t,i.appendChild(r)}function RegisterFonts(t){"string"==typeof t&&(t=t.replace(/[\u000a\u000b\u000c\u000d\u0085\u2028\u2029]/g,""),t=t.replace(/&#x[0-8bcef];/gi,""));var e=null;window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml");for(var t=e.getElementsByTagName("font"),e=null,i=0;i<t.length;i++)e=new ppFont(t[i]),g_listFonts[e.Id]=e}function ppFont(t){this.m_xmlData=null,this.m_listGlyphs={},this.m_bFontReady=!1,this.CMD_LINE="%",this.CMD_MOVE="^",this.CMD_CURVE="#",this.CMD_LINE_E="!",this.CMD_MOVE_E="(",this.CMD_CURVE_E=")",this.BASE_NUMBER=64,this.BASE_POW=6,this.m_o64to10={v0:0,v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8,v9:9,va:10,vb:11,vc:12,vd:13,ve:14,vf:15,vg:16,vh:17,vi:18,vj:19,vk:20,vl:21,vm:22,vn:23,vo:24,vp:25,vq:26,vr:27,vs:28,vt:29,vu:30,vv:31,vw:32,vx:33,vy:34,vz:35,vA:36,vB:37,vC:38,vD:39,vE:40,vF:41,vG:42,vH:43,vI:44,vJ:45,vK:46,vL:47,vM:48,vN:49,vO:50,vP:51,vQ:52,vR:53,vS:54,vT:55,vU:56,vV:57,vW:58,vX:59,vY:60,vZ:61,v_:62,v$:63},this.Name=this.GetAttrStr(t,"name"),this.Id=this.GetAttrStr(t,"id"),this.m_xmlData=t.getElementsByTagName("g"),this.m_bFontReady=!0}function ppFontLib(t,e){this.m_strFontUrl=e,null==t&&(t=""),this.m_strBasePath=t}function ppGlyphCmd(t,e,i,r,n){this.cmd=t,this.x1=e,this.y1=i,this.x2=r,this.y2=n}function ppTextLib(t){if(this.m_bHasXML=!1,null!=t)try{this.m_xmlData=t.getElementsByTagName("textdata"),this.m_bHasXML=!0}catch(e){this.m_bHasXML=!1}else ppDebug.debug_trace("Text data is null")}function ppImageLib(){this.m_listImages={},this.m_nCount=0}function ResourcesPanel(){}function GlossaryPanel(){}function TranscriptPanel(){}function CustomStyleSheet(){this.rules=[],this.ruleLookup={},this.sheet=null}function StyleRule(t){this.selector=t,this.attributes=[]}var buildNumber=60,buildDate="20140121 13:39";!function(t,e){function i(t){var e,i,r=$[t]={},t=t.split(/\s+/);for(e=0,i=t.length;i>e;e++)r[t[e]]=!0;return r}function r(t,i,r){if(r===e&&1===t.nodeType)if(r="data-"+i.replace(L,"-$1").toLowerCase(),r=t.getAttribute(r),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:A.isNumeric(r)?parseFloat(r):M.test(r)?A.parseJSON(r):r}catch(n){}A.data(t,i,r)}else r=e;return r}function n(t){for(var e in t)if(("data"!==e||!A.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function a(t,e,i){var r=e+"defer",n=e+"queue",a=e+"mark",s=A._data(t,r);!(!s||"queue"!==i&&A._data(t,n)||"mark"!==i&&A._data(t,a)||!setTimeout(function(){!A._data(t,n)&&!A._data(t,a)&&(A.removeData(t,r,!0),s.fire())},0))}function s(){return!1}function o(){return!0}function l(t,e,i){if(e=e||0,A.isFunction(e))return A.grep(t,function(t,r){return!!e.call(t,r,t)===i});if(e.nodeType)return A.grep(t,function(t){return t===e===i});if("string"==typeof e){var r=A.grep(t,function(t){return 1===t.nodeType});if(nt.test(e))return A.filter(e,r,!i);e=A.filter(e,r)}return A.grep(t,function(t){return 0<=A.inArray(t,e)===i})}function h(t){var e=lt.split("|"),t=t.createDocumentFragment();if(t.createElement)for(;e.length;)t.createElement(e.pop());return t}function p(t,e){if(1===e.nodeType&&A.hasData(t)){var i,r,n;r=A._data(t);var a=A._data(e,r),s=r.events;if(s)for(i in delete a.handle,a.events={},s)for(r=0,n=s[i].length;n>r;r++)A.event.add(e,i+(s[i][r].namespace?".":"")+s[i][r].namespace,s[i][r],s[i][r].data);a.data&&(a.data=A.extend({},a.data))}}function c(t,e){var i;1===e.nodeType&&(e.clearAttributes&&e.clearAttributes(),e.mergeAttributes&&e.mergeAttributes(t),i=e.nodeName.toLowerCase(),"object"===i?e.outerHTML=t.outerHTML:"input"!==i||"checkbox"!==t.type&&"radio"!==t.type?"option"===i?e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue):(t.checked&&(e.defaultChecked=e.checked=t.checked),e.value!==t.value&&(e.value=t.value)),e.removeAttribute(A.expando))}function d(t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName("*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll("*"):[]}function u(t){("checkbox"===t.type||"radio"===t.type)&&(t.defaultChecked=t.checked)}function m(t){var e=(t.nodeName||"").toLowerCase();"input"===e?u(t):"script"!==e&&"undefined"!=typeof t.getElementsByTagName&&A.grep(t.getElementsByTagName("input"),u)}function f(t,e){e.src?A.ajax({url:e.src,async:!1,dataType:"script"}):A.globalEval((e.text||e.textContent||e.innerHTML||"").replace(wt,"/*$0*/")),e.parentNode&&e.parentNode.removeChild(e)}function y(t,e,i){var r="width"===e?t.offsetWidth:t.offsetHeight,n="width"===e?Mt:Lt,a=0,s=n.length;if(r>0){if("border"!==i)for(;s>a;a++)i||(r-=parseFloat(A.css(t,"padding"+n[a]))||0),r="margin"===i?r+(parseFloat(A.css(t,i+n[a]))||0):r-(parseFloat(A.css(t,"border"+n[a]+"Width"))||0);return r+"px"}if(r=Ct(t,e,e),(0>r||null==r)&&(r=t.style[e]||0),r=parseFloat(r)||0,i)for(;s>a;a++)r+=parseFloat(A.css(t,"padding"+n[a]))||0,"padding"!==i&&(r+=parseFloat(A.css(t,"border"+n[a]+"Width"))||0),"margin"===i&&(r+=parseFloat(A.css(t,i+n[a]))||0);return r+"px"}function g(t){return function(e,i){var r;if("string"!=typeof e&&(i=e,e="*"),A.isFunction(i))for(var n,a,s=e.toLowerCase().split(Ut),o=0,l=s.length;l>o;o++)n=s[o],(a=/^\+/.test(n))&&(n=n.substr(1)||"*"),r=t[n]=t[n]||[],n=r,n[a?"unshift":"push"](i)}}function v(t,i,r,n,a,s){a=a||i.dataTypes[0],s=s||{},s[a]=!0;for(var o,a=t[a],l=0,h=a?a.length:0,p=t===Kt;h>l&&(p||!o);l++)o=a[l](i,r,n),"string"==typeof o&&(!p||s[o]?o=e:(i.dataTypes.unshift(o),o=v(t,i,r,n,o,s)));return!p&&o||s["*"]||(o=v(t,i,r,n,"*",s)),o}function b(t,i){var r,n,a=A.ajaxSettings.flatOptions||{};for(r in i)i[r]!==e&&((a[r]?t:n||(n={}))[r]=i[r]);n&&A.extend(!0,t,n)}function w(t,e,i,r){if(A.isArray(e))A.each(e,function(e,n){i||Ot.test(t)?r(t,n):w(t+"["+("object"==typeof n||A.isArray(n)?e:"")+"]",n,i,r)});else if(i||null==e||"object"!=typeof e)r(t,e);else for(var n in e)w(t+"["+n+"]",e[n],i,r)}function S(){try{return new t.XMLHttpRequest}catch(e){}}function x(){return setTimeout(C,0),pe=A.now()}function C(){pe=e}function _(t,e){var i={};return A.each(me.concat.apply([],me.slice(0,e)),function(){i[this]=t}),i}function T(t){if(!ce[t]){var e=k.body,i=A("<"+t+">").appendTo(e),r=i.css("display");i.remove(),("none"===r||""===r)&&(oe||(oe=k.createElement("iframe"),oe.frameBorder=oe.width=oe.height=0),e.appendChild(oe),le&&oe.createElement||(le=(oe.contentWindow||oe.contentDocument).document,le.write(("CSS1Compat"===k.compatMode?"<!doctype html>":"")+"<html><body>"),le.close()),i=le.createElement(t),le.body.appendChild(i),r=A.css(i,"display"),e.removeChild(oe)),ce[t]=r}return ce[t]}function I(t){return A.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var k=t.document,D=t.navigator,E=t.location,A=function(){function i(){if(!s.isReady){try{k.documentElement.doScroll("left")}catch(t){return void setTimeout(i,1)}s.ready()}}var r,n,a,s=function(t,e){return new s.fn.init(t,e,r)},o=t.jQuery,l=t.$,h=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,p=/\S/,c=/^\s+/,d=/\s+$/,u=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,m=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,y=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,v=/(webkit)[ \/]([\w.]+)/,b=/(opera)(?:.*version)?[ \/]([\w.]+)/,w=/(msie) ([\w.]+)/,S=/(mozilla)(?:.*? rv:([\w.]+))?/,x=/-([a-z]|[0-9])/gi,C=/^-ms-/,_=function(t,e){return(e+"").toUpperCase()},T=D.userAgent,I=Object.prototype.toString,E=Object.prototype.hasOwnProperty,A=Array.prototype.push,$=Array.prototype.slice,R=String.prototype.trim,M=Array.prototype.indexOf,L={};return s.fn=s.prototype={constructor:s,init:function(t,i,r){var n;if(!t)return this;if(t.nodeType)return this.context=this[0]=t,this.length=1,this;if("body"===t&&!i&&k.body)return this.context=k,this[0]=k.body,this.selector=t,this.length=1,this;if("string"==typeof t){if((n="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&3<=t.length?[null,t,null]:h.exec(t))&&(n[1]||!i)){if(n[1])return r=(i=i instanceof s?i[0]:i)?i.ownerDocument||i:k,(t=u.exec(t))?s.isPlainObject(i)?(t=[k.createElement(t[1])],s.fn.attr.call(t,i,!0)):t=[r.createElement(t[1])]:(t=s.buildFragment([n[1]],[r]),t=(t.cacheable?s.clone(t.fragment):t.fragment).childNodes),s.merge(this,t);if((i=k.getElementById(n[2]))&&i.parentNode){if(i.id!==n[2])return r.find(t);this.length=1,this[0]=i}return this.context=k,this.selector=t,this}return!i||i.jquery?(i||r).find(t):this.constructor(i).find(t)}return s.isFunction(t)?r.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),s.makeArray(t,this))},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return $.call(this,0)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t,e,i){var r=this.constructor();return s.isArray(t)?A.apply(r,t):s.merge(r,t),r.prevObject=this,r.context=this.context,"find"===e?r.selector=this.selector+(this.selector?" ":"")+i:e&&(r.selector=this.selector+"."+e+"("+i+")"),r},each:function(t,e){return s.each(this,t,e)},ready:function(t){return s.bindReady(),n.add(t),this},eq:function(t){return t=+t,-1===t?this.slice(t):this.slice(t,t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack($.apply(this,arguments),"slice",$.call(arguments).join(","))},map:function(t){return this.pushStack(s.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:A,sort:[].sort,splice:[].splice},s.fn.init.prototype=s.fn,s.extend=s.fn.extend=function(){var t,i,r,n,a,o=arguments[0]||{},l=1,h=arguments.length,p=!1;for("boolean"==typeof o&&(p=o,o=arguments[1]||{},l=2),"object"!=typeof o&&!s.isFunction(o)&&(o={}),h===l&&(o=this,--l);h>l;l++)if(null!=(t=arguments[l]))for(i in t)r=o[i],n=t[i],o!==n&&(p&&n&&(s.isPlainObject(n)||(a=s.isArray(n)))?(a?(a=!1,r=r&&s.isArray(r)?r:[]):r=r&&s.isPlainObject(r)?r:{},o[i]=s.extend(p,r,n)):n!==e&&(o[i]=n));return o},s.extend({noConflict:function(e){return t.$===s&&(t.$=l),e&&t.jQuery===s&&(t.jQuery=o),s},isReady:!1,readyWait:1,holdReady:function(t){t?s.readyWait++:s.ready(!0)},ready:function(t){if(!0===t&&!--s.readyWait||!0!==t&&!s.isReady){if(!k.body)return setTimeout(s.ready,1);s.isReady=!0,!0!==t&&0<--s.readyWait||(n.fireWith(k,[s]),s.fn.trigger&&s(k).trigger("ready").off("ready"))}},bindReady:function(){if(!n){if(n=s.Callbacks("once memory"),"complete"===k.readyState)return setTimeout(s.ready,1);if(k.addEventListener)k.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",s.ready,!1);else if(k.attachEvent){k.attachEvent("onreadystatechange",a),t.attachEvent("onload",s.ready);var e=!1;try{e=null==t.frameElement}catch(r){}k.documentElement.doScroll&&e&&i()}}},isFunction:function(t){return"function"===s.type(t)},isArray:Array.isArray||function(t){return"array"===s.type(t)},isWindow:function(t){return t&&"object"==typeof t&&"setInterval"in t},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?""+t:L[I.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==s.type(t)||t.nodeType||s.isWindow(t))return!1;try{if(t.constructor&&!E.call(t,"constructor")&&!E.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}for(var r in t);return r===e||E.call(t,r)},isEmptyObject:function(t){for(var e in t)return!1;return!0},error:function(t){throw Error(t)},parseJSON:function(e){return"string"==typeof e&&e?(e=s.trim(e),t.JSON&&t.JSON.parse?t.JSON.parse(e):m.test(e.replace(f,"@").replace(y,"]").replace(g,""))?new Function("return "+e)():void s.error("Invalid JSON: "+e)):null},parseXML:function(i){var r,n;try{t.DOMParser?(n=new DOMParser,r=n.parseFromString(i,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(i))}catch(a){r=e}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&s.error("Invalid XML: "+i),r},noop:function(){},globalEval:function(e){e&&p.test(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(C,"ms-").replace(x,_)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toUpperCase()===e.toUpperCase()},each:function(t,i,r){var n,a=0,o=t.length,l=o===e||s.isFunction(t);if(r)if(l){for(n in t)if(!1===i.apply(t[n],r))break}else for(;o>a&&!1!==i.apply(t[a++],r););else if(l){for(n in t)if(!1===i.call(t[n],n,t[n]))break}else for(;o>a&&!1!==i.call(t[a],a,t[a++]););return t},trim:R?function(t){return null==t?"":R.call(t)}:function(t){return null==t?"":t.toString().replace(c,"").replace(d,"")},makeArray:function(t,e){var i=e||[];if(null!=t){var r=s.type(t);null==t.length||"string"===r||"function"===r||"regexp"===r||s.isWindow(t)?A.call(i,t):s.merge(i,t)}return i},inArray:function(t,e,i){var r;if(e){if(M)return M.call(e,t,i);for(r=e.length,i=i?0>i?Math.max(0,r+i):i:0;r>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var r=t.length,n=0;if("number"==typeof i.length)for(var a=i.length;a>n;n++)t[r++]=i[n];else for(;i[n]!==e;)t[r++]=i[n++];return t.length=r,t},grep:function(t,e,i){for(var r,n=[],i=!!i,a=0,s=t.length;s>a;a++)r=!!e(t[a],a),i!==r&&n.push(t[a]);return n},map:function(t,i,r){var n,a,o=[],l=0,h=t.length;if(t instanceof s||h!==e&&"number"==typeof h&&(h>0&&t[0]&&t[h-1]||0===h||s.isArray(t)))for(;h>l;l++)n=i(t[l],l,r),null!=n&&(o[o.length]=n);else for(a in t)n=i(t[a],a,r),null!=n&&(o[o.length]=n);return o.concat.apply([],o)},guid:1,proxy:function(t,i){if("string"==typeof i)var r=t[i],i=t,t=r;if(!s.isFunction(t))return e;var n=$.call(arguments,2),r=function(){return t.apply(i,n.concat($.call(arguments)))};return r.guid=t.guid=t.guid||r.guid||s.guid++,r},access:function(t,i,r,n,a,o){var l=t.length;if("object"==typeof i){for(var h in i)s.access(t,h,i[h],n,a,r);return t}if(r!==e){for(n=!o&&n&&s.isFunction(r),h=0;l>h;h++)a(t[h],i,n?r.call(t[h],h,a(t[h],i)):r,o);return t}return l?a(t[0],i):e},now:function(){return(new Date).getTime()},uaMatch:function(t){return t=t.toLowerCase(),t=v.exec(t)||b.exec(t)||w.exec(t)||0>t.indexOf("compatible")&&S.exec(t)||[],{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function t(e,i){return new t.fn.init(e,i)}s.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(i,r){return r&&r instanceof s&&!(r instanceof t)&&(r=t(r)),s.fn.init.call(this,i,r,e)},t.fn.init.prototype=t.fn;var e=t(k);return t},browser:{}}),s.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(t,e){L["[object "+e+"]"]=e.toLowerCase()}),T=s.uaMatch(T),T.browser&&(s.browser[T.browser]=!0,s.browser.version=T.version),s.browser.webkit&&(s.browser.safari=!0),p.test(" ")&&(c=/^[\s\xA0]+/,d=/[\s\xA0]+$/),r=s(k),k.addEventListener?a=function(){k.removeEventListener("DOMContentLoaded",a,!1),s.ready()}:k.attachEvent&&(a=function(){"complete"===k.readyState&&(k.detachEvent("onreadystatechange",a),s.ready())}),s}(),$={};A.Callbacks=function(t){var r,n,a,s,o,t=t?$[t]||i(t):{},l=[],h=[],p=function(e){var i,r,n,a;for(i=0,r=e.length;r>i;i++)n=e[i],a=A.type(n),"array"===a?p(n):"function"===a&&(!t.unique||!d.has(n))&&l.push(n)},c=function(e,i){for(i=i||[],r=!t.memory||[e,i],n=!0,o=a||0,a=0,s=l.length;l&&s>o;o++)if(!1===l[o].apply(e,i)&&t.stopOnFalse){r=!0;break}n=!1,l&&(t.once?!0===r?d.disable():l=[]:h&&h.length&&(r=h.shift(),d.fireWith(r[0],r[1])))},d={add:function(){if(l){var t=l.length;p(arguments),n?s=l.length:r&&!0!==r&&(a=t,c(r[0],r[1]))}return this},remove:function(){if(l)for(var e=arguments,i=0,r=e.length;r>i;i++)for(var a=0;a<l.length&&(e[i]!==l[a]||(n&&s>=a&&(s--,o>=a&&o--),l.splice(a--,1),!t.unique));a++);return this},has:function(t){if(l)for(var e=0,i=l.length;i>e;e++)if(t===l[e])return!0;return!1},empty:function(){return l=[],this},disable:function(){return l=h=r=e,this},disabled:function(){return!l},lock:function(){return h=e,(!r||!0===r)&&d.disable(),this},locked:function(){return!h},fireWith:function(e,i){return h&&(n?t.once||h.push([e,i]):(!t.once||!r)&&c(e,i)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d};var R=[].slice;A.extend({Deferred:function(t){var e,i=A.Callbacks("once memory"),r=A.Callbacks("once memory"),n=A.Callbacks("memory"),a="pending",s={resolve:i,reject:r,notify:n},o={done:i.add,fail:r.add,progress:n.add,state:function(){return a},isResolved:i.fired,isRejected:r.fired,then:function(t,e,i){return l.done(t).fail(e).progress(i),this},always:function(){return l.done.apply(l,arguments).fail.apply(l,arguments),this},pipe:function(t,e,i){return A.Deferred(function(r){A.each({done:[t,"resolve"],fail:[e,"reject"],progress:[i,"notify"]},function(t,e){var i,n=e[0],a=e[1];A.isFunction(n)?l[t](function(){(i=n.apply(this,arguments))&&A.isFunction(i.promise)?i.promise().then(r.resolve,r.reject,r.notify):r[a+"With"](this===l?r:this,[i])}):l[t](r[a])})}).promise()},promise:function(t){if(null==t)t=o;else for(var e in o)t[e]=o[e];return t}},l=o.promise({});for(e in s)l[e]=s[e].fire,l[e+"With"]=s[e].fireWith;return l.done(function(){a="resolved"},r.disable,n.lock).fail(function(){a="rejected"},i.disable,n.lock),t&&t.call(l,l),l},when:function(t){function e(t){return function(e){r[t]=1<arguments.length?R.call(arguments,0):e,--o||l.resolveWith(l,r)}}function i(t){return function(e){s[t]=1<arguments.length?R.call(arguments,0):e,l.notifyWith(h,s)}}var r=R.call(arguments,0),n=0,a=r.length,s=Array(a),o=a,l=1>=a&&t&&A.isFunction(t.promise)?t:A.Deferred(),h=l.promise();if(a>1){for(;a>n;n++)r[n]&&r[n].promise&&A.isFunction(r[n].promise)?r[n].promise().then(e(n),l.reject,i(n)):--o;o||l.resolveWith(l,r)}else l!==t&&l.resolveWith(l,a?[t]:[]);return h}}),A.support=function(){var e,i,r,n,a,s,o,l,h=k.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("*"),r=h.getElementsByTagName("a")[0],!i||!i.length||!r)return{};n=k.createElement("select"),a=n.appendChild(k.createElement("option")),i=h.getElementsByTagName("input")[0],e={leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.55/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:"on"===i.value,optSelected:a.selected,getSetAttribute:"t"!==h.className,enctype:!!k.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==k.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,e.noCloneChecked=i.cloneNode(!0).checked,n.disabled=!0,e.optDisabled=!a.disabled;try{delete h.test}catch(p){e.deleteExpando=!1}if(!h.addEventListener&&h.attachEvent&&h.fireEvent&&(h.attachEvent("onclick",function(){e.noCloneEvent=!1}),h.cloneNode(!0).fireEvent("onclick")),i=k.createElement("input"),i.value="t",i.setAttribute("type","radio"),e.radioValue="t"===i.value,i.setAttribute("checked","checked"),h.appendChild(i),r=k.createDocumentFragment(),r.appendChild(h.lastChild),e.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,e.appendChecked=i.checked,r.removeChild(i),r.appendChild(h),h.innerHTML="",t.getComputedStyle&&(i=k.createElement("div"),i.style.width="0",i.style.marginRight="0",h.style.width="2px",h.appendChild(i),e.reliableMarginRight=0===(parseInt((t.getComputedStyle(i,null)||{marginRight:0}).marginRight,10)||0)),h.attachEvent)for(o in{submit:1,change:1,focusin:1})i="on"+o,l=i in h,l||(h.setAttribute(i,"return;"),l="function"==typeof h[i]),e[o+"Bubbles"]=l;return r.removeChild(h),r=n=a=i=h=i=null,A(function(){var t,i,r,n,a=k.getElementsByTagName("body")[0];a&&(t=k.createElement("div"),t.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(t,a.firstChild),h=k.createElement("div"),t.appendChild(h),h.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",s=h.getElementsByTagName("td"),l=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",e.reliableHiddenOffsets=l&&0===s[0].offsetHeight,h.innerHTML="",h.style.width=h.style.paddingLeft="1px",A.boxModel=e.boxModel=2===h.offsetWidth,"undefined"!=typeof h.style.zoom&&(h.style.display="inline",h.style.zoom=1,e.inlineBlockNeedsLayout=2===h.offsetWidth,h.style.display="",h.innerHTML="<div style='width:4px;'></div>",e.shrinkWrapBlocks=2!==h.offsetWidth),h.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;visibility:hidden;border:0;",h.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;'><div></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",i=h.firstChild,r=i.firstChild,n={doesNotAddBorder:5!==r.offsetTop,doesAddBorderForTableAndCells:5===i.nextSibling.firstChild.firstChild.offsetTop},r.style.position="fixed",r.style.top="20px",n.fixedPosition=20===r.offsetTop||15===r.offsetTop,r.style.position=r.style.top="",i.style.overflow="hidden",i.style.position="relative",n.subtractsBorderForOverflowNotVisible=-5===r.offsetTop,n.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,a.removeChild(t),h=null,A.extend(e,n))}),e}();var M=/^(?:\{.*\}|\[.*\])$/,L=/([A-Z])/g;A.extend({cache:{},uuid:0,expando:"jQuery"+(A.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?A.cache[t[A.expando]]:t[A.expando],!!t&&!n(t)},data:function(t,i,r,n){if(A.acceptData(t)){var a;a=A.expando;var s="string"==typeof i,o=t.nodeType,l=o?A.cache:t,h=o?t[a]:t[a]&&a,p="events"===i;if(h&&l[h]&&(p||n||l[h].data)||!s||r!==e)return h||(o?t[a]=h=++A.uuid:h=a),l[h]||(l[h]={},o)||(l[h].toJSON=A.noop),("object"==typeof i||"function"==typeof i)&&(n?l[h]=A.extend(l[h],i):l[h].data=A.extend(l[h].data,i)),a=t=l[h],n||(t.data||(t.data={}),t=t.data),r!==e&&(t[A.camelCase(i)]=r),p&&!t[i]?a.events:(s?(r=t[i],null==r&&(r=t[A.camelCase(i)])):r=t,r)}},removeData:function(t,e,i){if(A.acceptData(t)){var r,a,s,o=A.expando,l=t.nodeType,h=l?A.cache:t,p=l?t[o]:o;if(h[p]){if(e&&(r=i?h[p]:h[p].data)){A.isArray(e)||(e in r?e=[e]:(e=A.camelCase(e),e=e in r?[e]:e.split(" ")));for(a=0,s=e.length;s>a;a++)delete r[e[a]];if(!(i?n:A.isEmptyObject)(r))return}if(!i&&(delete h[p].data,!n(h[p])))return;A.support.deleteExpando||!h.setInterval?delete h[p]:h[p]=null,l&&(A.support.deleteExpando?delete t[o]:t.removeAttribute?t.removeAttribute(o):t[o]=null)}}},_data:function(t,e,i){return A.data(t,e,i,!0)},acceptData:function(t){if(t.nodeName){var e=A.noData[t.nodeName.toLowerCase()];if(e)return!(!0===e||t.getAttribute("classid")!==e)}return!0}}),A.fn.extend({data:function(t,i){var n,a,s,o=null;if("undefined"==typeof t){if(this.length&&(o=A.data(this[0]),1===this[0].nodeType&&!A._data(this[0],"parsedAttrs"))){a=this[0].attributes;for(var l=0,h=a.length;h>l;l++)s=a[l].name,0===s.indexOf("data-")&&(s=A.camelCase(s.substring(5)),r(this[0],s,o[s]));A._data(this[0],"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){A.data(this,t)}):(n=t.split("."),n[1]=n[1]?"."+n[1]:"",i===e?(o=this.triggerHandler("getData"+n[1]+"!",[n[0]]),o===e&&this.length&&(o=A.data(this[0],t),o=r(this[0],t,o)),o===e&&n[1]?this.data(n[0]):o):this.each(function(){var e=A(this),r=[n[0],i];e.triggerHandler("setData"+n[1]+"!",r),A.data(this,t,i),e.triggerHandler("changeData"+n[1]+"!",r)}))},removeData:function(t){return this.each(function(){A.removeData(this,t)})}}),A.extend({_mark:function(t,e){t&&(e=(e||"fx")+"mark",A._data(t,e,(A._data(t,e)||0)+1))},_unmark:function(t,e,i){if(!0!==t&&(i=e,e=t,t=!1),e){var i=i||"fx",r=i+"mark";(t=t?0:(A._data(e,r)||1)-1)?A._data(e,r,t):(A.removeData(e,r,!0),a(e,i,"mark"))}},queue:function(t,e,i){var r;return t?(e=(e||"fx")+"queue",r=A._data(t,e),i&&(!r||A.isArray(i)?r=A._data(t,e,A.makeArray(i)):r.push(i)),r||[]):void 0},dequeue:function(t,e){var e=e||"fx",i=A.queue(t,e),r=i.shift(),n={};"inprogress"===r&&(r=i.shift()),r&&("fx"===e&&i.unshift("inprogress"),A._data(t,e+".run",n),r.call(t,function(){A.dequeue(t,e)},n)),i.length||(A.removeData(t,e+"queue "+e+".run",!0),a(t,e,"queue"))}}),A.fn.extend({queue:function(t,i){return"string"!=typeof t&&(i=t,t="fx"),i===e?A.queue(this[0],t):this.each(function(){var e=A.queue(this,t,i);"fx"===t&&"inprogress"!==e[0]&&A.dequeue(this,t)})},dequeue:function(t){return this.each(function(){A.dequeue(this,t)})},delay:function(t,e){return t=A.fx?A.fx.speeds[t]||t:t,this.queue(e||"fx",function(e,i){var r=setTimeout(e,t);i.stop=function(){clearTimeout(r)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t){function i(){--o||n.resolveWith(a,[a])}"string"!=typeof t&&(t=e);for(var r,t=t||"fx",n=A.Deferred(),a=this,s=a.length,o=1,l=t+"defer",h=t+"queue",t=t+"mark";s--;)(r=A.data(a[s],l,e,!0)||(A.data(a[s],h,e,!0)||A.data(a[s],t,e,!0))&&A.data(a[s],l,A.Callbacks("once memory"),!0))&&(o++,r.add(i));return i(),n.promise()}});var P,F,N,O=/[\n\t\r]/g,B=/\s+/,X=/\r/g,G=/^(?:button|input)$/i,W=/^(?:button|input|object|select|textarea)$/i,H=/^a(?:rea)?$/i,j=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Y=A.support.getSetAttribute;A.fn.extend({attr:function(t,e){return A.access(this,t,e,!0,A.attr)},removeAttr:function(t){return this.each(function(){A.removeAttr(this,t)})},prop:function(t,e){return A.access(this,t,e,!0,A.prop)},removeProp:function(t){return t=A.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(i){}})},addClass:function(t){var e,i,r,n,a,s,o;if(A.isFunction(t))return this.each(function(e){A(this).addClass(t.call(this,e,this.className))});if(t&&"string"==typeof t)for(e=t.split(B),i=0,r=this.length;r>i;i++)if(n=this[i],1===n.nodeType)if(n.className||1!==e.length){for(a=" "+n.className+" ",s=0,o=e.length;o>s;s++)~a.indexOf(" "+e[s]+" ")||(a+=e[s]+" ");n.className=A.trim(a)}else n.className=t;return this},removeClass:function(t){var i,r,n,a,s,o,l;if(A.isFunction(t))return this.each(function(e){A(this).removeClass(t.call(this,e,this.className))});if(t&&"string"==typeof t||t===e)for(i=(t||"").split(B),r=0,n=this.length;n>r;r++)if(a=this[r],1===a.nodeType&&a.className)if(t){for(s=(" "+a.className+" ").replace(O," "),o=0,l=i.length;l>o;o++)s=s.replace(" "+i[o]+" "," ");a.className=A.trim(s)}else a.className="";return this},toggleClass:function(t,e){var i=typeof t,r="boolean"==typeof e;return A.isFunction(t)?this.each(function(i){A(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var n,a=0,s=A(this),o=e,l=t.split(B);n=l[a++];)o=r?o:!s.hasClass(n),s[o?"addClass":"removeClass"](n);else("undefined"===i||"boolean"===i)&&(this.className&&A._data(this,"__className__",this.className),this.className=this.className||!1===t?"":A._data(this,"__className__")||"")})},hasClass:function(t){for(var t=" "+t+" ",e=0,i=this.length;i>e;e++)if(1===this[e].nodeType&&-1<(" "+this[e].className+" ").replace(O," ").indexOf(t))return!0;
return!1},val:function(t){var i,r,n,a=this[0];return arguments.length?(n=A.isFunction(t),this.each(function(r){var a=A(this);1!==this.nodeType||(r=n?t.call(this,r,a.val()):t,null==r?r="":"number"==typeof r?r+="":A.isArray(r)&&(r=A.map(r,function(t){return null==t?"":t+""})),i=A.valHooks[this.nodeName.toLowerCase()]||A.valHooks[this.type],i&&"set"in i&&i.set(this,r,"value")!==e)||(this.value=r)})):a?(i=A.valHooks[a.nodeName.toLowerCase()]||A.valHooks[a.type])&&"get"in i&&(r=i.get(a,"value"))!==e?r:(r=a.value,"string"==typeof r?r.replace(X,""):null==r?"":r):void 0}}),A.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,i,r=t.selectedIndex,n=[],a=t.options,s="select-one"===t.type;if(0>r)return null;for(t=s?r:0,i=s?r+1:a.length;i>t;t++)if(e=a[t],!(!e.selected||(A.support.optDisabled?e.disabled:null!==e.getAttribute("disabled"))||e.parentNode.disabled&&A.nodeName(e.parentNode,"optgroup"))){if(e=A(e).val(),s)return e;n.push(e)}return s&&!n.length&&a.length?A(a[r]).val():n},set:function(t,e){var i=A.makeArray(e);return A(t).find("option").each(function(){this.selected=0<=A.inArray(A(this).val(),i)}),i.length||(t.selectedIndex=-1),i}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(t,i,r,n){var a,s,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o){if(n&&i in A.attrFn)return A(t)[i](r);if("undefined"==typeof t.getAttribute)return A.prop(t,i,r);if((n=1!==o||!A.isXMLDoc(t))&&(i=i.toLowerCase(),s=A.attrHooks[i]||(j.test(i)?F:P)),r===e)return s&&"get"in s&&n&&null!==(a=s.get(t,i))?a:(a=t.getAttribute(i),null===a?e:a);if(null!==r)return s&&"set"in s&&n&&(a=s.set(t,r,i))!==e?a:(t.setAttribute(i,""+r),r);A.removeAttr(t,i)}},removeAttr:function(t,e){var i,r,n,a,s=0;if(e&&1===t.nodeType)for(r=e.toLowerCase().split(B),a=r.length;a>s;s++)(n=r[s])&&(i=A.propFix[n]||n,A.attr(t,n,""),t.removeAttribute(Y?n:i),j.test(n)&&i in t&&(t[i]=!1))},attrHooks:{type:{set:function(t,e){if(G.test(t.nodeName)&&t.parentNode)A.error("type property can't be changed");else if(!A.support.radioValue&&"radio"===e&&A.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}},value:{get:function(t,e){return P&&A.nodeName(t,"button")?P.get(t,e):e in t?t.value:null},set:function(t,e,i){return P&&A.nodeName(t,"button")?P.set(t,e,i):void(t.value=e)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,i,r){var n,a,s=t.nodeType;return t&&3!==s&&8!==s&&2!==s?(1===s&&A.isXMLDoc(t)||(i=A.propFix[i]||i,a=A.propHooks[i]),r!==e?a&&"set"in a&&(n=a.set(t,r,i))!==e?n:t[i]=r:a&&"get"in a&&null!==(n=a.get(t,i))?n:t[i]):void 0},propHooks:{tabIndex:{get:function(t){var i=t.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):W.test(t.nodeName)||H.test(t.nodeName)&&t.href?0:e}}}}),A.attrHooks.tabindex=A.propHooks.tabIndex,F={get:function(t,i){var r,n=A.prop(t,i);return!0===n||"boolean"!=typeof n&&(r=t.getAttributeNode(i))&&!1!==r.nodeValue?i.toLowerCase():e},set:function(t,e,i){return!1===e?A.removeAttr(t,i):(e=A.propFix[i]||i,e in t&&(t[e]=!0),t.setAttribute(i,i.toLowerCase())),i}},Y||(N={name:!0,id:!0},P=A.valHooks.button={get:function(t,i){var r;return(r=t.getAttributeNode(i))&&(N[i]?""!==r.nodeValue:r.specified)?r.nodeValue:e},set:function(t,e,i){var r=t.getAttributeNode(i);return r||(r=k.createAttribute(i),t.setAttributeNode(r)),r.nodeValue=e+""}},A.attrHooks.tabindex.set=P.set,A.each(["width","height"],function(t,e){A.attrHooks[e]=A.extend(A.attrHooks[e],{set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}})}),A.attrHooks.contenteditable={get:P.get,set:function(t,e,i){""===e&&(e="false"),P.set(t,e,i)}}),A.support.hrefNormalized||A.each(["href","src","width","height"],function(t,i){A.attrHooks[i]=A.extend(A.attrHooks[i],{get:function(t){return t=t.getAttribute(i,2),null===t?e:t}})}),A.support.style||(A.attrHooks.style={get:function(t){return t.style.cssText.toLowerCase()||e},set:function(t,e){return t.style.cssText=""+e}}),A.support.optSelected||(A.propHooks.selected=A.extend(A.propHooks.selected,{get:function(){return null}})),A.support.enctype||(A.propFix.enctype="encoding"),A.support.checkOn||A.each(["radio","checkbox"],function(){A.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]=A.extend(A.valHooks[this],{set:function(t,e){return A.isArray(e)?t.checked=0<=A.inArray(A(t).val(),e):void 0}})});var V=/^(?:textarea|input|select)$/i,z=/^([^\.]*)?(?:\.(.+))?$/,U=/\bhover(\.\S+)?\b/,q=/^key/,Q=/^(?:mouse|contextmenu)|click/,Z=/^(?:focusinfocus|focusoutblur)$/,K=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,J=function(t){return(t=K.exec(t))&&(t[1]=(t[1]||"").toLowerCase(),t[3]=t[3]&&RegExp("(?:^|\\s)"+t[3]+"(?:\\s|$)")),t},tt=function(t){return A.event.special.hover?t:t.replace(U,"mouseenter$1 mouseleave$1")};A.event={add:function(t,i,r,n,a){var s,o,l,h,p,c,d,u,m;if(3!==t.nodeType&&8!==t.nodeType&&i&&r&&(s=A._data(t))){for(r.handler&&(d=r,r=d.handler),r.guid||(r.guid=A.guid++),l=s.events,l||(s.events=l={}),o=s.handle,o||(s.handle=o=function(t){return"undefined"==typeof A||t&&A.event.triggered===t.type?e:A.event.dispatch.apply(o.elem,arguments)},o.elem=t),i=A.trim(tt(i)).split(" "),s=0;s<i.length;s++)h=z.exec(i[s])||[],p=h[1],c=(h[2]||"").split(".").sort(),m=A.event.special[p]||{},p=(a?m.delegateType:m.bindType)||p,m=A.event.special[p]||{},h=A.extend({type:p,origType:h[1],data:n,handler:r,guid:r.guid,selector:a,quick:J(a),namespace:c.join(".")},d),u=l[p],u||(u=l[p]=[],u.delegateCount=0,m.setup&&!1!==m.setup.call(t,n,c,o))||(t.addEventListener?t.addEventListener(p,o,!1):t.attachEvent&&t.attachEvent("on"+p,o)),m.add&&(m.add.call(t,h),!h.handler.guid)&&(h.handler.guid=r.guid),a?u.splice(u.delegateCount++,0,h):u.push(h),A.event.global[p]=!0;t=null}},global:{},remove:function(t,e,i,r,n){var a,s,o,l,h,p,c,d,u,m,f=A.hasData(t)&&A._data(t);if(f&&(c=f.events)){for(e=A.trim(tt(e||"")).split(" "),a=0;a<e.length;a++)if(s=z.exec(e[a])||[],o=l=s[1],s=s[2],o){for(d=A.event.special[o]||{},o=(r?d.delegateType:d.bindType)||o,u=c[o]||[],h=u.length,s=s?RegExp("(^|\\.)"+s.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,p=0;p<u.length;p++)m=u[p],!n&&l!==m.origType||i&&i.guid!==m.guid||s&&!s.test(m.namespace)||r&&r!==m.selector&&("**"!==r||!m.selector)||(u.splice(p--,1),m.selector&&u.delegateCount--,d.remove&&d.remove.call(t,m));0===u.length&&h!==u.length&&((!d.teardown||!1===d.teardown.call(t,s))&&A.removeEvent(t,o,f.handle),delete c[o])}else for(o in c)A.event.remove(t,o+e[a],i,r,!0);A.isEmptyObject(c)&&((e=f.handle)&&(e.elem=null),A.removeData(t,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(i,r,n,a){if(!n||3!==n.nodeType&&8!==n.nodeType){var s,o,l,h,p,c=i.type||i,d=[];if(!Z.test(c+A.event.triggered)&&(0<=c.indexOf("!")&&(c=c.slice(0,-1),s=!0),0<=c.indexOf(".")&&(d=c.split("."),c=d.shift(),d.sort()),n&&!A.event.customEvent[c]||A.event.global[c]))if(i="object"==typeof i?i[A.expando]?i:new A.Event(c,i):new A.Event(c),i.type=c,i.isTrigger=!0,i.exclusive=s,i.namespace=d.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+d.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,s=0>c.indexOf(":")?"on"+c:"",n){if(i.result=e,i.target||(i.target=n),r=null!=r?A.makeArray(r):[],r.unshift(i),l=A.event.special[c]||{},!l.trigger||!1!==l.trigger.apply(n,r)){if(p=[[n,l.bindType||c]],!a&&!l.noBubble&&!A.isWindow(n)){for(h=l.delegateType||c,d=Z.test(h+c)?n:n.parentNode,o=null;d;d=d.parentNode)p.push([d,h]),o=d;o&&o===n.ownerDocument&&p.push([o.defaultView||o.parentWindow||t,h])}for(o=0;o<p.length&&!i.isPropagationStopped();o++)d=p[o][0],i.type=p[o][1],(h=(A._data(d,"events")||{})[i.type]&&A._data(d,"handle"))&&h.apply(d,r),(h=s&&d[s])&&A.acceptData(d)&&!1===h.apply(d,r)&&i.preventDefault();return i.type=c,a||i.isDefaultPrevented()||l._default&&!1!==l._default.apply(n.ownerDocument,r)||"click"===c&&A.nodeName(n,"a")||!A.acceptData(n)||s&&n[c]&&("focus"!==c&&"blur"!==c||0!==i.target.offsetWidth)&&!A.isWindow(n)&&((o=n[s])&&(n[s]=null),A.event.triggered=c,n[c](),A.event.triggered=e,o&&(n[s]=o)),i.result}}else for(o in n=A.cache)n[o].events&&n[o].events[c]&&A.event.trigger(i,r,n[o].handle.elem,!0)}},dispatch:function(i){var r,n,a,s,o,l,h,i=A.event.fix(i||t.event),p=(A._data(this,"events")||{})[i.type]||[],c=p.delegateCount,d=[].slice.call(arguments,0),u=!i.exclusive&&!i.namespace,m=[];if(d[0]=i,i.delegateTarget=this,c&&!i.target.disabled&&(!i.button||"click"!==i.type))for(a=A(this),a.context=this.ownerDocument||this,n=i.target;n!=this;n=n.parentNode||this){for(o={},l=[],a[0]=n,r=0;c>r;r++){if(s=p[r],h=s.selector,o[h]===e){var f,y=o,g=h;if(s.quick){f=s.quick;var v=n.attributes||{};f=!(f[1]&&n.nodeName.toLowerCase()!==f[1]||f[2]&&(v.id||{}).value!==f[2]||f[3]&&!f[3].test((v["class"]||{}).value))}else f=a.is(h);y[g]=f}o[h]&&l.push(s)}l.length&&m.push({elem:n,matches:l})}for(p.length>c&&m.push({elem:this,matches:p.slice(c)}),r=0;r<m.length&&!i.isPropagationStopped();r++)for(c=m[r],i.currentTarget=c.elem,p=0;p<c.matches.length&&!i.isImmediatePropagationStopped();p++)s=c.matches[p],(u||!i.namespace&&!s.namespace||i.namespace_re&&i.namespace_re.test(s.namespace))&&(i.data=s.data,i.handleObj=s,s=((A.event.special[s.origType]||{}).handle||s.handler).apply(c.elem,d),s!==e&&(i.result=s,!1===s&&(i.preventDefault(),i.stopPropagation())));return i.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var r,n,a=i.button,s=i.fromElement;return null==t.pageX&&null!=i.clientX&&(r=t.target.ownerDocument||k,n=r.documentElement,r=r.body,t.pageX=i.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=i.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),!t.relatedTarget&&s&&(t.relatedTarget=s===t.target?i.toElement:s),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[A.expando])return t;var i,r,n=t,a=A.event.fixHooks[t.type]||{},s=a.props?this.props.concat(a.props):this.props,t=A.Event(n);for(i=s.length;i;)r=s[--i],t[r]=n[r];return t.target||(t.target=n.srcElement||k),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey===e&&(t.metaKey=t.ctrlKey),a.filter?a.filter(t,n):t},special:{ready:{setup:A.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(t,e,i){A.isWindow(this)&&(this.onbeforeunload=i)},teardown:function(t,e){this.onbeforeunload===e&&(this.onbeforeunload=null)}}},simulate:function(t,e,i,r){t=A.extend(new A.Event,i,{type:t,isSimulated:!0,originalEvent:{}}),r?A.event.trigger(t,null,e):A.event.dispatch.call(e,t),t.isDefaultPrevented()&&i.preventDefault()}},A.event.handle=A.event.dispatch,A.removeEvent=k.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){t.detachEvent&&t.detachEvent("on"+e,i)},A.Event=function(t,e){return this instanceof A.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||!1===t.returnValue||t.getPreventDefault&&t.getPreventDefault()?o:s):this.type=t,e&&A.extend(this,e),this.timeStamp=t&&t.timeStamp||A.now(),void(this[A.expando]=!0)):new A.Event(t,e)},A.Event.prototype={preventDefault:function(){this.isDefaultPrevented=o;var t=this.originalEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=o;var t=this.originalEvent;t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},A.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){A.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,r=t.relatedTarget,n=t.handleObj;return(!r||r!==this&&!A.contains(this,r))&&(t.type=n.origType,i=n.handler.apply(this,arguments),t.type=e),i}}}),A.support.submitBubbles||(A.event.special.submit={setup:function(){return A.nodeName(this,"form")?!1:void A.event.add(this,"click._submit keypress._submit",function(t){t=t.target,(t=A.nodeName(t,"input")||A.nodeName(t,"button")?t.form:e)&&!t._submit_attached&&(A.event.add(t,"submit._submit",function(t){this.parentNode&&!t.isTrigger&&A.event.simulate("submit",this.parentNode,t,!0)}),t._submit_attached=!0)})},teardown:function(){return A.nodeName(this,"form")?!1:void A.event.remove(this,"._submit")}}),A.support.changeBubbles||(A.event.special.change={setup:function(){return V.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(A.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),A.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1,A.event.simulate("change",this,t,!0))})),!1):void A.event.add(this,"beforeactivate._change",function(t){t=t.target,V.test(t.nodeName)&&!t._change_attached&&(A.event.add(t,"change._change",function(t){this.parentNode&&!t.isSimulated&&!t.isTrigger&&A.event.simulate("change",this.parentNode,t,!0)}),t._change_attached=!0)})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return A.event.remove(this,"._change"),V.test(this.nodeName)}}),A.support.focusinBubbles||A.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,r=function(t){A.event.simulate(e,t.target,A.event.fix(t),!0)};A.event.special[e]={setup:function(){0===i++&&k.addEventListener(t,r,!0)},teardown:function(){0===--i&&k.removeEventListener(t,r,!0)}}}),A.fn.extend({on:function(t,i,r,n,a){var o,l;if("object"==typeof t){"string"!=typeof i&&(r=i,i=e);for(l in t)this.on(l,i,r,t[l],a);return this}if(null==r&&null==n?(n=i,r=i=e):null==n&&("string"==typeof i?(n=r,r=e):(n=r,r=i,i=e)),!1===n)n=s;else if(!n)return this;return 1===a&&(o=n,n=function(t){return A().off(t),o.apply(this,arguments)},n.guid=o.guid||(o.guid=A.guid++)),this.each(function(){A.event.add(this,t,n,r,i)})},one:function(t,e,i,r){return this.on.call(this,t,e,i,r,1)},off:function(t,i,r){if(t&&t.preventDefault&&t.handleObj){var n=t.handleObj;return A(t.delegateTarget).off(n.namespace?n.type+"."+n.namespace:n.type,n.selector,n.handler),this}if("object"==typeof t){for(n in t)this.off(n,i,t[n]);return this}return(!1===i||"function"==typeof i)&&(r=i,i=e),!1===r&&(r=s),this.each(function(){A.event.remove(this,t,r,i)})},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},live:function(t,e,i){return A(this.context).on(t,this.selector,e,i),this},die:function(t,e){return A(this.context).off(t,this.selector||"**",e),this},delegate:function(t,e,i,r){return this.on(e,t,i,r)},undelegate:function(t,e,i){return 1==arguments.length?this.off(t,"**"):this.off(e,t,i)},trigger:function(t,e){return this.each(function(){A.event.trigger(t,e,this)})},triggerHandler:function(t,e){return this[0]?A.event.trigger(t,e,this[0],!0):void 0},toggle:function(t){var e=arguments,i=t.guid||A.guid++,r=0,n=function(i){var n=(A._data(this,"lastToggle"+t.guid)||0)%r;return A._data(this,"lastToggle"+t.guid,n+1),i.preventDefault(),e[n].apply(this,arguments)||!1};for(n.guid=i;r<e.length;)e[r++].guid=i;return this.click(n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),A.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){A.fn[e]=function(t,i){return null==i&&(i=t,t=null),0<arguments.length?this.on(e,null,t,i):this.trigger(e)},A.attrFn&&(A.attrFn[e]=!0),q.test(e)&&(A.event.fixHooks[e]=A.event.keyHooks),Q.test(e)&&(A.event.fixHooks[e]=A.event.mouseHooks)}),function(){function t(t,e,i,r,a,s){for(var a=0,o=r.length;o>a;a++){var l=r[a];if(l){for(var h=!1,l=l[t];l;){if(l[n]===i){h=r[l.sizset];break}if(1!==l.nodeType||s||(l[n]=i,l.sizset=a),l.nodeName.toLowerCase()===e){h=l;break}l=l[t]}r[a]=h}}}function i(t,e,i,r,a,s){for(var a=0,o=r.length;o>a;a++){var l=r[a];if(l){for(var h=!1,l=l[t];l;){if(l[n]===i){h=r[l.sizset];break}if(1===l.nodeType)if(s||(l[n]=i,l.sizset=a),"string"!=typeof e){if(l===e){h=!0;break}}else if(0<d.filter(e,[l]).length){h=l;break}l=l[t]}r[a]=h}}}var r=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,n="sizcache"+(Math.random()+"").replace(".",""),a=0,s=Object.prototype.toString,o=!1,l=!0,h=/\\/g,p=/\r\n/g,c=/\W/;[0,0].sort(function(){return l=!1,0});var d=function(t,e,i,n){var i=i||[],a=e=e||k;if(1!==e.nodeType&&9!==e.nodeType)return[];if(!t||"string"!=typeof t)return i;var o,l,h,p,c,u=!0,m=d.isXML(e),g=[],b=t;do if(r.exec(""),(o=r.exec(b))&&(b=o[3],g.push(o[1]),o[2])){p=o[3];break}while(o);if(1<g.length&&y.exec(t))if(2===g.length&&f.relative[g[0]])l=x(g[0]+g[1],e,n);else for(l=f.relative[g[0]]?[e]:d(g.shift(),e);g.length;)t=g.shift(),f.relative[t]&&(t+=g.shift()),l=x(t,l,n);else if(!n&&1<g.length&&9===e.nodeType&&!m&&f.match.ID.test(g[0])&&!f.match.ID.test(g[g.length-1])&&(o=d.find(g.shift(),e,m),e=o.expr?d.filter(o.expr,o.set)[0]:o.set[0]),e)for(o=n?{expr:g.pop(),set:v(n)}:d.find(g.pop(),1!==g.length||"~"!==g[0]&&"+"!==g[0]||!e.parentNode?e:e.parentNode,m),l=o.expr?d.filter(o.expr,o.set):o.set,0<g.length?h=v(l):u=!1;g.length;)o=c=g.pop(),f.relative[c]?o=g.pop():c="",null==o&&(o=e),f.relative[c](h,o,m);else h=[];if(h||(h=l),h||d.error(c||t),"[object Array]"===s.call(h))if(u)if(e&&1===e.nodeType)for(t=0;null!=h[t];t++)h[t]&&(!0===h[t]||1===h[t].nodeType&&d.contains(e,h[t]))&&i.push(l[t]);else for(t=0;null!=h[t];t++)h[t]&&1===h[t].nodeType&&i.push(l[t]);else i.push.apply(i,h);else v(h,i);return p&&(d(p,a,i,n),d.uniqueSort(i)),i};d.uniqueSort=function(t){if(w&&(o=l,t.sort(w),o))for(var e=1;e<t.length;e++)t[e]===t[e-1]&&t.splice(e--,1);return t},d.matches=function(t,e){return d(t,null,null,e)},d.matchesSelector=function(t,e){return 0<d(e,null,null,[t]).length},d.find=function(t,e,i){var r,n,a,s,o,l;if(!t)return[];for(n=0,a=f.order.length;a>n;n++)if(o=f.order[n],(s=f.leftMatch[o].exec(t))&&(l=s[1],s.splice(1,1),"\\"!==l.substr(l.length-1)&&(s[1]=(s[1]||"").replace(h,""),r=f.find[o](s,e,i),null!=r))){t=t.replace(f.match[o],"");break}return r||(r="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):[]),{set:r,expr:t}},d.filter=function(t,i,r,n){for(var a,s,o,l,h,p,c,u,m=t,y=[],g=i,v=i&&i[0]&&d.isXML(i[0]);t&&i.length;){for(o in f.filter)if(null!=(a=f.leftMatch[o].exec(t))&&a[2]&&(p=f.filter[o],h=a[1],s=!1,a.splice(1,1),"\\"!==h.substr(h.length-1))){if(g===y&&(y=[]),f.preFilter[o])if(a=f.preFilter[o](a,g,r,y,n,v)){if(!0===a)continue}else s=l=!0;if(a)for(c=0;null!=(h=g[c]);c++)h&&(l=p(h,a,c,g),u=n^l,r&&null!=l?u?s=!0:g[c]=!1:u&&(y.push(h),s=!0));if(l!==e){if(r||(g=y),t=t.replace(f.match[o],""),!s)return[];break}}if(t===m){if(null!=s)break;d.error(t)}m=t}return g},d.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)};var u,m=d.getText=function(t){var e,i;e=t.nodeType;var r="";if(e){if(1===e||9===e){if("string"==typeof t.textContent)return t.textContent;if("string"==typeof t.innerText)return t.innerText.replace(p,"");for(t=t.firstChild;t;t=t.nextSibling)r+=m(t)}else if(3===e||4===e)return t.nodeValue}else for(e=0;i=t[e];e++)8!==i.nodeType&&(r+=m(i));return r},f=d.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(t){return t.getAttribute("href")},type:function(t){return t.getAttribute("type")}},relative:{"+":function(t,e){var i="string"==typeof e,r=i&&!c.test(e),i=i&&!r;r&&(e=e.toLowerCase());for(var n,r=0,a=t.length;a>r;r++)if(n=t[r]){for(;(n=n.previousSibling)&&1!==n.nodeType;);t[r]=i||n&&n.nodeName.toLowerCase()===e?n||!1:n===e}i&&d.filter(e,t,!0)},">":function(t,e){var i,r="string"==typeof e,n=0,a=t.length;if(r&&!c.test(e))for(e=e.toLowerCase();a>n;n++)(i=t[n])&&(i=i.parentNode,t[n]=i.nodeName.toLowerCase()===e?i:!1);else{for(;a>n;n++)(i=t[n])&&(t[n]=r?i.parentNode:i.parentNode===e);r&&d.filter(e,t,!0)}},"":function(e,r,n){var s,o=a++,l=i;"string"==typeof r&&!c.test(r)&&(s=r=r.toLowerCase(),l=t),l("parentNode",r,o,e,s,n)},"~":function(e,r,n){var s,o=a++,l=i;"string"==typeof r&&!c.test(r)&&(s=r=r.toLowerCase(),l=t),l("previousSibling",r,o,e,s,n)}},find:{ID:function(t,e,i){return"undefined"==typeof e.getElementById||i?void 0:(t=e.getElementById(t[1]))&&t.parentNode?[t]:[]},NAME:function(t,e){if("undefined"!=typeof e.getElementsByName){for(var i=[],r=e.getElementsByName(t[1]),n=0,a=r.length;a>n;n++)r[n].getAttribute("name")===t[1]&&i.push(r[n]);return 0===i.length?null:i}},TAG:function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t[1]):void 0}},preFilter:{CLASS:function(t,e,i,r,n,a){if(t=" "+t[1].replace(h,"")+" ",a)return t;for(var s,a=0;null!=(s=e[a]);a++)s&&(n^(s.className&&0<=(" "+s.className+" ").replace(/[\t\n\r]/g," ").indexOf(t))?i||r.push(s):i&&(e[a]=!1));return!1},ID:function(t){return t[1].replace(h,"")},TAG:function(t){return t[1].replace(h,"").toLowerCase()},CHILD:function(t){if("nth"===t[1]){t[2]||d.error(t[0]),t[2]=t[2].replace(/^\+|\s*/g,"");var e=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===t[2]&&"2n"||"odd"===t[2]&&"2n+1"||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=e[1]+(e[2]||1)-0,t[3]=e[3]-0}else t[2]&&d.error(t[0]);return t[0]=a++,t},ATTR:function(t,e,i,r,n,a){return e=t[1]=t[1].replace(h,""),!a&&f.attrMap[e]&&(t[1]=f.attrMap[e]),t[4]=(t[4]||t[5]||"").replace(h,""),"~="===t[2]&&(t[4]=" "+t[4]+" "),t},PSEUDO:function(t,e,i,n,a){if("not"===t[1]){if(!(1<(r.exec(t[3])||"").length||/^\w/.test(t[3])))return t=d.filter(t[3],e,i,1^a),i||n.push.apply(n,t),!1;t[3]=d(t[3],null,null,e)}else if(f.match.POS.test(t[0])||f.match.CHILD.test(t[0]))return!0;return t},POS:function(t){return t.unshift(!0),t}},filters:{enabled:function(t){return!1===t.disabled&&"hidden"!==t.type},disabled:function(t){return!0===t.disabled},checked:function(t){return!0===t.checked},selected:function(t){return!0===t.selected},parent:function(t){return!!t.firstChild},empty:function(t){return!t.firstChild},has:function(t,e,i){return!!d(i[3],t).length},header:function(t){return/h\d/i.test(t.nodeName)},text:function(t){var e=t.getAttribute("type"),i=t.type;return"input"===t.nodeName.toLowerCase()&&"text"===i&&(e===i||null===e)},radio:function(t){return"input"===t.nodeName.toLowerCase()&&"radio"===t.type},checkbox:function(t){return"input"===t.nodeName.toLowerCase()&&"checkbox"===t.type},file:function(t){return"input"===t.nodeName.toLowerCase()&&"file"===t.type},password:function(t){return"input"===t.nodeName.toLowerCase()&&"password"===t.type},submit:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"submit"===t.type},image:function(t){return"input"===t.nodeName.toLowerCase()&&"image"===t.type},reset:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"reset"===t.type},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},input:function(t){return/input|select|textarea|button/i.test(t.nodeName)},focus:function(t){return t===t.ownerDocument.activeElement}},setFilters:{first:function(t,e){return 0===e},last:function(t,e,i,r){return e===r.length-1},even:function(t,e){return 0===e%2},odd:function(t,e){return 1===e%2},lt:function(t,e,i){return e<i[3]-0},gt:function(t,e,i){return e>i[3]-0},nth:function(t,e,i){return i[3]-0===e},eq:function(t,e,i){return i[3]-0===e}},filter:{PSEUDO:function(t,e,i,r){var n=e[1],a=f.filters[n];if(a)return a(t,i,e,r);if("contains"===n)return 0<=(t.textContent||t.innerText||m([t])||"").indexOf(e[3]);if("not"===n){for(e=e[3],i=0,r=e.length;r>i;i++)if(e[i]===t)return!1;return!0}d.error(n)},CHILD:function(t,e){var i,r,a,s,o,l;switch(i=e[1],l=t,i){case"only":case"first":for(;l=l.previousSibling;)if(1===l.nodeType)return!1;if("first"===i)return!0;l=t;case"last":for(;l=l.nextSibling;)if(1===l.nodeType)return!1;return!0;case"nth":if(i=e[2],r=e[3],1===i&&0===r)return!0;if(a=e[0],(s=t.parentNode)&&(s[n]!==a||!t.nodeIndex)){for(o=0,l=s.firstChild;l;l=l.nextSibling)1===l.nodeType&&(l.nodeIndex=++o);s[n]=a}return l=t.nodeIndex-r,0===i?0===l:0===l%i&&l/i>=0}},ID:function(t,e){return 1===t.nodeType&&t.getAttribute("id")===e},TAG:function(t,e){return"*"===e&&1===t.nodeType||!!t.nodeName&&t.nodeName.toLowerCase()===e},CLASS:function(t,e){return-1<(" "+(t.className||t.getAttribute("class"))+" ").indexOf(e)},ATTR:function(t,e){var i=e[1],i=d.attr?d.attr(t,i):f.attrHandle[i]?f.attrHandle[i](t):null!=t[i]?t[i]:t.getAttribute(i),r=i+"",n=e[2],a=e[4];return null==i?"!="===n:!n&&d.attr?null!=i:"="===n?r===a:"*="===n?0<=r.indexOf(a):"~="===n?0<=(" "+r+" ").indexOf(a):a?"!="===n?r!==a:"^="===n?0===r.indexOf(a):"$="===n?r.substr(r.length-a.length)===a:"|="===n?r===a||r.substr(0,a.length+1)===a+"-":!1:r&&!1!==i},POS:function(t,e,i,r){var n=f.setFilters[e[2]];return n?n(t,i,e,r):void 0}}},y=f.match.POS,g=function(t,e){return"\\"+(e-0+1)};for(u in f.match)f.match[u]=RegExp(f.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source),f.leftMatch[u]=RegExp(/(^(?:.|\r|\n)*?)/.source+f.match[u].source.replace(/\\(\d+)/g,g));var v=function(t,e){return t=Array.prototype.slice.call(t,0),e?(e.push.apply(e,t),e):t};try{Array.prototype.slice.call(k.documentElement.childNodes,0)}catch(b){v=function(t,e){var i=0,r=e||[];if("[object Array]"===s.call(t))Array.prototype.push.apply(r,t);else if("number"==typeof t.length)for(var n=t.length;n>i;i++)r.push(t[i]);else for(;t[i];i++)r.push(t[i]);return r}}var w,S;k.documentElement.compareDocumentPosition?w=function(t,e){return t===e?(o=!0,0):t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:1:t.compareDocumentPosition?-1:1}:(w=function(t,e){if(t===e)return o=!0,0;if(t.sourceIndex&&e.sourceIndex)return t.sourceIndex-e.sourceIndex;var i,r,n=[],a=[];i=t.parentNode,r=e.parentNode;var s=i;if(i===r)return S(t,e);if(!i)return-1;if(!r)return 1;for(;s;)n.unshift(s),s=s.parentNode;for(s=r;s;)a.unshift(s),s=s.parentNode;for(i=n.length,r=a.length,s=0;i>s&&r>s;s++)if(n[s]!==a[s])return S(n[s],a[s]);return s===i?S(t,a[s],-1):S(n[s],e,1)},S=function(t,e,i){if(t===e)return i;for(t=t.nextSibling;t;){if(t===e)return-1;t=t.nextSibling}return 1}),function(){var t=k.createElement("div"),i="script"+(new Date).getTime(),r=k.documentElement;t.innerHTML="<a name='"+i+"'/>",r.insertBefore(t,r.firstChild),k.getElementById(i)&&(f.find.ID=function(t,i,r){return"undefined"==typeof i.getElementById||r?void 0:(i=i.getElementById(t[1]))?i.id===t[1]||"undefined"!=typeof i.getAttributeNode&&i.getAttributeNode("id").nodeValue===t[1]?[i]:e:[]},f.filter.ID=function(t,e){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return 1===t.nodeType&&i&&i.nodeValue===e}),r.removeChild(t),r=t=null}(),function(){var t=k.createElement("div");t.appendChild(k.createComment("")),0<t.getElementsByTagName("*").length&&(f.find.TAG=function(t,e){var i=e.getElementsByTagName(t[1]);if("*"===t[1]){for(var r=[],n=0;i[n];n++)1===i[n].nodeType&&r.push(i[n]);i=r}return i}),t.innerHTML="<a href='#'></a>",t.firstChild&&"undefined"!=typeof t.firstChild.getAttribute&&"#"!==t.firstChild.getAttribute("href")&&(f.attrHandle.href=function(t){return t.getAttribute("href",2)}),t=null}(),k.querySelectorAll&&function(){var t=d,e=k.createElement("div");if(e.innerHTML="<p class='TEST'></p>",!e.querySelectorAll||0!==e.querySelectorAll(".TEST").length){d=function(e,i,r,n){if(i=i||k,!n&&!d.isXML(i)){var a=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(e);if(a&&(1===i.nodeType||9===i.nodeType)){if(a[1])return v(i.getElementsByTagName(e),r);if(a[2]&&f.find.CLASS&&i.getElementsByClassName)return v(i.getElementsByClassName(a[2]),r)}if(9===i.nodeType){if("body"===e&&i.body)return v([i.body],r);if(a&&a[3]){var s=i.getElementById(a[3]);if(!s||!s.parentNode)return v([],r);if(s.id===a[3])return v([s],r)}try{return v(i.querySelectorAll(e),r)}catch(o){}}else if(1===i.nodeType&&"object"!==i.nodeName.toLowerCase()){var a=i,l=(s=i.getAttribute("id"))||"__sizzle__",h=i.parentNode,p=/^\s*[+~]/.test(e);s?l=l.replace(/'/g,"\\$&"):i.setAttribute("id",l),p&&h&&(i=i.parentNode);try{if(!p||h)return v(i.querySelectorAll("[id='"+l+"'] "+e),r)}catch(c){}finally{s||a.removeAttribute("id")}}}return t(e,i,r,n)};for(var i in t)d[i]=t[i];e=null}}(),function(){var t=k.documentElement,e=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector;if(e){var i=!e.call(k.createElement("div"),"div"),r=!1;try{e.call(k.documentElement,"[test!='']:sizzle")}catch(n){r=!0}d.matchesSelector=function(t,n){if(n=n.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!d.isXML(t))try{if(r||!f.match.PSEUDO.test(n)&&!/!=/.test(n)){var a=e.call(t,n);if(a||!i||t.document&&11!==t.document.nodeType)return a}}catch(s){}return 0<d(n,null,null,[t]).length}}}(),function(){var t=k.createElement("div");t.innerHTML="<div class='test e'></div><div class='test'></div>",t.getElementsByClassName&&0!==t.getElementsByClassName("e").length&&(t.lastChild.className="e",1!==t.getElementsByClassName("e").length)&&(f.order.splice(1,0,"CLASS"),f.find.CLASS=function(t,e,i){return"undefined"==typeof e.getElementsByClassName||i?void 0:e.getElementsByClassName(t[1])},t=null)}(),d.contains=k.documentElement.contains?function(t,e){return t!==e&&(t.contains?t.contains(e):!0)}:k.documentElement.compareDocumentPosition?function(t,e){return!!(16&t.compareDocumentPosition(e))}:function(){return!1},d.isXML=function(t){return(t=(t?t.ownerDocument||t:0).documentElement)?"HTML"!==t.nodeName:!1};var x=function(t,e,i){for(var r,n=[],a="",e=e.nodeType?[e]:e;r=f.match.PSEUDO.exec(t);)a+=r[0],t=t.replace(f.match.PSEUDO,"");t=f.relative[t]?t+"*":t,r=0;for(var s=e.length;s>r;r++)d(t,e[r],n,i);return d.filter(a,n)};d.attr=A.attr,d.selectors.attrMap={},A.find=d,A.expr=d.selectors,A.expr[":"]=A.expr.filters,A.unique=d.uniqueSort,A.text=d.getText,A.isXMLDoc=d.isXML,A.contains=d.contains}();var et=/Until$/,it=/^(?:parents|prevUntil|prevAll)/,rt=/,/,nt=/^.[^:#\[\.,]*$/,at=Array.prototype.slice,st=A.expr.match.POS,ot={children:!0,contents:!0,next:!0,prev:!0};A.fn.extend({find:function(t){var e,i,r=this;if("string"!=typeof t)return A(t).filter(function(){for(e=0,i=r.length;i>e;e++)if(A.contains(r[e],this))return!0});var n,a,s,o=this.pushStack("","find",t);for(e=0,i=this.length;i>e;e++)if(n=o.length,A.find(t,this[e],o),e>0)for(a=n;a<o.length;a++)for(s=0;n>s;s++)if(o[s]===o[a]){o.splice(a--,1);break}return o},has:function(t){var e=A(t);return this.filter(function(){for(var t=0,i=e.length;i>t;t++)if(A.contains(this,e[t]))return!0;
})},not:function(t){return this.pushStack(l(this,t,!1),"not",t)},filter:function(t){return this.pushStack(l(this,t,!0),"filter",t)},is:function(t){return!!t&&("string"==typeof t?st.test(t)?0<=A(t,this.context).index(this[0]):0<A.filter(t,this).length:0<this.filter(t).length)},closest:function(t,e){var i,r,n=[],a=this[0];if(A.isArray(t)){for(r=1;a&&a.ownerDocument&&a!==e;){for(i=0;i<t.length;i++)A(a).is(t[i])&&n.push({selector:t[i],elem:a,level:r});a=a.parentNode,r++}return n}var s=st.test(t)||"string"!=typeof t?A(t,e||this.context):0;for(i=0,r=this.length;r>i;i++)for(a=this[i];a;){if(s?-1<s.index(a):A.find.matchesSelector(a,t)){n.push(a);break}if(a=a.parentNode,!a||!a.ownerDocument||a===e||11===a.nodeType)break}return n=1<n.length?A.unique(n):n,this.pushStack(n,"closest",t)},index:function(t){return t?"string"==typeof t?A.inArray(this[0],A(t)):A.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(t,e){var i="string"==typeof t?A(t,e):A.makeArray(t&&t.nodeType?[t]:t),r=A.merge(this.get(),i);return this.pushStack(i[0]&&i[0].parentNode&&11!==i[0].parentNode.nodeType&&r[0]&&r[0].parentNode&&11!==r[0].parentNode.nodeType?A.unique(r):r)},andSelf:function(){return this.add(this.prevObject)}}),A.each({parent:function(t){return(t=t.parentNode)&&11!==t.nodeType?t:null},parents:function(t){return A.dir(t,"parentNode")},parentsUntil:function(t,e,i){return A.dir(t,"parentNode",i)},next:function(t){return A.nth(t,2,"nextSibling")},prev:function(t){return A.nth(t,2,"previousSibling")},nextAll:function(t){return A.dir(t,"nextSibling")},prevAll:function(t){return A.dir(t,"previousSibling")},nextUntil:function(t,e,i){return A.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return A.dir(t,"previousSibling",i)},siblings:function(t){return A.sibling(t.parentNode.firstChild,t)},children:function(t){return A.sibling(t.firstChild)},contents:function(t){return A.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:A.makeArray(t.childNodes)}},function(t,e){A.fn[t]=function(i,r){var n=A.map(this,e,i);return et.test(t)||(r=i),r&&"string"==typeof r&&(n=A.filter(r,n)),n=1<this.length&&!ot[t]?A.unique(n):n,(1<this.length||rt.test(r))&&it.test(t)&&(n=n.reverse()),this.pushStack(n,t,at.call(arguments).join(","))}}),A.extend({filter:function(t,e,i){return i&&(t=":not("+t+")"),1===e.length?A.find.matchesSelector(e[0],t)?[e[0]]:[]:A.find.matches(t,e)},dir:function(t,i,r){for(var n=[],t=t[i];t&&9!==t.nodeType&&(r===e||1!==t.nodeType||!A(t).is(r));)1===t.nodeType&&n.push(t),t=t[i];return n},nth:function(t,e,i){for(var e=e||1,r=0;t&&(1!==t.nodeType||++r!==e);t=t[i]);return t},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var lt="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:\d+|null)"/g,pt=/^\s+/,ct=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,dt=/<([\w:]+)/,ut=/<tbody/i,mt=/<|&#?\w+;/,ft=/<(?:script|style)/i,yt=/<(?:script|object|embed|option|style)/i,gt=RegExp("<(?:"+lt+")","i"),vt=/checked\s*(?:[^=]|=\s*.checked.)/i,bt=/\/(java|ecma)script/i,wt=/^\s*<!(?:\[CDATA\[|\-\-)/,St={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},xt=h(k);St.optgroup=St.option,St.tbody=St.tfoot=St.colgroup=St.caption=St.thead,St.th=St.td,A.support.htmlSerialize||(St._default=[1,"div<div>","</div>"]),A.fn.extend({text:function(t){return A.isFunction(t)?this.each(function(e){var i=A(this);i.text(t.call(this,e,i.text()))}):"object"!=typeof t&&t!==e?this.empty().append((this[0]&&this[0].ownerDocument||k).createTextNode(t)):A.text(this)},wrapAll:function(t){if(A.isFunction(t))return this.each(function(e){A(this).wrapAll(t.call(this,e))});if(this[0]){var e=A(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return A.isFunction(t)?this.each(function(e){A(this).wrapInner(t.call(this,e))}):this.each(function(){var e=A(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=A.isFunction(t);return this.each(function(i){A(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){A.nodeName(this,"body")||A(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.insertBefore(t,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this)});if(arguments.length){var t=A.clean(arguments);return t.push.apply(t,this.toArray()),this.pushStack(t,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this.nextSibling)});if(arguments.length){var t=this.pushStack(this,"after",arguments);return t.push.apply(t,A.clean(arguments)),t}},remove:function(t,e){for(var i,r=0;null!=(i=this[r]);r++)(!t||A.filter(t,[i]).length)&&(!e&&1===i.nodeType&&(A.cleanData(i.getElementsByTagName("*")),A.cleanData([i])),i.parentNode&&i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)for(1===t.nodeType&&A.cleanData(t.getElementsByTagName("*"));t.firstChild;)t.removeChild(t.firstChild);return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return A.clone(this,t,e)})},html:function(t){if(t===e)return this[0]&&1===this[0].nodeType?this[0].innerHTML.replace(ht,""):null;if("string"!=typeof t||ft.test(t)||!A.support.leadingWhitespace&&pt.test(t)||St[(dt.exec(t)||["",""])[1].toLowerCase()])A.isFunction(t)?this.each(function(e){var i=A(this);i.html(t.call(this,e,i.html()))}):this.empty().append(t);else{t=t.replace(ct,"<$1></$2>");try{for(var i=0,r=this.length;r>i;i++)1===this[i].nodeType&&(A.cleanData(this[i].getElementsByTagName("*")),this[i].innerHTML=t)}catch(n){this.empty().append(t)}}return this},replaceWith:function(t){return this[0]&&this[0].parentNode?A.isFunction(t)?this.each(function(e){var i=A(this),r=i.html();i.replaceWith(t.call(this,e,r))}):("string"!=typeof t&&(t=A(t).detach()),this.each(function(){var e=this.nextSibling,i=this.parentNode;A(this).remove(),e?A(e).before(t):A(i).append(t)})):this.length?this.pushStack(A(A.isFunction(t)?t():t),"replaceWith",t):this},detach:function(t){return this.remove(t,!0)},domManip:function(t,i,r){var n,a,s,o=t[0],l=[];if(!A.support.checkClone&&3===arguments.length&&"string"==typeof o&&vt.test(o))return this.each(function(){A(this).domManip(t,i,r,!0)});if(A.isFunction(o))return this.each(function(n){var a=A(this);t[0]=o.call(this,n,i?a.html():e),a.domManip(t,i,r)});if(this[0]){if(n=o&&o.parentNode,n=A.support.parentNode&&n&&11===n.nodeType&&n.childNodes.length===this.length?{fragment:n}:A.buildFragment(t,this,l),s=n.fragment,a=1===s.childNodes.length?s=s.firstChild:s.firstChild){i=i&&A.nodeName(a,"tr"),a=0;for(var h=this.length,p=h-1;h>a;a++)r.call(i&&A.nodeName(this[a],"table")?this[a].getElementsByTagName("tbody")[0]||this[a].appendChild(this[a].ownerDocument.createElement("tbody")):this[a],n.cacheable||h>1&&p>a?A.clone(s,!0,!0):s)}l.length&&A.each(l,f)}return this}}),A.buildFragment=function(t,e,i){var r,n,a,s,o=t[0];return e&&e[0]&&(s=e[0].ownerDocument||e[0]),s.createDocumentFragment||(s=k),!(1===t.length&&"string"==typeof o&&512>o.length&&s===k&&"<"===o.charAt(0))||yt.test(o)||!A.support.checkClone&&vt.test(o)||!A.support.html5Clone&&gt.test(o)||(n=!0,(a=A.fragments[o])&&1!==a&&(r=a)),r||(r=s.createDocumentFragment(),A.clean(t,s,r,i)),n&&(A.fragments[o]=a?r:1),{fragment:r,cacheable:n}},A.fragments={},A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){A.fn[t]=function(i){var r=[],i=A(i),n=1===this.length&&this[0].parentNode;if(n&&11===n.nodeType&&1===n.childNodes.length&&1===i.length)return i[e](this[0]),this;for(var n=0,a=i.length;a>n;n++){var s=(n>0?this.clone(!0):this).get();A(i[n])[e](s),r=r.concat(s)}return this.pushStack(r,t,i.selector)}}),A.extend({clone:function(t,e,i){var r,n,a;A.support.html5Clone||!gt.test("<"+t.nodeName)?r=t.cloneNode(!0):(r=k.createElement("div"),xt.appendChild(r),r.innerHTML=t.outerHTML,r=r.firstChild);var s=r;if(!(A.support.noCloneEvent&&A.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||A.isXMLDoc(t)))for(c(t,s),r=d(t),n=d(s),a=0;r[a];++a)n[a]&&c(r[a],n[a]);if(e&&(p(t,s),i))for(r=d(t),n=d(s),a=0;r[a];++a)p(r[a],n[a]);return s},clean:function(t,e,i,r){e=e||k,"undefined"==typeof e.createElement&&(e=e.ownerDocument||e[0]&&e[0].ownerDocument||k);for(var n,a,s=[],o=0;null!=(a=t[o]);o++)if("number"==typeof a&&(a+=""),a){if("string"==typeof a)if(mt.test(a)){a=a.replace(ct,"<$1></$2>"),n=(dt.exec(a)||["",""])[1].toLowerCase();var l=St[n]||St._default,p=l[0],c=e.createElement("div");for(e===k?xt.appendChild(c):h(e).appendChild(c),c.innerHTML=l[1]+a+l[2];p--;)c=c.lastChild;if(!A.support.tbody)for(p=ut.test(a),l="table"!==n||p?"<table>"!==l[1]||p?[]:c.childNodes:c.firstChild&&c.firstChild.childNodes,n=l.length-1;n>=0;--n)A.nodeName(l[n],"tbody")&&!l[n].childNodes.length&&l[n].parentNode.removeChild(l[n]);!A.support.leadingWhitespace&&pt.test(a)&&c.insertBefore(e.createTextNode(pt.exec(a)[0]),c.firstChild),a=c.childNodes}else a=e.createTextNode(a);var d;if(!A.support.appendChecked)if(a[0]&&"number"==typeof(d=a.length))for(n=0;d>n;n++)m(a[n]);else m(a);a.nodeType?s.push(a):s=A.merge(s,a)}if(i)for(t=function(t){return!t.type||bt.test(t.type)},o=0;s[o];o++)!r||!A.nodeName(s[o],"script")||s[o].type&&"text/javascript"!==s[o].type.toLowerCase()?(1===s[o].nodeType&&(e=A.grep(s[o].getElementsByTagName("script"),t),s.splice.apply(s,[o+1,0].concat(e))),i.appendChild(s[o])):r.push(s[o].parentNode?s[o].parentNode.removeChild(s[o]):s[o]);return s},cleanData:function(t){for(var e,i,r,n=A.cache,a=A.event.special,s=A.support.deleteExpando,o=0;null!=(r=t[o]);o++)if((!r.nodeName||!A.noData[r.nodeName.toLowerCase()])&&(i=r[A.expando])){if((e=n[i])&&e.events){for(var l in e.events)a[l]?A.event.remove(r,l):A.removeEvent(r,l,e.handle);e.handle&&(e.handle.elem=null)}s?delete r[A.expando]:r.removeAttribute&&r.removeAttribute(A.expando),delete n[i]}}});var Ct,_t,Tt,It=/alpha\([^)]*\)/i,kt=/opacity=([^)]*)/,Dt=/([A-Z]|^ms)/g,Et=/^-?\d+(?:px)?$/i,At=/^-?\d/,$t=/^([\-+])=([\-+.\de]+)/,Rt={position:"absolute",visibility:"hidden",display:"block"},Mt=["Left","Right"],Lt=["Top","Bottom"];A.fn.css=function(t,i){return 2===arguments.length&&i===e?this:A.access(this,t,i,!0,function(t,i,r){return r!==e?A.style(t,i,r):A.css(t,i)})},A.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Ct(t,"opacity","opacity");return""===i?"1":i}return t.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":A.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,r,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var a,s=A.camelCase(i),o=t.style,l=A.cssHooks[s],i=A.cssProps[s]||s;if(r===e)return l&&"get"in l&&(a=l.get(t,!1,n))!==e?a:o[i];if(n=typeof r,"string"===n&&(a=$t.exec(r))&&(r=+(a[1]+1)*+a[2]+parseFloat(A.css(t,i)),n="number"),!(null==r||"number"===n&&isNaN(r)||("number"===n&&!A.cssNumber[s]&&(r+="px"),l&&"set"in l&&(r=l.set(t,r))===e)))try{o[i]=r}catch(h){}}},css:function(t,i,r){var n,a,i=A.camelCase(i);return a=A.cssHooks[i],i=A.cssProps[i]||i,"cssFloat"===i&&(i="float"),a&&"get"in a&&(n=a.get(t,!0,r))!==e?n:Ct?Ct(t,i):void 0},swap:function(t,e,i){var r,n={};for(r in e)n[r]=t.style[r],t.style[r]=e[r];i.call(t);for(r in e)t.style[r]=n[r]}}),A.curCSS=A.css,A.each(["height","width"],function(t,e){A.cssHooks[e]={get:function(t,i,r){var n;return i?0!==t.offsetWidth?y(t,e,r):(A.swap(t,Rt,function(){n=y(t,e,r)}),n):void 0},set:function(t,e){return Et.test(e)?(e=parseFloat(e),e>=0?e+"px":void 0):e}}}),A.support.opacity||(A.cssHooks.opacity={get:function(t,e){return kt.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100+"":e?"1":""},set:function(t,e){var i=t.style,r=t.currentStyle,n=A.isNumeric(e)?"alpha(opacity="+100*e+")":"",a=r&&r.filter||i.filter||"";i.zoom=1,e>=1&&""===A.trim(a.replace(It,""))&&(i.removeAttribute("filter"),r&&!r.filter)||(i.filter=It.test(a)?a.replace(It,n):a+" "+n)}}),A(function(){A.support.reliableMarginRight||(A.cssHooks.marginRight={get:function(t,e){var i;return A.swap(t,{display:"inline-block"},function(){i=e?Ct(t,"margin-right","marginRight"):t.style.marginRight}),i}})}),k.defaultView&&k.defaultView.getComputedStyle&&(_t=function(t,e){var i,r,n,e=e.replace(Dt,"-$1").toLowerCase();return(r=t.ownerDocument.defaultView)&&(n=r.getComputedStyle(t,null))&&(i=n.getPropertyValue(e),""===i&&!A.contains(t.ownerDocument.documentElement,t)&&(i=A.style(t,e))),i}),k.documentElement.currentStyle&&(Tt=function(t,e){var i,r,n=t.currentStyle&&t.currentStyle[e],a=t.style;return null===n&&a&&(i=a[e])&&(n=i),!Et.test(n)&&At.test(n)&&(i=a.left,(r=t.runtimeStyle&&t.runtimeStyle.left)&&(t.runtimeStyle.left=t.currentStyle.left),a.left="fontSize"===e?"1em":n||0,n=a.pixelLeft+"px",a.left=i,r&&(t.runtimeStyle.left=r)),""===n?"auto":n}),Ct=_t||Tt,A.expr&&A.expr.filters&&(A.expr.filters.hidden=function(t){var e=t.offsetHeight;return 0===t.offsetWidth&&0===e||!A.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||A.css(t,"display"))},A.expr.filters.visible=function(t){return!A.expr.filters.hidden(t)});var Pt,Ft,Nt=/%20/g,Ot=/\[\]$/,Bt=/\r?\n/g,Xt=/#.*$/,Gt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Wt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ht=/^(?:GET|HEAD)$/,jt=/^\/\//,Yt=/\?/,Vt=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,zt=/^(?:select|textarea)/i,Ut=/\s+/,qt=/([?&])_=[^&]*/,Qt=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Zt=A.fn.load,Kt={},Jt={},te=["*/"]+["*"];try{Pt=E.href}catch(ee){Pt=k.createElement("a"),Pt.href="",Pt=Pt.href}Ft=Qt.exec(Pt.toLowerCase())||[],A.fn.extend({load:function(t,i,r){if("string"!=typeof t&&Zt)return Zt.apply(this,arguments);if(!this.length)return this;var n=t.indexOf(" ");if(n>=0)var a=t.slice(n,t.length),t=t.slice(0,n);n="GET",i&&(A.isFunction(i)?(r=i,i=e):"object"==typeof i&&(i=A.param(i,A.ajaxSettings.traditional),n="POST"));var s=this;return A.ajax({url:t,type:n,dataType:"html",data:i,complete:function(t,e,i){i=t.responseText,t.isResolved()&&(t.done(function(t){i=t}),s.html(a?A("<div>").append(i.replace(Vt,"")).find(a):i)),r&&s.each(r,[i,e,t])}}),this},serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?A.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||zt.test(this.nodeName)||Wt.test(this.type))}).map(function(t,e){var i=A(this).val();return null==i?null:A.isArray(i)?A.map(i,function(t){return{name:e.name,value:t.replace(Bt,"\r\n")}}):{name:e.name,value:i.replace(Bt,"\r\n")}}).get()}}),A.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(t,e){A.fn[e]=function(t){return this.on(e,t)}}),A.each(["get","post"],function(t,i){A[i]=function(t,r,n,a){return A.isFunction(r)&&(a=a||n,n=r,r=e),A.ajax({type:i,url:t,data:r,success:n,dataType:a})}}),A.extend({getScript:function(t,i){return A.get(t,e,i,"script")},getJSON:function(t,e,i){return A.get(t,e,i,"json")},ajaxSetup:function(t,e){return e?b(t,A.ajaxSettings):(e=t,t=A.ajaxSettings),b(t,e),t},ajaxSettings:{url:Pt,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Ft[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":te},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":t.String,"text html":!0,"text json":A.parseJSON,"text xml":A.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:g(Kt),ajaxTransport:g(Jt),ajax:function(t,i){function r(t,i,r,s){if(2!==S){S=2,l&&clearTimeout(l),o=e,a=s||"",x.readyState=t>0?4:0;var h,c,v,s=i;if(r){var b,w,C,_,T=d,I=x,k=T.contents,D=T.dataTypes,E=T.responseFields;for(w in E)w in r&&(I[E[w]]=r[w]);for(;"*"===D[0];)D.shift(),b===e&&(b=T.mimeType||I.getResponseHeader("content-type"));if(b)for(w in k)if(k[w]&&k[w].test(b)){D.unshift(w);break}if(D[0]in r)C=D[0];else{for(w in r){if(!D[0]||T.converters[w+" "+D[0]]){C=w;break}_||(_=w)}C=C||_}C?(C!==D[0]&&D.unshift(C),r=r[C]):r=void 0}else r=e;if(t>=200&&300>t||304===t)if(d.ifModified&&((b=x.getResponseHeader("Last-Modified"))&&(A.lastModified[n]=b),(b=x.getResponseHeader("Etag"))&&(A.etag[n]=b)),304===t)s="notmodified",h=!0;else try{b=d,b.dataFilter&&(r=b.dataFilter(r,b.dataType));var $=b.dataTypes;w={};var R,M,L,P,F,N,O,B,X=$.length,G=$[0];for(R=1;X>R;R++){if(1===R)for(M in b.converters)"string"==typeof M&&(w[M.toLowerCase()]=b.converters[M]);if(P=G,G=$[R],"*"===G)G=P;else if("*"!==P&&P!==G){if(F=P+" "+G,N=w[F]||w["* "+G],!N)for(O in B=e,w)if(L=O.split(" "),(L[0]===P||"*"===L[0])&&(B=w[L[1]+" "+G])){O=w[O],!0===O?N=B:!0===B&&(N=O);break}!N&&!B&&A.error("No conversion from "+F.replace(" "," to ")),!0!==N&&(r=N?N(r):B(O(r)))}}c=r,s="success",h=!0}catch(W){s="parsererror",v=W}else v=s,(!s||t)&&(s="error",0>t&&(t=0));x.status=t,x.statusText=""+(i||s),h?f.resolveWith(u,[c,s,x]):f.rejectWith(u,[x,s,v]),x.statusCode(g),g=e,p&&m.trigger("ajax"+(h?"Success":"Error"),[x,d,h?c:v]),y.fireWith(u,[x,s]),p&&(m.trigger("ajaxComplete",[x,d]),--A.active||A.event.trigger("ajaxStop"))}}"object"==typeof t&&(i=t,t=e);var n,a,s,o,l,h,p,c,i=i||{},d=A.ajaxSetup({},i),u=d.context||d,m=u!==d&&(u.nodeType||u instanceof A)?A(u):A.event,f=A.Deferred(),y=A.Callbacks("once memory"),g=d.statusCode||{},b={},w={},S=0,x={readyState:0,setRequestHeader:function(t,e){if(!S){var i=t.toLowerCase(),t=w[i]=w[i]||t;b[t]=e}return this},getAllResponseHeaders:function(){return 2===S?a:null},getResponseHeader:function(t){var i;if(2===S){if(!s)for(s={};i=Gt.exec(a);)s[i[1].toLowerCase()]=i[2];i=s[t.toLowerCase()]}return i===e?null:i},overrideMimeType:function(t){return S||(d.mimeType=t),this},abort:function(t){return t=t||"abort",o&&o.abort(t),r(0,t),this}};if(f.promise(x),x.success=x.done,x.error=x.fail,x.complete=y.add,x.statusCode=function(t){if(t){var e;if(2>S)for(e in t)g[e]=[g[e],t[e]];else e=t[x.status],x.then(e,e)}return this},d.url=((t||d.url)+"").replace(Xt,"").replace(jt,Ft[1]+"//"),d.dataTypes=A.trim(d.dataType||"*").toLowerCase().split(Ut),null==d.crossDomain&&(h=Qt.exec(d.url.toLowerCase()),d.crossDomain=!(!h||h[1]==Ft[1]&&h[2]==Ft[2]&&(h[3]||("http:"===h[1]?80:443))==(Ft[3]||("http:"===Ft[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=A.param(d.data,d.traditional)),v(Kt,d,i,x),2===S)return!1;if(p=d.global,d.type=d.type.toUpperCase(),d.hasContent=!Ht.test(d.type),p&&0===A.active++&&A.event.trigger("ajaxStart"),!d.hasContent&&(d.data&&(d.url+=(Yt.test(d.url)?"&":"?")+d.data,delete d.data),n=d.url,!1===d.cache)){h=A.now();var C=d.url.replace(qt,"$1_="+h);d.url=C+(C===d.url?(Yt.test(d.url)?"&":"?")+"_="+h:"")}(d.data&&d.hasContent&&!1!==d.contentType||i.contentType)&&x.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(n=n||d.url,A.lastModified[n]&&x.setRequestHeader("If-Modified-Since",A.lastModified[n]),A.etag[n]&&x.setRequestHeader("If-None-Match",A.etag[n])),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+te+"; q=0.01":""):d.accepts["*"]);for(c in d.headers)x.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(!1===d.beforeSend.call(u,x,d)||2===S))return x.abort(),!1;for(c in{success:1,error:1,complete:1})x[c](d[c]);if(o=v(Jt,d,i,x)){x.readyState=1,p&&m.trigger("ajaxSend",[x,d]),d.async&&0<d.timeout&&(l=setTimeout(function(){x.abort("timeout")},d.timeout));try{S=1,o.send(b,r)}catch(_){if(!(2>S))throw _;r(-1,_)}}else r(-1,"No Transport");return x},param:function(t,i){var r=[],n=function(t,e){e=A.isFunction(e)?e():e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=A.ajaxSettings.traditional),A.isArray(t)||t.jquery&&!A.isPlainObject(t))A.each(t,function(){n(this.name,this.value)});else for(var a in t)w(a,t[a],i,n);return r.join("&").replace(Nt,"+")}}),A.extend({active:0,lastModified:{},etag:{}});var ie=A.now(),re=/(\=)\?(&|$)|\?\?/i;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return A.expando+"_"+ie++}}),A.ajaxPrefilter("json jsonp",function(e,i,r){if(i="application/x-www-form-urlencoded"===e.contentType&&"string"==typeof e.data,"jsonp"===e.dataTypes[0]||!1!==e.jsonp&&(re.test(e.url)||i&&re.test(e.data))){var n,a=e.jsonpCallback=A.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s=t[a],o=e.url,l=e.data,h="$1"+a+"$2";return!1!==e.jsonp&&(o=o.replace(re,h),e.url===o&&(i&&(l=l.replace(re,h)),e.data===l&&(o+=(/\?/.test(o)?"&":"?")+e.jsonp+"="+a))),e.url=o,e.data=l,t[a]=function(t){n=[t]},r.always(function(){t[a]=s,n&&A.isFunction(s)&&t[a](n[0])}),e.converters["script json"]=function(){return n||A.error(a+" was not called"),n[0]},e.dataTypes[0]="json","script"}}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(t){return A.globalEval(t),t}}}),A.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),A.ajaxTransport("script",function(t){if(t.crossDomain){var i,r=k.head||k.getElementsByTagName("head")[0]||k.documentElement;return{send:function(n,a){i=k.createElement("script"),i.async="async",t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,n){(n||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i),i=e,n||a(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(0,1)}}}});var ne,ae=t.ActiveXObject?function(){for(var t in ne)ne[t](0,1)}:!1,se=0;A.ajaxSettings.xhr=t.ActiveXObject?function(){var e;if(!(e=!this.isLocal&&S()))t:{try{e=new t.ActiveXObject("Microsoft.XMLHTTP");break t}catch(i){}e=void 0}return e}:S,function(t){A.extend(A.support,{ajax:!!t,cors:!!t&&"withCredentials"in t})}(A.ajaxSettings.xhr()),A.support.ajax&&A.ajaxTransport(function(i){if(!i.crossDomain||A.support.cors){var r;return{send:function(n,a){var s,o,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(o in i.xhrFields)l[o]=i.xhrFields[o];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),!i.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");try{for(o in n)l.setRequestHeader(o,n[o])}catch(h){}l.send(i.hasContent&&i.data||null),r=function(t,n){var o,h,p,c,d;try{if(r&&(n||4===l.readyState))if(r=e,s&&(l.onreadystatechange=A.noop,ae&&delete ne[s]),n)4!==l.readyState&&l.abort();else{o=l.status,p=l.getAllResponseHeaders(),c={},(d=l.responseXML)&&d.documentElement&&(c.xml=d),c.text=l.responseText;try{h=l.statusText}catch(u){h=""}o||!i.isLocal||i.crossDomain?1223===o&&(o=204):o=c.text?200:404}}catch(m){n||a(-1,m)}c&&a(o,h,c,p)},i.async&&4!==l.readyState?(s=++se,ae&&(ne||(ne={},A(t).unload(ae)),ne[s]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var oe,le,he,pe,ce={},de=/^(?:toggle|show|hide)$/,ue=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,me=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];A.fn.extend({show:function(t,e,i){if(t||0===t)return this.animate(_("show",3),t,e,i);for(var i=0,r=this.length;r>i;i++)t=this[i],t.style&&(e=t.style.display,A._data(t,"olddisplay")||"none"!==e||(e=t.style.display=""),""===e&&"none"===A.css(t,"display")&&A._data(t,"olddisplay",T(t.nodeName)));for(i=0;r>i;i++)t=this[i],t.style&&(e=t.style.display,""===e||"none"===e)&&(t.style.display=A._data(t,"olddisplay")||"");return this},hide:function(t,e,i){if(t||0===t)return this.animate(_("hide",3),t,e,i);for(var i=0,r=this.length;r>i;i++)t=this[i],t.style&&(e=A.css(t,"display"),"none"!==e&&!A._data(t,"olddisplay")&&A._data(t,"olddisplay",e));for(i=0;r>i;i++)this[i].style&&(this[i].style.display="none");return this},_toggle:A.fn.toggle,toggle:function(t,e,i){var r="boolean"==typeof t;return A.isFunction(t)&&A.isFunction(e)?this._toggle.apply(this,arguments):null==t||r?this.each(function(){var e=r?t:A(this).is(":hidden");A(this)[e?"show":"hide"]()}):this.animate(_("toggle",3),t,e,i),this},fadeTo:function(t,e,i,r){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:e},t,i,r)},animate:function(t,e,i,r){function n(){var e;!1===a.queue&&A._mark(this);var i,r,n,s,o,l=A.extend({},a),h=1===this.nodeType,p=h&&A(this).is(":hidden");l.animatedProperties={};for(n in t){if(i=A.camelCase(n),n!==i&&(t[i]=t[n],delete t[n]),r=t[i],A.isArray(r)?(l.animatedProperties[i]=r[1],e=t[i]=r[0],r=e):l.animatedProperties[i]=l.specialEasing&&l.specialEasing[i]||l.easing||"swing","hide"===r&&p||"show"===r&&!p)return l.complete.call(this);!h||"height"!==i&&"width"!==i||(l.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===A.css(this,"display")&&"none"===A.css(this,"float")&&(A.support.inlineBlockNeedsLayout&&"inline"!==T(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=l.overflow&&(this.style.overflow="hidden");for(n in t)h=new A.fx(this,l,n),r=t[n],de.test(r)?(i=A._data(this,"toggle"+n)||("toggle"===r?p?"show":"hide":0))?(A._data(this,"toggle"+n,"show"===i?"hide":"show"),h[i]()):h[r]():(i=ue.exec(r),s=h.cur(),i?(r=parseFloat(i[2]),o=i[3]||(A.cssNumber[n]?"":"px"),"px"!==o&&(A.style(this,n,(r||1)+o),s*=(r||1)/h.cur(),A.style(this,n,s+o)),i[1]&&(r=("-="===i[1]?-1:1)*r+s),h.custom(s,r,o)):h.custom(s,r,""));return!0}var a=A.speed(e,i,r);return A.isEmptyObject(t)?this.each(a.complete,[!1]):(t=A.extend({},t),!1===a.queue?this.each(n):this.queue(a.queue,n))},stop:function(t,i,r){return"string"!=typeof t&&(r=i,i=t,t=e),i&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e,i=!1,n=A.timers,a=A._data(this);if(r||A._unmark(!0,this),null==t){for(e in a)if(a[e]&&a[e].stop&&e.indexOf(".run")===e.length-4){var s=a[e];A.removeData(this,e,!0),s.stop(r)}}else a[e=t+".run"]&&a[e].stop&&(a=a[e],A.removeData(this,e,!0),a.stop(r));for(e=n.length;e--;)n[e].elem!==this||null!=t&&n[e].queue!==t||(r?n[e](!0):n[e].saveState(),i=!0,n.splice(e,1));(!r||!i)&&A.dequeue(this,t)})}}),A.each({slideDown:_("show",1),slideUp:_("hide",1),slideToggle:_("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){A.fn[t]=function(t,i,r){return this.animate(e,t,i,r)}}),A.extend({speed:function(t,e,i){var r=t&&"object"==typeof t?A.extend({},t):{complete:i||!i&&e||A.isFunction(t)&&t,duration:t,easing:i&&e||e&&!A.isFunction(e)&&e};return r.duration=A.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in A.fx.speeds?A.fx.speeds[r.duration]:A.fx.speeds._default,(null==r.queue||!0===r.queue)&&(r.queue="fx"),r.old=r.complete,r.complete=function(t){A.isFunction(r.old)&&r.old.call(this),r.queue?A.dequeue(this,r.queue):!1!==t&&A._unmark(this)},r},easing:{linear:function(t,e,i,r){return i+r*t},swing:function(t,e,i,r){return(-Math.cos(t*Math.PI)/2+.5)*r+i}},timers:[],fx:function(t,e,i){this.options=e,this.elem=t,this.prop=i,e.orig=e.orig||{}}}),A.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(A.fx.step[this.prop]||A.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var t,e=A.css(this.elem,this.prop);return isNaN(t=parseFloat(e))?e&&"auto"!==e?e:0:t},custom:function(t,i,r){function n(t){return a.step(t)}var a=this,s=A.fx;this.startTime=pe||x(),this.end=i,this.now=this.start=t,this.pos=this.state=0,this.unit=r||this.unit||(A.cssNumber[this.prop]?"":"px"),n.queue=this.options.queue,n.elem=this.elem,n.saveState=function(){a.options.hide&&A._data(a.elem,"fxshow"+a.prop)===e&&A._data(a.elem,"fxshow"+a.prop,a.start)},n()&&A.timers.push(n)&&!he&&(he=setInterval(s.tick,s.interval))},show:function(){var t=A._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=t||A.style(this.elem,this.prop),this.options.show=!0,t!==e?this.custom(this.cur(),t):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),A(this.elem).show()},hide:function(){this.options.orig[this.prop]=A._data(this.elem,"fxshow"+this.prop)||A.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(t){var e,i=pe||x(),r=!0,n=this.elem,a=this.options;if(t||i>=a.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),a.animatedProperties[this.prop]=!0;for(e in a.animatedProperties)!0!==a.animatedProperties[e]&&(r=!1);if(r){if(null!=a.overflow&&!A.support.shrinkWrapBlocks&&A.each(["","X","Y"],function(t,e){n.style["overflow"+e]=a.overflow[t]}),a.hide&&A(n).hide(),a.hide||a.show)for(e in a.animatedProperties)A.style(n,e,a.orig[e]),A.removeData(n,"fxshow"+e,!0),A.removeData(n,"toggle"+e,!0);(t=a.complete)&&(a.complete=!1,t.call(n))}return!1}return 1/0==a.duration?this.now=i:(t=i-this.startTime,this.state=t/a.duration,this.pos=A.easing[a.animatedProperties[this.prop]](this.state,t,0,1,a.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},A.extend(A.fx,{tick:function(){for(var t,e=A.timers,i=0;i<e.length;i++)t=e[i],!t()&&e[i]===t&&e.splice(i--,1);e.length||A.fx.stop()},interval:13,stop:function(){clearInterval(he),he=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(t){A.style(t.elem,"opacity",t.now)},_default:function(t){t.elem.style&&null!=t.elem.style[t.prop]?t.elem.style[t.prop]=t.now+t.unit:t.elem[t.prop]=t.now}}}),A.each(["width","height"],function(t,e){A.fx.step[e]=function(t){A.style(t.elem,e,Math.max(0,t.now)+t.unit)}}),A.expr&&A.expr.filters&&(A.expr.filters.animated=function(t){return A.grep(A.timers,function(e){return t===e.elem}).length});var fe=/^t(?:able|d|h)$/i,ye=/^(?:body|html)$/i;A.fn.offset="getBoundingClientRect"in k.documentElement?function(t){var e,i=this[0];if(t)return this.each(function(e){A.offset.setOffset(this,t,e)});if(!i||!i.ownerDocument)return null;if(i===i.ownerDocument.body)return A.offset.bodyOffset(i);try{e=i.getBoundingClientRect()}catch(r){}var n=i.ownerDocument,a=n.documentElement;return e&&A.contains(a,i)?(i=n.body,n=I(n),{top:e.top+(n.pageYOffset||A.support.boxModel&&a.scrollTop||i.scrollTop)-(a.clientTop||i.clientTop||0),left:e.left+(n.pageXOffset||A.support.boxModel&&a.scrollLeft||i.scrollLeft)-(a.clientLeft||i.clientLeft||0)}):e?{top:e.top,left:e.left}:{top:0,left:0}}:function(t){var e=this[0];if(t)return this.each(function(e){A.offset.setOffset(this,t,e)});if(!e||!e.ownerDocument)return null;if(e===e.ownerDocument.body)return A.offset.bodyOffset(e);var i,r=e.offsetParent,n=e.ownerDocument,a=n.documentElement,s=n.body;i=(n=n.defaultView)?n.getComputedStyle(e,null):e.currentStyle;for(var o=e.offsetTop,l=e.offsetLeft;(e=e.parentNode)&&e!==s&&e!==a&&(!A.support.fixedPosition||"fixed"!==i.position);)i=n?n.getComputedStyle(e,null):e.currentStyle,o-=e.scrollTop,l-=e.scrollLeft,
e===r&&(o+=e.offsetTop,l+=e.offsetLeft,!A.support.doesNotAddBorder||A.support.doesAddBorderForTableAndCells&&fe.test(e.nodeName)||(o+=parseFloat(i.borderTopWidth)||0,l+=parseFloat(i.borderLeftWidth)||0),r=e.offsetParent),A.support.subtractsBorderForOverflowNotVisible&&"visible"!==i.overflow&&(o+=parseFloat(i.borderTopWidth)||0,l+=parseFloat(i.borderLeftWidth)||0);return("relative"===i.position||"static"===i.position)&&(o+=s.offsetTop,l+=s.offsetLeft),A.support.fixedPosition&&"fixed"===i.position&&(o+=Math.max(a.scrollTop,s.scrollTop),l+=Math.max(a.scrollLeft,s.scrollLeft)),{top:o,left:l}},A.offset={bodyOffset:function(t){var e=t.offsetTop,i=t.offsetLeft;return A.support.doesNotIncludeMarginInBodyOffset&&(e+=parseFloat(A.css(t,"marginTop"))||0,i+=parseFloat(A.css(t,"marginLeft"))||0),{top:e,left:i}},setOffset:function(t,e,i){var r=A.css(t,"position");"static"===r&&(t.style.position="relative");var n=A(t),a=n.offset(),s=A.css(t,"top"),o=A.css(t,"left"),l={},h={};("absolute"===r||"fixed"===r)&&-1<A.inArray("auto",[s,o])?(h=n.position(),r=h.top,o=h.left):(r=parseFloat(s)||0,o=parseFloat(o)||0),A.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(l.top=e.top-a.top+r),null!=e.left&&(l.left=e.left-a.left+o),"using"in e?e.using.call(t,l):n.css(l)}},A.fn.extend({position:function(){if(!this[0])return null;var t=this[0],e=this.offsetParent(),i=this.offset(),r=ye.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(A.css(t,"marginTop"))||0,i.left-=parseFloat(A.css(t,"marginLeft"))||0,r.top+=parseFloat(A.css(e[0],"borderTopWidth"))||0,r.left+=parseFloat(A.css(e[0],"borderLeftWidth"))||0,{top:i.top-r.top,left:i.left-r.left}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||k.body;t&&!ye.test(t.nodeName)&&"static"===A.css(t,"position");)t=t.offsetParent;return t})}}),A.each(["Left","Top"],function(t,i){var r="scroll"+i;A.fn[r]=function(i){var n,a;return i===e?(n=this[0],n?(a=I(n))?"pageXOffset"in a?a[t?"pageYOffset":"pageXOffset"]:A.support.boxModel&&a.document.documentElement[r]||a.document.body[r]:n[r]:null):this.each(function(){(a=I(this))?a.scrollTo(t?A(a).scrollLeft():i,t?i:A(a).scrollTop()):this[r]=i})}}),A.each(["Height","Width"],function(t,i){var r=i.toLowerCase();A.fn["inner"+i]=function(){var t=this[0];return t?t.style?parseFloat(A.css(t,r,"padding")):this[r]():null},A.fn["outer"+i]=function(t){var e=this[0];return e?e.style?parseFloat(A.css(e,r,t?"margin":"border")):this[r]():null},A.fn[r]=function(t){var n=this[0];if(!n)return null==t?null:this;if(A.isFunction(t))return this.each(function(e){var i=A(this);i[r](t.call(this,e,i[r]()))});if(A.isWindow(n)){var a=n.document.documentElement["client"+i],s=n.document.body;return"CSS1Compat"===n.document.compatMode&&a||s&&s["client"+i]||a}return 9===n.nodeType?Math.max(n.documentElement["client"+i],n.body["scroll"+i],n.documentElement["scroll"+i],n.body["offset"+i],n.documentElement["offset"+i]):t===e?(n=A.css(n,r),a=parseFloat(n),A.isNumeric(a)?a:n):this.css(r,"string"==typeof t?t:t+"px")}}),t.jQuery=t.$=A,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return A})}(window);var trace={box:null,useTextArea:!0,suppress:!0,zeroTime:new Date,filter:null};if(trace.log=function(t,e){trace.suppress||(trace.box||(box=trace.useTextArea?document.createElement("TEXTAREA"):document.createElement("DIV"),box.id="tracebox",box.style.position="absolute",box.style.width="200px",box.style.height="100px",box.style.left="100%",box.style.top="100%",box.style.overflow="scroll",box.style.margin="-120px 0 0 -220px",document.body.appendChild(box),trace.box=box),(e||trace.logShouldClear)&&(trace.box.innerHTML="",trace.box.value=""),trace.useTextArea?trace.box.value=trace.box.value+t+"\r\n":trace.box.innerHTML=trace.box.innerHTML+t+"<br/>",trace.logShouldClear=!1,setTimeout("trace.logShouldClear = true",100))},trace.logMulti=function(){if(!trace.suppress){for(var t="",e=!0,i=0;i<trace.logMulti.arguments.length;i++)e||(t+=", "),t+=trace.logMulti.arguments[i],e=!1;trace.log(t)}},trace.getTicks=function(){return new Date-trace.zeroTime},window.console)window.console.suppress=!0,window.console.logMulti=function(){if(!window.console.suppress){for(var t=new Date-trace.zeroTime+": ",e=!0,i=0;i<window.console.logMulti.arguments.length;i++)e||(t+=", "),t+=window.console.logMulti.arguments[i],e=!1;console.filter&&-1==t.indexOf(console.filter)||(window.console.log(t),window.console.logRemote&&window.console.logRemote(t),window.EventLogger&&window.EventLogger.logNote(t))}},-1<navigator.userAgent.indexOf("AppleWebKit/")&&-1==location.search.indexOf("logging=")&&(window.console.logMulti=function(){for(var t=new Date-trace.zeroTime+": ",e=!0,i=0;i<window.console.logMulti.arguments.length;i++)e||(t+=", "),t+=window.console.logMulti.arguments[i],e=!1;(!console.filter||-1!=t.indexOf(console.filter))&&window.console.log(new Date-trace.zeroTime,window.console.logMulti.arguments),window.EventLogger&&window.EventLogger.logNote(t)}),-1<location.search.indexOf("remote=1")&&(window.console.sockets=[],window.console.socketIndex=0,window.console.logRemote=function(t){t="/Log?message="+encodeURIComponent(t)+"&rand="+Math.random(),$.ajax({url:t})});else var console={log:function(t){trace.log(t)},logMulti:trace.logMulti,suppress:!0};var ppDebug={m_arrDebug:[],WriteQueue:function(){for(var t=0;t<this.m_arrDebug.length;t++)this.debug_trace(this.m_arrDebug[t]);this.m_arrDebug=[]},Clear:function(){},debug_trace:function(){},debug_error:function(t){console.log("ERROR",t)}},g_nStartTime=new Date;window.trace=trace,$.each("touchstart touchmove touchend orientationchange tap taphold swipe swipeleft swiperight swipeup swipedown scrollstart scrollstop".split(" "),function(t,e){$.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)},$.attrFn[e]=!0});var supportTouch=-1<navigator.userAgent.indexOf("iP"),scrollEvent="touchmove scroll",touchStartEvent=supportTouch?"touchstart":"mousedown",touchStopEvent=supportTouch?"touchend":"mouseup",touchMoveEvent=supportTouch?"touchmove":"mousemove";$.event.special.scrollstart={enabled:!0,setup:function(){function t(t,i){e=i;var n=t.type;t.type=e?"scrollstart":"scrollstop",$.event.handle.call(r,t),t.type=n}var e,i,r=this;$(r).bind(scrollEvent,function(r){$.event.special.scrollstart.enabled&&(e||t(r,!0),clearTimeout(i),i=setTimeout(function(){t(r,!1)},50))})}},$.event.special.tap={setup:function(){var t=this,e=$(t);e.bind(touchStartEvent,function(i){function r(){i.pageX=i.pageX||i.originalEvent.touches[0].pageX,i.pageY=i.pageY||i.originalEvent.touches[0].pageY,(10<Math.abs(l[0]-i.pageX)||10<Math.abs(l[1]-i.pageY))&&(s=!0)}if(!i.which||1===i.which){i.pageX=i.pageX||i.originalEvent.touches[0].pageX,i.pageY=i.pageY||i.originalEvent.touches[0].pageY;var n,a,s=!1,o=!0,l=[i.pageX,i.pageY];a=setTimeout(function(){o&&!s&&(n=i.type,i.type="taphold",$.event.handle.call(t,i),i.type=n)},750),e.one(touchMoveEvent,r).one(touchStopEvent,function(i){e.unbind(touchMoveEvent,r),clearTimeout(a),o=!1,(10<Math.abs(l[0]-i.pageX)||10<Math.abs(l[1]-i.pageY))&&(s=!0),s||(n=i.type,i.type="tap",$.event.handle.call(t,i),i.type=n)})}})}},$.event.special.swipe={setup:function(){var t=$(this);t.bind(touchStartEvent,function(e){function i(t){if(a){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t;r={time:(new Date).getTime(),coords:[e.pageX,e.pageY]},10<Math.abs(a.coords[0]-r.coords[0])&&t.preventDefault()}}var r,n=e.originalEvent.touches?e.originalEvent.touches[0]:e,a={time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:$(e.target)};t.bind(touchMoveEvent,i).one(touchStopEvent,function(){t.unbind(touchMoveEvent,i),a&&r&&(1e3>r.time-a.time&&30<Math.abs(a.coords[0]-r.coords[0])&&75>Math.abs(a.coords[1]-r.coords[1])?a.origin.trigger("swipe").trigger(a.coords[0]>r.coords[0]?"swipeleft":"swiperight"):1e3>r.time-a.time&&30<Math.abs(a.coords[1]-r.coords[1])&&75>Math.abs(a.coords[0]-r.coords[0])&&a.origin.trigger("swipe").trigger(a.coords[1]>r.coords[1]?"swipeup":"swipedown")),a=r=void 0})})}},function(t){function e(){var t=i();t!==r&&(r=t,n.trigger("orientationchange"))}var i,r,n=t(window);t.event.special.orientationchange={setup:function(){return t.support.orientation?!1:(r=i(),void n.bind("resize",e))},teardown:function(){return t.support.orientation?!1:void n.unbind("resize",e)},add:function(t){var e=t.handler;t.handler=function(t){return t.orientation=i(),e.apply(this,arguments)}}},i=function(){var t=document.documentElement;return t&&1.1>t.clientWidth/t.clientHeight?"portrait":"landscape"}}(jQuery),$.each({scrollstop:"scrollstart",taphold:"tap",swipeup:"swipe",swipedown:"swipe",swipeleft:"swipe",swiperight:"swipe"},function(t,e){$.event.special[t]={setup:function(){$(this).bind(e,$.noop)}}}),function(){function t(t,e){var p;if(this.element="object"==typeof t?t:document.getElementById(t),this.wrapper=this.element.parentNode,this.element.style.webkitTransitionProperty="-webkit-transform",this.element.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)",this.element.style.webkitTransitionDuration="0",this.element.style.webkitTransform=l+"0,0"+h,this.options={bounce:i,momentum:i,checkDOMChanges:!0,topOnDOMChanges:!1,hScrollbar:i,vScrollbar:i,fadeScrollbar:r||!n,shrinkScrollbar:r||!n,desktopCompatibility:!1,overflow:"auto",snap:!1,bounceLock:!1,directionLock:!0,scrollbarColor:"rgba(150,150,150,0.5)",onScrollEnd:function(){}},"object"==typeof e)for(p in e)this.options[p]=e[p];this.options.desktopCompatibility&&(this.options.overflow="hidden"),this.onScrollEnd=this.options.onScrollEnd,delete this.options.onScrollEnd,this.wrapper.style.overflow=this.options.overflow,this.refresh(),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",this,!1),(n||this.options.desktopCompatibility)&&(this.element.addEventListener(a,this,!1),this.element.addEventListener(s,this,!1),this.element.addEventListener(o,this,!1)),this.options.checkDOMChanges&&this.element.addEventListener("DOMSubtreeModified",this,!1)}function e(t,e,i,r,n){var a=document;this.dir=t,this.fade=i,this.shrink=r,this.uid=++p,this.bar=a.createElement("div"),this.bar.style.cssText="position:absolute;top:0;left:0;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);pointer-events:none;-webkit-transition-duration:0;-webkit-transition-delay:0;-webkit-transition-property:-webkit-transform;z-index:10;background:"+n+";-webkit-transform:"+l+"0,0"+h+";"+("horizontal"==t?"-webkit-border-radius:3px 2px;min-width:6px;min-height:5px":"-webkit-border-radius:2px 3px;min-width:5px;min-height:6px"),this.wrapper=a.createElement("div"),this.wrapper.style.cssText="-webkit-mask:-webkit-canvas(scrollbar"+this.uid+this.dir+");position:absolute;z-index:10;pointer-events:none;overflow:hidden;opacity:0;-webkit-transition-duration:"+(i?"300ms":"0")+";-webkit-transition-delay:0;-webkit-transition-property:opacity;"+("horizontal"==this.dir?"bottom:2px;left:2px;right:7px;height:5px":"top:2px;right:2px;bottom:7px;width:5px;"),this.wrapper.appendChild(this.bar),e.appendChild(this.wrapper)}t.prototype={x:0,y:0,enabled:!0,handleEvent:function(t){switch(t.type){case a:this.touchStart(t);break;case s:this.touchMove(t);break;case o:this.touchEnd(t);break;case"webkitTransitionEnd":this.transitionEnd();break;case"orientationchange":case"resize":this.refresh();break;case"DOMSubtreeModified":this.onDOMModified(t)}},onDOMModified:function(t){var e=this;t.target.parentNode==e.element&&(setTimeout(function(){e.refresh()},0),e.options.topOnDOMChanges&&(0!=e.x||0!=e.y)&&e.scrollTo(0,0,"0"))},refresh:function(){var t=this.x,i=this.y;this.scrollWidth=this.wrapper.clientWidth,this.scrollHeight=this.wrapper.clientHeight,this.scrollerWidth=this.element.offsetWidth,this.scrollerHeight=this.element.offsetHeight,this.maxScrollX=this.scrollWidth-this.scrollerWidth,this.maxScrollY=this.scrollHeight-this.scrollerHeight,this.directionY=this.directionX=0,this.scrollX&&(0<=this.maxScrollX?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX)),this.scrollY&&(0<=this.maxScrollY?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY)),this.options.snap&&(this.maxPageX=-Math.floor(this.maxScrollX/this.scrollWidth),this.maxPageY=-Math.floor(this.maxScrollY/this.scrollHeight),i=this.snap(t,i),t=i.x,i=i.y),(t!=this.x||i!=this.y)&&(this.setTransitionTime("0"),this.setPosition(t,i,!0)),this.scrollX=this.scrollerWidth>this.scrollWidth,this.scrollY=!this.options.bounceLock&&!this.scrollX||this.scrollerHeight>this.scrollHeight,this.options.hScrollbar&&this.scrollX?(this.scrollBarX=this.scrollBarX||new e("horizontal",this.wrapper,this.options.fadeScrollbar,this.options.shrinkScrollbar,this.options.scrollbarColor),this.scrollBarX.init(this.scrollWidth,this.scrollerWidth)):this.scrollBarX&&(this.scrollBarX=this.scrollBarX.remove()),this.options.vScrollbar&&this.scrollY&&this.scrollerHeight>this.scrollHeight?(this.scrollBarY=this.scrollBarY||new e("vertical",this.wrapper,this.options.fadeScrollbar,this.options.shrinkScrollbar,this.options.scrollbarColor),this.scrollBarY.init(this.scrollHeight,this.scrollerHeight)):this.scrollBarY&&(this.scrollBarY=this.scrollBarY.remove())},setPosition:function(t,e,i){this.x=t,this.y=e,this.element.style.webkitTransform=l+this.x+"px,"+this.y+"px"+h,i||(this.scrollBarX&&this.scrollBarX.setPosition(this.x),this.scrollBarY&&this.scrollBarY.setPosition(this.y))},setTransitionTime:function(t){t=t||"0",this.element.style.webkitTransitionDuration=t,this.scrollBarX&&(this.scrollBarX.bar.style.webkitTransitionDuration=t,this.scrollBarX.wrapper.style.webkitTransitionDuration=i&&this.options.fadeScrollbar?"300ms":"0"),this.scrollBarY&&(this.scrollBarY.bar.style.webkitTransitionDuration=t,this.scrollBarY.wrapper.style.webkitTransitionDuration=i&&this.options.fadeScrollbar?"300ms":"0")},touchStart:function(t){var e;this.enabled&&(t.preventDefault(),t.stopPropagation(),this.scrolling=!0,this.moved=!1,this.distY=this.distX=0,this.setTransitionTime("0"),(this.options.momentum||this.options.snap)&&(e=new WebKitCSSMatrix(window.getComputedStyle(this.element).webkitTransform),(e.e!=this.x||e.f!=this.y)&&(document.removeEventListener("webkitTransitionEnd",this,!1),this.setPosition(e.e,e.f),this.moved=!0)),this.touchStartX=n?t.changedTouches[0].pageX:t.pageX,this.scrollStartX=this.x,this.touchStartY=n?t.changedTouches[0].pageY:t.pageY,this.scrollStartY=this.y,this.scrollStartTime=t.timeStamp,this.directionY=this.directionX=0)},touchMove:function(t){if(this.scrolling){var e=n?t.changedTouches[0].pageX:t.pageX,i=n?t.changedTouches[0].pageY:t.pageY,r=this.scrollX?e-this.touchStartX:0,a=this.scrollY?i-this.touchStartY:0,s=this.x+r,o=this.y+a;t.stopPropagation(),this.touchStartX=e,this.touchStartY=i,(s>=0||s<this.maxScrollX)&&(s=this.options.bounce?Math.round(this.x+r/3):s>=0||0<=this.maxScrollX?0:this.maxScrollX),(o>=0||o<this.maxScrollY)&&(o=this.options.bounce?Math.round(this.y+a/3):o>=0||0<=this.maxScrollY?0:this.maxScrollY),5<this.distX+this.distY?(this.options.directionLock&&(this.distX-3>this.distY?(o=this.y,a=0):this.distY-3>this.distX&&(s=this.x,r=0)),this.setPosition(s,o),this.moved=!0,this.directionX=r>0?-1:1,this.directionY=a>0?-1:1):(this.distX+=Math.abs(r),this.distY+=Math.abs(a))}},touchEnd:function(t){if(this.scrolling){var e,i,r=t.timeStamp-this.scrollStartTime,a=n?t.changedTouches[0]:t;e=0,i=this.x;var s=this.y;if(this.scrolling=!1,t.preventDefault(),this.moved)!this.options.snap&&r>250?this.resetPosition():(this.options.momentum&&(t=!0===this.scrollX?this.momentum(this.x-this.scrollStartX,r,this.options.bounce?-this.x+this.scrollWidth/5:-this.x,this.options.bounce?this.x+this.scrollerWidth-this.scrollWidth+this.scrollWidth/5:this.x+this.scrollerWidth-this.scrollWidth):{dist:0,time:0},a=!0===this.scrollY?this.momentum(this.y-this.scrollStartY,r,this.options.bounce?-this.y+this.scrollHeight/5:-this.y,this.options.bounce?(0>this.maxScrollY?this.y+this.scrollerHeight-this.scrollHeight:0)+this.scrollHeight/5:this.y+this.scrollerHeight-this.scrollHeight):{dist:0,time:0},e=Math.max(Math.max(t.time,a.time),1),i=this.x+t.dist,s=this.y+a.dist),this.options.snap&&(t=this.snap(i,s),i=t.x,s=t.y,e=Math.max(t.time,e)),this.scrollTo(i,s,e+"ms"));else if(this.resetPosition(),n){for(e=a.target;1!=e.nodeType;)e=e.parentNode;t.preventDefault(),i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,t.view,1,a.screenX,a.screenY,a.clientX,a.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),i._fake=!0,e.dispatchEvent(i)}}},transitionEnd:function(){document.removeEventListener("webkitTransitionEnd",this,!1),this.resetPosition()},resetPosition:function(){var t=this,e=t.x,i=t.y;0<=t.x?e=0:t.x<t.maxScrollX&&(e=t.maxScrollX),0<=t.y||0<t.maxScrollY?i=0:t.y<t.maxScrollY&&(i=t.maxScrollY),e!=t.x||i!=t.y?t.scrollTo(e,i):(t.moved&&(t.onScrollEnd(),setTimeout(function(){t.moved=!1},0)),t.scrollBarX&&t.scrollBarX.hide(),t.scrollBarY&&t.scrollBarY.hide())},snap:function(t,e){var i,t=0<this.directionX?Math.floor(t/this.scrollWidth):0>this.directionX?Math.ceil(t/this.scrollWidth):Math.round(t/this.scrollWidth);return this.pageX=-t,t*=this.scrollWidth,t>0?t=this.pageX=0:t<this.maxScrollX&&(this.pageX=this.maxPageX,t=this.maxScrollX),e=0<this.directionY?Math.floor(e/this.scrollHeight):0>this.directionY?Math.ceil(e/this.scrollHeight):Math.round(e/this.scrollHeight),this.pageY=-e,e*=this.scrollHeight,e>0?e=this.pageY=0:e<this.maxScrollY&&(this.pageY=this.maxPageY,e=this.maxScrollY),i=Math.round(Math.max(500*(Math.abs(this.x-t)/this.scrollWidth),500*(Math.abs(this.y-e)/this.scrollHeight))),{x:t,y:e,time:i}},scrollTo:function(t,e,i){this.x==t&&this.y==e?this.resetPosition():(this.moved=!0,this.setTransitionTime(i||"350ms"),this.setPosition(t,e),"0"===i||"0s"==i||"0ms"==i?this.resetPosition():document.addEventListener("webkitTransitionEnd",this,!1))},scrollToPage:function(t,e,i){this.options.snap||(this.pageX=-Math.round(this.x/this.scrollWidth),this.pageY=-Math.round(this.y/this.scrollHeight)),"next"==t?t=++this.pageX:"prev"==t&&(t=--this.pageX),"next"==e?e=++this.pageY:"prev"==e&&(e=--this.pageY),t=-t*this.scrollWidth,e=-e*this.scrollHeight,e=this.snap(t,e),t=e.x,e=e.y,this.scrollTo(t,e,i||"500ms")},scrollToElement:function(t,e){if(t="object"==typeof t?t:this.element.querySelector(t)){var i=this.scrollX?-t.offsetLeft:0,r=this.scrollY?-t.offsetTop:0;i>=0?i=0:i<this.maxScrollX&&(i=this.maxScrollX),r>=0?r=0:r<this.maxScrollY&&(r=this.maxScrollY),this.scrollTo(i,r,e)}},momentum:function(t,e,i,r){var e=1e3*(Math.abs(t)/e),n=e*e/2.5/1e3,a=0;return t>0&&n>i?(e=e*i/n/2.5,n=i):0>t&&n>r&&(e=e*r/n/2.5,n=r),a=e/1.2,{dist:Math.round(n*(0>t?-1:1)),time:Math.round(a)}},destroy:function(t){return window.removeEventListener("onorientationchange"in window?"orientationchange":"resize",this,!1),this.element.removeEventListener(a,this,!1),this.element.removeEventListener(s,this,!1),this.element.removeEventListener(o,this,!1),document.removeEventListener("webkitTransitionEnd",this,!1),this.options.checkDOMChanges&&this.element.removeEventListener("DOMSubtreeModified",this,!1),this.scrollBarX&&(this.scrollBarX=this.scrollBarX.remove()),this.scrollBarY&&(this.scrollBarY=this.scrollBarY.remove()),t&&this.wrapper.parentNode.removeChild(this.wrapper),null}},e.prototype={init:function(t,e){var i=document,r=Math.PI;"horizontal"==this.dir?this.maxSize!=this.wrapper.offsetWidth&&(this.maxSize=this.wrapper.offsetWidth,i=i.getCSSCanvasContext("2d","scrollbar"+this.uid+this.dir,this.maxSize,5),i.fillStyle="rgb(0,0,0)",i.beginPath(),i.arc(2.5,2.5,2.5,r/2,-r/2,!1),i.lineTo(this.maxSize-2.5,0),i.arc(this.maxSize-2.5,2.5,2.5,-r/2,r/2,!1),i.closePath(),i.fill()):this.maxSize!=this.wrapper.offsetHeight&&(this.maxSize=this.wrapper.offsetHeight,i=i.getCSSCanvasContext("2d","scrollbar"+this.uid+this.dir,5,this.maxSize),i.fillStyle="rgb(0,0,0)",i.beginPath(),i.arc(2.5,2.5,2.5,r,0,!1),i.lineTo(5,this.maxSize-2.5),i.arc(2.5,this.maxSize-2.5,2.5,0,r,!1),i.closePath(),i.fill()),this.size=Math.max(Math.round(this.maxSize*this.maxSize/e),6),this.maxScroll=this.maxSize-this.size,this.toWrapperProp=this.maxScroll/(t-e),this.bar.style["horizontal"==this.dir?"width":"height"]=this.size+"px"},setPosition:function(t){"1"!=this.wrapper.style.opacity&&this.show(),t=Math.round(this.toWrapperProp*t),0>t?(t=this.shrink?t+3*t:0,7>this.size+t&&(t=-this.size+6)):t>this.maxScroll&&(t=this.shrink?t+3*(t-this.maxScroll):this.maxScroll,7>this.size+this.maxScroll-t&&(t=this.size+this.maxScroll-6)),t="horizontal"==this.dir?l+t+"px,0"+h:l+"0,"+t+"px"+h,this.bar.style.webkitTransform=t},show:function(){i&&(this.wrapper.style.webkitTransitionDelay="0"),this.wrapper.style.opacity="1"},hide:function(){i&&(this.wrapper.style.webkitTransitionDelay="350ms"),this.wrapper.style.opacity="0"},remove:function(){return this.wrapper.parentNode.removeChild(this.wrapper),null}};var i="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,r=/iphone|ipad/gi.test(navigator.appVersion),n="ontouchstart"in window,a=n?"touchstart":"mousedown",s=n?"touchmove":"mousemove",o=n?"touchend":"mouseup",l="translate"+(i?"3d(":"("),h=i?",0)":")",p=0;window.iScroll=t}();var util={};util.format=function(t){var e=util.format.arguments[1],i=1;if("object"==typeof e){for(key in e)t=t.replace("{"+key+"}",e[key]);return t}e&&e.splice?i=0:e=util.format.arguments;for(var r=i;r<e.length;r++)t=t.replace("{"+(r-i)+"}",e[r]);return t},util.min=function(t,e){return t>e?e:t},util.max=function(t,e){return e>t?e:t},util.count=function(t){var e=0;for(key in t)e++;return e},util.hasMutualKey=function(t,e){var i=!1;return $.each(t,function(t){$.each(e,function(e){i=i||t==e})}),i},util.asyncEach=function(t,e,i,r){r||(r=0);var n=[],a=0;$.each(t,function(t,e){var i={index:t,item:e,next:null};0<n.length&&(n[n.length-1].next=i),n.push(i),a++});var s=function(t){e(t.index,t.item),a--,t.next&&setTimeout(function(){s(t.next)},r)},o=function(){0==a&&i?i():setTimeout(function(){o()},10)};0<n.length&&s(n[0]),o()},util.popArrayElement=function(t,e){if(!t.indexOf)return null;var i=t.indexOf(e);return i>-1?t.splice(i,1)[0]:null},jQuery.cookie=function(t,e,i){if(1<arguments.length&&"[object Object]"!=""+e){if(i=jQuery.extend({},i),(null===e||void 0===e)&&(i.expires=-1),"number"==typeof i.expires){var r=i.expires,n=i.expires=new Date;n.setDate(n.getDate()+r)}return e=""+e,document.cookie=[encodeURIComponent(t),"=",i.raw?e:encodeURIComponent(e),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}return i=e||{},n=i.raw?function(t){return t}:decodeURIComponent,(r=RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)").exec(document.cookie))?n(r[1]):null};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){for(var e,i,r,n,a,s,o="",l=0,t=Base64._utf8_encode(t);l<t.length;)e=t.charCodeAt(l++),i=t.charCodeAt(l++),r=t.charCodeAt(l++),n=e>>2,e=(3&e)<<4|i>>4,a=(15&i)<<2|r>>6,s=63&r,isNaN(i)?a=s=64:isNaN(r)&&(s=64),o=o+this._keyStr.charAt(n)+this._keyStr.charAt(e)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return o},decode:function(t){for(var e,i,r,n,a,s="",o=0,t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<t.length;)e=this._keyStr.indexOf(t.charAt(o++)),i=this._keyStr.indexOf(t.charAt(o++)),n=this._keyStr.indexOf(t.charAt(o++)),a=this._keyStr.indexOf(t.charAt(o++)),e=e<<2|i>>4,i=(15&i)<<4|n>>2,r=(3&n)<<6|a,s+=String.fromCharCode(e),64!=n&&(s+=String.fromCharCode(i)),64!=a&&(s+=String.fromCharCode(r));return s=Base64._utf8_decode(s)},_utf8_encode:function(t){for(var t=t.replace(/\r\n/g,"\n"),e="",i=0;i<t.length;i++){var r=t.charCodeAt(i);128>r?e+=String.fromCharCode(r):(r>127&&2048>r?e+=String.fromCharCode(r>>6|192):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128)),e+=String.fromCharCode(63&r|128))}return e},_utf8_decode:function(t){for(var e="",i=0,r=c1=c2=0;i<t.length;)r=t.charCodeAt(i),128>r?(e+=String.fromCharCode(r),i++):r>191&&224>r?(c2=t.charCodeAt(i+1),e+=String.fromCharCode((31&r)<<6|63&c2),i+=2):(c2=t.charCodeAt(i+1),c3=t.charCodeAt(i+2),e+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),i+=3);return e}};TaskQueue.prototype.add=function(t){this.tasks.push(t)},TaskQueue.prototype.tick=function(t){(t=this.tasks.shift())&&t();var e=this;setTimeout(function(){e.tick()},e.timeout)},MatrixTransform.PI_OVER_180=Math.PI/180,MatrixTransform.prototype.reset=function(){this.m=[1,0,0,1,0,0]},MatrixTransform.prototype.copy=function(t){return t=new MatrixTransform,t.m=[this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5]],t},MatrixTransform.prototype.multiply=function(t){var e=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],n=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=e,this.m[2]=i,this.m[3]=r,this.m[4]=n,this.m[5]=a},MatrixTransform.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=-this.m[1]*t,i=-this.m[2]*t,r=this.m[0]*t,n=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*t,this.m[1]=e,this.m[2]=i,this.m[3]=r,this.m[4]=n,this.m[5]=a},MatrixTransform.prototype.rotateDegrees=function(t){this.rotate(t*MatrixTransform.PI_OVER_180)},MatrixTransform.prototype.rotate=function(t){var e=Math.cos(t),t=Math.sin(t),i=this.m[1]*e+this.m[3]*t,r=this.m[0]*-t+this.m[2]*e,n=this.m[1]*-t+this.m[3]*e;this.m[0]=this.m[0]*e+this.m[2]*t,this.m[1]=i,this.m[2]=r,this.m[3]=n},MatrixTransform.prototype.translate=function(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e},MatrixTransform.prototype.scale=function(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e},MatrixTransform.prototype.transformPoint=function(t,e){var i=t,r=e,t=i*this.m[0]+r*this.m[2]+this.m[4],e=i*this.m[1]+r*this.m[3]+this.m[5];return{x:t,y:e}},MatrixTransform.prototype.unTransformPoint=function(t,e){var i=this.copy();return i.invert(),i.transformPoint(t,e)},MatrixTransform.prototype.applyContext=function(t){t.setTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},MatrixTransform.prototype.toCSSTransform=function(){return"matrix("+this.m[0]+","+this.m[1]+","+this.m[2]+","+this.m[3]+","+this.m[4]+","+this.m[5]+")"};var Element=function(){this.ref=this.container=null,this.events=[],this.actionGroups={},this.variables={},this.states={},this.parent=null,this.children={},this.log=[]};Element.prototype.objectType="Element",Element.prototype.innerType="Element",Element.PixelSrc="data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",Element.prototype.restoreVariableResumeData=function(t){for(var e=$(this.xml).children("variables").children("[resume='true'][type='boolean']"),i=$(this.xml).children("variables").children("[resume='true'][type!='boolean']"),t=new bwChunk(t),r=0;!t.EOF();)for(var n=t.NextUBase10(1),a=1;n>=a;)n&a&&(r<e.length?this.variables[$(e[r]).attr("name")]="true":this.extractNextSpecialBool&&this.extractNextSpecialBool()),r++,a*=2;for(e=null,r=0;r<=i.length;r++)if(r<i.length){var e=e?e.NextChunk():t.NextChunk(),n=$(i[r]),a=this.variableTypes[n.attr("name")],s=e.Data();switch(a){case"number":s=e.NextBase10();break;case"string":s=bwChunk.DecodeString(s)}this.variables[n.attr("name")]=s}else this.extractNextSpecialVar&&(e=e?e.NextChunk():t.NextChunk(),this.extractNextSpecialVar(e.Data()));return e?e.Remainder():t.Remainder()},Element.prototype.shouldStoreVariableResume=function(){return this.getVariableResumeData()!=bwChunk.EMPTY_CHUNK},Element.prototype.getVariableResumeData=function(t){var e=this,i="",r="",n=1,a=0,s=!1,o=!1,l={},h=function(t,h){if(!l[t]&&e.variableResumes[t])switch(h!=e.variableDefaults[t]&&(o=!0),e.variableTypes[t]){case"bool":case"boolean":h&&"false"!=h&&(a+=n),n*=2,s=!0,n>32&&(n=1,r+=bwChunk.UBase10toN(a),s=!1,a=0);break;case"string":strTemp=bwChunk.EncodeString(h),i+=bwChunk.CreateChunk(strTemp);break;case"number":i+=bwChunk.CreateChunk(bwChunk.Base10toN(parseInt(h)))}};return $.each(this.variables,h),this.getExtraResumeVars&&$.each(this.getExtraResumeVars(),h),s&&(r+=bwChunk.UBase10toN(a)),i=bwChunk.CreateChunk(r)+i,o?bwChunk.CreateChunk(i):t?"":bwChunk.EMPTY_CHUNK},Element.prototype.toData=function(t){var e=this,i={},r={};return $.each(this.variables,function(t,n){n==e.variableDefaults[t]||r[t]||(i.variables||(i.variables={}),i.variables[t]=n)}),$.each(this.children,function(e,r){if(r.toData){var n=r.toData(t);jQuery.isEmptyObject(n)||(i.children||(i.children={}),i.children[e]=n)}}),this.shuffled&&(i.shuffled=!0),void 0!=this.shuffleX&&(i.shuffleX=this.shuffleX,i.shuffleY=this.shuffleY),this.visible&&(i.visible=!0),i},Element.prototype.updateFromData=function(t,e){var i=this;i.reset(e),t.variables&&$.each(t.variables,function(e,r){if(i.variables[e]!=r)switch(i.variables[e]=r,e){case"OnStage":t.visible="true"==r}}),t.children&&$.each(t.children,function(t,r){var n=i.children[t];n&&n.updateFromData(r,e)}),e||(t.shuffled&&(this.shuffled=!0,this.shuffleGroup&&(this.shuffleGroup.shuffled=!0),void 0!=t.shuffleX&&(this.shuffleX=t.shuffleX,this.shuffleY=t.shuffleY,this.x=this.shuffleX,this.y=this.shuffleY),void 0!=t.x&&(isNaN(parseInt(t.x))||(this.x=parseInt(t.x)),isNaN(parseInt(t.y))||(this.y=parseInt(t.y))),this.updateMatrixComplete(!0)),i.slide&&i.slide==player.currentSlide()&&i.ref&&(t.visible?this.quickShow?this.quickShow():(this.show(),this.visible=!0):"ShuffleGroup"!=this.innerType&&(this.quickHide?this.quickHide():this.hide())))},Element.prototype.reset=function(t,e){var i=this;$.each(this.variables,function(t,e){void 0!=i.variableDefaults[t]&&i.variableDefaults[t]!=e&&(i.variables[t]=i.variableDefaults[t])}),i.variables._disabled=i.variableDefaults._disabled,t||"Slide"==this.innerType||(this.visible=!1),$.each(this.children,function(i,r){(!e||e(r))&&r.reset&&r.reset(t)})},Element.prototype.setElementProperty=function(t,e,i){this[t]=e,i&&this.children&&$.each(this.children,function(r,n){n.setElementProperty&&n.setElementProperty(t,e,i)})},Element.prototype.constructElement=function(){this.events=[],this.actionGroups={},this.variables={},this.variableDefaults={},this.variableResumes={},this.variableTypes={},this.content={},this.states={},this.colors={},this.animations={},this.resources=[],this.eventSubscribers=[],this.matrix=new MatrixTransform,this.isRotated=!1,this.parent=null,this.children={},this.variableDefaults._default="true",this.variables.ObjectState="_default",this.variableDefaults.ObjectState="_default",this.originalYOffset=this.originalXOffset=this.originalHeight=this.originalWidth=this.originalZ=this.originalY=this.originalX=this.rotation=this.yoffset=this.xoffset=this.rotateypos=this.rotatexpos=this.dragY=this.dragX=this.y=this.x=0},Element.prototype.emptyElement=function(){this.constructElement(),this.xml=null},Element.prototype.childItems=function(){var t=[];return $.each(this.children,function(e,i){"Item"==i.objectType&&t.push(i)}),t},Element.prototype.findDescendantById=function(t){var e=null;return $.each(this.children,function(i,r){!e&&r.id==t&&(e=r),!e&&r.findDescendantById&&(e=r.findDescendantById(t))}),e},Element.prototype.hasDescendantByType=function(t){var e=!1;return $.each(this.children,function(i,r){!e&&r.innerType.toLowerCase()==t.toLowerCase()&&(e=!0),!e&&r.hasDescendantByType&&(e=r.hasDescendantByType(t))}),e},Element.prototype.getDescendantsByType=function(t){var e=this,i=[];return $.each(this.children,function(r,n){"Storyline"==e.innerType&&"Slide"==n.innerType||(n.innerType.toLowerCase()==t.toLowerCase()&&i.push(n),n.getDescendantsByType&&(i=i.concat(n.getDescendantsByType(t))))}),i},Element.prototype.isAncestor=function(t){for(var e=this.parent;e;){if(t==e)return!0;e=e.parent}return!1},Element.prototype.findAncestorOfType=function(t){for(var e=this;e;){if(e.innerType==t)return e;e=e.parent}return null},Element.prototype.eachAncestor=function(t){for(var e=this.parent;e;)t(e),e=e.parent},Element.prototype.getFullObjref=function(t){var e=this.id;return this.parent&&this.parent.id&&this.parent.getFullObjref&&(e=this.parent.getFullObjref()+"."+e),
(t?"_player.":"")+e},Element.prototype.getFullVariableRef=function(t){return t=this.parseObjref(t),"_player."+t.target.getFullObjref()+"."+t.variable},Element.prototype.loadElementInfoFromXML=function(t){var e=this;this.events=[],$(t).children("events").children().each(function(t,i){var r=new StoryEvent(e);r.loadFromXML(i),e.events.push(r)}),this.actionGroups={},$(t).children("actiongroups").children().each(function(t,i){var r=$(i).attr("id"),n=$(i).children("actions").children();e.actionGroups[r]=n}),$(t).children("variables").children().each(function(t,i){e.variables[$(i).attr("name")]=$(i).attr("value"),e.variableDefaults[$(i).attr("name")]=$(i).attr("value"),e.variableTypes[$(i).attr("name")]=$(i).attr("type"),e.variableResumes[$(i).attr("name")]="true"==$(i).attr("resume")}),$.each($(t).children("colors").children("color"),function(t,i){var r=$(i).attr("name"),n=new Background(e.ref);n.loadFromXML($(i),"fill"),e.colors[r]=n}),this.lmsid=$(t).attr("lmsid"),e.variables.Id=$(t).attr("id"),e.variableDefaults.Id=$(t).attr("id"),e.resume="true"==$(t).attr("resume")},Element.prototype.hasEvent=function(t,e){if(!this.events)return null;for(var i=0;i<this.events.length;i++){var r=this.events[i];if(r.trigger==t)return r}return i=null,!i&&e&&this.parent&&this.parent.hasEvent&&(i=i||this.parent.hasEvent(t,e)),i},Element.constructors={},Element.registerTagNames=function(t,e){$.each(e,function(e,i){Element.constructors[i]=t})},Element.prototype.allResourcesLoaded=function(){var t=!0;return $.each(this.resources,function(e,i){t=t&&i.loaded}),t},Element.prototype.loadResources=function(){$.each(this.resources,function(t,e){e.load(player.deferredLoadingIndex++)})},Element.prototype.unloadResources=function(){$.each(this.resources,function(t,e){e.unload()})},Element.prototype.loadChildrenFromXML=function(t,e,i,r){var n=this;$(t).children("objects").children().each(function(t,a){var s;"objgroup"==a.tagName?s=new ItemGroup(n.ref,e,i):"expandinglabel"==a.tagName?s=new ExpandingLabel(n.ref,e,i):"sequencectrl"==a.tagName?s=new SequenceCtrl(n.ref,e,i):"shufflegroup"==a.tagName?s=new ShuffleGroup(n.ref,e,i):"scrollarea"==a.tagName?s=new ScrollArea(n.ref,e,i):"stategroup"==a.tagName?s=new StateGroup(n.ref,e,i):"dragitem"==a.tagName?s=new DragItem(n.ref,e,i):"droparea"==a.tagName?s=new DropArea(n.ref,n.slide,i):"droplist"==a.tagName?s=new DropList(n.ref,e,i):"textinput"==a.tagName?s=new TextInput(n.ref,e,i):"button"==a.tagName?s=new Button(n.ref,e,i):"image"==a.tagName?s=new ImageItem(n.ref,e,i):"vectorshape"==a.tagName?s=(s=$(a).attr("id"))&&0==s.indexOf("hotspot_")&&s.indexOf("_marker")==s.length-7?new HotspotMarker(n.ref,e,i):ImageItem.extractAnimatedGif(a)?new ImageItem(n.ref,e,i):new VectorShape(n.ref,e,i):"swf"==a.tagName?(s=$(a).attr("id"),s=0==s.indexOf("hotspot")?new HotspotMarker(n.ref,e,i):new SWFItem(n.ref,e,i)):"video"==a.tagName?(s=new Video,s.directParent=n):s=new StageItem(n.ref,e,i),s&&(s.parent=n,s.offsetParent=n,s.loadFromXML(a,e,i),n.children[$(a).attr("id")]=s,r&&r(s))})},Element.prototype.handleEventDeep=function(t,e,i,r){this.handleEvent(t,e,i,!1,!0,r),this.deepEach(function(n,a){a.handleEvent(t,e,i,!1,!0,r)})},Element.prototype.handleEvent=function(t,e,i,r,n,a){var s=this,o=!0;StoryEvent.cancelEvent=!1;var l=!0;return this.events.forEach(function(n){n.trigger!=t||n.filter&&!n.filter(e)||i&&!i(s,e)||(l=l&&n.act(s,a),o=r)}),this.group&&!n&&(l=l&&this.group.handleEvent(t,e,i,r,n,a)),!n&&o&&this.parent&&this.parent.handleEvent&&(l=l&&this.parent.handleEvent(t,e,i,r,n,a)),l},Element.prototype.runActionGroup=function(t){var e=this.parseObjref(t),i=e.target,t=e.variable,r=i.actionGroups[t],n=!0;return r&&$.each(r,function(t,e){n&&(n=i.runAction(e))}),e.processChildren&&$.each(this.children,function(e,i){var r=i.actionGroups[t];r&&$.each(r,function(t,e){n&&(n=i.runAction(e))})}),n},Element.prototype.performGotoPlay=function(t,e){var i=!0;if(DragItem.cancelDrag(),("_current"==t||"_frame"==t&&null==player.currentWindow)&&(i=!1),"Scene"==e.innerType&&(e=e.getFirstSlide()),"Slide"==e.innerType)if("_current"!=t&&(e.variables.WindowId=t),"_current"!=t&&"_frame"!=t){player.pause();var r=story.parseObjref(t).target;r.showSlide(e),player.windowZoomModifier=r.zoomModifier,r.isPrompt&&(i=!1)}else"_current"==t&&null!=player.currentWindow?(player.pause(),player.currentWindow.showSlide(e)):(i=player.currentSlide()==e,null!=player.currentWindow&&(player.previousWindow=player.currentWindow),player.currentWindow=null,player.windowZoomModifier=1,i&&player.currentSlide().resetSlide(!1,!1,!0),player.showSlideIndex(e.slideIndex,null,!0,function(){player.pause(),player.zoomParams=null,player.play()})),i=!1;else"SlideDraw"==e.innerType&&(e.showFirst(),i=!1);return i},Element.prototype.runAction=function(t){var e=!0,i=this,r=$(t).attr("id"),n=$(t).get(0).tagName.toLowerCase();switch(player.logActivity&&this.log.push([n,trace.getTicks()]),n){case"adjustvar":case"show":case"hide":case"show_slidelayer":case"hide_slidelayer":case"hideallslidelayers":case"media_play":case"media_pause":case"media_toggle":case"set_volume":var r=new TimelineAction(i),a=new StoryEvent(i);a.isUserInitiated=!1,r.loadFromXML(t,a),r[n](a,i,!1);break;case"exe_actiongroup":e=this.runActionGroup(r);break;case"if_action":n=i.evaluateCondition($(t).children("condition").first())?"then_actions":"else_actions",$.each($(t).children(n).children(),function(t,r){e&&(e=i.runAction(r))});break;case"set_enabled":n=$(t).children("objref").attr("value"),t=$(t).children("enabled").attr("value"),n=i.parseObjref(n).target,n.variables._disabled=("false"==t).toString(),"textinput"==n.type?n.input.get(0).disabled=n.variables._disabled:"droplist"==n.type&&(n.select.get(0).disabled=n.variables._disabled);break;case"set_review":n=$(t).children("objref").attr("value"),t=$(t).children("enabled").attr("value"),n=i.parseObjref(n).target,0==n.id.indexOf("hotspot")&&(n.variables._disabled="true",n.parent.variables._disabled="true",n.ref.parent().find(".item.swf").show()),n.setVariable("ReviewMode",!0),n.set_review&&n.set_review();break;case"setdrawreview":n=$(t).attr("drawid"),t="true"==$(t).attr("review"),n=i.parseObjref(n).target,n.setVariable("ReviewMode",t),n.m_bReviewMode=t;break;case"setobjstate":(n=i.parseObjrefFromXML(t).target)||(n=i),t=$(t).children("stateref").attr("value"),n.setStates(t,"true");break;case"setfocus":i.input&&i.input.get(0).focus();break;case"trigger_next_slide":e=player.currentSlide().handleEvent("onnextslide");break;case"trigger_prev_slide":e=player.currentSlide().handleEvent("onprevslide");break;case"trigger_submit_slide":e=player.currentSlide().handleEvent("onsubmitslide");break;case"trigger_submitall_slide":Interaction.partialEvaluateSlide(player.currentSlide()),e=player.currentSlide().handleEvent("onsubmitallslide");break;case"trigger_slide_finish":e=player.currentSlide().handleEvent("onfinishslide");break;case"history_prev":player.currentWindow?0<player.currentWindow.history.length&&(t=player.currentWindow.history.pop(),player.currentWindow.showSlide(story.allSlides[t],!0)):0<player.history.length&&(t=player.history.pop(),player.showSlideIndex(t,null,!1)),e=!1;break;case"reset_player":t=$(t).attr("startslideid"),n=i.parseObjref(t).target,$.each(story.allSlides,function(t,e){e.resetSlide(!0)}),player.currentTime=0,player.currentWindow&&(player.currentWindow.close(),player.currentWindow=null),t&&(e=!1,this.performGotoPlay("_frame",n));break;case"resume_player":if(t=$(t).attr("resume"),Audio.iOSPrepare&&Audio.iOSPrepare(),"true"==t){t=player.resumeData,player.overrideResumeData&&(resumedata=player.overrideResumeData);try{player.useCompactResume?story.updateFromCompactData(t):story.updateFromData(JSON.parse(t))}catch(s){console.error("could not restore from resumeData",s)}}else story.clearLocalStorage(),SlideDraw.populateDraws();t=story.parseObjref(story.resumeWindow).target,t.close(),$(".slide:not(.framed)").hide(),n=story.getStartingSlide(!0),n.prepDownstreamMedia(),player.showSlideID(story.startingslide,!0,function(){if(story.startingWindowInfo){var t=0,e=function(){10<t++||player.currentSlide()&&player.currentSlide().transitionedIn?story.startingWindowInfo.win.showSlide(story.startingWindowInfo.slide):setTimeout(e,100)};e()}});break;case"notifylinkselected":t=$(t).attr("id"),(t=story.parseObjref(t).target)&&t.notifySelected();break;case"trigger_submit_slide":player.currentSlide().handleEvent("onsubmitslide");break;case"gotoplay":n=$(t).children("objref").attr("value"),t=$(t).attr("window"),n=i.parseObjref(n).target,e=this.performGotoPlay(t,n);break;case"playnextdrawslide":player.currentDraw.playnextdrawslide(),e=!1;break;case"close_window":r=$(t).attr("id"),"_current"==r?player.currentWindow&&player.currentWindow.close():(t=story.parseObjref(r).target,t.close());break;case"close_player":window.manuallyClosing=!0,player.lmsManager.handleClosePlayer(),window.close(),setTimeout(function(){player.isCrossDomainFrame?(window.open("","_self",""),window.close()):(top.window.open("","_self",""),top.window.close())},10);break;case"eval_interaction":r=$(t).attr("id"),e=i.parseObjref(r).target.evaluate();break;case"eval_all_unanswered":r=this.parseObjrefFromXML(t).target,Interaction.eval_all_unanswered(r,t);break;case"setquizcomplete":Interaction.setquizcomplete(t);break;case"object_action":if(n=$(t).attr("command"),r=this.parseObjrefFromXML(t).target,"function"==typeof r[n])return r[n](this.xml),!0;break;case"showtimer":r=$(t).attr("id"),t=i.parseObjref(r).target,t.show();break;case"hidetimer":r=$(t).attr("id"),t=i.parseObjref(r).target,t.hide();break;case"starttimer":r=$(t).attr("id"),t=i.parseObjref(r).target,t.start();break;case"pausetimer":r=$(t).attr("id"),t=i.parseObjref(r).target,t.pause();break;case"pause_timeline":t=i.parseObjrefFromXML(t).target,"Layer"==t.innerType?player.layerPlaying=!1:player.pause();break;case"resetquiz":t=i.parseObjrefFromXML(t).target,t.reset(),t.attemptCount++,$.each(t.sliderefs,function(t,e){var r=i.parseObjref(e).target;r.compactResumeData=null,r.resumeData=null,r.resetSlide(!0,!0)}),player.currentSlide().reset();break;case"exe_javascript":r=$(t).attr("id"),window.ExecuteScript(r);break;case"emailto":t=$(t).attr("address"),location.href="mailto:"+t;break;case"printresults":break;case"enable_frame_control":n=$(t).attr("name"),t="true"==$(t).attr("enable"),player.frame.setControlEnabled(n,t);break;case"setactivetimeline":player.useActiveTimeline&&(t=i.parseObjrefFromXML(t).target,player.activeTimeline="Layer"==t.innerType?t:player);break;case"debug_trace":$(t).attr("message");break;default:i[n]?i[n](t):(r=new TimelineAction(i),a=new StoryEvent(i),r.loadFromXML(t,a),r[n]&&r[n](a,i,!1))}return e},Element.prototype.getProperty=function(t){switch(t){case"AbsoluteId":return this.getFullObjref(!0);case"XPos":return this.x;case"YPos":return this.y;case"InitXPos":return this.originalX+this.xoffset-this.originalXOffset;case"InitYPos":return this.originalY+this.yoffset-this.originalYOffset;case"width":return this.width;case"height":return this.height;case"Position":if("ScrollArea"==this.innerType&&this.ref)return this.getScrollPosition()}return"function"==typeof this[t]?this[t]():""},Element.prototype.GetProperty=function(t){return this.extractVariable(t)},Element.prototype.GetVariable=function(t){return this.extractVariable(t)},Element.prototype.extractVariable=function(t,e){switch(e=e||"var"){case"var":case"variable":case"property":var i=this.parseObjref(t),r=i.target.variables[i.variable];return void 0==r&&(r=i.target.getProperty(i.variable)),"property"==e&&story.properties[t]&&(r=story.properties[t]),r;case"number":return parseFloat(t);case"boolean":return t;case"string":return t;case"actparam":return TimelineAction.actparams[t];default:return t}},Element.prototype.setVariable=function(t,e){var i=this.parseObjref(t);i.target.variables[i.variable]!=e&&(i.target.variables[i.variable]=e,i.target.handleVarChanged(t,"onvarchanged"))},Element.prototype.registerVariableEventSubscriber=function(t,e){for(var i in this.eventSubscribers){var r=this.eventSubscribers[i];if(r.item==t&&r.varname==e)return}this.eventSubscribers.push({item:t,varname:e,check:Math.random()})},Element.prototype.handleVarChanged=function(t,e){var e=e||"onvarchanged",i=this;$.each(this.eventSubscribers,function(r,n){(n.varname==t||n.item.getFullVariableRef(n.varname)==i.getFullVariableRef(t))&&(n.item.handleEvent(e,t,null,!1,!0),n.item.render&&n.item.render(null,!0,null,"handleVarChanged"))})},Element.prototype.setProperty=function(t,e,i){var r=this.parseObjref(t),t=r.target.variables[r.variable]!=e;r.target.variables[r.variable]=e,t&&!i&&!this.group&&setTimeout(function(){r.target.handleVarChanged(r.variable,"onpropchanged")},0)},Element.prototype.parseObjrefFromXML=function(t){return this.parseObjref($(t).find("objref").attr("value"))},Element.prototype.parseObjref=function(t){var e=this,i=t,r=!1,n=!0,a=!1;if(!t)return{target:null,variable:null,success:!1,isVariableRef:!1};var s=i.split(".");return $.each(s,function(t,o){switch(o){case"_this":break;case"_children":r=!0;break;case"_parent":if(e.parent)for(e=e.parent;"ShuffleGroup"==e.innerType;)e=e.parent;break;case"_player":e=story;break;default:var l=t==s.length-1,h=e.children[o];!h&&e.children[""]&&(h=e.children[""].children[o]),h?e=h:l&&(i=o,a=!0,"undefined"==typeof e.variables[o]&&(n=!1))}}),{target:e,variable:i,processChildren:r,success:n,isVariableRef:a}},Element.prototype.setStates=function(t,e){var i=this;1<t.split("_").length&&$.each(t.split("_"),function(t,r){0!=r.length&&(r="_"+r.toLowerCase(),i.variables[r]=e,i.handleVarChanged("onvarchanged",r))}),i.render&&i.render(t,!0,null,"setStates"),i.executeStateActions&&i.executeStateActions(t),i.variables.ObjectState=t},Element.prototype.store_resume_data=function(t){var e=$(t).attr("objref"),t=$(t).attr("varref"),e=this.parseObjref(e).target,e=JSON.stringify(e.toData());this.setVariable(t,e)},Element.prototype.restore_resume_state=function(t){var e=$(t).attr("objref"),i=$(t).attr("varref"),t="true"==$(t).attr("limited"),e=this.parseObjref(e).target;(i=this.extractVariable(i))&&(i=JSON.parse(i)),i&&e.updateFromData(i,t)},Element.prototype.evaluateCondition=function(t,e){var i=this,r=function(){if(e){if(e.lmsCorrectResponses[0]&&e.lmsCorrectResponses[0].lmstext)return e.lmsCorrectResponses[0].lmstext;e.lmsCorrectResponses[0]={lmstext:""}}return""},n=function(t){if(e){var i=r();i&&(i+=" "),e.lmsCorrectResponses[0]={lmstext:i+t}}},a=$(t).get(0).tagName;switch(a){case"condition":return 1!=$(t).children().length&&console.error("FAILED INVARIANT: condition with multiple children",a,i.id,i.innerType,$(t).children().length),i.evaluateCondition($(t).children().first(),e);case"and":var s=!0;return $(t).children().each(function(t,a){r()&&n("and"),s=e?i.evaluateCondition(a,e)&&s:s&&i.evaluateCondition(a)}),s;case"or":return s=!1,$(t).children().each(function(t,a){r()&&n("or"),s=e?i.evaluateCondition(a,e)||s:s||i.evaluateCondition(a)}),s;case"nand":return s=!0,$(t).children().each(function(t,a){r()&&n("and"),s=e?i.evaluateCondition(a,e)&&s:s&&i.evaluateCondition(a)}),!s;case"nor":return s=!1,$(t).children().each(function(t,a){r()&&n("nor"),s=e?i.evaluateCondition(a,e)||s:s||i.evaluateCondition(a)}),!s;case"compare":var o=$(t),a=o.attr("operator"),l=!0,h=o.attr("valuea"),h=i.extractVariable(h,o.attr("typea")),p=o.attr("valueb"),o=i.extractVariable(p,o.attr("typeb"));!isNaN(h)&&!isNaN(o)&&""!==h&&""!==o&&(h=parseFloat(h),o=parseFloat(o));var p=h==o,c="equals";switch(a){case"eq":c="equal to";break;case"iceq":p=h.toLowerCase()==o.toLowerCase(),c="equal to";break;case"noteq":p=!p,c="not equal to";break;case"icneq":p=h.toLowerCase()!=o.toLowerCase(),c="not equal to";break;case"gt":p=h>o,c="greater than";break;case"gte":p=h>=o,c="greater than or equal to";break;case"lt":p=o>h,c="less than";break;case"lte":p=o>=h,c="less than or equal to";break;default:l=!1}return n("Correct Response is "+c+" "+o),l?p:!1;case"hittestpoint":return a=this.parseObjref($(t).children("objref").attr("value")).target,l=parseInt(this.extractVariable($(t).children("xpos").attr("value"),$(t).children("xpos").attr("type"))),h=parseInt(this.extractVariable($(t).children("ypos").attr("value"),$(t).children("ypos").attr("type"))),a?a.isPointActive(l,h):!1;case"hasslidetext":var a=this.parseObjref(this.extractVariable($(t).children("slideref").attr("value"),$(t).children("slideref").attr("type"))).target,d=this.extractVariable($(t).children("searchref").attr("value"),$(t).children("searchref").attr("type")),d=d.toLowerCase(),u=!1;return a.xml.find("[alttext]").each(function(t,e){u=u||-1<$(e).attr("alttext").toLowerCase().indexOf(d)}),u;case"varexists":return a=this.parseObjref($(t).attr("value")),d=a.target.variables[a.variable],void 0!=d;case"isdescendant":return l=this.extractVariable($(t).attr("targeta"),$(t).attr("typea")),a=this.extractVariable($(t).attr("targetb"),$(t).attr("typeb")),l=this.parseObjref(l).target,a=this.parseObjref(a).target,l.isAncestor(a);default:return!1}},Element.prototype.get_mouse_position=function(t){if("true"!=this.variables._disabled&&"true"!=this.parent.variables._disabled){swipe.sniff(player.lastEvent||window.event),swipe.moved=!1;var e=this.slide.ref.offset(),e=this.slide.matrix.unTransformPoint((swipe.rawX-e.left)/player.frameScale,(swipe.rawY-e.top)/player.frameScale);this.setVariable($(t).children("xvar").attr("value"),e.x),this.setVariable($(t).children("yvar").attr("value"),e.y)}},Element.prototype.moveto=function(t){var e=this.parseObjref($(t).children("objref").attr("value")).target,i=parseInt(this.extractVariable($(t).children("xpos").attr("value"),$(t).children("xpos").attr("type"))),r=parseInt(this.extractVariable($(t).children("ypos").attr("value"),$(t).children("ypos").attr("type")));if("true"==$(t).attr("addoffsetx"))var n=parseInt(this.extractVariable($(t).children("xoffset").attr("value"),$(t).children("xoffset").attr("type"))),i=i+n;"true"==$(t).attr("addoffsety")&&(t=parseInt(this.extractVariable($(t).children("yoffset").attr("value"),$(t).children("yoffset").attr("type"))),r+=t),e.actionControlled=!0,e.ref.css("left",i),e.ref.css("top",r),e.x=i,e.y=r,e.updateMatrixComplete(!0)},Element.prototype.bringtofront=function(t){var e=this;t&&(e=this.parseObjref($(t).children("value").attr("value")).target),e.depth<e.slide.topZ&&(e.depth=++e.slide.topZ,e.setZIndex(e.depth))},Element.prototype.open_webobject=function(t){this.webobject&&(this.webobject.remove(),this.webobject=null);var e=this.parent,i=this.slide;"Slide"==this.innerType?(e=this,i=this):"Layer"==this.innerType&&(e=this),this.webobject=$("<iframe class='item webobject'></iframe>"),this.webobject.attr("src",$(t).attr("url")),this.webobject.attr("width",$(t).attr("width")),this.webobject.attr("height",$(t).attr("height")),this.webobject.css("left",$(t).attr("xpos")+"px"),this.webobject.css("top",$(t).attr("ypos")+"px"),this.webobject.css("z-index",++i.topZ),e.ref.append(this.webobject),this.webobject.show()},Element.prototype.destroyWebobjects=function(){this.webobject&&(this.webobject.remove(),this.webobject=null)},Element.prototype.open_url=function(t){var e=$(t).attr("url"),i=$(t).attr("window"),r=$(t).attr("windowsize");$(t).attr("usedefaultcontrols");var n="true"==$(t).attr("status")?1:0,a="true"==$(t).attr("toolbar")?1:0,s="true"==$(t).attr("location")?1:0,o="true"==$(t).attr("menubar")?1:0,l="true"==$(t).attr("scrollbars")?1:0,h="true"==$(t).attr("resizable")?1:0,p=parseInt($(t).attr("width")),t=parseInt($(t).attr("height")),n="location="+s+",menubar="+o+",resizable="+h+",status="+n+",scrollbars="+l+",toolbar="+a;switch(r){case"fullscreen":n+=",width="+(screen.width-33)+",height="+(screen.height-150);break;case"custom":n+=",width="+p+",height="+t}story.popWindow=window.open(e,i,n),story.popWindow&&story.popWindow.focus&&story.popWindow.focus()},Element.prototype.slideY=function(){for(var t=0,e=this;e&&!isNaN(e.y);)t+=parseInt(e.y),!isNaN(e.yoffset)&&e!=this&&(t+=e.yoffset),"ScrollArea"==e.innerType&&e.ref&&e.ref.get(0)&&e.ref.get(0).scrollTop&&(t-=parseInt(e.ref.get(0).scrollTop)),e=e.parent;return parseInt(t)},Element.prototype.slideX=function(){for(var t=0,e=this;e&&!isNaN(e.x);)t+=parseInt(e.x),!isNaN(e.xoffset)&&e!=this&&(t+=e.xoffset),"ScrollArea"==e.innerType&&e.ref&&e.ref.get(0)&&e.ref.get(0).scrollLeft&&(t-=parseInt(e.ref.get(0).scrollLeft)),e=e.parent;return parseInt(t)},Element.prototype.testOver=function(t,e){var i=this.matrix.unTransformPoint(t,e);return 0<=i.x&&i.x<=this.width&&0<=i.y&&i.y<=this.height},Element.prototype.deepEach=function(t,e,i){isNaN(i)&&(i=0),$.each(this.children,function(r,n){(!e||e(n))&&(t(r,n,i),n.deepEach&&n.deepEach(t,e,i+1))})},Element.prototype.getAbsoluteMatrix=function(){for(var t=this.matrix.copy(),e=this.parent,i=0;e&&e.matrix&&10>i++;)t.multiply(e.matrix),e=e.parent;return t},Element.prototype.updateMatrixComplete=function(t){this.parent&&this.parent.updateMatrixComplete&&this.parent.updateMatrix&&this.parent.updateMatrixComplete(!1),this.updateMatrix(),t&&this.deepEach(function(t,e){e.matrix&&e.isStageItem&&e.updateMatrix()})},Element.prototype.getAnimationTime=function(){return this.currentTime};var Storyline=function(t){this.container=t,this.scenes=[],this.allSlides=[],this.slideLookup={},this.media=[],this.slideDraws=[],this.startingslide=null,this.quizzes={},this.timers={},this.pathlibs={},this.properties={},this.currentSceneIndex=0,this.constructElement()};Storyline.prototype=new Element,Storyline.prototype.objectType="Storyline",Storyline.prototype.innerType="Storyline",Storyline.prototype.saveToLocalStorage=function(){if(player.useCompactResume){var t=story.toResumeData();try{localStorageAlias[story.resumeID]=t}catch(e){}}else t=JSON.stringify(story.toData(!0)),localStorageAlias[story.resumeID]=t},Storyline.prototype.clearLocalStorage=function(){localStorageAlias.removeItem(story.resumeID)},Storyline.prototype.toResumeData=function(){var t="";if(0==player.history.length&&null==player.currentWindowSlide)return"";var e="",i=0;$.each(this.allSlides,function(t,r){r.variables.Visited&&r.trackviews&&(e+=bwChunk.UBase10toN(r.slideIndexForResume,2),i++)}),1==i&&(e="");var t=t+bwChunk.CreateChunk(e),r="",n=Window.getWindowResumeData(0,story.allSlides[player.slideIndex],player.history),r=r+bwChunk.CreateChunk(n),a=0;$.each(this.children,function(t,e){if("Window"==e.innerType&&(a++,e.visible)){var i=Window.getWindowResumeData(a,player.currentWindowSlide,e.history);r+=bwChunk.CreateChunk(i)}});var t=t+bwChunk.CreateChunk(r),n=story.getVariableResumeData(),t=t+n,s="";return $.each(this.children,function(t,e){if("Scene"==e.innerType){var i=bwChunk.EMPTY_CHUNK;e.compactResumeData&&(i=e.compactResumeData),s+=i}}),t+=s,n=bwChunk.UBase10toN(t.length),t=bwChunk.CreateChunk(n)+t},Storyline.prototype.updateFromCompactData=function(t){var t=new bwChunk(t),e=t.Remainder(),i=bwChunk.UBaseNto10(t.Data());if(e.length!=i)return!1;t=t.NextChunk(),i=t.NextChunk(),e=new bwChunk(i.Data()),i=i.NextChunk(),story.restoreVariableResumeData(i.Data()),i.Remainder();for(var i=i.NextChunk(),r=0;!i.isNothing;)i.IsEmpty()||story.getDescendantsByType("Scene")[r].restoreFromResumeData(i.Data()),i=i.NextChunk(),r++;for(;!e.IsEmpty();){var n,i=new bwChunk(e.Data()),a=bwChunk.UBaseNto10(i.Data());if(0==a)i=Window.parseResumeChunk(e),i.slide&&(this.startingslide=i.slide.getFullObjref()),player.history=i.history;else{n=null;var s=1;$.each(this.children,function(t,e){"Window"==e.innerType&&(s==a&&(n=e),s++)}),n&&(i=Window.parseResumeChunk(e),i.slide)&&(i.win=n,this.startingWindowInfo=i)}e=e.NextChunk()}for(;!t.EOF();){var o=t.NextUBase10(2),l=null;$.each(story.allSlides,function(t,e){e.slideIndexForResume==o&&(l=e)}),l.trackviews&&player.lmsManager&&(player.lmsManager.viewedSlides[l.id]=!0),player.slideList.markVisited(l)}return!0},Storyline.prototype.toData=function(t){var e=this,i={slideID:player.currentSlide().id,history:player.history};return $.each(this.variables,function(t,r){r!=e.variableDefaults[t]&&(i.variables||(i.variables={}),i.variables[t]=r)}),$.each(this.children,function(e,r){if("Slide"!=r.innerType&&r.toData){var n=r.toData(t);jQuery.isEmptyObject(n)||(i.children||(i.children={}),i.children[e]=n)}}),i},Storyline.prototype.updateBaseFromData=Element.prototype.updateFromData,Storyline.prototype.updateFromData=function(t){try{this.updateBaseFromData(t),t.slideID&&(this.startingslide=t.slideID),t.history&&(player.history=t.history)}catch(e){}},Storyline.prototype.loadFromXML=function(t){var e=this;e.xml=$(t).children(),this.scenes=[],this.allSlides=[],this.slideLookup={},this.media=[],this.currentSceneIndex=0,this.children={},this.resumeID=$(t).children().children("resume").attr("id"),this.resumeWindow=$(t).children().children("resume").attr("window"),this.resumeSlideID=$(t).children().children("resume").attr("slideid"),this.resumeLMS="true"==$(t).children().children("resume").attr("lmsresume"),this.resumeFlash="true"==$(t).children().children("resume").attr("flashresume"),this.resumePrompt="true"==$(t).children().children("resume").attr("prompt"),this.frameWidth=parseInt($(t).children().children("display").attr("width")),this.frameHeight=parseInt($(t).children().children("display").attr("height")),-1<location.search.indexOf("&menu=1")&&(this.frameWidth+=200),$(t).find("display").children("windows").children("window").each(function(t,i){var r=new Window;r.loadFromXML(i,e),r.createRef(),e.children[r.id]=r}),e.slidemap=[],$(t).children().children("slidemap").children("slideref").each(function(t,i){var r={};r.id=$(i).attr("id"),e.slidemap.push(r)}),$(t).children().children("pathlibs").children("pathlib").each(function(t,i){var r=new PathLib;r.loadFromXML(i,e),e.pathlibs[r.id]=r}),e.entrypoint=$(t).find("bwContent").attr("entrypoint"),e.startingslide=$(t).find("bwContent").attr("entrypoint");var i=$(t).find("scene");e.pendingSceneCount=i.length,i.each(function(i,r){1==i&&(story.startingSlideIndex=story.allSlides.length);var n=new Scene;n.id=$(r).attr("id"),n.lmsid=$(r).attr("lmsid"),n.startingslide=$(r).attr("startingslide"),n.sceneIndex=i,n.parent=e,n.loadElementInfoFromXML(r),e.pendingSceneCount=0,$(r).children("slides").children("slide").each(function(t,i){var r=new Slide(e.container);r.loadFromXML($(i)),r.parent=n,r.sceneIndex=n.sceneIndex,r.sceneSlideIndex=t,n.slides.push(r),n.children[$(i).attr("id")]=r,e.allSlides.push(r),e.slideLookup[$(i).attr("id")]=r,e.children[r.id]=r,r.slideIndex=e.allSlides.length-1,r.slideIndexForResume=r.slideIndex+1,-1==r.id.indexOf("Prompt")&&(player.width=r.width,player.height=r.height,player.aspectRatio=r.aspectRatio)}),$(t).children().children("timers").children("timer").each(function(t,i){var r=new Timer;r.loadFromXML(i,e),e.children[r.id]=r,e.timers[r.id]=r}),n.slideDraws=[];var a=0;$(r).children("slidedraws").children("slidedraw").each(function(t,e){var i=new SlideDraw;i.loadFromXML(e),i.parent=n,i.sceneDrawIndex=a,n.children[i.id]=i,n.slideDraws.push(i),a++}),n.title="Scene "+i,e.children[n.id]=n}),this.loadElementInfoFromXML($(t).children()),$(t).children().children("quizzes").children().each(function(t,i){var r=new Quiz;r.loadFromXML(i,e),e.quizzes[r.id]=r,e.children[r.id]=r}),e.scoring=new Scoring,e.scoring.loadFromXML($(t).children().children("scoring")),SlideDraw.NextSlideIndex=this.allSlides.length+1,$(t).children().children("slidebank").each(function(t,i){var r=new SlideBank;r.loadFromXML(i,e),e.children[r.id]=r}),i=e.getStartingSlide(),story.startingSlideIndex=i.slideIndex,player.width=i.width,player.height=i.height,player.aspectRatio=i.aspectRatio,"SlideDraw"==i.innerType&&(i=i.getFirstSpecifiedSlide(),player.width=i.width,player.height=i.height,player.aspectRatio=i.aspectRatio),$(t).children().children("slidemap").children("slideref").each(function(t,i){var r=$(i).attr("id"),n=e.parseObjref(r).target;$(i).children("assets").children("asset").each(function(t,i){var r=$(i).attr("url");$(i).attr("mobileurl");var a=$(i).attr("htmlurl"),r=player.basepath+(a?a:r),a="image";switch(r.split(".").pop()){case"swf":r=r.replace(".swf",".png"),a="swfImage";break;case"png":case"jpg":case"jpeg":case"gif":case"bmp":break;case"flv":case"mov":case"mp4":case"avi":a="video";break;case"mp3":a="audio";break;default:return}switch(a){case"image":a=new Resource(e,r),"Slide"==n.innerType&&(n.pushResource(a),a.src=r);break;case"video":Video.refStore[Video.getStoreReference(n,r)]||(a=$('<video class="item"><source src="'+r+'"/></video>'),Video.refStore[Video.getStoreReference(n,r)]=a),n.firstVideoAssetSrc||(n.firstVideoAssetSrc=Video.getStoreReference(n,r))}})}),player.loadingSlide=null},Storyline.prototype.addSlide=function(){},Storyline.prototype.getStartingSlide=function(t){var e=this.parseObjref(this.startingslide).target;switch(e.innerType){case"Scene":e=this.parseObjref(e.startingslide).target}return"SlideDraw"==e.innerType&&t&&(e=e.getFirstSlide()),e},Storyline.prototype.getSlideByID=function(t){for(var e=0;e<story.allSlides.length;e++)if(story.allSlides[e].id==t)return story.allSlides[e];return null};var Window=function(){this.xml="",this.constructElement(),this.selected=!1,this.zoomModifier=1,this.history=[],this.visible=!1};Window.prototype=new Element,Window.prototype.objectType="Window",Window.prototype.innerType="Window",Window.getWindowResumeData=function(t,e,i){var t=""+bwChunk.CreateChunk(bwChunk.UBase10toN(t)),t=t+Slide.getResumeReference(e),r="";return $.each(i,function(t,e){r+=Slide.getResumeReference(story.allSlides[e])}),r+=Slide.getResumeReference(e),t+=bwChunk.CreateChunk(r)},Window.parseResumeChunk=function(t){var e={},i=new bwChunk(t.Data());t.Skip(i.ChunkData().length),i=Slide.getFromResumeChunk(t),e.slide=i;for(var r=[],t=new bwChunk(t.NextString());!t.EOF();)i=Slide.getFromResumeChunk(t),r.push(i.slideIndex);return r.pop(),e.history=r,e},Window.closeAll=function(){$.each(story.children,function(t,e){"Window"==e.innerType&&e.close()})},Window.prototype.loadFromXML=function(t,e){this.parent=e,this.children={},this.id=$(t).attr("id"),this.linkid=$(t).attr("linkid"),this.width=parseInt($(t).attr("width"))-2,this.height=parseInt($(t).attr("height"))-2,this.alignto=$(t).attr("alignto"),this.align=$(t).attr("align"),this.valign=$(t).attr("valign"),-1<this.linkid.indexOf("StoryPopup")?(this.width-=6,this.height-=6):this.isPrompt=!0},Window.prototype.createRef=function(){if(this.ref)return!1;var t=$("<div class='window'><h1>Title</h1><hr><div class='windowContent'></div></div>");switch(t.css("width",this.width),t.css("height",this.height),t.css("margin","auto"),t.addClass(this.id),this.contentRef=t.children("div").first(),this.titleRef=t.children("h1").first(),this.isPrompt&&t.addClass("prompt"),this.align){case"center":t.css("left","50%"),t.css("margin-left",-this.width/2)}switch(this.valign){case"center":t.css("top","50%"),t.css("margin-top",-this.height/2)}return $("#slidecontainer").append(t),this.ref=t,this.ref.hide(),!0},Window.prototype.prepareLightbox=function(){if($(".interstitial").removeClass("black"),$(".interstitial").removeClass("white"),$(".interstitial").unbind(),$(document.body).append($(".window.prompt")),!this.lightboxPrepared){$(document.body).append(this.ref),this.contentRef.css("width",this.width),this.contentRef.css("height",this.height),this.closeIcon=$("<div class='closeicon'><span>x</span></div>"),this.closeIcon.css("left",.85*player.width-10+"px"),this.ref.append(this.closeIcon);var t=this;this.closeIcon.click(function(){t==player.currentWindow&&t.close()}),this.lightboxPrepared=!0,this.zoomModifier=.85,"LightboxControlsWnd"==this.id&&(this.controls=$("#controls").clone(!1),this.controls.css("left","0px"),this.ref.append(this.controls),this.progressBar=new ProgressBar(null,this.controls.find("#progressbar"),!0),this.progressBar.onDragUpdate=player.progressBar.onDragUpdate,this.progressBar.zoomModifier=this.zoomModifier,this.controls.find(".submit-slide").parent().bind("click",function(){0<$(".modalfence:visible").length||story.handleEvent("onobjectevent","submit_pressed",null,!1,!1,!0)}),this.controls.find(".next-slide").parent().bind("click",function(){
story.handleEvent("onobjectevent","next_pressed",null,!1,!1,!0)}),this.controls.find(".previous-slide").parent().bind("click",function(){story.handleEvent("onobjectevent","prev_pressed",null,!1,!1,!0)}),this.controls.find(".play").bind("click",function(){player.activeTimeline.play()}),this.controls.find(".pause").bind("click",function(){player.activeTimeline.pause()}),this.volumeSlider=new VolumeSlider(this.controls.find("#control-volume")),this.volumeSlider.onDragUpdate=function(t){$("audio,video").each(function(e,i){i.volume=Math.min(t*player.clipVolume,1)}),Audio.setMasterVolume&&Audio.setMasterVolume(t)})}},Window.prototype.closeLightbox=function(){player.stackedWindow||($(".blocker").hide(),$(".interstitial").hide(),$(".interstitial").removeClass("black"),player.showingInterstitial=!1,$("#slidecontainer").append($(".window.prompt"))),player.currentWindowSlide.variables.Visited=!0,player.currentWindowSlide.viewedCurrent=!0,player.currentWindowSlide.saveIfNecessary(),player.currentWindowSlide.hide(),player.currentWindowSlide.resetSlide(),player.currentWindowSlide.unloadContent(),player.currentWindow=null,player.currentWindowSlide=null,player.currentSlide().handleEvent("ontransitionin",null,null,!1,!0),player.currentTime=player.currentSlide().currentTime},Window.prototype.renderBackground=function(){var t={canvas:this.background.get(0),m_nXOffset:0,m_nYOffset:0,m_nWidth:this.width+100,m_nHeight:this.height};ppArt.DrawVector(t,"ZB1$v$vPCZy$f2L$_XA100jfZQA1$3N10OaXIA1ag70FCDY$v00LCYv0000PC_$3w2wPC_$9wn3PC_$9wn3PC_$9wn3PC_$9wn3e20PC_$9wn3PC_$PyDYg40PC_$PyDYPC_$VyYvLCYv_y00FCDY_y00e20FCDY_y009wn3_y00g409wn3_y003w2w_y00$v00VyYv$v00PyDYe20$v00PyDY$v009wn3g40$v009wn300003w2w3w2w$v009wn3$v003t3w00px000000E0505010100w00N10$$$$E0aEg70FC$v$v$vLCt1$v$vPC$v3wx_PC$v9w$vPC$v9w$vPC$v9w$vPC$v9w$ve20PC$v9w$vPC$vPy$vg40PC$vPy$vPC$vVyt1LCt1Zy$vFC$vZy$ve20FC$vZy$v9w$vZy$vg409w$vZy$v3wx_Zy$v$v$vVyt1$v$vPy$ve20$v$vPy$v$v$v9w$vg40$v$v9w$v$v$v3wx_3wx_$v$v9w$v$v$v3E",null,player.fontlib,null)},Window.prototype.appendSlide=function(t){t.loadContentFromXML(),this.slide&&this.slide.ref.remove(),this.slide=t,this.contentRef.empty(),this.contentRef.append(t.ref),this.titleRef.html(t.title)},Window.prototype.close=function(){this.slide&&this.slide.ref&&(player.pause(),this.slide.ref.remove()),this.slide=null,this.ref.hide(),(this==player.currentWindow||this==player.previousWindow)&&(this.closeLightbox(),player.currentWindow=player.stackedWindow,player.currentWindowSlide=player.stackedWindowSlide,player.stackedWindow=null,player.stackedWindowSlide=null,this.visible=!1,player.windowZoomModifier=1,player.zoomParams=null,player.pause(),player.play())},Window.prototype.showSlide=function(t,e){if(player.currentWindow&&player.currentWindow!=this&&(player.stackedWindow=player.currentWindow,player.stackedWindowSlide=player.currentWindowSlide,player.windowStack.push(player.currentWindow)),-1<this.linkid.indexOf("StoryPopup"))this.isLightbox=!0,this.prepareLightbox();else if("MessageWnd"==this.id){var i=$("<div class='blocker'></div>");$(".contentpane").append(i)}player.currentSlide().saveIfNecessary(),player.currentWindowSlide&&(player.currentWindowSlide.saveIfNecessary(),player.currentWindowSlide.resetSlide()),this.ref.show(),t.createRef(),this.appendSlide(t),t.ref.show(),t.visible=!0,t.variables.WindowId=this.id,t.variables.Visited=!0,t.viewedCurrent=!0,t.currentIndex=0,t.update(t.currentTime,!0),!e&&player.currentWindow&&player.currentWindowSlide&&player.currentWindow.history.push(player.currentWindowSlide.slideIndex),player.currentWindow=this,player.currentWindowSlide=t,this.visible=!0,this.isLightbox&&($(".interstitial").show(),player.showingInterstitial=!0),player.currentSlide().handleEvent("ontransitionin",null,null,!1,!0),player.currentSlide().handleEvent("ontransitionincomplete",null,null,!1,!0),player.currentSlide().handleEvent("onslidestart",null,null,!1,!0),player.currentSlide().deepEach(function(t,e){e.handleEvent&&e.handleEvent("onslidestart",null,null,!1,!0)}),player.pause(),player.currentTime=0,player.play()};var ResumePrompt=function(){this.xml="",this.constructElement(),this.selected=!1};ResumePrompt.prototype=new Window,ResumePrompt.prototype.objectType="ResumePrompt",ResumePrompt.prototype.innerType="ResumePrompt",ResumePrompt.prototype.createRef=function(){if(this.ref)return!1;var t=this,e=$("<div class='window dialog'><h1>Resume</h1><p>Would you like to resume where you left off?</p><div class='choose'><span class='button yes'>Yes</span><span class='button no'>No</span></div></div>");this.contentRef=e.children("p").first(),this.titleRef=e.children("h1").first(),this.suppressRef=$("<div></div>"),$(document.body).append(e),this.ref=e;var i=e.find(".yes"),r=e.find(".no");return e.find(".button").bind("mousedown touchstart",function(){$(this).addClass("pressed")}),e.find(".button").bind("mouseup touchend mouseout",function(){$(this).removeClass("pressed")}),i.bind("click",function(){t.slide.children.btn0.handleEvent("onrelease",null,null,!1,!1,!0),$(".interstitial").removeClass("resume"),$(".interstitial").hide(),player.showingInterstitial=!1}),r.bind("click",function(){t.slide.children.btn1.handleEvent("onrelease",null,null,!1,!1,!0),$(".interstitial").removeClass("resume"),$(".interstitial").hide(),player.showingInterstitial=!1}),this.ref.hide(),!0},ResumePrompt.prototype.appendSlide=function(t){this.slide&&this.slide.ref.remove(),this.slide=t,this.suppressRef.append(t.ref),this.titleRef.html($(t.title).text()),setTimeout(function(){t.ref.find(".item_ResumePromptSlide_Text").text(),$(".interstitial").removeClass("black"),$(".interstitial").addClass("resume"),$(".interstitial").show(),player.showingInterstitial=!0},1)};var Scene=function(){this.slides=[],this.slideDraws=[],this.constructElement()};Scene.prototype=new Element,Scene.prototype.objectType="Scene",Scene.prototype.innerType="Scene",Scene.prototype.restoreFromResumeData=function(t){var e=this.getDescendantsByType("Slide"),i=[];$.each(e,function(t,e){e.resume&&i.push(e)}),e=new bwChunk(t),this.restoreVariableResumeData(e.Data());for(var e=e.NextChunk(),r=0,n=0;!e.isNothing;){if(r>=i.length){var a=this.slideDraws[n];a&&a.restoreFromResumeData(e.Data()),n++}else a=i[r],a.compactResumeData=e.ChunkData(),a.restoreFromResumeData(e.Data(),!0);e=e.NextChunk(),r++}this.compactResumeData=bwChunk.CreateChunk(t)},Scene.prototype.getResumeData=function(){var t;t=""+this.getVariableResumeData();var e="";$.each(this.children,function(t,i){i.compactResumeData?e+=i.compactResumeData:i.resume&&(e+=bwChunk.EMPTY_CHUNK)});var i="";return $.each(this.children,function(t,e){"SlideDraw"==e.innerType&&(e.compactResumeData||(e.compactResumeData=e.getResumeData()),i+=e.compactResumeData||"0")}),e+=i,bwChunk.CreateChunk(t+e)},Scene.prototype.getFirstSlide=function(){for(var t=0;t<story.allSlides.length;t++)if(story.allSlides[t].parent.id==this.id)return story.allSlides[t];return this},Scene.prototype.populateDraws=function(){$.each(this.slideDraws,function(t,e){0==e.draw.length&&(e.createDraw(),e.populateDraw())})};var Timer=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.content={fontsize:18,font:"Arial"},this.constructElement(),this.events=[],this.active=!0,this.visible=!1,this.startPosition=0,this.startTime=null,this.currentPosition=0,this.visible=this.running=!1};Timer.prototype=new Element,Timer.prototype.innerType="Timer",Timer.prototype.objectType="Timer",Timer.prototype.toBaseData=Element.prototype.toData,Timer.prototype.toData=function(t){return t=this.toBaseData(t),0!=this.currentPosition&&(t.currentPosition=this.currentPosition),this.running&&(t.running=!0),this.visible&&(t.visible=!0),t},Timer.prototype.updateBaseFromData=Element.prototype.updateFromData,Timer.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.currentPosition&&(this.currentPosition=t.currentPosition),t.visible&&this.show(),t.running&&this.start(),t.variables&&t.variables.DropTargetId&&(this.dropArea=this.parent.children[t.variables.DropTargetId])},Timer.prototype.loadFromXML=function(t){this.loadElementInfoFromXML(t),this.id=$(t).attr("id"),this.duration=parseInt($(t).attr("duration"))},Timer.prototype.show=function(){this.visible=!0,this.createRef(),this.render(),this.ref.show()},Timer.prototype.hide=function(){this.visible=!1,this.ref.hide()},Timer.prototype.start=function(){var t=this;this.startPosition=this.currentPosition,this.startTime=new Date,this.render(),this.interval||(this.interval=setInterval(function(){t.tick()},100))},Timer.prototype.pause=function(){this.interval&&(clearInterval(this.interval),this.interval=null)},Timer.prototype.tick=function(){this.currentPosition=this.startPosition+(new Date-this.startTime),this.currentPosition>this.duration&&(this.currentPosition=this.duration,this.handleEvent("timercomplete"),this.pause()),this.render()},Timer.prototype.createRef=function(){return this.ref?!1:(this.ref=$("<canvas class='timer' width='20' height='20'></canvas>"),player.isIOSFrame?$(document.body).append(this.ref):$(".framewrap").append(this.ref),this.context=this.ref.get(0).getContext("2d"),!0)},Timer.prototype.render=function(){if(this.context){this.context.strokeStyle="#cfcfcf",player.isIOSFrame||(this.context.strokeStyle=player.frame.colorGroups.timer.stroke.toColorString()),this.context.beginPath(),this.context.arc(10,10,9,0,2*Math.PI,!1),this.context.stroke();var t=this.context.createLinearGradient(0,0,0,20);t.addColorStop(0,"#039EF4"),t.addColorStop(1,"#0147E6");var e=this.context.createLinearGradient(0,0,0,20);e.addColorStop(0,"#FDE145"),e.addColorStop(1,"#E4B202"),player.isIOSFrame||(t=player.frame.colorGroups.timer.duration.toCanvasGradient(this.context,20),e=player.frame.colorGroups.timer.elapsed.toCanvasGradient(this.context,20)),this.context.beginPath(),this.context.fillStyle=t,this.context.arc(10,10,9,0,2*Math.PI,!1),this.context.fill();var t=-Math.PI/2,i=t-2*this.currentPosition/this.duration*Math.PI;this.context.beginPath(),this.context.fillStyle=e,this.context.moveTo(10,10),this.context.arc(10,10,9,t,i,!0),this.context.closePath(),this.context.fill()}};var Slide=function(t){this.container=t||$(document.body),this.ref=null,this.title="Untitled Slide",this.transition=null,this.layers={},this.timelineEvents=[],this.clips=[],this.resources=[],this.interactions={},this.responses={},this.navLinks=[],this.layerStack=[],this.loadedChunkXML=this.backgroundReady=this.ready=!1,this.currentIndex=this.zeroTime=this.currentTime=this.slideIndex=0,this.duration=5e3,this.active=!0,this.paused=this.playing=!1,this.width=720,this.height=540,this.scale=1,this.topZ=5,this.constructElement(),this.fullyLoaded=!1};Slide.prototype=new Element,Slide.prototype.objectType="Slide",Slide.prototype.innerType="Slide",Slide.getResumeReference=function(t){var e;return null==t?e=9:(e=""+(t.slideBank?"1":"0"),t.slideBank?(e+=bwChunk.CreateChunk(bwChunk.UBase10toN(t.drawSlideIndex)),e+=bwChunk.CreateChunk(bwChunk.UBase10toN(t.sceneIndex)),e+=bwChunk.CreateChunk(bwChunk.UBase10toN(t.drawIndex))):(e+=bwChunk.CreateChunk(bwChunk.UBase10toN(t.sceneSlideIndex)),e+=bwChunk.CreateChunk(bwChunk.UBase10toN(t.sceneIndex)))),e},Slide.getFromResumeChunk=function(t){if("1"==t.NextString(1))var e=t.NextChunkedUBase10(),i=t.NextChunkedUBase10(),t=t.NextChunkedUBase10(),i=story.getDescendantsByType("Scene")[i],e=i.getDescendantsByType("SlideDraw")[t].orderedChildren[e];else e=t.NextChunkedUBase10(),i=t.NextChunkedUBase10(),i=story.getDescendantsByType("Scene")[i],e=i.slides[e];return e},Slide.prototype.restoreFromResumeData=function(t,e){!this.fullyLoaded&&!e&&(this.loadContentFromXML(),e=!0),this.hasRestoredInteractions=!0;var i=[];this.deepEach(function(t,e){e.resume&&"ShuffleGroup"!=e.innerType&&i.push(e)},function(t){return"Layer"==t.innerType?!1:!0});var r=new bwChunk(t),r=new bwChunk(r.Data()),n=new bwChunk(r.Data());if($.each(this.interactions,function(t,e){e.restoreFromResumeChunk(n),n=n.NextChunk()}),!e){r=r.NextChunk(),this.currentTime=bwChunk.BaseNto10(r.Data(),r.Length()),this.fixCurrentIndex();for(var r=r.NextChunk(),a=new bwChunk(r.Data()),s=0;!a.isNothing;){var o=i[s];o?o.restoreFromResumeData(a.ChunkData()):console.error("u:ERROR restoring slide: unknown item",s),a=a.NextChunk(),s++}var l=[];for($.each(this.children,function(t,e){"Layer"==e.innerType&&l.push(e)}),s=r.NextChunk(),o=new bwChunk(s.Data()),a=0;!o.isNothing;)r=l[a],r.restoreFromResumeData(o.Data()),o=o.NextChunk(),a++,r.reset(),r.hide();for(s=s.NextChunk(),o=new bwChunk(s.Data());!o.isNothing;)a=o.NextUBase10(),r=l[a],a=r.currentTime,r.slide==player.currentSlide()?r.show():(r.visible=!0,r.setOnStage(!0)),r.currentTime=a,o=o.NextChunk();var r=s.NextChunk(),h=r.Data();this.clips.forEach(function(t){if("audio"==t.innerType){var e=new bwChunk(h);t.SetResumeData(e.Data()),h=e.Remainder()}}),this.restoreVariableResumeData(r.NextChunk().Data())}},Slide.prototype.getResumeData=function(){var t="";if(this.resume&&this.variables.Visited){var e="",i="",r="",n="",a="";this.deepEach(function(t,i){i.resume&&"ShuffleGroup"!=i.innerType&&(e+=bwChunk.CreateChunk(i.GetResumeData()))},function(t){return"Layer"==t.innerType?!1:!0}),this.clips.forEach(function(t){"audio"==t.innerType&&(n+=bwChunk.CreateChunk(t.GetResumeData()))}),a="",$.each(this.interactions,function(t,e){a+=bwChunk.CreateChunk(e.GetResumeData())});var t=bwChunk.CreateChunk(a),s=bwChunk.Base10toN(this.currentTime),t=t+bwChunk.CreateChunk(s),t=t+bwChunk.CreateChunk(e),o=[];$.each(this.children,function(t,e){"Layer"==e.innerType&&(e.visible&&o.push(e),e.resume&&(i+=bwChunk.CreateChunk(e.getResumeData())))}),t+=bwChunk.CreateChunk(i),$.each(o,function(t,e){var i=e.getItemIndex();r+=bwChunk.CreateChunk(bwChunk.Base10toN(i))}),t+=bwChunk.CreateChunk(r),t+=bwChunk.CreateChunk(n),s=this.getVariableResumeData(),0<util.count(this.variables)&&(t+=s),t=bwChunk.CreateChunk(t)}return t},Slide.prototype.rebuildInteractionData=function(){if(this.compactResumeData){var t=new bwChunk(this.compactResumeData),t=new bwChunk(t.Data()),e="",i="";$.each(this.interactions,function(t,e){i+=bwChunk.CreateChunk(e.GetResumeData())}),e+=bwChunk.CreateChunk(i),e+=t.Remainder(),this.compactResumeData=bwChunk.CreateChunk(e)}},Slide.prototype.toBaseData=Element.prototype.toData,Slide.prototype.toData=function(t){if(t&&this.resumeData)return this.variables.Visited&&(this.resumeData.variables||(this.resumeData.variables={}),this.resumeData.variables.Visited=!0),this.resumeData;var e=this.toBaseData(t);return $.each(this.interactions,function(t,i){var r=i.toData();jQuery.isEmptyObject(r)||(e.interactions||(e.interactions={}),e.interactions[t]=r)}),e},Slide.prototype.updateBaseFromData=Element.prototype.updateFromData,Slide.prototype.updateFromData=function(t){this.updateBaseFromData(t),this.variables.Visited&&player.slideList.markVisited(this),this.resumeData||(this.resumeData=t)},Slide.prototype.loadFromXML=function(t){var e=this;this.width=parseInt($(t).attr("width")),this.height=parseInt($(t).attr("height")),this.aspectRatio=this.width/this.height,this.id=$(t).attr("id"),this.title=$(t).attr("title"),this.html5url=$(t).attr("html5url"),this.dataurl=$(t).attr("dataurl"),this.trackviews="true"==$(t).attr("trackviews"),this.resume="true"==$(t).attr("resume"),this.enableseek="true"==$(t).attr("enableseek"),this.enablereplay="true"==$(t).attr("enablereplay"),this.xml=t,this.loadedChunkXML=null==this.html5url,this.loadElementInfoFromXML(t),this.loadedChunkXML&&(this.loadAudioFromXML(),this.loadBackgroundFromXML(),this.loadElementInfoFromXML(t)),e.interactionCount=0,$(t).children("interactions").children("interaction").each(function(t,i){var r=new Interaction;r.loadFromXML(i,e),e.interactions[r.id]=r,e.children[r.id]=r,e.interactionCount++}),this.transition=new Transition(this),this.transition.loadFromXML(t),this.detectSimpleNavigation(),player.preload&&this.loadContentFromXML(),e.variables.WindowId="_frame",e.variableDefaults.WindowId="_frame"},Slide.prototype.loadAudioFromXML=function(){var t=this;$(this.xml).children("audiolib").children("audio").each(function(e,i){var r=new Audio;r.loadFromXML(i,t,t.slide,t.layer),r.createRef(),t.children[r.id]=r})},Slide.prototype.loadBackgroundFromXML=function(){var t=this;$(t.xml).children("background").each(function(e,i){t.background=new Background(t.ref),t.background.loadFromXML(i),t.background.src?(t.content={src:t.background.src},t.resource=new Resource(t,t.background.src,function(){t.backgroundReady=!0}),t.pushResource(t.resource)):t.backgroundReady=!0,t.ref&&t.background.apply(t.ref)})},Slide.prototype.blockAndLoad=function(t){var e=this;this.loadCallbackStack?this.loadCallbackStack.push(t):this.loadCallbackStack=[t];var i=function(){for(player.shouldShowLoadingSpinner=!1;e.loadCallbackStack.length;)e.loadCallbackStack.pop()();player.actionQueuePaused=!1};if(player.actionQueuePaused=!0,e.ready&&e.backgroundReady&&e.loadedChunkXML)i();else{var r=0;clearTimeout(e.readyWaitTimeout),e.readyWaitTimeout=null;var n=function(){e.ready&&e.backgroundReady&&e.loadedChunkXML||50<r++?i():e.readyWaitTimeout=setTimeout(n,100)};player.slideLoadQueue&&0!=e.slideIndex&&player.slideLoadQueue.promote(e.slideIndex),player.shouldShowLoadingSpinner=!0,player.loadingSpinnerTimeout=setTimeout(function(){player.shouldShowLoadingSpinner&&(player.loadingSpinner.show(),player.frame.setControlEnabled("previous",!1),player.frame.setControlEnabled("next",!1),player.frame.setControlEnabled("submit",!1))},1e3),n()}},Slide.prototype.loadContentFromXML=function(){var t=this;if(this.loadedChunkXML){if(!this.fullyLoaded){this.fullyLoaded=!0;var e=t.xml;this.loadChildrenFromXML(e,t,null,null),t.timelineEvents=[],$(e).children("timeline").each(function(e,i){t.duration=$(i).attr("duration"),$(i).find("event").each(function(e,i){var r=new TimelineEvent(t);r.loadFromXML(i),t.timelineEvents.push(r)})}),$(e).children("slidelayers").children("slidelayer").each(function(e,i){var r=new Layer(t.ref,t);r.loadFromXML(i),t.layers[r.id]=r,t.children[$(i).attr("id")]=r}),this.resetSlide()}}else this.loadingChunkXML||(this.loadingChunkXML=!0,this.loadChunkXML(!0))},Slide.prototype.integrateChunkXML=function(t,e){var i=this;$(t).children("slide").children().each(function(t,e){$(i.xml).append($(e))}),this.loadedChunkXML=!0,e&&(this.loadAudioFromXML(),this.loadElementInfoFromXML(i.xml),this.loadContentFromXML(),this.loadBackgroundFromXML(),this.detectSimpleNavigation(),player.loadResourcesForSlide(i))},Slide.prototype.loadChunkXML=function(t){var e=this;if(window.SlideXMLData=function(i,r){if("string"==typeof r){r=r.replace(/[\u000a\u000b\u000c\u000d\u0085\u2028\u2029]/g,""),r=r.replace(/&#x[0-8bcef];/gi,""),-1<location.search.indexOf("dumpxml=1")&&console.log(r);var n;window.ActiveXObject?(n=new ActiveXObject("Microsoft.XMLDOM"),n.loadXML(r)):n=(new DOMParser).parseFromString(r,"text/xml"),r=n}e.id!=i?story.getSlideByID(i).integrateChunkXML(r,t):e.integrateChunkXML(r,t)},player.loadFromScript){var i=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",r.src=player.basepath+e.html5url,i.appendChild(r)}else $.ajax({url:player.basepath+e.dataurl.replace(".swf",".xml")+"?rand="+Math.random(),dataType:"xml",success:function(i){e.integrateChunkXML(i,t)},error:function(){return!1}})},Slide.prototype.detectSimpleNavigation=function(){var t=this;this.hasSimpleNavigation=!0,$(this.xml).find('actiongroup[id="ActGrpOnNextButtonClick"]').each(function(e,i){var r=$(i).children("actions").children(),n=$(i).children("actions").children("gotoplay");(1!=r.length||1!=n.length)&&(t.hasSimpleNavigation=!1)})},Slide.prototype.canUnloadContent=function(){return $(this.xml).find("hittestpoint"),0==$(this.xml).find("hittestpoint").length},Slide.prototype.unloadContent=function(){if(this.fullyLoaded&&this.canUnloadContent()&&!player.preload){this.fullyLoaded=!1;var t=this,e=0,i=0;$.each(this.layers,function(t,e){e.emptyLayer()});var r=[];this.deepEach(function(t,e){r.push(e)},function(t){return"audio"!=t.innerType&&"Interaction"!=t.innerType}),$.each(r,function(t,i){i.emptyElement(),e++});var n={};$.each(this.children,function(t,e){"audio"!=e.innerType&&"Interaction"!=e.innerType&&(n[t]=e)}),$.each(n,function(e){delete t.children[e],i++}),$(this.ref).find(".webobject").each(function(t,e){e.src="",$(e).remove()}),t.timelineEvents=[]}},Slide.prototype.pushResource=function(t){for(var e=0;e<this.resources.length;e++)if(this.resources[e].src==t.src)return;this.resources.push(t)},Slide.prototype.createRef=function(t){return this.ref?!1:(this.container=t||$("#slidecontainer"),this.ref=$('<div class="slide transitionable"></div>'),this.ref.css("display","none"),this.background&&this.background.apply(this.ref),this.ref.get(0).id="slide_"+this.id,this.ref.get(0).item=this,(this.width>player.frame.availableWidth||this.height>player.frame.availableHeight)&&(this.scale=Math.min(player.frame.availableWidth/this.width,player.frame.availableHeight/this.height),this.y=this.x=0,this.applySize(this.ref)),$.each(this.children,function(t,e){e.createRef&&e.createRef()}),this.container.append(this.ref),this.ref.css("width",this.width+"px"),this.ref.css("height",this.height+"px"),player.reorient(!0),!0)},Slide.prototype.reduce=function(){$.each(this.children,function(t,e){e.reduce&&e.reduce()}),this.canvas&&(this.canvas.width=1,this.canvas.height=1)},Slide.prototype.destroyRef=function(){$.each(this.children,function(t,e){e.destroyRef&&e.destroyRef()}),this.ref&&(this.ref.get(0).item=null,this.ref.get(0).id=null,this.ref.remove(),this.ref=null)},Slide.prototype.findClip=function(t){var e=$.grep(this.clips,function(e){return e.id==t});return 0<e.length?e[0]:null},Slide.prototype.topMostLayer=function(){return 0<this.layerStack.length?this.layerStack[this.layerStack.length-1]:this},Slide.prototype.saveIfNecessary=function(){$.each(this.interactions,function(t,e){e.variables.Status&&"incomplete"!=e.variables.Status&&"unanswered"!=e.variables.Status||(e.evaluate(!0,!0,!0),e.variables.Status||(e.variables.Status="unanswered"))}),this.resume&&(this.currentTime=player.currentTime,player.useCompactResume?this.compactResumeData=this.getResumeData():this.resumeData=this.toData()),this.parent.compactResumeData=this.parent.getResumeData()},Slide.prototype.resetSlide=function(t,e,i){this.timelineComplete=this.transitionedIn=!1,this.resume&&!t?player.useCompactResume&&this.compactResumeData?this.restoreFromResumeData(this.compactResumeData):this.resumeData&&this.updateFromData(this.resumeData):(this.deepEach(function(t,e){e.quickHide&&e.quickHide(),e.reset()},function(t){return t.parent&&"Layer"==t.parent.innerType&&t.parent.resume?!1:"Interaction"==t.innerType?1==e:!0}),this.compactResumeData="",this.currentIndex=this.currentTime=0,player.currentSlide()==this&&(player.currentTime=0),this.clips.forEach(function(t){t.m_bResumeOnSeek=!1}),this.reset(),this.update(this.currentTime,!i,!0))},Slide.prototype.resetBase=Element.prototype.reset,Slide.prototype.reset=function(t){this.resetBase(t,function(t){return"Interaction"==t.innerType?!1:!0})},Slide.prototype.resetInteractions=function(){this.resume||$.each(this.interactions,function(t,e){e.reset()})},Slide.prototype.show=function(t,e,i){this.createRef(this.container),player.modalLayer=null,this.visible=!0,$.each(this.layers,function(t,e){e.visible||e.hide()}),player.container.children(".slide").removeClass("out"),player.container.children(".slide.in").addClass("out"),player.container.children(".slide").removeClass("in"),this.ref.addClass("in"),$(".slide:not(.in,.out,.framed)").css("display","none"),this.ref.css("display","block");var e=this.transition,r=this,n=this.ref,a=$(".slide.out");if(e.wipe&&(r=0<a.length?a.get(0).item:null,n=$(".slide.out"),a=this.ref,$(".slide.out").addClass("over"),Transition.applyCss({"-webkit-transform":"translate3d(0px,0px,0px) scale(1) rotate(0deg)",opacity:1,"-webkit-transition-duration":"0s"},this.ref)),a=function(){$(".slide.out").css("display","none"),$(".slide.over").removeClass("over"),t&&(player.play(!0),i&&i())},e&&0<e.duration&&0<n.length){this.currentIndex=0,this.update(this.currentTime,!0,!0);var s=e.convertToAnimation(r);s.item=r,this.rotatexpos=this.width/2,this.rotateypos=this.height/2,s.start(n,e.reverse,player,a),s.seek(s.target,s.reverse,0,!0)}else a();"SlideDraw"==this.parent.innerType&&(player.currentDraw=this.parent,this.parent.sniffDrawIndex(this)),this.currentIndex=0,this.transitionedIn=!1,player.zoomParams=null,this.transcript&&this.transcript.show()},Slide.prototype.hide=function(){this.visible=!1,this.ref&&this.destroyRef()},Slide.prototype.fixCurrentIndex=function(){for(this.currentIndex=0;this.currentIndex<this.timelineEvents.length&&this.timelineEvents[this.currentIndex].time<=this.currentTime;)this.currentIndex++},Slide.prototype.tick=function(){if(!(this.paused||this.animating&&!this.animationEnded)&&(this.currentTime+=player.currentTickDuration,this.ended=!1,this.currentTime>=this.duration)){var t=this.handleEvent("ontimelinecomplete");!player.layerPlaying&&t&&this.handleEvent("onallopentimelinescomplete"),this.currentTime=parseInt(this.duration),this.pause(!0,!1),this.endedAnimationTime=player.animationTime,this.ended=!0}},Slide.prototype.update=function(t,e,i){for(this.currentTime=t;1<this.currentIndex&&this.currentIndex<=this.timelineEvents.length&&parseInt(this.timelineEvents[this.currentIndex-1].time)>=parseInt(this.currentTime);)this.currentIndex--,this.timelineEvents[this.currentIndex].revert(t);for(;this.currentIndex<this.timelineEvents.length&&this.timelineEvents[this.currentIndex].time<=this.currentTime&&(!player.paused||i);)t=this.timelineEvents[this.currentIndex],t.act(e,this.currentTime>t.time+1e3),this.currentIndex++;e||this.handleTransitionIn(e),this.updateLayers(),this.currentTime>=this.duration&&!this.timelineComplete&&(e=this.handleEvent("ontimelinecomplete"),!player.layerPlaying&&e&&this.handleEvent("onallopentimelinescomplete"),this.timelineComplete=!0),this.currentTime<this.duration&&(this.timelineComplete=!1)},Slide.prototype.tickLayers=function(){$.each(this.layers,function(t,e){e.visible&&!e.paused&&(e.currentTime+=player.TICK_DURATION)})},Slide.prototype.updateLayers=function(){$.each(this.layers,function(t,e){e.visible&&e.update()})},Slide.prototype.handleTransitionIn=function(){this.transitionedIn||(this.transitionedIn=!0,this.handleEvent("ontransitionin",null,null,!1,!0),this.handleEvent("ontransitionincomplete",null,null,!1,!0),this.handleEvent("onslidestart",null,null,!1,!0),this.deepEach(function(t,e){e.handleEvent&&e.handleEvent("onslidestart",null,null,!1,!0)},function(t){return"Layer"!=t.innerType}))},Slide.prototype.addchoiceresponse=function(t){var e=this.children[$(t).attr("interactionid")],t=$(t).attr("value"),i=this.extractVariable(t)||"true",r=e.parseObjref(t).target;"Choice"!=r.innerType&&$.each(e.choices,function(t,e){e.lmstext.toLowerCase()==i.toLowerCase()&&(r=e)}),e.m_bAnswered=!0,"Choice"==r.innerType?(e.responses[t]=r,e.lmsResponses.push(new ResponseData(!1,r.id,"",r.lmstext,"")),r.selected=!0):(e.variables.Value=i,t=e.parseObjref(i).target,"Choice"==t.innerType?(t.selected=!0,e.lmsResponses.push(new ResponseData(!1,t.id,"",t.lmstext,""))):e.lmsResponses.push(new ResponseData(!1,i,"",i,"")))},Slide.prototype.addpairresponse=function(t){var e=this.children[$(t).attr("interactionid")],i=this.extractVariable($(t).attr("valuea"),$(t).attr("typea")),r=this.extractVariable($(t).attr("valueb"),$(t).attr("typeb"));if(i&&r)switch(t=e.parseObjref(i).target,r=e.parseObjref(r).target,t.addPair(r),r.addPair(t),e.interactionType){case"matching":case"sequence":case"likert":e.lmsResponses.push(new ResponseData(!0,r.id,t.id,r.lmstext,t.lmstext))}else e.parseObjref($(t).attr("valueb"));e.m_bAnswered=!0},Slide.prototype.show_slidelayer=function(t){var e=this.parseObjrefFromXML(t).target,i=new Transition(e);i.loadFromXML(t),e.show(i),e.update(0)},Slide.prototype.set_frame_layout=function(t){player.currentSlide()==this||player.currentFramedSlide==this||player.currentWindowSlide==this?player.frame.set_frame_layout(t):this.deferredFrameLayoutXML=t},Slide.prototype.set_window_control_layout=function(t){player.frame.set_window_control_layout(t)},Slide.prototype.isPointActive=function(){return!1},Slide.prototype.isPointObscured=function(){return!1},Slide.prototype.simplify=function(t){var e=this.childItems(),i=$('<canvas class="simplebackground"></canvas>');i.attr("width",player.width),i.attr("height",player.height);var r=i.get(0).getContext("2d");this.ref.prepend($(i));var n=0,a=0,s=!1,o=!0;$.each(e,function(t,e){player.renderVectorShapes&&player.renderVectorsAsSVG&&e.content.path&&(e.canSimplify=!1),player.renderVectorShapes&&(e.hasImagelib||e.hasTextlib)&&(e.canSimplify=!1),e.canSimplify&&o&&!e.group?a++:(o=!1,e.canSimplify=!1)});var l=function(e,i,r,o){s=!0;var l=function(){n++,n==a&&(p(),$(c).unbind("load"),c.src=Element.PixelSrc,t&&t())},c=new Image;$(c).bind("load",function(){l()}),$(c).bind("error",function(){l()}),player.renderVectorShapes&&!player.renderVectorsAsSVG&&o&&o.content.path&&!o.hasImagelib&&!o.hasTextlib?n++:c.src=e,h.push({img:c,x:i,y:r,item:o})},h=[],p=function(){$.each(h,function(t,e){if(player.renderVectorShapes&&!player.renderVectorsAsSVG&&e.item&&e.item.content.path&&!e.item.hasImagelib&&!e.item.hasTextlib){var n={canvas:i.get(0),m_nXOffset:e.x,m_nYOffset:e.y,m_nWidth:e.item.width,m_nHeight:e.item.height};ppArt.DrawVector(n,e.item.content.path),e.item.ref.addClass("vector")}else r.drawImage(e.img,e.x,e.y)})};this.background&&this.background.src&&(a++,l(this.background.src,0,0),this.ref.css("background","transparent")),$.each(e,function(t,e){e.canSimplify&&(l(e.content.src,e.x,e.y,e),e.ref.addClass("simplified"),e.simplified=!0,e.ref.attr("src",Element.PixelSrc),e.ref.css("background","transparent"),e.hasEvents||e.ref.remove(),s=!0)}),t&&!s&&t()},Slide.prototype.isSubmitted=function(){var t=!0;return $.each(this.interactions,function(e,i){t=t&&i.variables.Status&&"incomplete"!=i.variables.Status&&void 0!=i.variables.Points}),t},Slide.prototype.isAnswered=function(){var t=!0;return $.each(this.interactions,function(e,i){t=t&&i.m_bAnswered}),t},Element.prototype.forceRepaint=function(t){t&&!player.isIOS||!this.ref||"block"!=this.ref.css("display")||(t=this.ref.get(0),this.ref.hide(),player.uselessOffsetHeight=t.offsetHeight,this.ref.show())};var StageItem=function(t){this.container=t,this.ref=null,this.constructElement(),this.dirty=!0,this.actionMoved=this.actionControlled=!1,this.content={}};StageItem.prototype=new Element,StageItem.prototype.objectType="Item",StageItem.prototype.innerType="Item";var Item=StageItem;StageItem.prototype.isStageItem=!0,StageItem.prototype.getItemIndex=function(){var t=this,e=0,i=-1;return this.itemIndex?this.itemIndex:((this.layer||this.slide).deepEach(function(r,n){n.isStageItem&&"ShuffleGroup"!=n.innerType&&(n==t&&(i=e),e++)},function(t){return"Layer"==t.innerType?!1:!0}),this.itemIndex=i)},StageItem.prototype.getItemByResumeIndex=function(t){var e=0,i=null;return(this.layer||this.slide).deepEach(function(r,n){n.isStageItem&&"ShuffleGroup"!=n.innerType&&(e==t&&(i=n),e++)},function(t){return"Layer"==t.innerType?!1:!0}),i},StageItem.FlagA={FLAGA_STATE:1,FLAGA_VARIABLE:2,FLAGA_ONSTAGE:4,FLAGA_DRAGDROP:8,FLAGA_POSITION:16,FLAGA_USEFLAGB:32},StageItem.FlagB={FLAGB_DEPTH:1,FLAGB_SHUFFLED:2,FLAGB_ACTIONMOVED:4,FLAGB_ACTIONCONTROLLED:8,FLAGB_DISABLED:16,FLAGB_REVIEW:32},StageItem.prototype.restoreFromResumeData=function(t){var e=StageItem.FlagA,i=StageItem.FlagB,t=new bwChunk(t),r=t.NextUBase10(1),n=0;if(r&e.FLAGA_USEFLAGB&&(n=t.NextUBase10(1)),r&e.FLAGA_STATE){var a=t.NextUBase10(2),s="";$.each(this.states,function(t,e){e.index==a&&(s=t)}),this.variables.ObjectState=s}r&e.FLAGA_ONSTAGE?this.quickShow?this.quickShow():(this.show(),this.visible=!0):"ShuffleGroup"!=this.innerType&&(this.quickHide?this.quickHide():this.hide()),r&e.FLAGA_DRAGDROP&&(t.NextUBase10(2),t.NextUBase10(1));var o=!1;if(r&e.FLAGA_POSITION){
var l=t.NextBase10(2),h=t.NextBase10(2),p=t.NextUBase10(2);switch(this.x=l+this.xoffset,this.y=h+this.yoffset,o=!0,p){case 4094:break;case 4095:this.originalParent=this.parent,this.parent=this.slide;break;default:this.originalParent=this.parent,this.parent=this.getItemByResumeIndex(p)}this.updateMatrixComplete(!0)}n&i.FLAGB_DEPTH&&this.setZIndex(t.NextUBase10(2)),n&i.FLAGB_SHUFFLED&&(this.shuffled=!0,this.shuffleGroup&&(this.shuffleGroup.shuffled=!0),l=t.NextUBase10(2),h=t.NextUBase10(2),o||(this.x=l,this.y=h),this.shuffleX=l,this.shuffleY=h,this.updateMatrixComplete(!0)),r&e.FLAGA_VARIABLE&&this.restoreVariableResumeData(t.NextString())},StageItem.prototype.GetResumeData=function(t){var e=StageItem.FlagA,i=StageItem.FlagB,r="",n="";if(this.resume||t){var a=this.shouldStoreVariableResume(),t=this.originalZ&&this.depth!=this.originalZ,s="true"==this.variables._disabled,o=this.actionControlled||this.actionMoved||t||this.shuffled||s,l=0,h=0;if(this.variables.ObjectState!=bwUtils.DEFAULT_STATE){var p=this.states[this.variables.ObjectState],c=p?p.index:0;!p&&this.actionstates&&this.actionstateindices&&(p=this.actionstates[this.variables.ObjectState],c=this.actionstateindices[this.variables.ObjectState]||0),c>=0&&(l+=e.FLAGA_STATE,n+=bwChunk.UBase10toN(p.index,2))}a&&(l+=e.FLAGA_VARIABLE),this.visible&&(l+=e.FLAGA_ONSTAGE),this.dropArea&&(p=this.dropArea.getItemIndex(),c=this.dropArea.getDragItemIndex(this),c>-1&&(l+=e.FLAGA_DRAGDROP,n+=bwChunk.UBase10toN(p,2),n+=bwChunk.UBase10toN(c,1))),p=this.x,c=this.y,isNaN(this.xoffset)||(p=this.x-this.xoffset,c=this.y-this.yoffset),(!this.shuffled||p==this.shuffleX&&c==this.shuffleX)&&(this.shuffled||isNaN(this.originalX)||p==this.originalX&&c==this.originalY)||(isNaN(this.xoffset)||(p=this.x-this.xoffset,c=this.y-this.yoffset),l+=e.FLAGA_POSITION,n+=bwChunk.Base10toN(p,2),n+=bwChunk.Base10toN(c,2),p=4094,this.originalParent&&this.parent!=this.originalParent&&(p="wordbank"==this.style?4094:"Slide"==this.parent.innerType?4095:this.parent.getItemIndex()),n+=bwChunk.UBase10toN(p,2)),o&&(l+=e.FLAGA_USEFLAGB,t&&(h+=i.FLAGB_DEPTH,n+=bwChunk.Base10toN(this.depth,2)),this.shuffled&&(h+=i.FLAGB_SHUFFLED,n+=bwChunk.Base10toN(this.shuffleX,2),n+=bwChunk.Base10toN(this.shuffleY,2)),this.actionMoved&&(h+=i.FLAGB_ACTIONMOVED),this.actionControlled&&(h+=i.FLAGB_ACTIONCONTROLLED),s&&(h+=i.FLAGB_DISABLED))}return r+=bwChunk.UBase10toN(l),o&&(r+=bwChunk.UBase10toN(h)),a&&(e=new bwChunk(this.getVariableResumeData()).Data(),n+=e),r+n},StageItem.prototype.getExtraResumeVars=function(){return{}},StageItem.prototype.loadFromXML=function(t,e,i){this.slide=e,this.layer=i,this.children={},this.links={},this.jcanvas=null,this.innerType=this.type=t.tagName,this.id="undefined"==typeof $(t).attr("id")?$(t).attr("name"):$(t).attr("id"),this.xml=t,this.loadElementInfoFromXML(t),$(t).find("html5data"),this.scrolling="true"==$(t).attr("scrolling"),this.shufflelock="true"==$(t).attr("shufflelock"),this.hasEvents=0!=$(t).find("events").length,this.content.src=Element.PixelSrc,this.loadContentFromXML(t),this.loadSizeFromXML(t),this.bitMask=new BitMask(!0,this.width,this.height),this.bitMask.itemID=this.id,0<$(this.xml).children("dragdrop").length&&("true"==$(this.xml).children("dragdrop").first().attr("dragenabled")&&this.convertToDragItem(this.xml),"true"==$(this.xml).children("dragdrop").first().attr("dropenabled")&&this.convertToDropArea(this.xml),"true"==$(this.xml).children("dragdrop").first().attr("dragoverenabled"))&&(this.announceDragOver=!0,this.setupDragOver(this.xml))},StageItem.prototype.setupDragOver=function(){this.announceDragOver=!0,this.parseDragGroupsFromXML=DragItem.prototype.parseDragGroupsFromXML,this.parseDragGroupsFromXML(this.xml)},StageItem.prototype.loadContentFromXML=function(t){var e=$(t).find("html5data");switch(this.scrolling="true"==$(t).attr("scrolling"),this.hasEvents=0!=$(t).find("events").length,this.type){case"audio":this.canSimplify=!1,this.content.src=player.basepath+""+$(t).attr("url"),this.content.duration=parseInt($(t).attr("duration")),slide&&slide.clips&&slide.clips.push&&slide.clips.push(this),layer&&layer.clips&&layer.clips.push&&(layer.clips.push(this),this.layered=!0);break;case"vectorshape":case"scrollarea":case"state":case"dragitem":case"droplist":case"droparea":case"button":case"expandinglabel":case"link":this.content.src=Element.PixelSrc,0<$(t).children("textlib").length?(this.textlib=$(t).children("textlib"),story.textlibs||(story.textlibs={}),(e=this.textlib.children("textdata").attr("linkid"))&&0==this.textlib.find("path").length&&0==this.textlib.find("pr").length&&story.textlibs[e]&&(this.textlib=story.textlibs[e]),!e||1!=this.textlib.find("path").length&&1!=this.textlib.find("pr").length||story.textlibs[e]||(story.textlibs[e]=this.textlib)):0<$(t).children("data").length&&(this.textlib=$(t).children("data")),0<$(t).children("imagelib").length&&this.loadImageDataFromXML(t);var e=$(t).children("data").children("vectordata").children("path"),i=$(t).children("data").children("vectordata").children("pr");(1==e.length||1==i.length)&&(t=$(t).children("data").children("vectordata"),null!=$(t).attr("top")&&(this.originalRectShape=this.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom")))),this.content.path=1==i.length?PathLib.getPathFromXML(i):e.text(),t.attr("alttext")),this.type="image";break;case"item":this.content.src=Element.PixelSrc,this.textlib=$(t),this.forceDivPattern=!0,this.type="image";break;case"textfield":this.content.src=Element.PixelSrc,0<e.length&&(this.content.src=player.basepath+"mobile/"+e.attr("url"),this.content.mask=e.attr("mask"),this.content.maskref=e.attr("maskref")),this.textlib=$(t).children("data");break;case"image":this.content.src=$(t).find("imagedata").attr("url"),this.content.src=this.content.src?player.basepath+"mobile/"+this.content.src.replace("story_content/","").replace(".swf",".png"):"",0<e.length&&(this.content.src=player.basepath+"mobile/"+e.attr("url"),this.content.mask=e.attr("mask"),this.content.maskref=e.attr("maskref"));break;case"textinput":this.canSimplify=!1,this.content.src=Element.PixelSrc;break;case"video":this.canSimplify=!1,this.content.src=$(t).find("videodata").attr("url"),this.content.autoplay="true"==$(t).attr("autoplay"),this.content.showcontrols="true"==$(t).attr("showcontrols"),this.content.autorewind="true"==$(t).attr("autorewind"),this.content.loop="true"==$(t).attr("loop"),this.content.src?(this.content.src=player.basepath+""+this.content.src,this.content.src=this.content.src.replace(".mp4",".mov"),player.usePlaceholderVideo&&(this.content.src="/aomock/DocumentHandler.ashx?mimetype=video/mp4&url=/test/video_3.mp4")):this.content.src=""}this.textlib&&this.content.src==Element.PixelSrc&&(t=this.textlib.children("textdata").children("vartext").first().text(),t||(t=this.textlib.children("textdata").attr("lmstext"))&&(t="<span>"+t+"</span>"),t)&&(this.textTemplate=t=t.replace(/size='(.*?)(pt|)'/gi,"style='font-size:$1pt'"))},StageItem.prototype.loadImageDataFromXML=function(t){var e=this;e.imagelib=new ppImageLib,$(t).children("imagelib").children("imagedata").each(function(t,i){var r=e.imagelib.AddImage($(i).attr("id"),$(i).attr("type"),null,$(i).attr("width"),$(i).attr("height"),$(i).attr("mobiledx"),$(i).attr("mobiledy")),n=$(i).attr("altimage"),a=$(i).attr("url"),n=player.basepath+(n?n:a),a=$(i).attr("mask");e.content.mask=a,e.content.maskref=$(i).attr("maskref"),-1<n.indexOf(".swf")&&(n=Element.PixelSrc),e.content.src=n,a=e.createResource(e.slide,n,function(){e.blocked&&e.ref&&e.render(e.lastRenderedState,!0,null,"resource callback")}),a.imgLibID=$(i).attr("id"),a.src=n,a.poolImage||(a.poolImage=document.createElement("img"),a.poolImage.className="loader"),r.imgNode=a.poolImage,r.Width=$(i).attr("width"),r.Height=$(i).attr("height")})},StageItem.prototype.loadSizeFromXML=function(t){var e=$(t).children("data").children("html5data");"audio"!=this.type&&(0<e.length?(this.hasImagelib=0<$(t).find("imagelib").length,this.hasTextlib=0<$(t).find("textlib").length,this.xpos=parseInt($(t).attr("xpos")),this.ypos=parseInt($(t).attr("ypos")),this.xoffset=parseInt($(t).attr("xoffset"))||0,this.yoffset=parseInt($(t).attr("yoffset"))||0,this.x=this.xpos+this.xoffset,this.y=this.ypos+this.yoffset,this.width=parseInt(e.attr("width")),this.height=parseInt(e.attr("height"))):("video"==this.type?(this.xpos=parseInt($(t).attr("xpos")),this.ypos=parseInt($(t).attr("ypos")),this.x=parseInt($(t).attr("xpos")),this.y=parseInt($(t).attr("ypos"))):(this.xpos=parseInt($(t).attr("xpos")),this.ypos=parseInt($(t).attr("ypos")),this.yoffset=this.xoffset=0,this.x=this.xpos+this.xoffset,this.y=this.ypos+this.yoffset),this.width=parseInt($(t).attr("width")),this.height=parseInt($(t).attr("height")))),this.rotatexpos=Math.round($(t).attr("rotatexpos"))||0,this.rotateypos=Math.round($(t).attr("rotateypos"))||0,this.rotation=parseInt($(t).attr("rotation"))||0,this.xscale=parseInt($(t).attr("xscale"))||0,this.yscale=parseInt($(t).attr("yscale"))||0,this.originalX=this.x,this.originalY=this.y,this.depth=parseInt($(t).attr("depth"))||1,0==this.depth&&(this.depth=1),this.originalZ=this.depth,this.depth>this.slide.topZ&&(this.slide.topZ=this.depth)},StageItem.prototype.createResource=function(t,e,i){return e=new Resource(this,e,function(){i&&i()}),t.resources||(t=t.slide),t.pushResource(e),this.resources.push(e),e},StageItem.prototype.createRef=function(){return this.parent.ref?(this.container=this.parent.ref,this.ref?(this.render(null,!1,null,"StageItem createRef"),!1):(this.ref=$('<div class="item"></div>'),this.ref.addClass(this.type),this.ref.addClass(this.innerType.toLowerCase()),this.ref.addClass("item_"+this.id),player.showItemInfo&&this.ref.append($('<div class="itemid">'+this.id+"</div>")),this.applySize(this.ref),"dragitem"==this.innerType&&this.setZIndex(this.depth),this.container.append(this.ref),this.ref.get(0).item=this,"video"!=this.type&&"audio"!=this.type&&this.bindEvents(),$.each(this.children,function(t,e){e.createRef&&e.createRef()}),this.initDrag&&(this.initDrag(),this.convertRefToDragItem()),("DropArea"==this.innerType||this.isDropArea)&&this.ref.addClass("droparea"),this.announceDragOver&&this.ref.addClass("dragover"),this.visible=!1,this.nearestScrollAreaAncestor=this.findAncestorOfType("ScrollArea"),!0)):(this.parent.createRef(),!1)},StageItem.prototype.setInteractive=function(){this.ref.addClass("interactive"),this.parent.setInteractive&&this.parent.setInteractive()},StageItem.prototype.setZIndex=function(t,e){(e||"Layer"!=this.innerType&&"ExpandingLabel"!=this.innerType)&&($.each(this.children,function(e,i){i.depth>t&&(t=i.depth)}),this.ref&&this.ref.css("z-index",t),this.depth=t,this.parent&&this.parent.setZIndex&&this.parent.setZIndex(t))},Element.prototype.updateMatrix=function(){this.matrix.reset(),"ScrollArea"==this.innerType&&this.ref&&0!=this.ref.get(0).scrollTop&&this.matrix.translate(0,-this.ref.get(0).scrollTop),"sequencectrl"==this.innerType&&this.ref&&0!=this.ref.get(0).scrollTop&&this.matrix.translate(0,-this.ref.get(0).scrollTop),this.parent&&!this.parent.dragX&&!this.parent.dragY&&this.matrix.translate(this.dragX||0,this.dragY||0),this.parent&&this.parent.matrix&&this.matrix.multiply(this.parent.matrix.copy()),this.centerpoint={x:this.rotatexpos-this.xoffset,y:this.rotateypos-this.yoffset},this.matrix.translate(this.x+this.centerpoint.x,this.y+this.centerpoint.y),this.matrix.rotateDegrees(this.rotation),this.matrix.translate(-this.centerpoint.x,-this.centerpoint.y),this.isRotated=this.parent&&this.parent.isRotated||0!=this.rotation},Element.prototype.applySize=function(t){this.updateMatrix(),player.showMatrixDebug&&(player.testCanvas||(player.testCanvas=$("<canvas id='test' width='1000' height='1000' style='position:absolute;z-index:200;left:0px;top:0px;'></canvas>"),$("#slideframe").append(player.testCanvas),player.testContext=player.testCanvas.get(0).getContext("2d"),player.testContext.fillStyle="rgba(255,255,0,0.5)",player.testContext.fillStyle="rgba(0,0,0,0.5)",player.testContext.strokeStyle="rgba(0,255,0,0.5)"),player.testContext.save(),this.matrix.applyContext(player.testContext),player.testContext.strokeStyle="rgba(0,255,0,0.5)",player.testContext.strokeRect(0,0,this.width,this.height),this.getAABB(),player.testContext.restore()),t.css("left",this.x+"px"),t.css("top",this.y+"px"),t.css("width",this.width+"px"),t.css("height",this.height+"px"),"Layer"!=this.innerType&&"ExpandingLabel"!=this.innerType&&0<this.depth&&(t.css("z-index",this.depth),this.parent&&"ShuffleGroup"==this.parent.innerType&&this.parent.ref)&&(this.parent.depth=this.depth,this.parent.ref.css("z-index",this.depth)),0!=this.rotation&&(t.css("-webkit-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-webkit-transform","rotate("+this.rotation+"deg)"),t.css("-moz-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-moz-transform","rotate("+this.rotation+"deg)"),t.css("-o-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-o-transform","rotate("+this.rotation+"deg)"),t.css("-ms-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-ms-transform","rotate("+this.rotation+"deg)"),this.canSimplify=!1)},StageItem.prototype.bindEvents=function(){var t=this,e=function(e){if("true"==t.variables._disabled||swipe.moved)return!1;var i=(e.pageX-t.ref.offset().left+t.xoffset)/player.currentZoom(),r=(e.pageY-t.ref.offset().top+t.yoffset)/player.currentZoom();return t.ref.offset(),t.ref.offset(),swipe.parseEventCoords(e),e=swipe.getSlideCoords(t.slide),i<t.width&&r<t.height&&t.isPointActive(e.x,e.y)&&!t.isPointObscured(e.x,e.y)?!0:!1},i=!1;t.bindStoryEvent("click touchstart","ondoubleclick",function(t){if(e(t)){if(i)return!0;i=!0,setTimeout(function(){i=!1},400)}return!1}),t.bindStoryEvent("mousedown","onrightrelease",function(t){return 3==t.which}),t.shouldBindEvent("onpress")||t.shouldBindEvent("onrelease")},StageItem.prototype.unBindEvents=function(){},StageItem.prototype.reduce=function(){$.each(this.children,function(t,e){e.reduce&&e.reduce()}),this.canvas&&(this.canvas.width=1,this.canvas.height=1)},StageItem.prototype.destroyRef=function(){$.each(this.children,function(t,e){e.destroyRef&&e.destroyRef()}),this.ref&&(this.ref.unbind(),this.ref.get(0).item=null,this.ref.get(0).id=null,removeDOMElement(this.ref),this.ref=null,this.destroyComponent("ref"),this.destroyComponent("contentRef"),this.destroyComponent("jcanvas"),this.destroyComponent("canvas"),this.destroyComponent("border"),this.dirty=!0),this.xml&&(this.xml=null),this.unloadResources()},StageItem.prototype.destroyComponent=function(t){this[t]&&($(this[t]).remove(),this[t]=null)};var removeDOMElement=function(t){t.get&&(t=t.get(0)),t.parentNode&&t.parentNode.removeChild(t)};StageItem.prototype.render=function(){if(this.ref)switch(this.innerType){case"swf":this.ref.css("background-color","orange"),player.addToShowQueue(this);case"textfield":case"image":this.content.src!=Element.PixelSrc&&(this.ref.css("background","transparent url("+escape(this.content.src)+") no-repeat"),player.addToShowQueue(this))}},StageItem.prototype.show=function(t,e){this.createRef(this.parent.ref),this.loadResources();var i=this;if(!this.visible||this.dirty){if(this.dirty=!1,t&&t.isUserInitiated&&(this.actionControlled=!0),"audio"!=this.type){if(i.textlib&&i.textTemplate&&i.content.src==Element.PixelSrc&&i.textTemplate&&i.renderTextTemplate(),!e||0==e.duration&&"custom"!=e.transition)i.runningTransition=null,i.pendingHide=!1,i.pendingShow=!1,this.bShowQueue=this.visible=!0,i.addWithChildrenToShowQueue(),i.handleEvent("ontransitionin",null,null,!1,!0),i.handleEvent("ontransitionincomplete",null,null,!1,!0);else{if(!this.ref)return;this.visible=!0;for(var r in this.children)this.children[r].bParentHidden&&player.addToShowQueue(this.children[r]);player.addToShowQueue(i),i.handleEvent("ontransitionin",null,null,!1,!0),i.runningTransition=e,i.pendingHide=!1,i.pendingShow=!0,i.transitioning=!1,i.justShowed=!0,setTimeout(function(){i.justShowed=!1},0),r=e.convertToAnimation(i);var n=player;t&&"TimelineEvent"==t.type&&(n=t.parentElement),i.animated=!0,r.start(i.ref,e.reverse,n,function(){i.transitioning=!1,i.ref&&i.pendingShow&&(i.pendingHide=!1,i.pendingShow=!1,i.addWithChildrenToShowQueue()),i.handleEvent("ontransitionincomplete",null,null,!1,!0)}),i.transitioning=!0}i.group&&i.group.show(null,null,null,!0)}0<i.events.length&&(!i.ref.data("events")||!i.ref.data("events").mouseup&&!i.ref.data("events").mousedown&&!i.ref.data("events").touchstart&&!i.ref.data("events").touchend)&&this.bindEvents(),this.setOnStage(!0),this.shuffleGroup&&this.shuffleGroup.shuffle()}},StageItem.prototype.setOnStage=function(t,e){this.setProperty("OnStage",(t&&this.visible).toString(),e),$.each(this.children,function(i,r){r.setOnStage&&r.setOnStage(t,e)})},StageItem.prototype.quickShow=function(){this.visible=!0,"audio"!=this.type&&this.slide&&this.slide==player.currentSlide()&&this.ref&&(this.pendingShow=this.pendingHide=!1,player.addToShowQueue(this)),this.setOnStage(!0,!0)},StageItem.prototype.quickHide=function(){this.visible=!1,"audio"!=this.type&&"ItemGroup"!=this.type&&this.slide&&this.slide==player.currentSlide()&&this.ref&&(this.ref.hide(),player.removeFromShowQueue(this),this.pendingShow=this.pendingHide=!1),this.setOnStage(!1,!0)},StageItem.prototype.hide=function(t,e){if(this.visible&&this.ref){var i=this;if(this.visible=!1,t&&t.isUserInitiated&&(this.actionControlled=!0),Animation.endForItem(this),"audio"!=this.type)if(i.handleEvent("ontransitionout",null,null,!1,!0),!e||0==e.duration&&"custom"!=e.transition)i.runningTransition=null,this.ref&&(i.pendingHide=!1,i.pendingShow=!1,i.hideRefAndUnQueue()),i.handleEvent("ontransitionoutcomplete",null,null,!1,!0);else{i.runningTransition=e,i.pendingHide=!0,i.pendingShow=!1,i.transitioning=!1;var r=e.convertToAnimation(i),n=player;t&&"TimelineEvent"==t.type&&(n=t.parentElement),i.animated=!0,r.start(i.ref,e.reverse,n,function(){i.transitioning=!1,i.ref&&i.pendingHide&&(i.pendingHide=!1,i.pendingShow=!1,i.hideRefAndUnQueue()),i.handleEvent("ontransitionoutcomplete",null,null,!1,!0)}),i.transitioning=!0}this.setOnStage(!1),this.showOnFirstStep=!1,this.animation&&(this.animation.showOnFirstStep=!1)}},StageItem.prototype.addWithChildrenToShowQueue=function(){for(var t in this.children)this.children[t].bParentHidden&&(this.children[t].shapemaskid&&this.children[t].renderOnUpdate&&player.addToRenderQueue(this.children[t]),player.addToShowQueue(this.children[t]));player.addToShowQueue(this)},StageItem.prototype.hideRefAndUnQueue=function(){for(var t in this.children)this.children[t].ref&&this.children[t].ref.hide(),this.children[t].bParentHidden=!0;this.ref.hide(),player.removeFromShowQueue(this)},StageItem.prototype.mediaReady=function(){return this&&this.ref&&this.ref.get(0)&&4==this.ref.get(0).readyState?!0:!1},StageItem.prototype.shouldBindEvent=function(t){if(player.showItemInfo)return!0;var e=this,i=!1;return $.each(e.events,function(r,n){if(n.trigger==t)i=!0;else{var a=e.parent;a&&a.shouldBindEvent&&!i&&(i=a.shouldBindEvent(t))}}),i},StageItem.prototype.bindStoryEvent=function(t,e,i){if(this.shouldBindEvent(e)){var r=this;this.ref.bind(t,function(t){"onrelease"==e&&player.updateItemInfo(r);var n=r.findDownstreamMedia();n&&n.prep();var a=function(n,a){return $.each(n,function(n,s){s.trigger!=e||i&&"function"==typeof i&&!i(t)||(s.act(r,!0),a=!1)}),a},n=a(r.events,!0);return r.group&&r.group.events&&r.group.events.length&&(n=a(r.group.events,n)),n})}},Element.prototype.prepDownstreamMedia=function(){if(player.isIOS){var t=this.findDownstreamMedia();this.firstVideoAssetSrc&&Video.refStore[this.firstVideoAssetSrc]?Video.refStore[this.firstVideoAssetSrc].get(0).load():t&&t.prep()}},Element.prototype.findDownstreamMedia=function(t){if(t=t||0,!(t>6)){var e=this,i=[],r=function(r){r&&$.each(r,function(r,n){n.findDownstreamMedia(e,i,++t)})};return r(e.events),0==i.length&&e.timelineEvents&&r(e.timelineEvents),0==i.length&&r(player.currentSlide().timelineEvents),0<i.length?i[0]:null}},StageItem.prototype.bindVarListener=function(t){for(var e=this.parseObjref(t).target,e=0;e<this.events.length;e++){var i=this.events[e];if("onvarchanged"==i.trigger&&i.varname==t&&i.boundByItemID==this.id)return i}return i=new StoryEvent(this),i.trigger="onvarchanged",i.varname=t,i.boundByItemID=this.id,i.filter=function(e){return e==t},e=new TimelineAction(this),e.type="render_item",e.item=this,i.actions.push(e),this.events.push(i),e=this.parseObjref(t).target,e.registerVariableEventSubscriber(this,t),i},StageItem.prototype.renderTextTemplate=function(){var t=this,e=t.textTemplate,e=e.replace(/pt'/gi,"px'"),i=e.match(/\&(.*?);/g);i&&$.each(i,function(i,r){var n=r.replace(/\&|\$|;/g,""),a=t.extractVariable(n);(null===a||"undefined"==typeof a)&&(a=""),!isNaN(parseFloat(a))&&isFinite(a)&&(a=Math.round(100*parseFloat(a))/100),e=e.replace(r,a),t.bindVarListener(n)}),t.contentRef||(t.contentRef=t.ref),t.contentRef.empty(),t.contentRef.append($(e)),t.contentRef.find("p").first().css("width",t.width),t.contentRef.find("p").first().css("height",t.height)},StageItem.prototype.getBitMask=function(){return this.lastRenderedState&&this.stateMasks&&this.stateMasks[this.lastRenderedState]?this.stateMasks[this.lastRenderedState]:this.bitMask},StageItem.prototype.fixRef=function(){if(!this.isState&&this.ref.get(0).id){var t=$("#"+this.ref.get(0).id);t.get(0)&&this.ref.get(0)!=t.get(0)&&(this.ref=t)}},StageItem.prototype.getAABB=function(){var t=this,e={left:5e3,top:5e3,right:-5e3,bottom:-5e3};return $.each([[0,0],[this.width,0],[this.width,this.height],[0,this.height]],function(i,r){var n=t.matrix.transformPoint(r[0]-t.xoffset,r[1]-t.yoffset),a=n.x,n=n.y;a<e.left&&(e.left=a),a>e.right&&(e.right=a),n<e.top&&(e.top=n),n>e.bottom&&(e.bottom=n)}),player.showDebugOverlap&&player.testContext&&setTimeout(function(){player.testContext.strokeStyle="rgba(0,0,255,0.5)",player.testContext.strokeRect(e.left,e.top,e.right-e.left,e.bottom-e.top)},0),e},StageItem.prototype.getAABB_simple=function(t,e){if(void 0===t&&(t=this.rotation),0==t){var i={};return e?(i.left=0,i.top=0,i.right=this.width,i.bottom=this.height):(i.left=this.x+this.dragX,i.top=this.y+this.dragY,i.right=this.x+this.dragX+this.width,i.bottom=this.y+this.dragY+this.height),i}var i={left:5e3,top:5e3,right:-5e3,bottom:-5e3},r=[[-this.width/2,-this.height/2],[this.width/2,-this.height/2],[this.width/2,this.height/2],[-this.width/2,this.height/2]],n=Math.cos(t*Math.PI/180),a=Math.sin(t*Math.PI/180);return $.each(r,function(t,e){x=Math.ceil(-e[0]*n+e[1]*a),y=Math.ceil(e[0]*a-e[1]*n),x<i.left&&(i.left=x),x>i.right&&(i.right=x),y<i.top&&(i.top=y),y>i.bottom&&(i.bottom=y)}),e?(i.left+=this.rotatexpos,i.top+=this.rotateypos,i.right+=this.rotatexpos,i.bottom+=this.rotateypos):(i.left+=this.x+this.dragX+this.rotatexpos,i.top+=this.y+this.dragY+this.rotateypos,i.right+=this.x+this.dragX+this.rotatexpos,i.bottom+=this.y+this.dragY+this.rotateypos),player.showDebugOverlap&&player.testContext&&setTimeout(function(){player.testContext.strokeStyle="rgba(0,0,255,0.5)",player.testContext.strokeRect(i.left,i.top,i.right-i.left,i.bottom-i.top)},0),i},StageItem.prototype.testRotatedOverlap=function(t){var e,i,r,n,a=this.getAABB(),s=t.getAABB();if(e=BitMask.max(a.left,s.left),i=BitMask.min(a.right,s.right),r=BitMask.max(a.top,s.top),n=BitMask.min(a.bottom,s.bottom),a.right<s.left||a.left>s.right||a.bottom<s.top||a.top>s.bottom)return!1;for(player.showDebugOverlap&&(player.testCanvas||(player.testCanvas=$("<canvas id='test' width='1000' height='1000' style='position:absolute;z-index:200;left:0px;top:0px;'></canvas>"),$("#slideframe").append(player.testCanvas),player.testContext=player.testCanvas.get(0).getContext("2d"),player.testContext.fillStyle="rgba(255,255,0,0.5)"),player.testCanvas.show(),clearTimeout(player.testCanvasClear),player.testCanvasClear=setTimeout(function(){player.testCanvas.hide()},1e3),player.showDebugOverlapPersistent||(player.testContext.clearRect(0,0,1e3,1e3),player.testContext.fillStyle="rgba(0,255,255,0.2)",player.testContext.fillRect(a.left,a.top,a.right-a.left,a.bottom-a.top),player.testContext.fillStyle="rgba(0,0,255,0.2)",player.testContext.fillRect(s.left,s.top,s.right-s.left,s.bottom-s.top),player.testContext.strokeStyle="rgba(255,0,255,0.8)",player.testContext.strokeRect(e,r,i-e,n-r))),a=i-e,n=a*(n-r),s=0;n>s;s+=64){i=e+s%a;var o=r+Math.floor(s/a);if(player.showDebugOverlap&&(this.isPointActive(i,o)?t.isPointActive(i,o)?t.isPointObscured(i,o,this,function(t){return t.dropArea})?(player.testContext.fillStyle="rgba(255,0,0,0.9)",player.testContext.fillRect(i-1,o-1,2,2)):(player.testContext.fillStyle="rgba(0,255,0,0.9)",player.testContext.fillRect(i-2,o-2,4,4)):(player.testContext.fillStyle="rgba(255,255,0,0.9)",player.testContext.fillRect(i-1,o-1,2,2)):(player.testContext.fillStyle=t.isPointActive(i,o)?"rgba(0,0,0,0.5)":"rgba(100,100,100,0.2)",player.testContext.fillRect(i-1,o-1,2,2))),this.isPointActive(i,o)&&t.isPointActive(i,o)&&!t.isPointObscured(i,o,this,function(t){return t.dropArea}))return!0}return!1};var Layer=function(t,e){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.timelineEvents=[],this.clips=[],this.currentIndex=this.currentTime=0,this.duration=10,this.active=!0,this.slide=e,this.layer=null,this.parent=e,this.paused=this.viewed=!1};Layer.prototype=new StageItem,Layer.prototype.objectType="Layer",Layer.prototype.innerType="Layer",Layer.prototype.getItemIndex=function(){var t=this,e=0,i=-1;return this.itemIndex?this.itemIndex:($.each(this.slide.children,function(r,n){"Layer"==n.innerType&&(n==t&&(i=e),e++)}),this.itemIndex=i)},Layer.prototype.restoreFromResumeData=function(t){var e=[];this.deepEach(function(t,i){i.resume&&"ShuffleGroup"!=i.innerType&&e.push(i)}),t=new bwChunk(t).NextChunk(),this.currentTime=bwChunk.BaseNto10(t.Data(),t.Length());for(var t=t.NextChunk(),i=new bwChunk(t.Data()),r=0;!i.isNothing;){var n=e[r];n&&n.restoreFromResumeData(i.ChunkData()),i=i.NextChunk(),r++}var a=t.NextChunk().NextChunk().NextChunk().Data();this.clips.forEach(function(t){if("audio"==t.innerType){var e=new bwChunk(a);t.SetResumeData(e.Data()),a=e.Remainder()}})},Layer.prototype.getResumeData=function(){var t="";if(this.resume&&this.viewed){var e="",i="";this.deepEach(function(t,i){i.resume&&"ShuffleGroup"!=i.innerType&&(e+=bwChunk.CreateChunk(i.GetResumeData()))}),this.clips.forEach(function(t){"audio"==t.innerType&&(i+=bwChunk.CreateChunk(t.GetResumeData()))});var t=t+bwChunk.EMPTY_CHUNK,r=bwChunk.Base10toN(this.currentTime),t=t+bwChunk.CreateChunk(r),t=t+bwChunk.CreateChunk(e),t=t+bwChunk.EMPTY_CHUNK,t=t+bwChunk.EMPTY_CHUNK,t=t+bwChunk.CreateChunk(i)}return t},Layer.prototype.toBaseData=Element.prototype.toData,Layer.prototype.toData=function(){var t=this.toBaseData();return t.currentTime=this.currentTime,t},Layer.prototype.updateBaseFromData=Element.prototype.updateFromData,Layer.prototype.updateFromData=function(t){this.updateBaseFromData(t),this.currentTime=t.currentTime},Layer.prototype.loadFromXML=function(t){var e=this;this.id=$(t).attr("id"),this.modal="true"==$(t).attr("modal"),this.resume="true"==$(t).attr("resume"),this.pauseparent="true"==$(t).attr("pauseparent"),this.depth=parseInt($(t).attr("depth")),this.loadChildrenFromXML(t,e.slide,e,function(t){t.canSimplify=!1}),$(t).children("audiolib").children("audio").each(function(t,i){var r=new Audio;r.loadFromXML(i,e.slide,e),r.createRef(),e.children[r.id]=r}),$(t).find("timeline").each(function(t,i){e.duration=$(i).attr("duration"),$(i).find("event").each(function(t,i){var r=new TimelineEvent(e);r.loadFromXML(i),e.timelineEvents.push(r)})}),$(t).children("background").each(function(t,i){e.background=new Background(e.ref),e.background.loadFromXML(i),e.background.src||(e.backgroundReady=!0),e.ref&&e.background.apply(e.ref)}),this.loadElementInfoFromXML(t),this.depth=++this.slide.topZ,this.type="layer"},Layer.prototype.resetBase=Element.prototype.reset,Layer.prototype.reset=function(t){this.resume?player.useCompactResume&&this.compactResumeData?this.restoreFromResumeData(this.compactResumeData):this.resumeData&&this.updateFromData(this.resumeData):(this.resetBase(),t||(this.visible=!1,this.ref&&this.ref.hide()),$.each(this.children,function(t,e){e.hide&&e.hide()}))},Layer.prototype.createBaseRef=StageItem.prototype.createRef,Layer.prototype.destroyBaseRef=StageItem.prototype.destroyRef,Layer.prototype.createRef=function(){return this.ref||!this.createBaseRef()?!1:(this.ref.removeClass("item"),this.ref.addClass("layer"),this.background&&this.background.apply(this.ref),this.ref.css("display","none"),!0)},Layer.prototype.show=function(t){this.createRef(this.parent.ref);var e=this;$(".currentlayer").removeClass("currentlayer"),this.ref.addClass("currentlayer"),this.viewed=!0;var i=this.ref;if(t&&0!=t.duration){var r=this.visible;i.css("display","block"),t.setTarget(this),e.transitioning=!0,t.apply(function(){e.transitioning=!1,r||(e.handleEvent("ontransitionincomplete",null,null,!1,!0),e.handleSlideStart())},null,null,"ease-out"),r||(e.handleEvent("ontransitionin",null,null,!1,!0),e.setOnStage(!0))}else e.runningTransition=null,i.css("display","block"),this.visible||(e.handleEvent("ontransitionin",null,null,!1,!0),e.handleEvent("ontransitionincomplete",null,null,!1,!0),e.handleSlideStart(),e.setOnStage(!0));this.pauseparent&&this.slide==player.currentSlide()&&player.pause(!0),player.modalLayer=null,this.modal&&(this.modalfence||(this.modalfence=$("<div class='modalfence'></div>"),this.parent.ref.append(this.modalfence),this.modalfence.bind("click",function(){})),player.modalLayer=e,this.modalfence.show()),t=e.slide.topMostLayer(),t!=e&&t.handleEvent("endtopmostlayer"),util.popArrayElement(this.slide.layerStack,this),this.slide.layerStack.push(this),this.handleEvent("ontopmostlayer"),this.depth=this.slide.topZ+1,this.slide.topZ=this.depth,this.visible&&this.resume?this.ref.css("display","block"):(this.visible||(this.currentIndex=this.currentTime=0),this.resume&&this.compactResumeData&&(this.restoreFromResumeData(this.compactResumeData),player.activeTimeline==this)&&(player.activeTimeline.currentTime=this.currentTime),this.visible=!0,this.paused=!1)},Layer.prototype.emptyLayer=function(){this.timelineEvents=[]},Layer.prototype.hide=function(t){if(this.visible){this.visible=!1,player.modalLayer=null;var e=this,i=function(){e.ref.css("display","none"),e.handleEvent("ontransitionoutcomplete",null,null,!1,!0),$.each(e.clips,function(t,e){e.getIsPlaying()&&(e.m_bResumeOnSeek=!0),e.pauseClip()}),e.modalfence&&e.modalfence.hide(),e.destroyWebobjects(),e.resume?e.compactResumeData=e.getResumeData():e.reset(),e.slide.topMostLayer()==e&&e.handleEvent("endtopmostlayer"),util.popArrayElement(e.slide.layerStack,e),0<e.slide.layerStack.length?e.slide.layerStack[e.slide.layerStack.length-1].handleEvent("ontopmostlayer"):(e.slide.handleEvent("ontopmostlayer"),player.activeTimeline=player),e.setOnStage(!1),e.pauseparent&&player.play(!0,!0,!1)};e.handleEvent("ontransitionout",null,null,!1,!0),t&&0!=t.duration?(t.setTarget(this),t.apply(function(){i()},null,null,"ease-out")):(e.runningTransition=null,i())}},Layer.prototype.destroyWebobjects=function(){$.each(this.children,function(t,e){e.destroyWebobjects&&e.destroyWebobjects()})},Layer.prototype.play=function(t,e,i){this.paused=!1;var r=this;i||player.currentSlide().clips.forEach(function(t){t.m_bResumeOnSeek&&t.layer==r&&(player.currentClipStartTime=t.lastStartTime,player.currentClipSyncToTimeline=!0,player.currentClip=t,t.playClip())&&(t.m_bResumeOnSeek=!1)}),$(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".play").hide(),$(".controlbar-button").find(".pause").show()},Layer.prototype.pause=function(){this.paused=!0,$.each(this.clips,function(t,e){
e.syncToTimeline&&(e.getIsPlaying()&&(e.m_bResumeOnSeek=!0),e.pauseClip(),player.scheduledMediaSrc==e.content.src&&(clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=null))}),$(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".pause").hide(),$(".controlbar-button").find(".play").show()},Layer.prototype.update=function(){if(!(this.currentTime>parseInt(this.duration)+100)){for(ProgressBar.getCurrentProgressBar().dragging&&player.currentClip&&(player.currentClip.currentTime=(player.activeTimeline.currentTime-player.currentClipStartTime)/1e3),player.activeTimeline==this&&(ProgressBar.getCurrentProgressBar().index=player.activeTimeline.currentTime,ProgressBar.getCurrentProgressBar().count=player.activeTimeline.duration,ProgressBar.getCurrentProgressBar().update(),this.paused?($(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".pause").hide(),$(".controlbar-button").find(".play").show()):($(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".play").hide(),$(".controlbar-button").find(".pause").show())),$.each(this.clips,function(t,e){e.getIsPlaying&&e.getIsPlaying()}),player.layerPlaying=!0;0<this.currentIndex&&this.timelineEvents[this.currentIndex-1].time>this.currentTime;)this.currentIndex--,this.timelineEvents[this.currentIndex].revert(this.currentTime);for(;this.currentIndex<this.timelineEvents.length&&this.timelineEvents[this.currentIndex].time<=this.currentTime&&player.layerPlaying;)this.timelineEvents[this.currentIndex].act(),this.currentIndex++;this.currentTime>=this.duration&&(this.handleEvent("ontimelinecomplete",null,null,!1,!0)&&player.currentTime>=player.currentSlide().duration&&this.handleEvent("onallopentimelinescomplete"),player.layerPlaying=!1)}},Layer.prototype.handleSlideStart=function(){this.handledSlideStart||(this.handledSlideStart=!0,this.handleEvent("onslidestart",null,null,!1,!0),this.deepEach(function(t,e){e.handleEvent&&e.handleEvent("onslidestart",null,null,!1,!0)}))};var VectorShape=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="textfield",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.lastRenderedState="none",this.canvas=null,this.m_nYOffset=this.m_nXOffset=0,this.height=this.width=1e3,this.vectorHot=!1};VectorShape.prototype=new StageItem,VectorShape.prototype.objectType="Item",VectorShape.prototype.innerType="vectorshape",VectorShape.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,VectorShape.prototype.loadFromXML=function(t,e,i){var r=this;this.loadBaseFromXML(t,e,i),this.yoffset=this.xoffset=0,this.originalWidth=parseInt($(t).attr("width")),this.originalHeight=parseInt($(t).attr("height")),this.originalX=this.x,this.originalY=this.y,0<$(t).children("data").children("textdata").children("vartext").length&&(this.textlib=$(t).children("data")),this.canSimplify=!1,$(t).children("states").children().each(function(t,e){var i=$(e).attr("name"),n=$(e).children("data").children("vectordata"),a={left:n.attr("left"),top:n.attr("top"),right:n.attr("right"),bottom:n.attr("bottom"),path:PathLib.getPathFromXML(n.children("pr")),index:t};a.path&&""!=a.path||(a.path=n.children("path").text()),r.states[i]=a}),this.loadLinksFromXML(t)},VectorShape.prototype.loadLinksFromXML=function(t){var e=this;$(t).children("textlib").children("textdata").each(function(t,i){var r=$(i).attr("id");$(i).children("linkdata").children("link").each(function(t,i){var n=new LinkArea(e.ref,e.slide,e.layer,r);n.parent=e,n.loadFromXML(i,e.slide,e.layer),e.links[n.id]=n,e.hasLinks=!0})})},VectorShape.prototype.createBaseRef=StageItem.prototype.createRef,VectorShape.prototype.destroyBaseRef=StageItem.prototype.destroyRef,VectorShape.prototype.createRef=function(){if(this.ref||!this.createBaseRef())return!1;this.contentRef||(this.contentRef=$('<div class="item unhideable vartext"></div>')),this.ref.append(this.contentRef),this.ref.css("width",this.originalWidth),this.ref.css("height",this.originalHeight);var t=$(this.xml).find("textdata").first().attr("valign");return t&&this.contentRef.addClass("v"+t),t=$('<canvas class="content" width="'+this.originalWidth+'" height="'+this.originalHeight+'"></canvas>'),t.css("position","absolute"),this.ref.append(t),this.jcanvas=t,this.canvas=t.get(0),this.context=this.canvas.getContext("2d"),this.renderAsBackground&&(this.altRef=$('<div class="item unhideable alternate"></div>'),this.altRef.css("width",this.originalWidth),this.altRef.css("height",this.originalHeight),this.ref.append(this.altRef)),this.lastRenderedState=null,this.render(this.variables.ObjectState,!0,null,"VectorShape createRef"),!0},VectorShape.prototype.destroyRef=function(){this.destroyBaseRef(),this.canvas&&($(this.canvas).remove(),this.canvas=null),this.contentRef&&(this.contentRef.remove(),this.contentRef=null),this.bitMask=this.lastRenderedState=null,this.stateMasks={}},VectorShape.prototype.renderCallback=function(){},VectorShape.prototype.render=function(t,e,i,r,n,a){if(this.ref){var s=this;if(e||t!=this.lastRenderedState)if(this.lastRenderedState=t,s.allResourcesLoaded())if(s.blocked=!1,s.canvas||(s.canvas=$(this.ref).find("canvas").get(0)),player.useSafeCanvas)this.canvas.getContext("2d"),this.ref.css("background-color","#"+parseInt(900*Math.random()+1100)%1e3);else{if(s.m_nXOffset=s.xoffset,s.m_nYOffset=s.yoffset,s.width=s.width,s.height=s.height,e=new ppTextLib(s.xml),i=s.content.path,s.states[t]?(i=s.states[t].path,s.rectShape=new ppRect(s.states[t].left,s.states[t].top,s.states[t].right,s.states[t].bottom)):this.originalRectShape&&(this.rectShape=this.originalRectShape),s.rectShape&&0==s.rectShape.right&&0==s.rectShape.bottom&&(s.rectShape.right=s.width,s.rectShape.bottom=s.height),i)try{var o=new Date;ppArt.itemID=s.id,ppArt.item=s,ppArt.DrawVector(s,i,e,player.fontlib,s.imagelib,a);for(var l in s.links)s.links[l].linkdx=ppArt.m_listTextOffsets[s.links[l].textid].x,s.links[l].linkdy=ppArt.m_listTextOffsets[s.links[l].textid].y;if(s.textOffset&&(s.m_nXOffset+=s.textOffset.x,s.m_nYOffset+=s.textOffset.y),s.m_nXOffset!=s.xoffset||s.m_nYOffset!=s.yoffset){var h=s.m_nXOffset-s.xoffset,p=s.m_nYOffset-s.yoffset;s.originalXOffset||(s.originalXOffset=s.xoffset,s.originalYOffset=s.yoffset),s.xoffset=s.m_nXOffset,s.yoffset=s.m_nYOffset,this.x+=h,this.y+=p,s.applySize(s.ref)}parseInt(new Date-o),t&&!s.stateMasks&&(s.stateMasks={}),a=function(){if(player.usePixelTesting)return new BitMask(!0,s.width,s.height);var t=new BitMask(!1,s.width,s.height,s.imageWidth||s.width,s.imageHeight||s.height);return!s.content.mask&&s.content.maskref&&(s.content.mask=player.bitmasks[s.content.maskref]),s.content.mask?(t.loadFromRLE(s.content.mask),t.pixels&&!t.isOpaque&&(s.width!=$(s.canvas).attr("width")||s.height!=$(s.canvas).attr("height"))&&t.resize($(s.canvas).attr("width"),$(s.canvas).attr("height"),-s.xoffset,-s.yoffset)):-1<s.content.src.indexOf(".jpg")?t.isOpaque=!0:player.isLocalFileSystem&&s.imagelib?t.isOpaque=!0:(t=new BitMask(!1,$(s.canvas).attr("width"),$(s.canvas).attr("height")),s.context||(s.context=s.canvas.getContext("2d")),t.loadFromContext(s.context)),t},t&&!s.stateMasks[t]?s.stateMasks[t]=a():(!s.bitMask||s.bitMask.isOpaque)&&(s.bitMask=a())}catch(c){s.ref&&s.ref.addClass("failedcanvas")}s.renderForeground&&s.renderForeground(),s.updateDragPosition&&s.dragging&&s.updateDragPosition()}else s.blocked=!0}},VectorShape.prototype.renderForeground=function(){if(this.textlib){this.ref.addClass("textlib");var t=this.textlib.children("textdata").children("vartext").first().text();!t&&this.textlib.children("textdata").attr("lmstext")&&(t=this.textlib.children("textdata").attr("lmstext"),t="<span>"+t+"</span>"),t&&(t=t.replace(/size='(.*?)(pt|)'/gi,"style='font-size:$1pt'"),this.textTemplate=t=t.replace(/pt'/gi,"px'"),this.renderTextTemplate())}else this.hasImagelib&&(this.image||(this.image=new Image,this.image.src=this.content.src),this.ref.css("background","url("+escape(this.image.src)+")"),this.ref.removeClass("failedcanvas"))};var Audio=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="audio",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml=""};Audio.prototype=new StageItem,Audio.prototype.objectType="Item",Audio.prototype.innerType="audio",Audio.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,Audio.prototype.GetResumeData=function(){var t="";return this.slide.resume&&(t=0,this.syncToTimeline&&(t+=1),this.playing&&(t+=2),(this.playing||this.m_bResumeOnSeek)&&(t+=4),t=t.toString()),t},Audio.prototype.SetResumeData=function(t){0<t.length&&(t=parseInt(t,10),this.syncToTimeline=(1&t)>0,this.m_bResumeOnSeek=(4&t)>0)},Audio.prototype.loadFromXML=function(t,e,i){this.parent=i?i:e,this.slide=e,this.layer=i,this.children={},this.id=$(t).attr("id"),this.xml=t,this.loadElementInfoFromXML(t),this.content.src=player.basepath+$(t).attr("url"),this.content.duration=parseInt($(t).attr("duration")),e&&e.clips&&e.clips.push&&e.clips.push(this),i&&i.clips&&i.clips.push&&(i.clips.push(this),this.layered=!0),this.resource||(this.resource=this.createResource(this.slide,this.content.src))},Audio.prototype.createRef=function(){if(this.ref)return!1;var t=this;return this.container=$(document.body),this.ref=$('<audio preload="auto"><source src="'+t.content.src+'"/></audio>'),this.ref.attr("src",t.content.src),this.container.append(this.ref),this.ref.get(0).item=this,this.ref.bind("canplay",function(){player.blocked&&(player.currentSlide().currentIndex+=1,t.canPlayThrough=!0,player.unblock())}),this.ref.bind("timeupdate",function(){4==t.ref.get(0).readyState&&player.blocked&&(player.currentSlide().currentIndex+=1,t.canPlayThrough=!0,player.unblock())}),this.ref.bind("error",function(){t.canPlayThrough=!0,player.unblock()}),this.ref.bind("ended",function(){(t.slide==player.currentSlide()||t.slide==player.currentWindowSlide)&&t.handleEvent("onmediacomplete")}),this.ref.bind("play",function(){if(!isNaN(t.correctedPosition)&&t.shouldSetPosition)try{t.setCurrentTime(t.correctedPosition),t.shouldSetPosition=!1}catch(e){}}),!0},Audio.prototype.destroyRef=function(){},Audio.prototype.renderCallback=function(){},Audio.prototype.render=function(){},Audio.prototype.reset=function(t,e){this.currentTime=0,Element.prototype.reset.call(this,t,e)},Audio.prototype.prep=function(){if(player.isIOS){var t=this;if(this.id!=player.nextPreparedClipID){var e=!1;$("audio,video").each(function(i,r){!r.paused&&!r.ended&&(r.item.slide!=t.slide?r.pause():e=!0)}),e||(this.ref.get(0).load(),this.prepared=!0,player.nextPreparedClipID=this.id)}}},Audio.prototype.getTimelineAncestor=function(){for(var t=this.parent,e=4;t&&0<e--;){if("Layer"==t.innerType||"Slide"==t.innerType)return t;t=this.parent}return this.slide},Audio.prototype.playClip=function(){if(this.ref&&this.ref.get&&this.ref.get(0)&&this.ref.get(0).play){var t=this.layer?this.layer:player.activeTimeline;if(!isNaN(player.currentClipStartTime)&&(!isNaN(this.lastStartTime)&&this.m_bResumeOnSeek&&this.syncToTimeline||player.currentClipSyncToTimeline&&player.currentClip==this)&&(this.currentTime=(t.currentTime-player.currentClipStartTime)/1e3),0>this.currentTime||1e3*this.currentTime>=this.content.duration)return!1;if(this.syncToTimeline=!(StoryEvent.currentEvent&&StoryEvent.currentEvent.isUserInitiated)||player.currentClipSyncToTimeline&&player.currentClip==this,this.lastStartTime=isNaN(player.currentClipStartTime)?player.activeTimeline.currentTime:player.currentClipStartTime,(t=this.ref.get(0))&&t.play){if(this.currentTime!=t.currentTime)try{t.currentTime=this.currentTime}catch(e){}t.play()}}},Audio.prototype.pauseClip=function(t){if(this.ref&&this.ref.get&&this.ref.get(0)&&this.ref.get(0).pause){var e=this.ref.get(0),i=!e.ended&&!e.paused;e&&e.pause&&e.pause(),i&&t&&this.handleEvent("onmediacomplete")}},Audio.prototype.setCurrentTime=function(t){this.ref&&this.ref.get&&this.ref.get(0)&&(this.ref.get(0).currentTime=t)},Audio.prototype.getScheduled=function(){return this.ref&&this.ref.get&&this.ref.get(0)?this.ref.get(0).scheduled:!1},Audio.prototype.setScheduled=function(t){this.ref&&this.ref.get&&this.ref.get(0)&&(this.ref.get(0).scheduled=t)},Audio.prototype.getClip=function(){return this.ref&&this.ref.get&&this.ref.get(0)?this.ref.get(0):null},Audio.prototype.getIsPlaying=function(){return this.ref&&this.ref.get&&this.ref.get(0)?!this.ref.get(0).paused&&!this.ref.get(0).ended:!1};var Video=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.storedRef=this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="video",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml=""};Video.refStore={},Video.prototype=new StageItem,Video.prototype.objectType="Item",Video.prototype.innerType="video",Video.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,Video.prototype.loadFromXML=function(t,e,i){this.slide=e,this.layer=i,this.children={},this.innerType=this.type="video",this.id=$(t).attr("id"),this.xml=t,this.loadElementInfoFromXML(t),this.loadSizeFromXML(t),this.canSimplify=!1,this.content.src=player.basepath+$(t).find("videodata").attr("url"),this.content.autoplay="true"==$(t).attr("autoplay"),this.content.showcontrols="true"==$(t).attr("showcontrols"),this.content.autorewind="true"==$(t).attr("autorewind"),this.content.loop="true"==$(t).attr("loop"),this.content.captureanimation="true"==$(t).attr("captureanimation"),this.content.poster=player.basepath+$(t).find("videodata").attr("poster"),this.content.hasPoster=""!=$(t).find("videodata").attr("poster"),player.usePlaceholderVideo&&(this.content.src="/aomock/DocumentHandler.ashx?mimetype=video/mp4&url=/test/video_3.mp4"),this.content.src=this.content.src.replace(".flv",".mp4"),this.showPlaceholder=-1<this.content.src.indexOf(".swf"),this.directParent&&"Layer"==this.directParent.innerType&&(i=this.directParent),e&&e.clips&&e.clips.push&&e.clips.push(this),i&&i.clips&&i.clips.push&&(i.clips.push(this),this.layered=!0),this.resource||(this.resource=this.createResource(this.slide,this.content.src)),this.canSimplify=!1},Video.prototype.createBaseRef=StageItem.prototype.createRef,Video.prototype.destroyBaseRef=StageItem.prototype.destroyRef,Video.prototype.createRef=function(){if(!this.parent.ref)return this.parent.createRef(),!1;if(this.container=this.parent.ref,this.ref)return!1;var t=this,e=Video.refStore[Video.getStoreReference(this.slide,this.content.src)];if(e){if(this.ref=e,this.refInitialized||this.ref.hasClass("initialized")){this.container.append(this.ref);try{this.ref.get(0).currentTime=0}catch(i){}return!1}}else this.ref=$('<video class="item"><source src="'+t.content.src+'"/></video>'),this.ref.attr("src",t.content.src);return this.ref.addClass(this.type),this.ref.addClass("initialized"),this.content.showcontrols&&this.ref.attr("controls","controls"),this.ref.attr("poster",this.content.poster),(player.noVideo||this.showPlaceholder)&&(this.content.hasPoster||(this.ref=$('<div class="item video unsupported"><h1>Not Supported</h1>Flash content is not supported in the HTML5 player.</div>'),this.ref.addClass(this.type)),this.playClip=function(){player.blockedOn=null,player.unblock(),t.handleEvent("onmediacomplete")},this.ref.get(0).play=this.playClip,this.ref.get(0).load=function(){},this.ref.get(0).pause=function(){}),this.content.captureanimation&&(player.suppressCaptureAnimations||player.isIOS)&&(t.isSuppressedCaptureAnimation=!0,this.ref=$('<div class="item video captureanimation"></div>'),this.playClip=function(){player.blockedOn=null,player.unblock(),t.handleEvent("onmediacomplete")},this.ref.get(0).play=this.playClip,this.pauseClip=function(){},this.ref.get(0).load=function(){},this.ref.get(0).pause=function(){},this.ref.get(0).src="[captureanimation: no source]"),this.applySize(this.ref),this.container.append(this.ref),this.ref.get(0).item=this,this.ref.bind("canplay",function(){t.canPlayThrough=!0,player.blocked&&player.blockedOn==t&&player.unblock()}),this.ref.bind("timeupdate",function(){4==t.ref.get(0).readyState&&(t.canPlayThrough=!0,player.blocked&&player.blockedOn==t&&player.unblock())}),this.ref.bind("error",function(){t.canPlayThrough=!0,player.blocked&&player.blockedOn==t&&player.unblock()}),this.ref.bind("ended",function(){t.handleEvent("onmediacomplete")}),this.ref.bind("play",function(){if(!isNaN(t.correctedPosition)&&t.shouldSetPosition)try{t.setCurrentTime(t.correctedPosition),t.shouldSetPosition=!1}catch(e){}}),this.refInitialized=!0},Video.prototype.destroyRef=function(){if(this.pauseClip(),this.ref&&this.ref.get&&this.ref.get(0)&&!Video.refStore[Video.getStoreReference(this.slide,this.content.src)]){Video.refStore[Video.getStoreReference(this.slide,this.content.src)]=this.ref;try{this.ref.get(0).currentTime=0}catch(t){}this.ref.hide(),this.ref.remove()}this.ref=null},Video.prototype.renderCallback=function(){},Video.prototype.render=function(){},Video.prototype.showBase=StageItem.prototype.show,Video.prototype.show=function(t,e,i){if(this.showBase(t,e,i),this.slide==player.currentSlide()&&!player.noVideo)if(this.showPlaceholder)this.handleEvent("onmediacomplete");else{var r=this;if((r.content.autoplay||"StoryEvent"==t.type)&&(player.playing||player.layerPlaying)){var n=r.getTimelineAncestor().currentTime-t.time;if(r.ref&&r.ref.get&&r.ref.get(0)){var a=r.ref.get(0);this.isSuppressedCaptureAnimation?r.playClip():(this.syncToTimeline=!(StoryEvent.currentEvent&&StoryEvent.currentEvent.isUserInitiated)||player.currentClipSyncToTimeline&&player.currentClip==this,this.lastStartTime=isNaN(player.currentClipStartTime)?player.activeTimeline.currentTime:player.currentClipStartTime,clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=a.src,player.mediaTimeout=setTimeout(function(){player.mediaTimeout=null,player.scheduledMediaSrc=null,r.playClip(),player.currentClip=a,player.currentClipStartTime=t.time,player.currentClipSyncToTimeline="TimelineEvent"==t.type;try{r.setCurrentTime(n/1e3)}catch(e){}},0))}}}},Video.prototype.prep=function(){player.isIOS&&this.id!=player.nextPreparedClipID&&this.ref&&this.ref.get&&this.ref.get(0)&&(this.ref.get(0).load(),this.prepared=!0,player.nextPreparedClipID=this.id)},Video.prototype.getTimelineAncestor=Audio.prototype.getTimelineAncestor,Video.extractZeroTimeAutoPlayEvent=function(t){if(!player.isIOS||0!=t.time)return null;for(var e=0;e<t.actions.length;e++){var i=t.actions[e],r=i.parentElement.parseObjref(i.originalItemID).target;if("show"==i.type&&"video"==r.innerType)return i=new TimelineEvent(i.parentElement),i.actions.push(t.actions.splice(e,1)[0]),i.time=1,i}return null},Video.prototype.playClip=function(){this.ref&&this.ref.get&&this.ref.get(0)&&this.ref.get(0).play&&this.ref.get(0).play()},Video.prototype.pauseClip=function(){this.ref&&this.ref.get&&this.ref.get(0)&&this.ref.get(0).pause&&this.ref.get(0).pause()},Video.prototype.setCurrentTime=function(t){this.ref&&this.ref.get&&this.ref.get(0)&&(this.ref.get(0).currentTime=t)},Video.prototype.mediaReady=function(){return this&&this.ref&&this.ref.get(0)&&4==this.ref.get(0).readyState?!0:!1},Video.prototype.getScheduled=function(){return this.ref&&this.ref.get&&this.ref.get(0)?this.ref.get(0).scheduled:!1},Video.prototype.setScheduled=function(t){this.ref&&this.ref.get&&this.ref.get(0)&&(this.ref.get(0).scheduled=t)},Video.prototype.getClip=function(){return this.ref&&this.ref.get&&this.ref.get(0)?this.ref.get(0):null},Video.prototype.getIsPlaying=function(){return this.ref&&this.ref.get&&this.ref.get(0)?!this.ref.get(0).paused&&!this.ref.get(0).ended:!1},Video.prototype.isPointObscured=function(t,e,i,r){var n=this.matrix.unTransformPoint(t,e);return this.content.showcontrols&&n.y>this.height-35?!0:StageItem.prototype.isPointObscured.call(this,t,e,i,r)},Video.getStoreReference=function(t,e){return t.getFullObjref()+":"+e};var LinkArea=function(t,e,i,r){this.textid=r,this.linkdy=this.linkdx=0,this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement()};LinkArea.prototype=new VectorShape,LinkArea.prototype.innerType="LinkArea",LinkArea.prototype.objectType="Item",LinkArea.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,LinkArea.prototype.renderBase=VectorShape.prototype.render,LinkArea.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),e=$(t).children("textdata").children("vectortext").children("pr"),1==e.length&&(t=$(t).children("textdata").children("vectortext"),null!=$(t).attr("top")&&(this.originalRectShape=this.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom")))),1==e.length&&(this.content.path=PathLib.getPathFromXML(e))),this.type="LinkArea"},LinkArea.prototype.createRef=function(){return!0},LinkArea.prototype.render=function(t){switch(t){case"onrollover":new ppTextLib(this.xml),this.parent.render(this.parent.lastRenderedState,!0,null,"LinkArea render",!1,this.id);break;case"onrollout":this.parent.render(null,!0)}},LinkArea.prototype.handleIfOver=function(t,e,i){return e=this.parent.getCanvasPoint(e.x,e.y),e.x>this.xpos+this.linkdx&&e.x<this.xpos+this.linkdx+this.width&&e.y>this.ypos+this.linkdy&&e.y<this.ypos+this.linkdy+this.height?(i&&this.isMouseOver||(this.isMouseOver=!0,this.parent.handleEvent(t,this.id,null,!1,!1,!0),this.render(t)),!0):!1},LinkArea.prototype.handleIfOut=function(t,e){var i=this.parent.getCanvasPoint(e.x,e.y);return i.x>this.xpos+this.linkdx&&i.x<this.xpos+this.linkdx+this.width&&i.y>this.ypos+this.linkdy&&i.y<this.ypos+this.linkdy+this.height?!1:(this.isMouseOver&&(this.isMouseOver=!1,this.parent.handleEvent(t,this.id,null,!1,!1,!0),this.render(t)),!0)};var TextInput=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.content={fontsize:18,font:"Arial"},this.constructElement(),this.events=[],this.active=!0,this.visible=!1,this.clickFocus=!0};TextInput.prototype=new StageItem,TextInput.prototype.innerType="TextInput",TextInput.prototype.objectType="Item",TextInput.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,TextInput.prototype.showBase=StageItem.prototype.show,TextInput.prototype.hideBase=StageItem.prototype.hide,TextInput.prototype.extractNextSpecialVar=function(t){t=bwChunk.DecodeString(t),this.variables.Text=t,this.ref&&this.input&&(this.input[0].value=t)},TextInput.prototype.getExtraResumeVars=function(){var t="";return this.variableResumes.VAR_TEXT=!0,this.variableDefaults.VAR_TEXT=t,this.variableTypes.VAR_TEXT="string",this.ref&&this.input&&(t=this.input[0].value),{VAR_TEXT:t}},TextInput.prototype.loadFromXML=function(t,e,i){this.content.numeric="true"==$(t).attr("numeric"),this.content.multiline="true"==$(t).attr("multiline"),this.content.maxchars=parseInt($(t).attr("maxchars")),this.content.fontsize=$(t).attr("fontsize"),this.content.textcolor=$(t).attr("textcolor").replace("0x","#"),this.content.bold="true"==$(t).attr("bold"),this.content.font=$(t).attr("font"),this.bindto=$(t).attr("bindto"),this.content.instructionText="";var r=$(t).children("data").children("textdata").text();""!=r?this.content.instructionText=$(r).text():this.content.numeric||(this.content.instructionText="type your text here");var r=$(t).children("background").children("vectordata").children("path"),n=$(t).children("background").children("vectordata").children("pr");if(1==r.length||1==n.length){var a=$(t).children("background").children("vectordata");null!=$(a).attr("top")&&(this.originalRectShape=this.rectShape=new ppRect(parseInt($(a).attr("left")),parseInt($(a).attr("top")),parseInt($(a).attr("right")),parseInt($(a).attr("bottom")))),this.content.path=1==n.length?PathLib.getPathFromXML(n):r.text()}this.loadBaseFromXML(t,e,i),this.updateMatrixComplete(),this.type="textinput",this.variables.Text=""},TextInput.prototype.validate=function(){var t=this.input.get(0).value;return this.content.numeric&&!t.match(/^-?([0-9]*\.|)[0-9]*$/)?!1:(!isNaN(this.content.maxchars)&&0<this.content.maxchars&&t.length>this.content.maxchars&&(this.input.get(0).value=t.substr(0,this.content.maxchars)),!0)},TextInput.prototype.createRef=function(){if(this.ref)return!1;var t=this;this.container=this.parent.ref,this.ref=$('<div class="item textinput interactive"></div>'),this.applySize(this.ref),this.container.append(this.ref);var e=this.content.multiline?$("<textarea>"):$("<input type='text'>");e.css("font-size",this.content.fontsize+"px"),e.css("font-family",this.content.font+",Arial,Sans-Serif"),e.css("color",this.content.textcolor),e.attr("size",this.content.maxchars),e.attr("placeholder",this.content.instructionText),""!=this.variables.Text&&(e.get(0).value=this.variables.Text);var i=$("<canvas></canvas>");return i.css("position","absolute"),this.ref.append(i),this.canvas=i.get(0),this.ref.append(e),this.input=e,this.input.get(0).item=this,"true"==this.variables._disabled&&(this.input.get(0).disabled=!0),this.ref.addClass("interactive"),this.contentRef=this.ref,this.ref.get(0).item=this,t.input.bind("change",function(){t.variables.Text=this.value}),t.input.bind("keydown",function(e){var i=t.input.get(0),r=i.value;setTimeout(function(){if(player.iOSKeyboardFault)switch(e.keyCode){case 8:0<i.value.length&&(i.value=i.value.substr(0,i.value.length-1))}t.validate(i.value)||(i.value=r),t.variables.Text=i.value,t.bindto&&""!=t.bindto&&t.setVariable(t.bindto,i.value)},0)}),player.isIOS&&window!=top&&t.input.bind("keypress",function(e){var i=this,r=i.value;setTimeout(function(){var n=r+String.fromCharCode(e.charCode);i.value==r&&n.length>r.length&&n!=r&&t.validate(n)&&(player.iOSKeyboardFault=!0,1<n.length&&n.substr(1,1).toLowerCase()!=n.substr(1,1)&&(n=n.substr(0,1)+n.substr(1,1).toLowerCase()+n.substr(2)),i.value=n,i.focus())},0)}),t.input.bind("blur",function(){t.handleEvent("onlosefocus",null,null,!1,!1,!0)}),t.bindto&&""!=t.bindto&&(t.bindVarListener(t.bindto).act(t,!1),t.variables.Text=this.input.get(0).value),t.renderBackground("",!0,null,"textinput createref"),!0},TextInput.prototype.renderBackground=VectorShape.prototype.render,TextInput.prototype.render=function(){if(this.bindto&&""!=this.bindto){var t=this.extractVariable(this.bindto);t!=this.input.get(0).value&&(this.input.get(0).value=t),this.variables.Text=t}},TextInput.prototype.applySize=function(t){t.css("left",this.x+"px"),t.css("top",this.y+"px"),t.css("width",this.width+"px"),t.css("height",this.height+"px"),"Layer"!=this.innerType&&"ExpandingLabel"!=this.innerType&&0<this.depth&&t.css("z-index",this.depth),$(this.canvas).css("left",this.xoffset+"px"),$(this.canvas).css("top",this.yoffset+"px"),0!=this.rotation&&(t.css("-webkit-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-webkit-transform","rotate("+this.rotation+"deg)"),t.css("-moz-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-moz-transform","rotate("+this.rotation+"deg)"),t.css("-o-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-o-transform","rotate("+this.rotation+"deg)"),t.css("-ms-transform-origin",this.rotatexpos-this.xoffset+"px "+(this.rotateypos-this.yoffset)+"px"),t.css("-ms-transform","rotate("+this.rotation+"deg)"),this.canSimplify=!1)};var DragItem=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="textfield",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.fillet=10,this.lastRenderedState="none",this.snapy=this.snapx=0,this.multidrop=this.dragreturn=!0,this.dropoffsety=this.dropoffsetx=0,this.canvas=null,this.m_nYOffset=this.m_nXOffset=0,this.height=this.width=1e3,this.downY=this.downX=this.dragY=this.dragX=0,this.dropArea=null,this.dragDropIDs={global:!0},this.dragOverIDs={global:!0},this.currentlyOver={},this.isDragItem=!0};DragItem.prototype=new Item,DragItem.prototype.objectType="Item",DragItem.prototype.innerType="Item",DragItem.prototype.extractNextSpecialVar=function(t){(t=this.getItemByResumeIndex(t))&&(this.dropArea=t,this.dropArea.variables.DragConnectData=this.connectdata,"wordbank"==this.style&&(this.originalParent=this.parent,this.parent=this.dropArea.parent,this.x=this.dropArea.x,this.y=this.dropArea.y,this.depth=++this.slide.topZ,this.updateMatrixComplete(!0)))},DragItem.prototype.getExtraResumeVars=function(){var t=-1;return this.variableResumes.VAR_SELECTED_ITEM=!0,this.variableDefaults.VAR_SELECTED_ITEM=-1,this.variableTypes.VAR_SELECTED_ITEM="number",this.dropArea&&(t=this.dropArea.getItemIndex()),{VAR_SELECTED_ITEM:t}},DragItem.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,DragItem.prototype.toBaseData=Element.prototype.toData,DragItem.prototype.toData=function(t){return t=this.toBaseData(t),t.x=this.x,t.y=this.y,this.depth!=this.originalZ&&(t.depth=this.depth),t},DragItem.prototype.updateBaseFromData=Element.prototype.updateFromData,DragItem.prototype.updateFromData=function(t,e){this.updateBaseFromData(t,e),e||(isNaN(parseInt(t.x))||(this.x=parseInt(t.x)),isNaN(parseInt(t.y))||(this.y=parseInt(t.y)),t.depth&&(this.depth=t.depth,this.depth>this.slide.topZ)&&(this.slide.topZ=this.depth),this.updateMatrixComplete(!0)),t.variables&&t.variables.DropTargetId&&(this.dropArea=this.parent.children[t.variables.DropTargetId],!this.dropArea)&&(this.dropArea=this.slide.findDescendantById(t.variables.DropTargetId)),this.ref&&this.updatePosition()},DragItem.prototype.resetBase=Element.prototype.reset,DragItem.prototype.reset=function(t){this.resetBase(t),t||(this.x=this.originalX,this.y=this.originalY,this.shuffled&&(this.x=this.shuffleX,this.y=this.shuffleY),this.xoffset=this.originalXOffset||0,this.yoffset=this.originalYOffset||0,this.dragY=this.dragX=0,this.dropArea=null,this.updatePosition(),isNaN(this.x)&&(this.x=this.originalX,this.y=this.originalY))},StageItem.prototype.convertToDragItem=function(t){switch(this.toBaseData=DragItem.prototype.toBaseData,this.toData=DragItem.prototype.toData,this.updateBaseFromData=DragItem.prototype.updateBaseFromData,this.updateFromData=DragItem.prototype.updateFromData,this.resetBase=DragItem.prototype.resetBase,this.reset=DragItem.prototype.reset,this.initDrag=DragItem.prototype.initDrag,this.mousedown=DragItem.prototype.mousedown,this.mousemove=DragItem.prototype.mousemove,this.mouseup=DragItem.prototype.mouseup,this.fixPositionEvent=DragItem.prototype.fixPositionEvent,this.updateDragPosition=DragItem.prototype.updateDragPosition,this.testOverlap=DragItem.prototype.testOverlap,this.findDropArea=DragItem.prototype.findDropArea,this.dock=DragItem.prototype.dock,this.undock=DragItem.prototype.undock,this.updatePosition=DragItem.prototype.updatePosition,this.reParent=DragItem.prototype.reParent,this.getExtraResumeVars=DragItem.prototype.getExtraResumeVars,this.parseDragGroupsFromXML=DropArea.prototype.parseDragGroupsFromXML,this.extractNextSpecialVar=DragItem.prototype.extractNextSpecialVar,this.lastRenderedState="none",this.currentlyOver={},this.innerType){case"textfield":case"image":break;case"ItemGroup":case"StateGroup":this.render=function(){},$.each(this.children,function(){});break;default:this.render=VectorShape.prototype.render}this.droptype=$(t).children("dragdrop").attr("droptype"),this.snapx=parseInt($(t).children("dragdrop").attr("snapx")),this.snapy=parseInt($(t).children("dragdrop").attr("snapy")),this.dragreturn="true"==$(t).children("dragdrop").attr("dragreturn"),this.multidrop="true"==$(t).children("dragdrop").attr("multidrop"),
this.dropoffsetx=parseInt($(t).children("dragdrop").attr("dropoffsetx")),this.dropoffsety=parseInt($(t).children("dragdrop").attr("dropoffsety")),this.originalX=this.x,this.originalY=this.y,this.downY=this.downX=this.dragY=this.dragX=0,this.parseDragGroupsFromXML(t),this.isDragItem=!0},StageItem.prototype.convertRefToDragItem=function(){this.ref.addClass("dragitem"),this.setInteractive()},DragItem.prototype.bustScrollAreas=function(){},DragItem.initialized=!1,DragItem.init=function(){DragItem.initialized=!0,DragItem.cargo=null;var t=function(t){DragItem.cargo&&(DragItem.cargo.mousemove(t),t.preventDefault())},e=function(t){DragItem.cargo&&(DragItem.cargo.mouseup(t),t.preventDefault())};player.isIOS?($(document.body).bind("touchmove",t),$(window).bind("touchend",e)):($(document.body).bind("mousemove",t),$(window).bind("mouseup",e))},DragItem.cancelDrag=function(){DragItem.cargo&&(DragItem.cargo.dragging=!1),DragItem.cargo=null,$(".item").removeClass("dragging")},DragItem.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.parseDragGroupsFromXML(t),this.style=$(t).attr("style"),this.connectdata=$(t).attr("connectdata"),this.reviewdata=$(t).attr("reviewdata"),this.width=parseInt($(t).attr("width")),this.height=parseInt($(t).attr("height")),this.originalX=this.x,this.originalY=this.y,this.alttext=$(this.xml).find("textdata").attr("alttext"),"wordbank"!=this.style||this.colors.hover||(e=new Background(this.ref),e.rotation="90",e.fillType="linear",e.stops.push(e.parseStop('<color rgb="0xBBF8FB" alpha="100" stop="0" />')),e.stops.push(e.parseStop('<color rgb="0xA5E8EB" alpha="100" stop="100" />')),this.colors.hover=e),this.variables.DropTargetId="",e=$(t).children("data").children("textdata"),t=$(t).children("data").children("textdata").children("vectortext"),i=t.children("pr"),1==i.length&&(this.textSprite={canvas:null,m_nXOffset:0,m_nYOffset:0,width:1e3,height:1e3,charIndex:0,maxCharIndex:0,vectorHot:!1,isShapeMask:!1},null!=$(t).attr("top")&&(this.textSprite.x=$(e).attr("xpos"),this.textSprite.y=$(e).attr("ypos"),this.textSprite.width=$(e).attr("width"),this.textSprite.height=$(e).attr("height"),this.textSprite.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom"))),this.textSprite.rectShape.right=Math.max(this.textSprite.rectShape.right,this.width),this.textSprite.rectShape.bottom=Math.max(this.textSprite.rectShape.bottom,this.height),this.textSprite.originalRectShape=this.rectShape),this.textSprite.path=PathLib.getPathFromXML(i)),this.canSimplify=!1},DragItem.prototype.parseDragGroupsFromXML=function(t){var e=$(t).children("dragdrop").children("dragoverids").children("dragoverid"),t=$(t).children("dragdrop").children("dragdropids").children("dragdropid");if(0==e.length&&0==t.length)this.dragDropIDs={global:!0},this.dragOverIDs={global:!0};else{this.dragDropIDs={},this.dragOverIDs={};var i=this;e.each(function(t,e){var r=$(e).text();i.dragOverIDs[r]=!0}),t.each(function(t,e){var r=$(e).text();i.dragDropIDs[r]=!0})}},DragItem.prototype.initDrag=function(){this.canSimplify=!1,DragItem.initialized||DragItem.init()},DragItem.prototype.createBaseRef=StageItem.prototype.createRef,DragItem.prototype.createRef=function(){if(this.ref)return this.render(null,!0),!1;if(!this.createBaseRef())return!1;this.ref.addClass("dragitem"),this.setInteractive();var t=$("<canvas></canvas>");t.attr("width",this.width),t.attr("height",this.height),t.css("position","absolute"),this.ref.append(t);var e=$("<canvas></canvas>");if(e.attr("width",this.width),e.attr("height",this.height),e.css("margin","0 0 0 "+2*this.fillet+"px"),e.css("position","absolute"),this.ref.append(e),this.textSprite){var i=$("<canvas></canvas>");i.css("position","absolute"),i.css("left",this.textSprite.x+"px"),i.css("top",this.textSprite.y+"px"),i.attr("width",this.width+"px"),i.attr("height",this.height+"px"),i.attr("id",this.id+"_text"),this.ref.append(i),this.textSprite.canvas=i.get(0),this.textRef=i}return this.border=t.get(0),this.canvas=e.get(0),this.initDrag(),this.render(null,!0),!0},DragItem.prototype.renderCallback=function(){this.width=this.originalWidth,this.height=this.originalHeight,this.render(),this.contentRef.css("margin-top",parseInt(this.height/2)-10),this.contentRef.empty(),this.contentRef.text(this.alttext)},DragItem.prototype.render=function(t,e){if(this.ref&&(e||t!=this.lastRenderedState)){this.lastRenderedState=t;var i=this.border.getContext("2d"),r=parseInt(900*Math.random()+1100)%1e3;switch(i.fillStyle="#"+r,i.fillStyle="#fff",i.lineWidth=1,i.strokeStyle="#ccc",r=i.createLinearGradient(0,0,0,this.height),r.addColorStop(0,"#fcfcfc"),r.addColorStop(1,"#eaeaea"),i.fillStyle=r,this.colors[t]&&this.colors[t].applyCanvas(i,this,!0,!1),r=this.fillet,this.style){case"matching":i.beginPath(),i.moveTo(r+.5,.5),i.lineTo(this.width-.5,.5),i.lineTo(this.width-.5,this.height-.5),i.lineTo(r+.5,this.height-.5),i.lineTo(r+.5,this.height-r-.5),i.lineTo(.5,this.height-r-.5),i.lineTo(.5,r+.5),i.lineTo(r+.5,r+.5),i.lineTo(r+.5,.5),i.fill(),i.save(),i.clip(),i.strokeStyle="#fff",i.lineWidth=5,i.stroke(),i.restore(),i.save(),i.lineWidth=1,i.strokeStyle="#ccc",!i.setLineDash||!this.variables.ReviewMode&&this.dropArea||(i.strokeStyle="#aaa",i.setLineDash([1.3])),this.colors[t]&&(i.strokeStyle=this.colors[t].stops[0].color),i.stroke(),i.restore(),this.variables.ReviewMode&&(i.fillStyle="#DB0000",this.dropArea&&this.reviewdata==this.dropArea.reviewdata&&(i.fillStyle="#008520"),r=8,i.beginPath(),i.arc(8.5,8.5,r,0,2*Math.PI),i.fill(),r=6.8,i.beginPath(),i.strokeStyle="rgba(255,255,255,0.6)",i.lineWidth=.8,i.arc(8.4,8.4,r,0,2*Math.PI),i.fill(),i.stroke(),i.fillStyle="#fff",i.font="10px sans-serif",i.textBaseline="top",1<this.reviewdata.length?i.fillText(this.reviewdata,2,2):i.fillText(this.reviewdata,5,2),this.dropArea&&this.dropArea.matchingDragItem!=this&&(this.dropArea.matchingDragItem=this,this.dropArea.variables.ReviewMode=this.variables.ReviewMode,this.dropArea.render(this.dropArea.lastRenderedState,!0)));break;case"wordbank":r=this.height/2,i.beginPath(),i.moveTo(r+.5,.5),i.lineTo(this.width-r-.5,.5),i.arc(this.width-r-.5,r,r-i.lineWidth/2,3*Math.PI/2,Math.PI/2),i.lineTo(r+.5,this.height-.5),i.arc(r+.5,r,r-i.lineWidth/2,Math.PI/2,3*Math.PI/2),i.fill(),i.save(),i.clip(),i.strokeStyle="#fff",i.lineWidth=3.4,i.stroke(),i.restore(),this.variables.ReviewMode&&("1"==this.reviewdata?(i.lineWidth=2,i.strokeStyle="#008520"):this.dropArea&&(i.lineWidth=2,i.strokeStyle="#DB0000")),0!=i.lineWidth&&(this.colors[t]&&(i.strokeStyle=this.colors[t].stops[0].color),i.stroke());break;default:i.fillRect(.5,.5,this.width,this.height-i.lineWidth),i.strokeRect(.5,.5,this.width,this.height-i.lineWidth)}this.textSprite&&(i=new ppTextLib(this.xml),ppArt.itemID=this.id,ppArt.item=this,ppArt.m_bMaskMode=!1,ppArt.DrawVector(this.textSprite,this.textSprite.path,i,player.fontlib,this.imagelib,null,null))}},DragItem.prototype.fixPositionEvent=function(t){if(!t.fixed){t.originalEvent.touches&&(0<t.originalEvent.touches.length?(t.pageX=t.originalEvent.touches[0].pageX,t.pageY=t.originalEvent.touches[0].pageY):(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY)),t.fixed=!0,t.pageX=parseInt(t.pageX/player.currentZoom()),t.pageY=parseInt(t.pageY/player.currentZoom());var e=$(".framewrap").offset(),i=t.pageY-e.top;t.pageX=parseInt((t.pageX-e.left)/player.frameScale+e.left),t.pageY=parseInt(i/player.frameScale+e.top)}},DragItem.prototype.mousedown=function(t){"true"!=this.variables._disabled&&"true"!=this.parent.variables._disabled&&("wordbank"==this.style&&this.dropArea?this.render(""):(this.fixPositionEvent(t),this.downScrollTop=0,this.nearestScrollAreaAncestor?this.downScrollTop=this.nearestScrollAreaAncestor.ref.get(0).scrollTop:"sequence"==this.style&&(this.downScrollTop=this.parent.ref.get(0).scrollTop),this.findAncestorOfType("ScrollArea")&&(this.originalParent=this.parent,this.reParent(this.slide)),this.downX=t.pageX,this.downY=t.pageY,this.lastX=this.x,this.lastY=this.y,this.depth<this.slide.topZ&&(this.originalZ||(this.originalZ=this.depth),this.depth=++this.slide.topZ,this.setZIndex(this.depth)),this.dragStarted=!1,this.dragging=!0,DragItem.cargo=this,this.ref.addClass("dragging"),this.handleEvent("ondragstart",null,null,!1,!1,!0),this.handleEvent("onpress",null,null,!1,!1,!0)))},DragItem.prototype.reParent=function(t){var e=this.findAncestorOfType("ScrollArea"),i=t.findAncestorOfType("ScrollArea"),r=this.parent.ref.offset(),n=t.ref.offset(),a=0,s=0,o=0,l=0;e&&(a=e.ref.get(0).scrollTop,s=e.ref.get(0).scrollLeft,!e.scrollPlaceHolder)&&(e.scrollPlaceHolder=$("<div class='scrollplaceholder'/>"),e.scrollPlaceHolder.css("top",e.ref.get(0).scrollHeight-1),e.scrollPlaceHolder.css("left",e.ref.get(0).scrollWidth-1),e.ref.append(e.scrollPlaceHolder)),i&&(o=i.ref.get(0).scrollTop,l=i.ref.get(0).scrollLeft),e=a-o,s-=l,t.ref.append(this.ref),this.parent=t,this.x+=(r.left-n.left-s)/player.frameScale,this.y+=(r.top-n.top-e)/player.frameScale,this.updateDragPosition()},DragItem.prototype.mousemove=function(t){this.fixPositionEvent(t),this.dragStarted||(this.dragStarted=!0,this.handleEvent("ondragdisconnect",null,null,!1,!0,!1)),this.dragging&&(swipe.moved=!0,this.dragX=t.pageX-this.downX,this.dragY=t.pageY-this.downY,this.updateDragPosition(),this.findDropArea())},DragItem.prototype.mouseup=function(t){this.fixPositionEvent(t),this.dragging=!1,DragItem.cargo=null,$(".item").removeClass("dragging"),this.updateDragPosition(),DragItem.dropArea?(this.dock(DragItem.dropArea),DragItem.dropArea=null,DropArea.update()):(this.undock(),this.dragreturn&&"sequence"!=this.style&&this.originalZ&&this.setZIndex(this.originalZ)),this.setElementProperty("dragX",0,!0),this.setElementProperty("dragY",0,!0),swipe.moved=!1,this.handleEvent("ondragend",null,null,!1,!1,!0),this.handleEvent("onrelease",null,null,!1,!1,!0),this.mouseupCallback&&this.mouseupCallback(t),$.each(this.children,function(t,e){void 0!=e.dragX&&(e.dragX=0,e.dragY=0)}),!this.dropArea&&this.dragreturn?this.originalParent&&this.originalParent!=this.parent&&(this.reParent(this.originalParent),this.updatePosition()):this.dropArea&&this.dropArea.parent!=this.parent&&(this.reParent(this.dropArea.parent),this.updatePosition()),this.updateMatrixComplete(!0)},DragItem.prototype.updateDragPosition=function(){this.ref.css("left",this.x+this.dragX),this.ref.css("top",this.y+this.dragY),this.updateMatrixComplete(!0)},StageItem.prototype.testOverlap=function(t){if(0<$(".modalfence:visible").length)return!1;var e=this;if("ItemGroup"==t.innerType||"StateGroup"==t.innerType){var i=!1;return $.each(t.children,function(t,r){i=i||e.testOverlap(r)}),i}return"ItemGroup"==e.innerType||"StateGroup"==e.innerType?(i=!1,$.each(e.children,function(r,n){n.testOverlap&&(n.setElementProperty("dragX",e.dragX,!0),n.setElementProperty("dragY",e.dragY,!0),i=i||n.testOverlap(t))}),i):this.testRotatedOverlap(t)},VectorShape.prototype.getCanvasPoint=function(t,e){return this.matrix.unTransformPoint(t,e)},StageItem.prototype.isPointActive=function(t,e){return this.visible?this.testOver(t,e):!1},VectorShape.prototype.isPointActive=function(t,e){var i=this.getCanvasPoint(t,e),r=this.getBitMask();return 0>=i.x||0>=i.y||i.x>=this.canvas.width||i.y>=this.canvas.height?!1:(r=r.isPointActive(i.x,i.y),BitMask.showDebug&&player.monitoringItem==this&&"_default_Hover"==this.lastRenderedState&&(BitMask.testCanvas||(BitMask.testCanvas=$("<canvas id='test' width='1000' height='1000' style='position:absolute;z-index:200;left:0px;top:0px;'></canvas>"),$(document.body).append(BitMask.testCanvas),BitMask.testContext=BitMask.testCanvas.get(0).getContext("2d"),BitMask.testContext.fillStyle="rgba(255,255,0,0.5)"),BitMask.testCanvas.show(),clearTimeout(BitMask.testCanvasClear),BitMask.testCanvasClear=setTimeout(function(){BitMask.testCanvas.hide()},1e3),BitMask.testContext.clearRect(0,0,1e3,1e3),this.getBitMask().drawDebug(BitMask.testCanvas.get(0)),BitMask.testContext.fillStyle=r?"rgba(0,255,0,1)":"rgba(255,0,0,1)",BitMask.testContext.fillRect(i.x-2,i.y-2,4,4)),r)},StageItem.prototype.isAbove=function(t){for(var e=this;e;){for(var i=t;i;){if(i.parent==e.parent)return e.depth>i.depth;i=i.parent}e=e.parent}return!1},StageItem.prototype.isPointObscured=function(t,e,i,r){var n=this,a=!1;return n.slide.deepEach(function(s,o){if(!a&&o!=n&&o!=i&&o.isAbove&&o.isAbove(n)&&o.isPointActive(t,e)&&(!i||!i.isAncestor(o)))if("ScrollArea"==o.innerType){o.isAncestor(n);var l=o.ref.get(0).scrollTop;a=o.isPointActive(t,e-l,i,r)}else o.nearestScrollAreaAncestor&&o.nearestScrollAreaAncestor!=n.nearestScrollAreaAncestor?(l=o.nearestScrollAreaAncestor.ref.get(0).scrollTop,a=o.isPointActive(t,e-l)):a=!0},function(t){var e=r&&r(t);return t!=n&&t.visible&&t!=i&&!e}),a},DragItem.prototype.findDropArea=function(){var t=this,e=null,i=1e5;return $.each(t.slide.ref.find(".droparea"),function(r,n){if(n.item&&util.hasMutualKey(n.item.dragDropIDs,t.dragDropIDs)&&t.testOverlap(n.item)){var a=t.slideX()+t.dragX,s=t.slideY()+t.dragY,a=Math.sqrt(Math.pow(a-n.item.slideX(),2)+Math.pow(s-n.item.slideY(),2));i>a&&(e=n.item,i=a)}}),t.variables.DragOverId="",$.each(t.slide.ref.find(".dragover"),function(e,i){i.item&&util.hasMutualKey(i.item.dragOverIDs,t.dragOverIDs)&&t.testOverlap(i.item)?(t.variables.DragOverId=i.item.id,t.currentlyOver[i.item.id]||t.handleEvent("ondragover",null,null,!1,!1,!0),t.currentlyOver[i.item.id]=!0):t.currentlyOver[i.item.id]=!1}),DragItem.dropArea=e,DropArea.update(),e},DragItem.prototype.swapPositionsWith=function(t){var e=this.y;this.y=t.y,t.y=e,this.ref.css("top",this.y+"px"),t.ref.css("top",t.y+"px")},DragItem.prototype.updatePosition=function(){var t=this.fillet||0;if(this.dropArea)switch(this.dropArea.droptype){case"matching":this.x=this.dropArea.x+this.dropArea.width-t;break;case"snap":this.x=this.dropArea.x+this.dropArea.snapx-this.snapx+this.xoffset-this.dropArea.xoffset,this.y=this.dropArea.y+this.dropArea.snapy-this.snapy+this.yoffset-this.dropArea.yoffset;break;case"tile":break;case"free":void 0==this.lastX&&(this.lastX=this.x,this.lastY=this.y),this.x=this.dragX+this.lastX,this.y=this.dragY+this.lastY,this.lastX=this.x,this.lastY=this.y;break;case"stackoffset":break;case"stackrandom":void 0==this.randx&&(this.randx=Math.random(),this.randy=Math.random(),1==this.dropArea.dockedItemCount)&&(this.randy=this.randx=.5);var t=parseInt(2*this.randx*this.dropArea.dropoffsetx)-this.dropArea.dropoffsetx,e=parseInt(2*this.randy*this.dropArea.dropoffsety)-this.dropArea.dropoffsety;this.x=this.dropArea.x+this.dropArea.snapx-this.snapx+t+this.xoffset-this.dropArea.xoffset,this.y=this.dropArea.y+this.dropArea.snapy-this.snapy+e+this.yoffset-this.dropArea.yoffset;break;case"wordbank":this.slideY(),this.x=this.dropArea.x+this.x-this.slideX()+this.dropArea.x-this.dropArea.slideX(),this.y=this.dropArea.y+this.y-this.slideY()+this.dropArea.y-this.dropArea.slideY();break;default:this.x=this.dropArea.x,this.y=this.dropArea.y}else this.dragreturn?this.shuffled&&"sequence"!=this.style?(this.x=parseInt(this.shuffleX)+this.xoffset,"matching"!=this.style&&(this.y=parseInt(this.shuffleY)+this.yoffset)):(this.x=parseInt(this.originalX)+this.xoffset,"matching"!=this.style&&(this.y=parseInt(this.originalY)+this.yoffset)):(this.x+=this.dragX,this.y+=this.dragY);this.ref&&(this.ref.css("left",this.x+"px"),this.ref.css("top",this.y+"px")),this.updateMatrixComplete(!0)},DragItem.prototype.undock=function(t){this.dropArea&&(this.dropArea.variables.DragConnectData="",this.dropArea.dockedItemCount--,this.dropArea.dragItem=null),this.variables.DropTargetId="",t||(this.dropArea=null,this.dragreturn&&this.originalParent&&this.originalParent!=this.parent&&this.reParent(this.originalParent),this.updatePosition(),DropArea.unstackItem(this),DropArea.update())},DragItem.prototype.dock=function(t){var e=this;"matching"==e.style?$.each(e.slide.ref.find(".dragitem"),function(i,r){var n=r.item;n&&n!=e&&n.y==t.y&&(e.reParent(n.parent),e.swapPositionsWith(n),n.undock())}):"wordbank"==e.style&&$.each(e.slide.ref.find(".dragitem"),function(t,i){var r=i.item;r&&r!=e&&r.undock()}),this.dropArea&&this.undock(!0),t.variables.DragConnectData=this.connectdata,t.dragItem=this,t.dockedItemCount++,e.variables.DropTargetId=t.id,e.dropArea=t,DropArea.unstackItem(this,e.dropArea),e.updatePosition(),e.render(e.lastRenderedState),t&&(!t.multidrop&&0<t.dockedItemCount&&$.each(e.slide.ref.find(".dragitem"),function(i,r){var n=r.item;n&&n!=e&&n.dropArea==t&&(n.x=parseInt(n.originalX)+n.xoffset,n.y=parseInt(n.originalY)+n.yoffset,n.undock())}),t.findSlot(this),t.updateSlotPositions()),swipe.moved=!1,this.handleEvent("ondragconnect",null,null,!1,!1,!0),t.handleEvent("ondragconnect",null,null,!1,!1,!0)},DragItem.prototype.set_review=function(){this.render("",!0)};var DropArea=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="droparea",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.fillet=10,this.droptype="matching",this.lastRenderedState="none",this.snapy=this.snapx=0,this.multidrop=this.dragreturn=!0,this.dropoffsety=this.dropoffsetx=0,this.slots=[],this.dragItemIDs=[],this.dockedItemCount=0,this.canvas=this.dragItem=null,this.m_nYOffset=this.m_nXOffset=0,this.m_nHeight=this.m_nWidth=1e3,this.dragDropIDs={global:!0},this.dragOverIDs={global:!0},this.isDropArea=!0};DropArea.prototype=new StageItem,DropArea.prototype.objectType="Item",DropArea.prototype.innerType="DropArea",DropArea.prototype.extractNextSpecialVar=function(t){(t=this.getItemByResumeIndex(t))&&(this.dragItem=t)},DropArea.prototype.getExtraResumeVars=function(){var t=-1;switch(this.variableResumes.VAR_SELECTED_ITEM=!0,this.variableDefaults.VAR_SELECTED_ITEM=-1,this.variableTypes.VAR_SELECTED_ITEM="number",this.style){case"matching":case"wordbank":return this.dragItem&&(t=this.dragItem.getItemIndex()),{VAR_SELECTED_ITEM:t};default:return{}}},DropArea.prototype.toBaseData=Element.prototype.toData,DropArea.prototype.toData=function(t){var e=this.toBaseData(t);return this.DragConnectData&&(e.DragConnectData=this.DragConnectData),this.slots&&0<this.slots.length&&(e.slots=[],$.each(this.slots,function(t,i){e.slots.push(i.id)})),e},DropArea.prototype.updateBaseFromData=Element.prototype.updateFromData,DropArea.prototype.updateFromData=function(t){var e=this;this.updateBaseFromData(t),t.DragConnectData&&(this.DragConnectData=t.DragConnectData),t.slots&&(this.slots=[],$.each(t.slots,function(t,i){var r=e.parent.children[i];r&&e.slots.push(r)}))},DropArea.prototype.resetBase=Element.prototype.reset,DropArea.prototype.reset=function(){this.resetBase(),this.slots=[],this.dragItemIDs=[],this.dockedItemCount=0},StageItem.prototype.convertToDropArea=function(t){switch(this.toBaseData=DropArea.prototype.toBaseData,this.toData=DropArea.prototype.toData,this.updateBaseFromData=DropArea.prototype.updateBaseFromData,this.updateFromData=DropArea.prototype.updateFromData,this.resetBase=DropArea.prototype.resetBase,this.reset=DropArea.prototype.reset,this.update=DragItem.prototype.update,this.findSlot=DropArea.prototype.findSlot,this.findTileSlot=DropArea.prototype.findTileSlot,this.findOffsetSlot=DropArea.prototype.findOffsetSlot,this.updateSlotPositions=DropArea.prototype.updateSlotPositions,this.unstack=DropArea.prototype.unstack,this.parseDragGroupsFromXML=DropArea.prototype.parseDragGroupsFromXML,this.getDragItemIndex=DropArea.prototype.getDragItemIndex,this.getExtraResumeVars=DropArea.prototype.getExtraResumeVars,this.extractNextSpecialVar=DropArea.prototype.extractNextSpecialVar,this.lastRenderedState="none",this.innerType){case"textfield":case"image":break;case"ItemGroup":case"StateGroup":this.render=function(){};break;default:this.render=VectorShape.prototype.render,this.renderOnUpdate=VectorShape.prototype.renderOnUpdate}this.originalWidth=parseInt($(t).attr("width")),this.originalHeight=parseInt($(t).attr("height")),this.originalX=this.x,this.originalY=this.y,this.droptype=$(t).children("dragdrop").attr("droptype"),this.snapx=parseInt($(t).children("dragdrop").attr("snapx")),this.snapy=parseInt($(t).children("dragdrop").attr("snapy")),this.dragreturn="true"==$(t).children("dragdrop").attr("dragreturn"),this.multidrop="true"==$(t).children("dragdrop").attr("multidrop"),this.dropoffsetx=parseInt($(t).children("dragdrop").attr("dropoffsetx")),this.dropoffsety=parseInt($(t).children("dragdrop").attr("dropoffsety")),this.slots=[],this.dragItemIDs=[],this.dockedItemCount=0,this.isDropArea=!0,this.variables.DragConnectData="",this.variableDefaults.DragConnectData="",this.parseDragGroupsFromXML(t)},DropArea.update=function(){$.each(player.currentSlide().ref.find(".droparea"),function(t,e){e.item&&(e.item==DragItem.dropArea?e.item.render("over"):e.item.render(),e.item.updateSlotPositions())}),DragItem.cargo&&DragItem.dropArea&&DragItem.dropArea.findSlot(DragItem.cargo)},DropArea.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,DropArea.prototype.parseDragGroupsFromXML=DragItem.prototype.parseDragGroupsFromXML,DropArea.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.style=$(t).attr("style"),this.droptype=$(t).attr("style"),this.reviewdata=$(t).attr("reviewdata"),this.originalWidth=parseInt($(t).attr("width")),this.originalHeight=parseInt($(t).attr("height")),this.alttext=$(this.xml).find("textdata").attr("alttext"),this.variables.DragConnectData="",this.variableDefaults.DragConnectData="",e=$(t).children("data").children("textdata"),t=$(t).children("data").children("textdata").children("vectortext"),i=t.children("pr"),1==i.length&&(this.textSprite={canvas:null,m_nXOffset:0,m_nYOffset:0,width:1e3,height:1e3,charIndex:0,maxCharIndex:0,vectorHot:!1,isShapeMask:!1},null!=$(t).attr("top")&&(this.textSprite.x=$(e).attr("xpos"),this.textSprite.y=$(e).attr("ypos"),this.textSprite.width=$(e).attr("width"),this.textSprite.height=$(e).attr("height"),this.textSprite.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom"))),this.textSprite.rectShape.right=Math.max(this.textSprite.rectShape.right,this.width),this.textSprite.rectShape.bottom=Math.max(this.textSprite.rectShape.bottom,this.height),this.textSprite.originalRectShape=this.rectShape),this.textSprite.path=PathLib.getPathFromXML(i)),this.canSimplify=!1},DropArea.prototype.loadDragDropFromXML=function(){},DropArea.prototype.createBaseRef=StageItem.prototype.createRef,DropArea.prototype.createRef=function(){if(this.ref)return this.render(null,!0),!1;if(this.type="droparea",!this.createBaseRef())return!1;this.ref.addClass("droparea");var t=$("<canvas></canvas>");t.attr("width",this.width),t.attr("height",this.height),t.css("position","absolute"),this.ref.append(t);var e=$("<canvas></canvas>");if(e.attr("width",this.width),e.attr("height",this.height),e.css("margin","0 0 0 "+this.fillet+"px"),e.css("position","absolute"),this.ref.append(e),this.textSprite){var i=$("<canvas></canvas>");i.css("position","absolute"),i.css("left",this.textSprite.x+"px"),i.css("top",this.textSprite.y+"px"),i.attr("width",this.width+"px"),i.attr("height",this.height+"px"),i.attr("id",this.id+"_text"),this.ref.append(i),this.textSprite.canvas=i.get(0),this.textRef=i}return this.border=t.get(0),this.jcanvas=e,this.canvas=e.get(0),this.bindEvents(),this.render(),!0},DropArea.prototype.bindEvents=function(){var t=this;t.ref.bind("dragstart",function(t){t.preventDefault()}),t.ref.bind("mouseover",function(){DragItem.cargo&&t.render("over")}),t.ref.bind("mouseout",function(){t.render("out")})},DropArea.prototype.renderCallback=function(){},DropArea.prototype.render=function(t,e){if(this.ref&&(e||t!=this.lastRenderedState)){this.lastRenderedState=t;var i=this.border.getContext("2d"),r=parseInt(900*Math.random()+1100)%1e3;switch(i.fillStyle="#"+r,i.fillStyle="#fff",i.lineWidth=1,i.strokeStyle="#ccc",r=i.createLinearGradient(0,0,0,this.height),r.addColorStop(0,"#fcfcfc"),r.addColorStop(1,"#eaeaea"),i.fillStyle=r,this.colors[t]&&this.colors[t].applyCanvas(i,this,!0,!1),t){case"over":i.lineWidth=3;break;default:i.lineWidth=1}var r=i.lineWidth/2,n=this.fillet;switch(this.style){case"matching":i.beginPath(),i.moveTo(0+r,0+r),i.lineTo(this.width-r,0+r),i.lineTo(this.width-r,n-r),i.lineTo(this.width-n-r,n-r),i.lineTo(this.width-n-r,this.height-n+r),i.lineTo(this.width-r,this.height-n+r),i.lineTo(this.width-r,this.height-r),i.lineTo(0+r,this.height-r),i.lineTo(0+r,0+r),i.fill(),i.save(),i.clip(),i.strokeStyle="#fff",i.lineWidth=5,i.stroke(),i.restore(),i.lineWidth=1,i.strokeStyle="#ccc",i.stroke(),this.variables.ReviewMode&&(i.fillStyle="#DB0000",this.matchingDragItem&&this.matchingDragItem.reviewdata==this.reviewdata&&(i.fillStyle="#008520"),n=8,i.beginPath(),i.arc(8,8,n,0,2*Math.PI),i.fill(),n=7,i.beginPath(),i.fillStyle="#000",i.strokeStyle="rgba(255,255,255,0.5)",i.lineWidth=.5,i.arc(8,8,n,0,2*Math.PI),i.fill(),i.stroke(),i.fillStyle="#fff",i.font="10px sans-serif",i.textBaseline="top",1<this.reviewdata.length?i.fillText(this.reviewdata,2,2):i.fillText(this.reviewdata,5,2));break;case"wordbank":this.variables.ReviewMode&&(i.lineWidth=2,i.strokeStyle="#DB0000"),n=this.height/2,i.beginPath(),i.moveTo(n+r,r),i.lineTo(this.width-n-r,r),i.arc(this.width-n-r,n,n-i.lineWidth/2,3*Math.PI/2,Math.PI/2),i.lineTo(n+r,this.height-r),i.arc(n+r,n,n-i.lineWidth/2,Math.PI/2,3*Math.PI/2),i.fill(),i.stroke();break;default:i.fillRect(r,r,this.width,this.height-i.lineWidth),i.strokeRect(r,r,this.width,this.height-i.lineWidth)}this.textSprite&&(i=new ppTextLib(this.xml),ppArt.itemID=this.id,ppArt.item=this,ppArt.m_bMaskMode=!1,ppArt.DrawVector(this.textSprite,this.textSprite.path,i,player.fontlib,this.imagelib,null,null))}},DropArea.prototype.updateSlotPositions=function(){switch(this.droptype){case"stackrandom":case"free":return;case"stackoffset":for(var t=0,e=0;e<this.slots.length;e++){var i=this.slots[e];i!=DragItem.cargo&&(i.x=this.x+e*this.dropoffsetx,i.y=this.y+e*this.dropoffsety,i.ref.css("left",i.x+"px"),i.ref.css("top",i.y+"px"),i.updateMatrixComplete(!0),0==t?t=i.depth:i.setZIndex(t+e))}return}for(var r=t=0,n=0,e=0;e<this.slots.length;e++)i=this.slots[e],t+i.width>this.width&&(t=0,r+=n),i!=DragItem.cargo&&(i.x=this.x+t,i.y=this.y+r,i.updatePosition()),n=i.height,t+=i.width},DropArea.prototype.findSlot=function(t){"tile"==this.droptype?(this.findTileSlot(t),this.updateSlotPositions()):"stackoffset"==this.droptype&&(this.findOffsetSlot(t),this.updateSlotPositions())},DropArea.prototype.findTileSlot=function(t){var e=t.x-this.x+t.dragX+t.snapx,i=t.y-this.y+t.dragY+t.snapy,r=this.slots.indexOf(t);if(r>-1&&this.slots.splice(r,1),0>e&&0>i)this.slots.splice(0,0,t);else{for(var n=0,a=0,s=0,o=0,r=o=0;r<this.slots.length;r++){var l=this.slots[r],n=n+s;if(n+l.width>this.width&&(n=0,a+=o),s=l.width,o=l.height,e+t.width<=this.width&&n+s>=e&&a+o>=i)return void this.slots.splice(r,0,t);if(a+o>=i&&n+s>=this.width)return void this.slots.splice(r,0,t)}this.slots.push(t)}},DropArea.prototype.findOffsetSlot=function(t){var e=t.x-this.x+t.dragX,i=t.y-this.y+t.dragY,r=this.slots.indexOf(t);for(r>-1&&this.slots.splice(r,1),r=0;r<this.slots.length;r++)if(e<r*this.dropoffsetx&&i<r*this.dropoffsety)return void this.slots.splice(r,0,t);this.slots.push(t)},DropArea.prototype.getDragItemIndex=function(t){if(0==this.slots.length)return 0;for(var e=0;e<this.slots.length;e++)if(this.slots[e]==t)return e;return-1},DropArea.unstackItem=function(t,e){$.each(player.currentSlide().ref.find(".droparea"),function(i,r){r!=e&&r.item&&r.item.unstack(t)})},DropArea.prototype.unstack=function(t){t=this.slots.indexOf(t),t>-1&&this.slots.splice(t,1)},DragItem.prototype.set_review=function(){this.render("",!0)};var DropList=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.content={fontsize:18,font:"Arial"},this.constructElement(),this.events=[],this.active=!0,this.visible=!1,this.clickFocus=!0,this.originalIndices={}};DropList.prototype=new StageItem,DropList.prototype.innerType="DropList",DropList.prototype.objectType="Item",DropList.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,DropList.prototype.showBase=StageItem.prototype.show,DropList.prototype.hideBase=StageItem.prototype.hide,DropList.prototype.toBaseData=Element.prototype.toData,DropList.prototype.toData=function(){var t=this.toBaseData();return this.shuffleOrder&&(t.shuffleOrder=this.shuffleOrder),t},DropList.prototype.updateBaseFromData=Element.prototype.updateFromData,DropList.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.shuffleOrder&&(this.shuffleOrder=t.shuffleOrder)},DropList.prototype.extractNextSpecialVar=function(t){t=$(this.xml).children("data").children("itemlist").children().get(t),t=$(t).attr("itemdata"),this.variables.SelectedItemData=t,this.ref&&this.select&&this.select.val(t)},DropList.prototype.getExtraResumeVars=function(){this.variableResumes.VAR_SELECTED_ITEM=!0,this.variableDefaults.VAR_SELECTED_ITEM=-1,this.variableTypes.VAR_SELECTED_ITEM="number";var t=-1;return this.ref&&this.select&&(t=this.originalIndices[this.select.val()],void 0===t&&(t=-1)),{VAR_SELECTED_ITEM:t}},DropList.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.updateMatrixComplete(),this.alttext=$(t).children("data").children("textdata ").attr("alttext"),this.shuffle="true"==$(t).attr("shuffle"),this.shuffleOrder=[],this.type="droplist"},DropList.prototype.update=function(){this.variables.SelectedItemData=this.select.val()},DropList.prototype.createRef=function(){if(this.ref)return this.update(),!1;var t=this;this.container=this.parent.ref,this.ref=$('<div class="item droplist interactive"></div>'),this.applySize(this.ref),this.container.append(this.ref),this.canvas=this.ref.get(0),this.select=$("<select></select>"),this.select.css("font-size",this.content.fontsize+"px"),this.select.css("font-family",this.content.font+",Arial,Sans-Serif"),this.applySize(this.select),this.ref.append(this.select),"true"==this.variables._disabled&&(this.select.get(0).disabled=!0),this.contentRef=this.ref,this.ref.get(0).item=this;var e={};if($(this.xml).children("data").children("itemlist").children().each(function(i,r){var n=$(r).attr("itemdata"),a=$(r).children("textdata").attr("alttext"),s=$("<option value='"+n+"'>"+a+"</option>");t.originalIndices[n]=i,e[a]=s,t.shuffleOrder.length<=i&&t.shuffleOrder.push(.5<Math.random()),t.shuffle&&t.shuffleOrder[i]?t.select.prepend(s):t.select.append(s)}),this.alttext&&""!=this.alttext)if(e[this.alttext])e[this.alttext].get(0).selected=!0;else{var i=$("<option value=''>"+this.alttext+"</option>");t.select.prepend(i)}return void 0!=this.variables.SelectedItemData&&this.select.val(this.variables.SelectedItemData),t.select.bind("change click",function(){t.update()}),t.select.bind("blur",function(){t.handleEvent("onlosefocus",null,null,!1,!1,!0)}),t.update(),!0};var Button=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="textfield",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.canvas=null,this.m_nYOffset=this.m_nXOffset=0,this.height=this.width=1e3};Button.prototype=new StageItem,Button.prototype.objectType="Item",Button.prototype.innerType="Item",Button.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,Button.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.style=$(t).attr("style"),this.connectdata=$(t).attr("connectdata"),this.originalWidth=parseInt($(t).attr("width")),this.originalHeight=parseInt($(t).attr("height")),this.originalX=this.x,this.originalY=this.y,0<$(t).children("data").children("textdata").children("vartext").length&&(this.textlib=$(t).children("data")),
e=$(t).children("data").children("textdata").children("vectortext").children("path"),i=$(t).children("data").children("textdata").children("vectortext").children("pr"),(1==e.length||1==i.length)&&(t=$(t).children("data").children("textdata").children("vectortext"),null!=$(t).attr("top")&&(this.originalRectShape=this.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom")))),this.content.path=1==i.length?PathLib.getPathFromXML(i):e.text()),this.canSimplify=!1},Button.prototype.createBaseRef=StageItem.prototype.createRef,Button.prototype.createRef=function(){if(this.ref||!this.createBaseRef())return!1;if(this.ref.addClass("interactive"),1<this.ref.children().length)return!1;this.contentRef=$('<div class="item unhideable"></div>'),this.contentRef.css("width","100%"),this.ref.append(this.contentRef);var t=$("<canvas></canvas>");t.css("position","absolute"),this.ref.append(t);var e=$("<canvas></canvas>");return e.css("position","relative"),this.ref.append(e),this.jcanvas=e,this.border=t.get(0),this.canvas=e.get(0),this.render("btn_bg"),this.ref.get(0).item=this,this.ref.css("width",this.width-2),this.ref.css("height",this.height-2),!0},Button.prototype.destroyBaseRef=StageItem.prototype.destroyRef,Button.prototype.destroyRef=function(){this.ref.empty(),this.contentRef.remove(),this.contentRef=null,this.destroyBaseRef()},Button.prototype.bindEventsBase=StageItem.prototype.bindEvents,Button.prototype.bindEvents=function(){var t=this;this.bindEventsBase(),this.ref.bind("mouseover",function(){t.render("btn_hover")}),this.ref.bind("mouseout mouseup",function(){t.render("btn_bg")}),this.ref.bind("mousedown",function(){t.render("btn_down")})},Button.prototype.renderCallback=function(){this.width=this.originalWidth,this.height=this.originalHeight,this.render("btn_bg")},Button.prototype.render=function(t){this.ref&&(this.colors[t]&&this.colors[t].apply(this.ref,this,!0,!1),this.colors.btn_border&&this.ref.css("border-color",this.colors.btn_border.toColorString()),this.renderVectorForeground(t))},Button.prototype.renderVectorForeground=VectorShape.prototype.render,Button.prototype.renderCanvas=function(t){if(this.ref){var e=this.border.getContext("2d"),i=parseInt(900*Math.random()+1100)%1e3;e.fillStyle="#"+i,e.fillStyle="#fff",e.lineWidth=1,e.strokeStyle="#ccc",i=e.createLinearGradient(0,0,0,this.height),i.addColorStop(0,"#fcfcfc"),i.addColorStop(1,"#eaeaea"),e.fillStyle=i,this.colors[t]&&this.colors[t].applyCanvas(e,this,!0,!1),e.fillRect(.5,.5,this.width,this.height-1),e.strokeRect(.5,.5,this.width,this.height-1)}};var ImageItem=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.type="image",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.canvas=null,this.m_nYOffset=this.m_nXOffset=0,this.height=this.width=1e3};ImageItem.prototype=new StageItem,ImageItem.prototype.objectType="Item",ImageItem.prototype.innerType="Image",ImageItem.extractAnimatedGif=function(t){var e=null;return $(t).children("imagelib").children("imagedata").each(function(t,i){var r=$(i).attr("altimage");r&&r.indexOf(".gif")==r.length-4&&(e=r)}),e},ImageItem.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,ImageItem.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.zoomtype=$(t).attr("zoomtype"),this.btnxpos=parseInt($(t).attr("btnxpos")),this.btnypos=parseInt($(t).attr("btnypos")),0<$(t).children("zoomdata").children("imagedata").length&&(this.zoomSrc=player.basepath+$(t).children("zoomdata").children("imagedata").attr("url"),this.zoomType=$(t).children("zoomdata").children("imagedata").attr("type"),this.zoomWidth=parseInt($(t).children("zoomdata").children("imagedata").attr("width")),this.zoomHeight=parseInt($(t).children("zoomdata").children("imagedata").attr("height"))),0<$(t).children("zoomdata").children("html5data").length&&(this.zoomSrc=player.basepath+"mobile/"+$(t).children("zoomdata").children("html5data").attr("url")),this.canSimplify=!1},ImageItem.prototype.loadContentFromXML=function(t){this.content.src=Element.PixelSrc;var e=$(t).find("html5data");this.content.mask=e.attr("mask"),this.content.maskref=e.attr("maskref");var i;0<e.length&&e.attr("url")&&(i="mobile/"+e.attr("url")),i||(i=$(t).children("zoomdata").children("imagedata").attr("url")),i||(i=$(t).children("data").children("imagedata").attr("url")),i&&(this.content.src=player.basepath+i,this.content.src.indexOf(".swf")==this.content.src.length-4)&&(this.content.src=this.content.src.replace(".swf",".png"),this.content.src=this.content.src.replace("story_content","mobile")),0<$(t).children("imagelib").length&&this.loadImageDataFromXML(t)},ImageItem.prototype.destroyBaseRef=StageItem.prototype.destroyRef,ImageItem.prototype.destroyRef=function(){this.zoomButton&&(this.zoomButton.remove(),this.zoomButton=null,this.zoomImage.remove(),this.zoomImage=null),this.destroyBaseRef()},ImageItem.prototype.createBaseRef=StageItem.prototype.createRef,ImageItem.prototype.createRef=function(){var t=this;if(this.ref||!this.createBaseRef())return!1;if(this.loadContentFromXML(this.xml,this.slide,this.layer),this.contentRef=$('<image class="item unhideable"></image>'),this.contentRef.attr("width",this.width),this.contentRef.attr("height",this.height),this.contentRef.attr("src",this.content.src),this.ref.append(this.contentRef),this.ref.get(0).item=this,this.zoomType){var e=$("<div class='zoombutton'><div class='zoombuttoninner'></div></div>");e.css("left",this.btnxpos),e.css("top",this.btnypos),e.css("z-index",this.depth);var i=$("<image class='zoomimage'/>");i.attr("src",this.zoomSrc),i.attr("width",this.zoomWidth),i.attr("height",this.zoomHeight),$(document.body).append(i),i.hide(),this.ref.click(function(){var e=t.zoomWidth,r=t.zoomHeight,n=e/r;n>player.frame.aspectRatio&&e>player.frame.containerWidth?(e=player.frame.containerWidth,r=player.frame.containerWidth*t.zoomHeight/t.zoomWidth):n<=player.frame.aspectRatio&&r>player.frame.containerHeight&&(r=player.frame.containerHeight,e=player.frame.containerHeight/t.zoomHeight*t.zoomWidth);var n=t.ref.offset().left+t.width/2-e/2,a=t.ref.offset().top+t.height/2-r/2;n<player.frame.containerLeft&&(n=player.frame.containerLeft),a<player.frame.containerTop&&(a=player.frame.containerTop),n+e>player.frame.containerLeft+player.frame.containerWidth&&(n=n-(n+e)+(player.frame.containerLeft+player.frame.containerWidth)),a+r>player.frame.containerTop+player.frame.containerHeight&&(a=a-(a+r)+(player.frame.containerTop+player.frame.containerHeight)),i.css("width",e),i.css("height",r),i.css("left",n),i.css("top",a),i.show(),MouseEvents.addHideable(".zoomimage",".zoombutton,.image",function(){$(".zoomimage").hide(),$(".interstitial").hide(),player.showingInterstitial=!1}),$(".interstitial").removeClass("black"),$(".interstitial").unbind(),$(".interstitial").show()}),this.ref.addClass("interactive"),this.ref.addClass("clickable"),this.ref.append(e),this.zoomButton=e,this.zoomImage=i}return!0},ImageItem.prototype.render=function(){};var ItemGroup=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.active=!0,this.visible=!1};ItemGroup.prototype=new StageItem,ItemGroup.prototype.innerType="ItemGroup",ItemGroup.prototype.objectType="Item",ItemGroup.prototype.loadFromXML=function(t){this.id=$(t).attr("id"),this.xml=t,this.loadElementInfoFromXML(t),this.loadSizeFromXML(t),0<$(this.xml).children("dragdrop").length&&("true"==$(this.xml).children("dragdrop").first().attr("dragenabled")&&this.convertToDragItem(this.xml),"true"==$(this.xml).children("dragdrop").first().attr("dropenabled")&&this.convertToDropArea(this.xml),"true"==$(this.xml).children("dragdrop").first().attr("dragoverenabled"))&&(this.announceDragOver=!0,this.setupDragOver(this.xml)),this.loadChildrenFromXML(t,this.slide,this.layer,function(t){t.canSimplify=!1}),this.canSimplify=!1},ItemGroup.prototype.renderForeground=function(){},ItemGroup.prototype.isPointActive=function(t,e,i,r){var n=!1;return $.each(this.children,function(a,s){s!=i&&(n=n||s.isPointActive(t,e,i,r))}),n};var ShuffleGroup=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.active=!0,this.visible=!1};ShuffleGroup.prototype=new ItemGroup,ShuffleGroup.prototype.innerType="ShuffleGroup",ShuffleGroup.prototype.objectType="Item",ShuffleGroup.prototype.loadBaseFromXML=ItemGroup.prototype.loadFromXML,ShuffleGroup.prototype.loadFromXML=function(t){var e=this;e.xml=t,this.loadBaseFromXML(t),this.shuffleAttr=$(t).attr("shuffle"),this.canSimplify=!1,$.each(this.children,function(t,i){i.shuffleGroup=e})},ShuffleGroup.prototype.createBaseRef=StageItem.prototype.createRef,ShuffleGroup.prototype.createRef=function(){var t=this.createBaseRef();return this.ref.addClass("unhideable"),t},ShuffleGroup.prototype.baseShow=ShuffleGroup.prototype.show,ShuffleGroup.prototype.show=function(t,e,i){this.baseShow(t,e,i),"false"!=this.shuffleAttr&&this.shuffle()},ShuffleGroup.prototype.shuffle=function(){"true"!=this.shuffleAttr||this.shuffled||(0<$(this.xml).find("droplist").length?this.shuffleDropLists():this.shuffleElements(),this.shuffled=!0)},ShuffleGroup.prototype.shuffleDropLists=function(){var t=this;$.each(this.children,function(e,i){"droplist"==i.innerType&&(t.shuffleSelect(i.select.get(0)),i.update())})},ShuffleGroup.prototype.shuffleSelect=function(t){for(var e=t.options,i=[],r=e.length-1;r>=0;r--)i.push(e[r]),$(e[r]).remove();for(;i.length;)r=i.splice(this.getRandomIndex(i),1)[0],e.add(r);t.selectedIndex=0},ShuffleGroup.prototype.shuffleElements=function(){var t=[],e=[],i=!0,r=-1e3;if($.each(this.children,function(n,a){a.shufflelock||(-1e3!=r&&a.xpos!=r&&(i=!1),r=a.xpos,e.push(a),t.push(a),a.unshuffleX=a.x,a.unshuffleY=a.y)}),i)this.shuffleStacked();else{for(;0<e.length&&0<t.length;){var n=e.pop(),a=this.getRandomIndex(t),a=t.splice(a,1)[0];a.originalX=a.unshuffleX,a.originalY=a.unshuffleY,a.x=n.unshuffleX,a.y=n.unshuffleY,a.ref&&(a.ref.css("top",a.y+"px"),a.ref.css("left",a.x+"px"))}$.each(this.children,function(t,e){e.shuffled=!0,e.shuffleX=e.x-e.xoffset,e.shuffleY=e.y-e.yoffset,e.updateMatrixComplete(!0)})}},ShuffleGroup.prototype.shuffleStacked=function(){var t=[],e=[],i=1e3,r=0,n=[];$.each(this.children,function(r,a){if(!a.shufflelock){e.push(a),t.push(a),a.unshuffleX=a.x,a.unshuffleY=a.y,i=Math.min(i,a.ypos);t:{for(var s=0;s<n.length;s++)if(a.y<n[s].y){n.splice(s,0,a);break t}n.push(a)}}}),1<n.length&&(r=n[1].y-(n[0].y+n[0].height),r=Math.max(r,0));var a=i;for(0==e.length&&(a=0);0<t.length;){var s=this.getRandomIndex(t),s=t.splice(s,1)[0];s.originalX=s.unshuffleX,s.originalY=s.unshuffleY,s.y=a+s.yoffset,a+=s.height,a+=r,s.ref&&s.ref.css("top",s.y+"px")}$.each(this.children,function(t,e){e.shuffled=!0,e.shuffleX=e.x-e.xoffset,e.shuffleY=e.y-e.yoffset,e.updateMatrixComplete(!0)})},ShuffleGroup.prototype.shuffleRows=function(){if(!this.shuffled){this.shuffled=!0;var t={},e=[],i=[];$.each(this.children,function(r,n){t[n.x]&&(t={},e.push(i),i=[]),i.push(n),t[n.x]=n}),e.push(i);for(var r=0;10>r;r++)this.swapRow(this.getRandomMember(e),this.getRandomMember(e));$.each(this.children,function(t,e){e.shuffled=!0,e.shuffleX=e.x-e.xoffset,e.shuffleY=e.y-e.yoffset})}},ShuffleGroup.prototype.getRandomIndex=function(t){return parseInt(Math.random()*t.length)},ShuffleGroup.prototype.getRandomMember=function(t){var e=this.getRandomIndex(t);return t[e]},ShuffleGroup.prototype.swapRow=function(t,e){var i=this;t!=e&&$.each(t,function(t,r){i.swapItem(r,e[t])})},ShuffleGroup.prototype.swapItem=function(t,e,i){if(t!=e&&t&&e){var r=t.y,n=t.x;t.y=e.y,e.y=r,t.originalY=t.y,e.originalY=e.y,t.ref.css("top",t.y+"px"),e.ref.css("top",e.y+"px"),i&&(t.x=e.x,e.x=n,t.originalX=t.x,e.originalX=e.x,t.ref.css("left",t.x+"px"),e.ref.css("left",e.x+"px")),t.updateMatrixComplete(!0),e.updateMatrixComplete(!0)}};var ScrollArea=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.active=!0,this.visible=!1};ScrollArea.prototype=new ItemGroup,ScrollArea.prototype.innerType="ScrollArea",ScrollArea.prototype.objectType="Item",ScrollArea.prototype.loadBaseFromXML=ItemGroup.prototype.loadFromXML,ScrollArea.prototype.loadFromXML=function(t){var e=this;e.xml=t,this.loadBaseFromXML(t),$(e.xml).children("background").each(function(t,i){e.background=new Background(e.ref),e.background.loadFromXML(i)}),this.canSimplify=!1,$.each(this.children,function(t,i){i.ScrollArea=e})},ScrollArea.prototype.baseShow=ScrollArea.prototype.show,ScrollArea.prototype.show=function(t,e,i){this.baseShow(t,e,i)},ScrollArea.prototype.createRef=function(){if(!this.parent.ref)return this.parent.createRef(),!1;if(this.container=this.parent.ref,this.ref)return this.render(null,!1,null,"StageItem createRef"),!1;var t=this;return this.ref=$('<div class="item scrollarea"></div>'),this.ref.addClass(this.type),this.ref.addClass(this.innerType.toLowerCase()),this.ref.addClass("item_"+this.id),this.ref.attr("id","item_"+this.id),player.showItemInfo&&this.ref.append($('<div class="itemid">'+this.id+"</div>")),this.applySize(this.ref),this.container.append(this.ref),this.ref.get(0).item=this,t.background&&t.background.apply(t.ref),$.each(this.children,function(t,e){e.createRef&&e.createRef()}),t.visible=!1,this.ref.bind("scroll",function(){var e=t.ref.get(0);e.style.cssText+=";-webkit-transform:rotateZ(0deg)",player.uselessOffsetHeight=e.offsetHeight,e.style.cssText+=";-webkit-transform:none",t.updateMatrixComplete(!0)}),-1<navigator.userAgent.indexOf("AppleWebKit")&&-1<navigator.userAgent.indexOf("Macintosh")&&t.ref.css("border","solid 1px transparent"),!0};var StateGroup=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.active=!0,this.visible=!1};StateGroup.prototype=new ItemGroup,StateGroup.prototype.innerType="StateGroup",StateGroup.prototype.loadFromXML=function(t){var e=this;this.id=$(t).attr("id"),this.xml=t,this.loadElementInfoFromXML(t),this.loadSizeFromXML(t),0<$(this.xml).children("dragdrop").length&&("true"==$(e.xml).children("dragdrop").first().attr("dragenabled")&&e.convertToDragItem(e.xml),"true"==$(e.xml).children("dragdrop").first().attr("dropenabled")&&e.convertToDropArea(e.xml),"true"==$(e.xml).children("dragdrop").first().attr("dragoverenabled"))&&(this.announceDragOver=!0,e.setupDragOver(e.xml)),this.loadChildrenFromXML(t,e.slide,e.layer,function(t){t.canSimplify=!1,t.group=e}),this.canSimplify=!1,this.actionstates={},this.actionstateindices={},$(t).children("actionstates").children().each(function(t,i){var r=$(i).attr("name"),n=$(i).children("actions").children();e.actionstates[r]=n,e.actionstateindices[r]=t})},StateGroup.prototype.render=VectorShape.prototype.render,StateGroup.prototype.executeStateActions=function(t){var e=this;(t=e.actionstates[t])&&$.each(t,function(t,i){e.runAction(i)})};var ExpandingLabel=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.events=[],this.active=!0,this.showContent=this.showTitle=this.visible=!1,this.VAR_EXPANDED="_expanded",this.GROW_TITLE_TIME=250,this.GROW_CONTENT_TIME=500,this.ARROW_HEIGHT=18,this.FILL_BORDER="border",this.FILL_BG="bg",this.borderwidth=1,this.arrowxpos=this.arrowypos=0,this.m_strAlign="top",this.m_nContentHeight=0,this.m_nRadius=8,this.m_nTitleHeight=80,this.m_bHideTitleOnComplete=this.m_bShowContentOnComplete=this.m_bAnimatingContentOut=this.m_bAnimatingContentIn=this.m_bAnimatingTitleOut=this.m_bAnimatingTitleIn=this.m_bContentShowing=this.m_bTitleShowing=!1,this.m_nGrowStartTime=0,this.m_nTextHeight=30,this.m_nMarginRight=this.m_nMarginLeft=5,this.m_nMarginRightTitle=20,this.m_nMarginText=this.m_nMarginBottom=this.m_nMarginTop=5,this.m_nHotspotHeight=0,this.m_bShowCloseButton=!1};ExpandingLabel.prototype=new StageItem,ExpandingLabel.prototype.innerType="ExpandingLabel",ExpandingLabel.prototype.objectType="Item",ExpandingLabel.prototype.extractNextSpecialBool=function(){this.showContent=!0},ExpandingLabel.prototype.getExtraResumeVars=function(){return this.variableResumes.VAR_EXPANDED=!0,this.variableDefaults.VAR_EXPANDED=!1,this.variableTypes.VAR_EXPANDED="bool",{VAR_EXPANDED:this.showContent}},ExpandingLabel.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,ExpandingLabel.prototype.loadFromXML=function(t,e,i){var r=$(t).children("objects");r.remove(),this.loadBaseFromXML(t,e,i),$(t).append(r),this.id=$(t).attr("id"),this.xml=t,this.borderwidth=parseInt($(t).attr("borderwidth")),this.contentheight=parseInt($(t).attr("contentheight")),this.arrowxpos=parseInt($(t).attr("arrowxpos")),this.arrowypos=parseInt($(t).attr("arrowypos")),this.showclosebutton="true"==$(t).attr("showclosebutton"),this.hasContent=0<$(t).children("objects").length,this.width+=8,this.height+=8,0>this.arrowypos?(this.m_strAlign="top",0>this.arrowxpos&&(this.arrowxpos=0),this.arrowxpos>this.width&&(this.arrowxpos=this.width),this.arrowypos=this.ARROW_HEIGHT):this.arrowypos>this.height?(this.m_strAlign="bottom",0>this.arrowxpos&&(this.arrowxpos=0),this.arrowxpos>this.width&&(this.arrowxpos=this.width),this.arrowypos=this.height+this.ARROW_HEIGHT):this.arrowxpos>this.width?(this.m_strAlign="left",this.arrowxpos=this.width+this.ARROW_HEIGHT):0>this.arrowxpos&&(this.m_strAlign="right",this.arrowxpos=this.ARROW_HEIGHT),this.loadChildrenFromXML(t,this.slide,this.layer,function(t){t.canSimplify=!1}),this.canSimplify=!1},ExpandingLabel.prototype.createBaseRef=StageItem.prototype.createRef,ExpandingLabel.prototype.destroyBaseRef=StageItem.prototype.destroyRef,ExpandingLabel.prototype.renderForeground=VectorShape.prototype.renderForeground,ExpandingLabel.prototype.renderVector=VectorShape.prototype.render,ExpandingLabel.prototype.createRef=function(){if(this.ref)return!1;var t=this;if(!this.createBaseRef())return!1;this.ref.addClass("expandinglabel interactive"),this.ref.children().addClass("expandinglabelcontent"),this.expandingLabelContent=this.ref.children(),this.canvasWidth=t.width+2*t.borderwidth+t.ARROW_HEIGHT,this.canvasHeight=t.height+2*t.borderwidth+t.ARROW_HEIGHT;var e=$('<canvas class="content" width="'+this.canvasWidth+'" height="'+this.canvasHeight+'"></canvas>');return e.css("position","absolute"),this.ref.append(e),this.backgroundCanvas=e.get(0),e=$('<canvas class="content expandinglabeltitlecanvas" width="'+this.canvasWidth+'" height="'+this.canvasHeight+'"></canvas>'),e.css("position","absolute"),this.ref.append(e),this.jcanvas=e,this.canvas=e.get(0),this.contentRef=$('<div class="item unhideable expandinglabeltitle"></div>'),this.contentRef.css("width","100%"),this.ref.prepend(this.contentRef),this.ref.css("width",t.width),this.ref.css("height",t.height),this.visible=!1,this.hide(),setTimeout(function(){var e=t.id.replace("_expandinglabel","");t.button=t.parent.children[e],t.button.ref&&t.button.ref.addClass("interactive")},0),!0},ExpandingLabel.prototype.show=function(t,e,i){if(this.createRef(this.parent.ref),this.visible){var r=this;e?i&&0!=e.duration||(this.visible=!0,this.variables.Expanded="true",r.ref.show(),r.handleEvent("ontransitionin",null,null,!1,!0),e.setTarget(this),e.apply(function(){r.handleEvent("ontransitionincomplete",null,null,!1,!0)})):(this.visible=!0,this.variables.Expanded="true",r.ref.show(),r.handleEvent("ontransitionin",null,null,!1,!0),r.handleEvent("ontransitionincomplete",null,null,!1,!0))}},ExpandingLabel.prototype.hide=function(t,e){this.visible=!1,this.variables.Expanded="false";var i=this;i.handleEvent("ontransitionout",null,null,!1,!0),e?(e.setTarget(this),e.apply(function(){i.ref&&i.ref.hide(),i.handleEvent("ontransitionoutcomplete",null,null,!1,!0)})):(this.ref&&this.ref.hide(),i.handleEvent("ontransitionoutcomplete",null,null,!1,!0))},ExpandingLabel.prototype.render=function(t,e){if(this.renderVector(t,e),this.ref){var i=this.width,r=this.showContent||!this.hasContent?this.height:this.m_nTextHeight+this.m_nMarginTop+this.m_nMarginBottom;yoffset=xoffset=0;var n=this.arrowypos;this.showContent?(this.ref.css("top",this.y),this.expandingLabelContent.show()):("right"==this.m_strAlign||"left"==this.m_strAlign?(n=this.arrowypos/this.height*r,this.ref.css("top",this.y+this.arrowypos-n)):"bottom"==this.m_strAlign&&this.ref.css("top",this.y+this.height-r),this.expandingLabelContent.hide());var a=this.backgroundCanvas.getContext("2d");switch(a.lineWidth=this.borderwidth,this.colors[this.FILL_BORDER].applyCanvas(a,this,!1,!0),this.colors[this.FILL_BG].applyCanvas(a,this,!0,!1),a.clearRect(0,0,this.canvasWidth,this.canvasHeight),a.save(),a.translate(a.lineWidth/2,a.lineWidth/2),a.beginPath(),$(this.canvas).css("margin","8px 8px 0px "+(a.lineWidth+8)+"px"),this.m_strAlign){case"top":a.translate(0,this.ARROW_HEIGHT),$(this.backgroundCanvas).css("margin-top",-this.ARROW_HEIGHT+"px"),this.DrawBottomCaption(a,0,-this.ARROW_HEIGHT,i,r,this.m_nRadius,this.arrowxpos,this.ARROW_HEIGHT);break;case"bottom":$(this.canvas).css("margin-top","-8px"),$(this.backgroundCanvas).css("margin-top","-8px"),this.DrawTopCaption(a,0,0,i,r,this.m_nRadius,this.arrowxpos,this.ARROW_HEIGHT);break;case"left":$(this.canvas).css("margin-left",a.lineWidth-8+"px"),$(this.backgroundCanvas).css("margin-left","-8px"),this.DrawLeftCaption(a,0,0,i,r,this.m_nRadius,n,this.ARROW_HEIGHT);break;case"right":a.translate(this.ARROW_HEIGHT,0),$(this.backgroundCanvas).css("margin-left",-this.ARROW_HEIGHT+"px"),this.DrawRightCaption(a,-this.ARROW_HEIGHT,0,i,r,this.m_nRadius,n,this.ARROW_HEIGHT)}a.fill(),a.stroke(),a.restore(),this.renderForeground()}},ExpandingLabel.prototype.hideOthers=function(){var t=this;$(".expandinglabel").each(function(e,i){i.item&&i.item!=t&&i.item.hide()})},ExpandingLabel.prototype.togglecontent=function(){this.showContent=!this.showContent,this.variables.Expanded=this.showContent.toString(),this.showContent?($(".above").removeClass("above"),$(".showing").removeClass("showing"),this.hideOthers(),this.render(null,!0,this.width,this.height),this.visible=!0,this.show(),this.ref.addClass("above showing"),this.button.ref.addClass("above showing"),this.handleEvent("onobjectevent","contentin",null,!1,!1,!0)):(this.hide(),$(".above").removeClass("above"),this.handleEvent("onobjectevent","contentout",null,!1,!1,!0))},ExpandingLabel.prototype.showcomplete=function(){this.showContent=!0,this.variables.Expanded=this.showContent.toString(),$(".above").removeClass("above"),$(".showing").removeClass("showing"),this.hideOthers(),this.render(null,!0,this.width,this.height),this.visible=!0,this.show(),this.ref.addClass("above showing"),this.button.ref.addClass("above showing"),this.handleEvent("onobjectevent","contentin")},ExpandingLabel.prototype.hidecomplete=function(){this.variables.Expanded="false",this.hide(),$(".above").removeClass("above"),this.showTitle=this.showContent=!1},ExpandingLabel.prototype.showtitle=function(){if(!this.showContent){var t=this.m_nTextHeight+this.m_nMarginTop+this.m_nMarginBottom,e=this.height-t;this.showTitle=this.visible=!0,this.showContent=!1,this.variables.Expanded="false",this.show(),$(".above").removeClass("above"),this.ref.addClass("above"),this.button.ref.addClass("above"),this.render(null,!0,this.width,t,0,e)}},ExpandingLabel.prototype.hidetitle=function(){this.showContent||(this.showContent=this.showTitle=this.visible=!1,this.variables.Expanded="false",this.hide(),$(".above").removeClass("above"))},ExpandingLabel.prototype.DrawTopCaption=function(t,e,i,r,n,a,s,o){0>a&&(a=0);var l=a+o/2>=s,h=s>=r-(a+o/2),p=s-o/2,c=r-(s+o/2),d=0;l&&(p=s,c=r-(s+o)),h&&(p=s-o,c=r-s),0>p&&(p=0),0>c&&(c=0),p>r&&(p=r),c>r&&(c=r);var s=o/2,u=0,u=a;p+o>r&&(d=o,o=d-(p+d-r)/2,p-=(p+d-r)/2),c+o>r&&(d=o,o=d-(c+d-r)/2,c-=(c+d-r)/2),d=r-c,a>c&&(d=r-a),t.moveTo(e+d,i),t.lineTo(e+r-u,i),t.arcTo(e+r,i,e+r,i+u,u),u=a,a>c&&(u=c),t.lineTo(e+r,i+n-u),t.arcTo(e+r,i+n,e+r-u,i+n,u),u=a,t.lineTo(e+r-c,i+n),a>p&&(u=p),l?t.lineTo(e+p,i+n+o):h?t.lineTo(e+r-c,i+n+o):t.lineTo(e+p+s,i+n+o),t.lineTo(e+p,i+n),t.lineTo(e+u,i+n),t.arcTo(e,i+n,e,i+n-u,u),u=a,t.lineTo(e,i+u),t.arcTo(e,i,e+u,i,u),t.lineTo(e+d,i)},ExpandingLabel.prototype.DrawBottomCaption=function(t,e,i,r,n,a,s,o){0>a&&(a=0);var l=a+o/2>=s,h=s>=r-(a+o/2),p=s-o/2,c=r-(s+o/2),d=0;l&&(p=s,c=r-(s+o)),h&&(p=s-o,c=r-s),0>p&&(p=0),0>c&&(c=0),p>r&&(p=r),c>r&&(c=r);var s=o/2,u=0,u=a;a>c&&(u=c),p+o>r&&(d=o,i+=(p+d-r)/2,o=d-(p+d-r)/2,p-=(p+d-r)/2),c+o>r&&(d=o,i+=(c+d-r)/2,o=d-(c+d-r)/2,c-=(c+d-r)/2),d=r-c,t.moveTo(e+d,i+o),t.lineTo(e+r-u,i+o),t.arcTo(e+r,i+o,e+r,i+o+u,u),u=a,t.lineTo(e+r,i+n+o-u),t.arcTo(e+r,i+o+n,e+r-u,i+n+o,u),u=a,t.lineTo(e+u,i+o+n),t.arcTo(e,i+n+o,e,i+n+o-u,u),u=a,a>p&&(u=p),t.lineTo(e,i+o+u),t.arcTo(e,i+o,e+u,i+o,u),t.lineTo(e+p,i+o),l?t.lineTo(e+p,i):h?t.lineTo(e+r-c,i):t.lineTo(e+p+s,i),t.lineTo(e+d,i+o)},ExpandingLabel.prototype.DrawLeftCaption=function(t,e,i,r,n,a,s,o){0>a&&(a=0);var l=o/2>=s,h=s>=n-o/2,p=s-o/2,c=n-(s+o/2),d=0;if(l&&(p=s,c=n-(s+o)),h&&(p=s-o,c=n-s),0>p&&(p=0),0>c&&(c=0),p>n&&(p=n),c>n&&(c=n),d=a,s=r/2,t.moveTo(e+s,i),d=a,a>p&&(d=p),t.lineTo(e+r-d,i),t.arcTo(e+r,i,e+r,i+d,d),c+o>n&&(d=o,o=d-(c+d-n)/2,c-=(c+d-n)/2),p+o>n)var u=p,d=o,p=u-(u+d-n)/2,o=d-(u+d-n)/2;t.lineTo(e+r,i+p),l?t.lineTo(e+r+o,i+p):h?t.lineTo(e+r+o,i+n-c):t.lineTo(e+r+o,i+p+o/2),t.lineTo(e+r,i+p+o),d=a,a>c&&(d=c),t.lineTo(e+r,i+n-d),t.arcTo(e+r,i+n,e+r-d,i+n,d),d=a,t.lineTo(e+d,i+n),t.arcTo(e,i+n,e,i+n-d,d),d=a,t.lineTo(e,i+d),t.arcTo(e,i,e+d,i,d),t.lineTo(e+s,i)},ExpandingLabel.prototype.DrawRightCaption=function(t,e,i,r,n,a,s,o){0>a&&(a=0);var l=o/2>=s,h=s>=n-o/2,p=s-o/2,c=n-(s+o/2),d=0;l&&(p=s,c=n-(s+o)),h&&(p=s-o,c=n-s),0>p&&(p=0),0>c&&(c=0),p>n&&(p=n),c>n&&(c=n),d=a,s=r/2,t.moveTo(e+o+s,i),t.lineTo(e+o+r-d,i),t.arcTo(e+o+r,i,e+o+r,i+d,d),t.lineTo(e+o+r,i+n-d),t.arcTo(e+o+r,i+n,e+o+r-d,i+n,d),d=a,a>c&&(d=c),t.lineTo(e+o+d,i+n),t.arcTo(e+o,i+n,e+o,i+n-d,d),c+o>n&&(d=o,e+=(c+d-n)/2,o=d-(c+d-n)/2,c-=(c+d-n)/2),p+o>n&&(r=p,d=o,e+=(r+d-n)/2,p=r-(r+d-n)/2,o=d-(r+d-n)/2),t.lineTo(e+o,i+n-c),l?t.lineTo(e,i+p):h?t.lineTo(e,i+n-c):t.lineTo(e,i+p+o/2),t.lineTo(e+o,i+p),d=a,a>p&&(d=p),t.lineTo(e+o,i+d),t.arcTo(e+o,i,e+o+d,i,d),t.lineTo(e+o+s,i)};var SequenceCtrl=function(t,e,i){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.slide=e,this.layer=i,this.constructElement(),this.events=[],this.active=!0,this.visible=!1,this.currentIndex=0,this.content={},this.colors={},this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.deferredResourceIndex=0,this.padY=20,this.padX=25,this.originalIndex=this.dropIndex=-1,this.indexedChildren=[]};SequenceCtrl.prototype=new StageItem,SequenceCtrl.prototype.objectType="Item",SequenceCtrl.prototype.innerType="SequenceCtrl",SequenceCtrl.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,SequenceCtrl.prototype.shuffleRows=ShuffleGroup.prototype.shuffleRows,SequenceCtrl.prototype.shuffleElements=ShuffleGroup.prototype.shuffleElements,SequenceCtrl.prototype.getRandomMember=ShuffleGroup.prototype.getRandomMember,SequenceCtrl.prototype.getRandomIndex=ShuffleGroup.prototype.getRandomIndex,SequenceCtrl.prototype.swapRow=ShuffleGroup.prototype.swapRow,SequenceCtrl.prototype.swapItem=ShuffleGroup.prototype.swapItem,SequenceCtrl.prototype.extractNextSpecialVar=function(t){for(var t=bwChunk.CreateChunk(t),t=new bwChunk(t),e=0,i=0;!t.EOF();){var r=this.indexedChildren[t.NextUBase10(1)];r.y=e,this.variables["_pos"+i]=r.itemdata,e+=r.height+this.padY,i++}},SequenceCtrl.prototype.getExtraResumeVars=function(){this.variableResumes.VAR_ITEM_ORDER=!0,this.variableDefaults.VAR_ITEM_ORDER="",this.variableTypes.VAR_ITEM_ORDER="string";var t="";if(this.ref){var e=this.getOrderedItemList();$.each(e,function(e,i){t+=bwChunk.UBase10toN(i.sequenceIndex)})}return{VAR_ITEM_ORDER:t}},SequenceCtrl.prototype.loadFromXML=function(t,e,i){var r=this;this.loadBaseFromXML(t,e,i),this.loadSizeFromXML(t),this.shortid=$(t).attr("id").replace("list_",""),this.parent.children[this.shortid]=this,this.canSimplify=!1;var n=10;$(t).children("data").children("itemlist").children().each(function(t,i){var a=new SequenceItem(r.ref,e);a.offsetY=n,a.offsetX=r.padX,a.sequenceIndex=t,a.loadFromXML(i,e),a.width=r.width-r.padX-r.padX,a.parent=r,a.offsetParent=r,r.children[a.id]=a,r.indexedChildren[t]=a,n+=a.height+r.padY,r.indicatorWidth=a.width,r.indicatorOffsetX=a.x})},SequenceCtrl.prototype.createBaseRef=StageItem.prototype.createRef,SequenceCtrl.prototype.createRef=function(){var t=this;if(t.ref)return!1;this.container=this.parent.ref,this.ref=$('<div class="item sequencectrl interactive"></div>'),this.container.append(this.ref),this.applySize(this.ref),this.indicator=$('<div class="sequenceindicator"></div>'),this.indicator.css("width",this.width),this.container.append(this.indicator),this.contentRef=this.ref,this.ref.get(0).item=this,this.indicator.css("left",this.x+this.indicatorOffsetX),this.indicator.css("width",this.indicatorWidth);var e=0;return $.each(t.children,function(i,r){r.createRef(),t.appendLineNumber(e++,r)}),this.shuffleRows(),this.ref.bind("scroll",function(){var e=t.ref.get(0);e.scrollHeight<=e.scrollTop+t.height&&(t.hasScrolledToEnd=!0),e=t.ref.get(0),e.style.cssText+=";-webkit-transform:rotateZ(0deg)",player.uselessOffsetHeight=e.offsetHeight,e.style.cssText+=";-webkit-transform:none",t.updateMatrixComplete(!0)}),this.slide.ref.bind("scroll",function(){this.scrollLeft=this.scrollTop=0}),this.updateScore(),!0},SequenceCtrl.prototype.appendLineNumber=function(t,e){var i=e.offsetY,r=$('<div class="sequencelinenumber"></div>');r.text(t+1+"."),r.css("top",-1e3),$(document.body).append(r);var n=r.height();n>0&&n<e.height&&(i+=(e.height-n)/2),r.css("top",i),this.variables.ReviewMode&&r.addClass("correct"),this.ref.append(r)},SequenceCtrl.prototype.getOrderedItemList=function(){var t=[];return $.each(this.children,function(e,i){for(var r=!1,n=0;n<t.length;n++)if(!r&&i.y<t[n].y){t.splice(n,0,i),r=!0;break}r||t.push(i)}),t},SequenceCtrl.prototype.updateScore=function(){var t=this,e=t.getOrderedItemList();$.each(e,function(e,i){t.variables["_pos"+e]=i.itemdata,i.currentIndex=e})},SequenceCtrl.prototype.set_review=function(){var t=this.ref.children(".sequencelinenumber"),e=this.getOrderedItemList();$.each(e,function(e,i){i.sequenceIndex==e?$(t[e]).addClass("correct"):$(t[e]).addClass("incorrect")})},SequenceCtrl.prototype.showBase=StageItem.prototype.show,SequenceCtrl.prototype.show=function(t,e,i,r){this.parent.ref&&(this.render(),this.showBase(t,e,i,r),r||$.each(this.children,function(r,n){n.show&&(n.ref.show(),n.render(),n.show(t,e,i))}))},SequenceCtrl.prototype.Viewed=function(){return"true"},SequenceCtrl.prototype.Viewed=function(){return this.ref&&(this.ref.get(0).scrollHeight<=this.height||this.hasScrolledToEnd)?"true":"false"};var SequenceItem=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="item",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml="",this.offsetY=this.offsetX=this.deferredResourceIndex=0,this.canvas=null,this.m_nYOffset=this.m_nXOffset=0,this.m_nHeight=this.m_nWidth=1e3};SequenceItem.prototype=new StageItem,SequenceItem.prototype.objectType="Item",SequenceItem.prototype.innerType="SequenceItem",SequenceItem.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,SequenceItem.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.id=$(t).attr("itemdata").split("_")[1],this.itemdata=$(t).attr("itemdata"),this.width=parseInt($(t).children("textdata").first().attr("width")),this.height=parseInt($(t).children("textdata").first().attr("height")),this.x=this.offsetX,this.y=this.offsetY,this.originalWidth=this.width,this.originalHeight=this.height,
this.canSimplify=!1,e=new Background(this.ref),e.rotation="90",e.fillType="linear",e.stops.push(e.parseStop('<color rgb="0xBBF8FB" alpha="100" stop="0" />')),e.stops.push(e.parseStop('<color rgb="0xA5E8EB" alpha="100" stop="100" />')),this.colors.hover=e,e=$(t).children("textdata"),t=$(t).children("textdata").children("vectortext"),i=t.children("pr"),1==i.length&&(this.textSprite={canvas:null,m_nXOffset:0,m_nYOffset:0,width:1e3,height:1e3,charIndex:0,maxCharIndex:0,vectorHot:!1,isShapeMask:!1},null!=$(t).attr("top")&&(this.textSprite.x=$(e).attr("xpos"),this.textSprite.y=$(e).attr("ypos"),this.textSprite.width=$(e).attr("width"),this.textSprite.height=$(e).attr("height"),this.textSprite.rectShape=new ppRect(parseInt($(t).attr("left")),parseInt($(t).attr("top")),parseInt($(t).attr("right")),parseInt($(t).attr("bottom"))),this.textSprite.rectShape.right=Math.max(this.textSprite.rectShape.right,this.width),this.textSprite.rectShape.bottom=Math.max(this.textSprite.rectShape.bottom,this.height),this.textSprite.originalRectShape=this.rectShape),this.textSprite.path=PathLib.getPathFromXML(i))},SequenceItem.prototype.createBaseRef=StageItem.prototype.createRef,SequenceItem.prototype.createRef=function(){if(this.ref)return this.render(),!1;this.container=this.parent.ref,this.ref=$('<div class="item sequenceitem interactive"></div>'),this.container.append(this.ref),this.ref.css("left",this.x+"px"),this.ref.css("top",this.y+"px"),this.ref.css("width",this.width+"px"),this.ref.css("height",this.height+"px"),this.contentRef=$('<div class="item unhideable"></div>'),this.contentRef.css("margin","4px 20px");var t=$('<canvas class="content"></canvas>');return t.css("position","relative"),this.ref.append(t),this.canvas=t.get(0),$(this.ref).css("width",this.width),$(this.ref).css("height",this.height),$(this.canvas).attr("width",this.width),$(this.canvas).attr("height",this.height),this.textSprite?(t=$("<canvas></canvas>"),t.css("position","absolute"),t.css("left",this.textSprite.x+"px"),t.css("top",this.textSprite.y+"px"),t.attr("width",this.width+"px"),t.attr("height",this.height+"px"),t.attr("id",this.id+"_text"),this.ref.append(t),this.textSprite.canvas=t.get(0),this.textRef=t):this.ref.append(this.contentRef),this.textTemplate="<span>"+this.textlib.children("textdata").attr("lmstext")+"</span>",this.renderTextTemplate(),this.ref.get(0).item=this,this.convertToDragItem(this.xml),this.style="sequence",this.dragreturn=!0,this.initDrag(),this.render=SequenceItem.prototype.renderOverride,this.updateDragPosition=SequenceItem.prototype.updateDragPositionOverride,this.findDropArea=SequenceItem.prototype.findDropAreaOverride,this.mouseupCallback=SequenceItem.prototype.Drop,this.show(),!0},SequenceItem.prototype.updateDragPositionOverride=function(){this.ghost||(this.ghost=this.ref.clone(),this.ghost.css("opacity",.7),this.ghost.css("z-index",1e3),this.parent.container.append(this.ghost),this.ghostCanvas=this.ghost.find("canvas").get(0));var t=this.parent.ref.get(0).scrollTop,e=this.x+this.dragX+this.parent.x,t=this.getScrolledY()+this.parent.y-t;this.ghost.show(),this.ghost.css("left",e),this.ghost.css("top",t),this.render("",this.ghostCanvas),this.render("hover",this.canvas)},SequenceItem.prototype.renderCallback=function(){},SequenceItem.prototype.renderOverride=function(t,e){var e=e||this.canvas,i=e.getContext("2d"),r=parseInt(900*Math.random()+1100)%1e3;i.fillStyle="#"+r,i.fillStyle="#fff",i.lineWidth=1,i.strokeStyle="#C7C7C7",r=i.createLinearGradient(0,0,0,this.height),r.addColorStop(0,"#fcfcfc"),r.addColorStop(1,"#eaeaea"),i.fillStyle=r,this.colors[t]&&this.colors[t].applyCanvas(i,this,!0,!1),r=this.height/2,i.beginPath(),i.moveTo(r+.5,.5),i.lineTo(this.width-r-.5,.5),i.arc(this.width-r-.5,r,r,3*Math.PI/2,Math.PI/2),i.lineTo(r+.5,this.height-.5),i.arc(r+.5,r,r,Math.PI/2,3*Math.PI/2),i.fill(),i.save(),i.clip(),i.strokeStyle="#fff",i.lineWidth=3.4,i.stroke(),i.restore(),this.colors[t]&&(i.strokeStyle=this.colors[t].stops[0].color),i.stroke(),this.textSprite&&(i=new ppTextLib(this.xml),ppArt.itemID=this.id,ppArt.item=this,ppArt.m_bMaskMode=!1,ppArt.DrawVector(this.textSprite,this.textSprite.path,i,player.fontlib,this.imagelib,null,null))},SequenceItem.prototype.getScrolledY=function(){var t=this.downScrollTop||0;return this.y+this.dragY+this.parent.ref.get(0).scrollTop-t},SequenceItem.prototype.findDropAreaOverride=function(){for(var t=this.parent.getOrderedItemList(),e=-1,i=this.getScrolledY(),r=this.parent.y,n=t.length-1;n>=0;n--){var a=t[n];i<a.y+a.height/2&&(e=n,r=this.parent.y+a.y-this.parent.padY/2),a==this&&(this.parent.originalIndex=n)}-1==e&&(a=t[t.length-1],r=this.parent.y+a.y+a.height+this.parent.padY/2),r-=this.parent.ref.get(0).scrollTop,this.parent.indicator.show(),this.parent.indicator.css("top",r),this.parent.dropIndex=e,player.lastSequenceDropIndex=e},SequenceItem.prototype.Drop=function(){if(-1==this.parent.originalIndex)this.parent.indicator.hide(),this.ghost.hide();else{this.parent.dropIndex!=player.lastSequenceDropIndex&&(this.parent.dropIndex=player.lastSequenceDropIndex),this.parent.indicator.hide(),this.ghost.hide();var t=this.parent.getOrderedItemList();if(-1==this.parent.dropIndex&&(this.parent.dropIndex=t.length),this.parent.dropIndex!=this.parent.originalIndex)for(var e=this.parent.dropIndex>this.parent.originalIndex?1:-1,i=this.parent.dropIndex>this.parent.originalIndex?0:-1,r=this.parent.originalIndex;r!=this.parent.dropIndex+i;r+=e)this.parent.swapItem(this,t[r]);this.variables._checked="true",this.parent.updateScore(),this.parent.dropIndex=-1,this.parent.originalIndex=-1}this.render()};var HotspotMarker=function(t){this.container=t||$(document.body),this.ref=null,this.constructElement(),this.xml="",this.angle=0,this.speed=.05};HotspotMarker.prototype=new StageItem,HotspotMarker.prototype.objectType="Item",HotspotMarker.prototype.innerType="HotspotMarker",HotspotMarker.prototype.toBaseData=Element.prototype.toData,HotspotMarker.prototype.toData=function(t){return t=this.toBaseData(t),this.x!=this.originalX&&(t.x=this.x),this.y!=this.originalY&&(t.y=this.y),t},HotspotMarker.prototype.updateBaseFromData=Element.prototype.updateFromData,HotspotMarker.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.x&&(this.x=t.x),t.y&&(this.y=t.y)},HotspotMarker.prototype.loadBaseFromXML=StageItem.prototype.loadFromXML,HotspotMarker.prototype.loadFromXML=function(t,e,i){this.loadBaseFromXML(t,e,i),this.originalX=this.x,this.originalY=this.y,this.height=this.width=38,this.spinnerRadius=5,this.ring1Radius=7,this.ring2Radius=16},HotspotMarker.prototype.createBaseRef=StageItem.prototype.createRef,HotspotMarker.prototype.createRef=function(){if(this.ref)return this.render(),!1;var t=this;if(!this.createBaseRef())return!1;this.ref.addClass("hotspotmarker"),this.ref.css("margin-left",-this.width/2),this.ref.css("margin-top",-this.height/2);var e=$("<canvas></canvas>");e.attr("width",this.width),e.attr("height",this.height),this.ref.append(e),this.jcanvas=e,this.canvas=e.get(0);var e=parseInt(this.parent.variables[this.id.replace("_marker","_xpos")]),i=parseInt(this.parent.variables[this.id.replace("_marker","_ypos")]);return!isNaN(e)&&e>-1?(this.ref.css("left",e),this.ref.css("top",i),setTimeout(function(){t.ref.show()},100)):(this.ref.css("left",-100),this.ref.css("top",-100)),this.spinning||(this.step(),this.spinning=!0),this.ref.show(),!0},HotspotMarker.prototype.render=function(){function t(t){return t=t%6/4,t>1&&(t=0),t>.5&&(t=1-t),0>t&&(t=0),t}if(this.ref){var e=this.canvas.getContext("2d"),i=this.width/2-2;e.clearRect(0,0,this.width,this.height),e.save(),e.translate(i+2,i+2),e.rotate(this.angle),e.beginPath(),e.arc(0,0,this.spinnerRadius,0,2*Math.PI),e.fillStyle="#000",e.fill(),e.beginPath(),e.moveTo(0,0),e.arc(0,0,this.spinnerRadius,0,Math.PI/2),e.lineTo(0,0),e.arc(0,0,this.spinnerRadius,Math.PI,3*Math.PI/2),e.fillStyle="#fff",e.fill();var i=t(this.angle+.5),r=t(this.angle);i>0&&(e.strokeStyle="rgba(0,255,255,0)",e.strokeStyle="rgba(100,255,255,"+i+")",e.lineWidth=4,e.beginPath(),e.arc(0,0,this.ring1Radius,0,2*Math.PI),e.stroke(),e.beginPath(),e.strokeStyle="rgba(100,255,255,"+r+")",e.arc(0,0,this.ring2Radius,0,2*Math.PI),e.stroke()),e.restore()}},HotspotMarker.prototype.step=function(){var t=this;if(this.ref){this.angle+=this.speed,this.render();var t=this,e=t.ref.get(0);t.ref.show(),setTimeout(function(){t.ref&&t.ref.show()},100)}HotspotMarker.requestAnimFrame()(function(){t.step()},e)},HotspotMarker.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}};var SWFItem=function(t,e,i){this.container=t||$(document.body),this.slide=e,this.layer=i,this.ref=null,this.constructElement(),this.currentIndex=0,this.content={},this.colors={},this.type="swf",this.active=!0,this.id=Math.random(),this.name="item",this.visible=this.layered=!1,this.canSimplify=!0,this.hasEvents=!1,this.xml=""};SWFItem.prototype=new StageItem,SWFItem.prototype.objectType="Item",SWFItem.prototype.innerType="SWFItem",SWFItem.prototype.createBaseRef=StageItem.prototype.createRef,SWFItem.prototype.destroyBaseRef=StageItem.prototype.destroyRef,SWFItem.prototype.createRef=function(){return this.ref?(this.container.append(this.ref),!1):(this.container=this.parent.ref,this.container?(this.ref=$('<div class="item swf unsupported"><h1>Not Supported</h1>SWF objects cannot be rendered by the HTML5 player.</div>'),this.ref.addClass(this.type),this.applySize(this.ref),this.container.append(this.ref),this.ref.get(0).item=this,!0):!1)},SWFItem.prototype.renderCallback=function(){},SWFItem.prototype.render=function(){};var Resource=function(t,e,i){this.item=t,this.src=e,this.loading=this.loaded=this.prepared=!1,this.callback=i,this.poolImage=null};Resource.ImagePool=[],Resource.LoadedImagesLog={},Resource.TotalPixels=0,Resource.LoadedImageCount=0,Resource.prototype.load=function(t,e){if(!t&&0!=t)throw"undefined index "+t;var i=this;if(this.loaded||this.deferLoading)i.execCallback(e);else if(!this.loading)switch(this.item.type){case"audio":case"video":i.execCallback(e);break;default:var r=Resource.LoadedImagesLog[i.src];if(r){i.item.imageWidth=r.width,i.item.imageHeight=r.height,i.poolImage=r,i.item.imagelib&&$.each(i.item.imagelib.m_listImages,function(t,e){i.imgLibID==e.Id&&(e.width=i.item.imageWidth,e.height=i.item.imageHeight,e.imgNode=r)}),i.loaded=!0,i.execCallback(e),i.unbind();break}i.poolImage||(i.poolImage=document.createElement("img"),i.poolImage.className="loader"),i.loadHandler=function(){i.poolImage&&(i.item.imageWidth=i.poolImage.width||i.poolImage.naturalWidth,i.item.imageHeight=i.poolImage.height||i.poolImage.naturalHeight,Resource.LoadedImagesLog[i.src]=i.poolImage,Resource.TotalPixels+=i.item.imageWidth*i.item.imageHeight,Resource.LoadedImageCount++,i.loading=!1,i.loaded||(i.loaded=!0,i.execCallback(e)),i.unbind())},i.errorHandler=function(){return i.item.ref&&i.item.ref.addClass("missing"),i.loaded=!0,i.execCallback(e),i.unbind(),!1},i.poolImage.addEventListener("load",i.loadHandler,!1),i.poolImage.addEventListener("error",i.errorHandler,!1),i.timeout=setTimeout(function(){i.loaded||(i.item.ref&&i.item.ref.addClass("missing"),i.loaded=!0,i.execCallback(e)),i.unbind()},1e4),i.poolImage.src=i.src,this.loading=!0}},Resource.prototype.unload=function(t){if(this.src)switch(this.item.type){case"audio":case"video":this.execCallback(t);break;default:this.unbind(),delete Resource.LoadedImagesLog[this.src],delete this.poolImage,this.loaded=!1}},Resource.prototype.unbind=function(){this.poolImage&&this.poolImage.removeEventListener&&(this.poolImage.removeEventListener("load",this.loadHandler,!1),this.poolImage.removeEventListener("error",this.errorHandler,!1)),clearTimeout(this.timeout)},Resource.prototype.prep=function(){this.item.prep&&(this.item.prep(),this.prepared=!0)},Resource.prototype.execCallback=function(t){t&&t(this),this.callback&&this.callback(this)};var TimelineEvent=function(t){this.actions=[],this.time=0,this.type="TimelineEvent",this.parentElement=t};TimelineEvent.prototype.loadFromXML=function(t){var e=this;e.time=parseInt($(t).attr("time")),$(t).children("actions").children().each(function(t,i){var r=new TimelineAction(e.parentElement);r.loadFromXML(i,e),e.actions.push(r)})},TimelineEvent.prototype.act=function(t,e){this.isUserInitiated=!1;var i=this,r=!0;player.currentTimelineEvent=this,$.each(this.actions,function(n,a){(!t||"media_play"!=a.type&&"media_seek"!=a.type&&"media_toggle"!=a.type)&&r&&(r=a.act(i,null,t,e,!1))}),player.currentTimelineEvent=null},TimelineEvent.prototype.getMediaDuration=function(){var t=0;return $.each(this.actions,function(e,i){if("media_play"==i.type||"media_seek"==i.type||"media_toggle"==i.type){var r=i.getItem();r.content.duration&&(t=r.content.duration)}}),t},TimelineEvent.prototype.revert=function(){$.each(this.actions,function(t,e){e.revert()})};var TimelineAction=function(t){this.type="show",this.transition=null,this.itemID="",this.item=null,this.xml="",this.variables={},this.parentElement=t};TimelineAction.prototype.loadFromXML=function(t,e){if(this.type=t.tagName,this.originalItemID=this.itemID=$(t).children("objref").attr("value"),"setfocus"==this.type&&(this.itemID=$(t).find("value").attr("value")),this.itemID&&-1<this.itemID.indexOf(".")){var i=this.itemID.split(".");this.itemID=i[i.length-1]}this.transition=new Transition,this.transition.loadFromXML(t),this.xml=t,(i=this.getItem())&&("StoryEvent"==e.type?i.canSimplify=!1:0!=e.time?i.canSimplify=!1:this.transition&&0!=this.transition.duration&&(i.canSimplify=!1))},TimelineAction.prototype.getItemPack=function(){return this.parentElement.parseObjref(this.originalItemID)},TimelineAction.prototype.getItem=function(){return this.parentElement.parseObjref(this.originalItemID).target},TimelineAction.prototype.act=function(t,e,i,r){var n=!0;return e&&this.getItem()&&this.getItem(),e=e||this.getItem()||this.parentElement||story,"function"==typeof this[this.type]?this[this.type](t,e,i,r):e?n=e.runAction(this.xml):"TimelineEvent"==t.type&&(n=player.currentSlide().runAction(this.xml)),n},TimelineAction.prototype.revert=function(){var t=this.getItem();switch(this.type){case"show":t&&"audio"!=t.type&&t.hide();break;case"hide":t&&"audio"!=t.type&&t.show()}},TimelineAction.prototype.show=function(t,e,i,r){var e=this.getItemPack(),n=e.target;!e.isVariableRef&&n&&(e=n,n=this.transition,r&&(n=null),"Slide"!=e.innerType&&e.show(t,n,i))},TimelineAction.prototype.hide=function(t,e,i,r){i=this.getItemPack(),e=i.target,i.isVariableRef||(e?(i=this.transition,r&&(i=null),e.hide(t,i)):trace.logMulti("should hide",this.itemID,e))},TimelineAction.prototype.hideallslidelayers=function(){$(".layer").hide(),$.each(player.currentSlide().layers,function(t,e){e.hide()})},TimelineAction.prototype.hide_slidelayer=function(t,e){var i=e.parseObjrefFromXML(this.xml),r=i.target;i.isVariableRef||(r.hide(this.transition),r.transitioning&&r.ref.hide())},TimelineAction.prototype.show_slidelayer=function(t,e){var i=e.parseObjrefFromXML(this.xml),r=i.target;if(!i.isVariableRef){var n="true"==$(this.xml).attr("hideothers"),i=!r.visible;n&&$.each(player.currentSlide().layers,function(t,e){e!=r&&e.hide()}),n=new Transition(r),n.loadFromXML(this.xml),r.show(n),i&&r.update(0),r.depth<r.slide.topZ&&(r.depth=++r.slide.topZ),r.setZIndex(r.depth,!0)}},TimelineAction.prototype.media_seek=function(t,e){var i=this.getItem();if(i&&(e=i),e&&e.setCurrentTime){var r=i=parseInt($(this.xml).attr("position"));"TimelineEvent"==t.type&&((r=e.getTimelineAncestor())||(r=player.currentSlide()),r=i+r.currentTime-t.time),e.shouldSetPosition=!1,i=0;try{i=Math.abs(1e3*clip.currentTime-r)}catch(n){}if(i>100){e.correctedPosition=r,e.shouldSetPosition=!0;try{e.setCurrentTime(r/1e3),e.shouldSetPosition=!1}catch(a){}}}},TimelineAction.prototype.set_volume=function(t,e){var i=this.getItem();i&&(e=i),i=parseInt($(this.xml).attr("volume")),player.clipVolume=i/100,i=util.min(i,100),i=util.max(i,0);try{e.ref.get(0).volume=i/100*player.volumeSlider.volume/100}catch(r){}},TimelineAction.prototype.media_toggle=function(t,e){var i=this.getItem();i&&(e=i),e&&(i=e.ref.get(0),!e.media_toggled&&i.paused?(e.media_toggled=!0,this.media_play(t,e)):(e.media_toggled=!1,this.media_pause(t,e)))},TimelineAction.prototype.media_play=function(t,e){var i=this.getItem();i&&(e=i),e&&(t&&"StoryEvent"==t.type&&t.isUserInitiated&&e.prep(),e.playClip)&&(this.getItem().mediaReady()||(player.blockedOn=this.getItem(),player.block()),e.isSuppressedCaptureAnimation?e.playClip():"audio"==e.innerType&&player.hasWebAudio?(player.currentClip=e.getClip(),player.currentClipStartTime=t.time,player.currentClipSyncToTimeline="TimelineEvent"==t.type,e.playClip()):(clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=e.content.src,e.setScheduled(!0),player.mediaTimeout=setTimeout(function(){player.mediaTimeout=null,player.scheduledMediaSrc=null,e.setScheduled(!1),e.playClip(),player.currentClip=e.getClip(),player.currentClipStartTime=t.time,player.currentClipSyncToTimeline="TimelineEvent"==t.type},0)))},TimelineAction.prototype.media_pause=function(t,e){if(e){var i=this.getItem();i.pauseClip(),i.media_toggled=!1}},TimelineAction.prototype.move=function(t,e,i){if(!i&&e){if(!this.path){this.path=new BezierPath,this.path.loadFromXML(this.xml,e),this.animationName="animation_"+e.id;var i="@-webkit-keyframes "+this.animationName,r=this.path.toKeyFrames(10);document.styleSheets[0].insertRule(i+r,0)}var n=this.path,a=this.animationName;t&&"StoryEvent"==t.type&&t.isUserInitiated&&(e.actionMoved=!0),e.ref.unbind("webkitAnimationEnd"),e.ref.bind("webkitAnimationEnd",function(){var t=n.points[n.points.length-1];e.ref.css("-webkit-transform","translateX("+t.x+"px) translateY("+t.y+"px)"),e.ref.css("-webkit-animation-name",""),e.ref.css("-webkit-animation-duration","0s"),e.ref.unbind("webkitAnimationEnd"),e.handleEvent("onmovecomplete")}),e.ref.css("-webkit-animation-name",""),e.ref.css("-webkit-animation-duration","0s"),setTimeout(function(){e.ref.css("-webkit-animation-name",a),e.ref.css("-webkit-animation-duration",n.duration+"ms"),e.ref.css("-webkit-animation-iteration-count","1")},0)}},TimelineAction.prototype.zoompan=function(t,e,i,r){r||(this.zoomPanObj||(this.zoomPanObj=new ZoomPan,this.zoomPanObj.loadFromXML(this.xml)),i||this.zoomPanObj.apply(player.currentSlide().ref))},TimelineAction.prototype.object_action=function(t,e){var i=$(this.xml).attr("command");if(this.getItem(),e=this.getItem().parseObjrefFromXML(this.xml).target,"function"==typeof e[i])e[i](this.xml);else switch(i){case"togglecontent":e.visible?e.hide():e.show();break;case"hidecomplete":e.hide()}},TimelineAction.prototype.adjustvar=function(t,e,i,r){var n=this,r=r||$(this.xml).attr("variable"),a=$(this.xml).attr("operator"),s=$(this.xml).children("value").attr("type"),o=$(this.xml).children("value").attr("value");switch(a){case"toggle":o="true"==e.extractVariable(r)?"false":"true";break;case"add":a=e.extractVariable(o,s),s=parseFloat(e.extractVariable(r)),isNaN(s)&&(s=0),o=s+parseFloat(a);break;case"sub":a=e.extractVariable(o,s),s=parseFloat(e.extractVariable(r)),isNaN(s)&&(s=0),o=s-parseFloat(a);break;case"mult":a=e.extractVariable(o,s),s=parseFloat(e.extractVariable(r)),isNaN(s)&&(s=0),o=s*parseFloat(a);break;case"div":a=e.extractVariable(o,s),s=parseFloat(e.extractVariable(r)),isNaN(s)&&(s=0),o=s/parseFloat(a),isNaN(o)&&(o=0);break;case"set":o=$(this.xml).children("value").attr("value"),("property"==s||"variable"==s||"var"==s)&&(o=e.extractVariable(o,s)),"number"==s&&(o=parseFloat(o))}e||(e=story),e.setVariable(r,o),0==r.indexOf("_children")&&$.each(e.children,function(e,a){var s=r.replace("_children.","");n.adjustvar(t,a,i,s)}),e.group&&this.adjustvar(t,e.group,i)},TimelineAction.prototype.exe_actiongroup=function(t,e){var i=$(this.xml).attr("id");i.indexOf("State"),e.runActionGroup(i),e.group&&e.group.runActionGroup(i)},TimelineAction.prototype.render_item=function(){this.item.render(null,!0,null,"TimelineAction.prototype.render_item")};var StoryEvent=function(t){this.trigger="",this.time=0,this.actions=[],this.type="StoryEvent",this.parentElement=t};StoryEvent.prototype.loadFromXML=function(t){var e=this;switch(this.trigger=t.tagName,$(t).children("actions").children().each(function(t,i){var r=new TimelineAction(e.parentElement);r.loadFromXML(i,e),e.actions.push(r)}),e.trigger){case"onvarchanged":case"onpropchanged":e.varname=$(t).attr("varname"),e.varname||(e.varname=$(t).attr("propname"));var i=this.parentElement.parseObjref(e.varname).target;e.filter=function(t){return void 0===t?void 0:t==e.varname||i.getFullVariableRef(t)==i.getFullVariableRef(e.varname)},i.registerVariableEventSubscriber(this.parentElement,e.varname);break;case"onobjectevent":e.eventname=$(t).attr("eventname"),e.filter=function(t){return t==e.eventname};break;case"onkeypress":e.keyCode=$(t).attr("keycode"),e.shiftKey="true"==$(t).attr("shift"),e.ctrlKey="true"==$(t).attr("ctrl"),e.altKey="true"==$(t).attr("alt"),e.filter=function(t){var i=t.keyCode==e.keyCode&&t.shiftKey==e.shiftKey&&t.ctrlKey==e.ctrlKey&&t.altKey==e.altKey;return i&&13==t.keyCode&&t.target.blur(),i};break;case"onlinkrelease":e.triggerid=$(t).attr("triggerid"),e.filter=function(t){return t==e.triggerid};break;default:e.filter=function(){return!0}}},StoryEvent.prototype.act=function(t,e){this.isUserInitiated=e,StoryEvent.currentEvent=this;var i=this,r=!0;return this.actions.forEach(function(e){r&&(r=e.act(i,t,!1,!1))}),StoryEvent.currentEvent=null,r},StoryEvent.prototype.findDownstreamMedia=function(t,e,i){return e||(e=[]),$.each(this.actions,function(r,n){switch(n.type){case"media_play":case"media_toggle":var a=n.getItem();e.push(a);break;case"show":n.getItem()&&"video"==n.getItem().type&&e.push(n.getItem());break;case"show_slidelayer":(a=t.parseObjrefFromXML(n.xml).target)&&(a=a.findDownstreamMedia(++i))&&e.push(a);break;case"if_action":$(n.xml).find("media_play,media_toggle").each(function(i,r){var n=t.parseObjrefFromXML(r).target;n&&e.push(n)}),$(n.xml).find("show_slidelayer").each(function(r,n){var a=t.parseObjrefFromXML(n).target;a&&(a=a.findDownstreamMedia(++i))&&e.push(a)})}}),0<e.length?e[0]:null},TimelineEvent.prototype.findDownstreamMedia=StoryEvent.prototype.findDownstreamMedia;var Background=function(t){this.container=t||$(document.body),this.backgroundType="fill",this.fillType="linear",this.stops=[]};Background.prototype.loadFromXML=function(t,e){var i=this;switch(i.backgroundType=e||$(t).attr("type"),this.backgroundType){case"fill":i.rotation=$(t).children("fill").attr("rotation"),i.fillType=$(t).children("fill").attr("type"),i.stops=[];var r=$(t).attr("url");r&&(i.src=player.basepath+"mobile/"+r),$(t).children("fill").children("colors").children("color").each(function(t,e){var r=i.parseStop(e);i.stops.push(r)});break;case"swf":i.src=player.basepath+""+$(t).children("imagedata").attr("url").replace("story_content","mobile").replace(".swf",".jpg");break;case"vector":r=$(t).children("vectordata"),i.state={left:r.attr("left"),top:r.attr("top"),right:r.attr("right"),bottom:r.attr("bottom"),path:PathLib.getPathFromXML(r.children("pr"))},i.rectShape=new ppRect(i.state.left,i.state.top,i.state.right,i.state.bottom)}i.src&&(i.img=new Image,i.img.src=i.src)},Background.prototype.parseStop=function(t){return{rawcolor:$(t).attr("rgb").replace("0x","#"),color:Background.parseRGBA($(t).attr("rgb"),$(t).attr("alpha")),stop:parseInt($(t).attr("stop"))/255,alpha:parseInt($(t).attr("alpha"))/100}},Background.parseRGBA=function(t,e){var i=Frame.parseRGB(t.replace("0x","#"));return i.push(parseInt(e)/100),"rgba("+i.join(",")+")"},Background.prototype.colorStops=function(){var t="";return $.each(this.stops,function(e,i){""!=t&&(t+=","),t+=i.color+" "+100*i.stop+"%"}),t},Background.prototype.toColorString=function(){return this.stops[0].color},Background.prototype.toCssString=function(){switch(this.backgroundType){case"fill":return this.src?"transparent url("+this.src+") no-repeat":1==this.stops.length?this.stops[0].color:"-webkit-linear-gradient(top, "+this.colorStops()+")";case"swf":return"transparent url("+this.src+") no-repeat"}},Background.prototype.toCss=function(){if(player.noImg)return{};var t={};switch(this.backgroundType){case"fill":t.background=this.src?"transparent url("+escape(this.src)+") no-repeat":1==this.stops.length?this.stops[0].color:"-webkit-linear-gradient(top, "+this.colorStops()+")";break;case"swf":t.background="transparent url("+escape(this.src)+") no-repeat";break;case"vector":this.generateVectorSrc(),t.background="transparent url("+this.src+") no-repeat"}return t},Background.prototype.generateVectorSrc=function(){this.src||(this.canvas=document.createElement("canvas"),this.canvas.width=this.state.right,this.canvas.height=this.state.bottom,this.m_nYOffset=this.m_nXOffset=0,this.height=this.width=1e3,ppArt.DrawVector(this,this.state.path,null,player.fontlib,this.imagelib,null),this.src=this.canvas.toDataURL("image/png"),this.canvas=null)},Background.prototype.apply=function(t){this.container=t||this.container;var e=this;$.each(this.toCss(),function(t,i){$(e.container).css(t,i)})},Background.prototype.toCanvasGradient=function(t,e){var i=t.createLinearGradient(0,0,0,e);return $.each(this.stops,function(t,e){i.addColorStop(e.stop,e.color)}),i},Background.prototype.applyCanvas=function(t,e,i,r){switch(this.backgroundType){case"fill":var n=t.createLinearGradient(0,0,0,e.height);$.each(this.stops,function(t,e){n.addColorStop(e.stop,e.color)}),i&&(t.fillStyle=n),r&&(t.strokeStyle=n)}},Background.prototype.drawCanvas=function(t,e,i,r){switch(this.backgroundType){case"fill":this.src?t.drawImage(this.img,0,0):(this.applyCanvas(t,e,i,r),t.fillRect(0,0,e.width,e.height));break;case"swf":t.drawImage(this.img,0,0)}};var SlideBank=function(){this.constructElement(),this.id="_slidebank_"+SlideBank.index,SlideBank.index++,this.bankSlideIndex=0};SlideBank.prototype=new Element,SlideBank.prototype.objectType="SlideBank",SlideBank.prototype.innerType="SlideBank",SlideBank.index=0,SlideBank.prototype.loadFromXML=function(t){var e=this;this.children={},$(t).children("slides").children("slide").each(function(t,i){var r=new Slide(story.container);r.loadFromXML($(i)),r.parent=e,story.allSlides.push(r),story.slideLookup[r.id]=r,e.children[r.id]=r,r.slideIndex=story.allSlides.length-1,r.bankSlideIndex=e.bankSlideIndex++})};var SlideDraw=function(){this.constructElement(),this.interactions={},this.exitActions=[],this.draw=[],this.orderedChildren=[],this.navLinks=[],this.sceneDrawIndex=this.drawIndex=0,this.quiz=null,this.populated=!1};SlideDraw.NextSlideIndex=0,SlideDraw.prototype=new Element,SlideDraw.prototype.objectType="SlideDraw",SlideDraw.prototype.innerType="SlideDraw",SlideDraw.prototype.getRandomMember=ShuffleGroup.prototype.getRandomMember,SlideDraw.prototype.getRandomIndex=ShuffleGroup.prototype.getRandomIndex,SlideDraw.populateDraws=function(){$.each(story.children,function(t,e){"Scene"==e.innerType&&e.populateDraws()}),player.calculateTotalViewSlides()},SlideDraw.prototype.restoreFromResumeData=function(t){this.compactResumeData=bwChunk.CreateChunk(t);var e=new bwChunk(t);for(this.draw=[];!e.EOF();)this.draw.push(this.refs[e.NextUBase10(2)]);for(this.populateDraw(),t=0,e=e.NextChunk();!e.isNothing;){var i=this.orderedChildren[t];i.compactResumeData=e.ChunkData(),i.restoreFromResumeData(e.ChunkData(),!0),t++,e=e.NextChunk()}},SlideDraw.prototype.getResumeData=function(){var t="",e="";$.each(this.orderedChildren,function(i,r){t+=bwChunk.UBase10toN(r.drawListIndex,2),e=r.compactResumeData?e+r.compactResumeData:e+bwChunk.EMPTY_CHUNK});var i=bwChunk.CreateChunk(bwChunk.CreateChunk(t)+e);return this.compactResumeData=i,this.parent.compactResumeData=this.parent.getResumeData(),i},SlideDraw.prototype.toBaseData=Element.prototype.toData,SlideDraw.prototype.toData=function(t){return t=this.toBaseData(t),t.draw=this.draw,t},SlideDraw.prototype.updateBaseFromData=Element.prototype.updateFromData,SlideDraw.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.draw&&(this.draw=t.draw,this.populateDraw())},SlideDraw.prototype.loadFromXML=function(t){var e=this;this.id=$(t).attr("id"),this.lmsid=$(t).attr("lmsid"),this.shuffle="true"==$(t).attr("shuffle"),this.shufflecount=parseInt($(t).attr("shufflecount")),e.variables.Id=$(t).attr("id"),e.variableDefaults.Id=$(t).attr("id"),e.variables.WindowId="_frame",e.variableDefaults.WindowId="_frame",$(t).children("exitaction").children().each(function(t,i){var r=new TimelineAction(e);r.loadFromXML(i,e),e.exitActions.push(r)}),this.refs=[],$(t).children("sliderefs").children("slideref").each(function(t,i){var r={id:$(i).attr("id"),index:t,shuffleinclude:"true"==$(i).attr("shuffleinclude"),linknext:"true"==$(i).attr("linknext"),linkprev:"true"==$(i).attr("linkprev")};e.refs.push(r)})},SlideDraw.prototype.createDraw=function(){if(this.shuffle){var t=this;this.draw=[];for(var e=[],i=[],r=[];0<this.refs.length&&this.refs[0].linkprev;){var n=this.refs.shift();t.draw.push(n)}for(;0<this.refs.length&&this.refs[this.refs.length-1].linknext;)r.unshift(this.refs.pop());for($.each(this.refs,function(t,r){i.push(r),r.linknext||(e.push(i),i=[])}),n=0;t.draw.length+r.length<this.shufflecount&&0<e.length&&100>n++;){var a=this.shufflecount-t.draw.length-r.length,s=t.getRandomIndex(e),o=e[s];o.length<=a&&($.each(o,function(e,i){t.draw.push(i)}),e.splice(s,1))}if(n>=100&&0<e.length){var l=1e3,l=null;$.each(e,function(t,e){(!l||l.length>e.length)&&(l=e)}),$.each(l,function(e,i){t.draw.push(i)})}for(;0<r.length;)t.draw.push(r.shift())}else this.createDrawUnshuffled()},SlideDraw.prototype.createDrawUnshuffled=function(){for(this.draw=[];this.refs.length;)this.draw.push(this.refs.shift())},SlideDraw.prototype.getQuiz=function(){return this.quiz},SlideDraw.prototype.populateDraw=function(){var t=this;this.children={},$.each(this.draw,function(e,i){var r=i.id,n=story.slideLookup[r],a=new Slide(story.container);a.loadFromXML($(n.xml)),a.parent=t,a.slideBank=t,story.allSlides.push(a),player.slideLoadQueue.push(story.allSlides.length-1),a.originalSlideIndex=a.slideIndex,a.drawSlideIndex=e,a.slideIndex=story.allSlides.length-1,a.slideIndexForResume=SlideDraw.NextSlideIndex++,a.sceneIndex=t.parent.sceneIndex,a.drawIndex=t.sceneDrawIndex,a.bankSlideIndex=n.bankSlideIndex,a.drawListIndex=i.index,t.children[r]=a,t.orderedChildren.push(a)}),player.slideLoadQueue.restart(),player.slideList.contentRef.empty(),$("#slide_list_portrait").empty(),player.slideList=new SlideList,player.slideList.build(Frame.navLinks,null,null,null,player.slideList.tree),player.slideList.build(Frame.navLinks,$("#slide_list_portrait")),this.populated=!0},SlideDraw.prototype.showFirst=function(){player.currentDraw=this;var t=this.getFirstSlide();this.parent.compactResumeData=this.parent.getResumeData(),player.showSlideIndex(t.slideIndex,null,!0)},SlideDraw.prototype.getFirstSlide=function(){return this.drawIndex=0,player.currentDraw=this,0==this.draw.length&&SlideDraw.populateDraws(),this.children[this.draw[this.drawIndex].id]},SlideDraw.prototype.getFirstSpecifiedSlide=function(){return story.slideLookup[this.refs[0].id]},SlideDraw.prototype.playnextdrawslide=function(){function t(){10<i++||e.fullyLoaded?player.currentWindow?player.currentWindow.showSlide(e,!1):player.showSlideIndex(e.slideIndex,null,!0):setTimeout(t,200)}if(player.currentDraw=this,0==this.draw.length&&SlideDraw.populateDraws(),player.currentSlide().parent==this&&(this.drawIndex=player.currentSlide().drawSlideIndex),this.drawIndex++,this.drawIndex>=this.draw.length)player.currentSlide().saveIfNecessary(),this.fireExitActions();else{var e=this.children[this.draw[this.drawIndex].id];e.loadContentFromXML();var i=0;t()}},SlideDraw.prototype.fireExitActions=function(){var t=this;$.each(this.exitActions,function(e,i){i.act(t,null,!1,!1)})},SlideDraw.prototype.sniffDrawIndex=function(t){var e=this;
$.each(this.draw,function(i,r){r==t.id&&(e.drawIndex=i)})},SlideDraw.prototype.resetSlide=function(t,e){$.each(this.children,function(i,r){r.resetSlide(t,e)}),this.compactResumeData=""};var SlideList=function(t){this.container=t||$(document.body),this.ref=null,this.ref=$("#menu_container"),this.landscapeContainer=$("#landscape_menu"),this.portraitContainer=$("#portrait_menu"),this.contentRef=$("#slide_list"),this.closed=!1,this.scroll={moved:!1},this.tree=new SlideListNode,player.simplenav&&(this.contentRef.removeClass("menu_list"),this.contentRef.addClass("slidelist"))};SlideList.maxDepth=0,SlideList.SetDepth=function(t,e){e>SlideList.maxDepth&&(SlideList.styleSheet||(SlideList.styleSheet=new CustomStyleSheet),SlideList.styleSheet.add("ul.slidelist li.depth"+e,"padding-left",6+12*e+"px"),SlideList.styleSheet.add("ul.slidelist li.depth"+e+".has_children","padding-left",-10+12*e+"px"),SlideList.styleSheet.add("ul.slidelist li.depth"+e+".correct:before","left",213-12*e+"px"),SlideList.styleSheet.add("ul.slidelist li.depth"+e+".incorrect:before","left",213-12*e+"px"),SlideList.styleSheet.add(".toptab ul.slidelist li.depth"+e+".correct:before","left",270-12*e+"px"),SlideList.styleSheet.add(".toptab ul.slidelist li.depth"+e+".incorrect:before","left",270-12*e+"px"),SlideList.styleSheet.build(),SlideList.maxDepth=e),t.addClass("depth"+e)},SlideList.prototype.build=function(t,e,i,r,n){var a=this,e=e||a.contentRef,i=i||"",r=r||1,n=n||new SlideListNode;a.hasBuilt=!0;var s=function(t,i){var s=$("<li>"+i+" "+t.displaytext+"</li>");t.slideid?s.attr("id",t.slideid):t.drawid&&s.attr("id",t.drawid),SlideList.SetDepth(s,r);var o=new SlideListNode(n,t);if(n.push(o),s.toggleExpand=function(){return o.toggleExpand(),!1},s.click(function(e){if(a.scroll.moved||player.currentWindow&&"MessageWnd"==player.currentWindow.id)return!1;if(s.hasClass("has_children")&&1==s.children("span").length){var i=s.children("span").position().left;if(e.offsetX<i+10&&!s.hasClass("neither"))return s.toggleExpand()}return $(this).hasClass("selected")||$(this).hasClass("locked")?!1:($(".window").hide(),player.slideList.hide(),$(".toptab.active").removeClass("active"),story.parseObjref(t.slideid).target?(player.showSlideID(t.slideid,!0),!1):!1)}),e.append(s),t.links){var l=$("<span/>");s.prepend(l),s.addClass("has_children open"),a.build(t.links,e,i,r+1,o)}else(l=story.parseObjref(t.slideid).target)&&"SlideDraw"==l.innerType?a.addSlideDraw(l,t):!l&&t.expand&&(l=$("<span/>"),s.prepend(l),s.addClass("has_children neither"));t.listitems||(t.listitems=[]),t.listitems.push(s),t.expand||s.toggleExpand()},o=player.frame.options.autonumber,l=0;$.each(t,function(t,e){if(e.drawid){var r=story.parseObjref(e.drawid).target;$.each(r.children,function(t,e){if("Slide"==e.innerType){var r=o?i+(l+1)+".":"",n={slideid:e.getFullObjref(),displaytext:e.title,expand:!0};e&&e.navLinks&&e.navLinks.push(n),s(n,r),l++}})}else s(e,o?i+(t+1)+".":"")})},SlideList.prototype.addSlideDraw=function(t,e){t.navLinks=[e],$.each(t.children,function(t,i){"Slide"==i.innerType&&i.navLinks.push(e)})},SlideList.prototype.addSlideDrawExpanded=function(t,e,i,r){var n=this,r=r||"",a=0;$.each(t.children,function(t,s){if("Slide"==s.innerType){var o=$('<li><span></span><a href="javascript:void(null);" title="">'+(player.frame.options.autonumber?r+(a+1)+".":"")+" "+s.title+"</a></li>");o.attr("id",s.getFullObjref()),o.click(function(){return n.scroll.moved?!1:(player.showSlideID(e+"."+s.id,!0),$(".window").hide(),player.slideList.hide(),!1)}),i.append(o),a++,s.navLinks.push({listitems:[o]})}})},SlideList.prototype.toggle=function(){this.visible?this.hide():this.show()},SlideList.prototype.show=function(){this.visible||(this.visible=!0,Transition.applyCss({"-webkit-transition-property":"none","-webkit-transition-duration":"0ms",opacity:1,display:"block"},this.portraitContainer),$("#control-menu").addClass("active"),this.refresh(),this.scrollSelectedIntoView(1))},SlideList.prototype.hide=function(){this.visible&&(this.visible=!1,this.portraitContainer.hide(),$("#control-menu").removeClass("active"))},SlideList.prototype.refresh=function(){this.scroll={moved:!1}},SlideList.prototype.scrollSelectedIntoView=function(){$(".slidelist .selected").each(function(t,e){var i=$(e).closest(".slidelist"),r=$(e).position().top,n=$(e).height(),a=i.position().top,s=i.parent().height(),o=i.parent().get(0).scrollTop,l=r-a-n,r=r-a-s+2*n;r>o&&(i.parent().get(0).scrollTop=r),o>l&&(i.parent().get(0).scrollTop=l)})},SlideList.prototype.markVisited=function(t){var e=function(t){t.listitems&&$.each(t.listitems,function(t,e){e.addClass("visited")})};!function(t){$.each(t.navLinks,function(t,i){i.parent&&e(i.parent),e(i)})}(t)},SlideList.prototype.collapseSections=function(t){Frame.navLinks&&player.slideList&&(player.frame.options.autocollapse&&0<t.navLinks.length&&$.each(player.slideList.tree.children,function(t,e){e.collapse()}),$.each(t.navLinks,function(t,e){$.each(e.nodes,function(t,e){for(;e&&!e.isRoot;)e.expand(),e=e.parent})}))},SlideList.prototype.collapseAll=function(){this.tree.collapse(!0),this.tree.expand()},SlideList.shorten=function(t,e){if(t.length>e){for(var i=t.substr(0,e-3),r=i.length-1;r>0;r--)if(" "==i.substr(r,1))return i.substr(0,r)+"&hellip;";return"&hellip;"}return t};var SlideListNode=function(t,e){e||(e={listitems:[]},this.isRoot=!0),this.parent=t,this.link=e,this.children=[],this.expanded=!0,e.nodes||(e.nodes=[]),e.nodes.push(this)};SlideListNode.prototype.push=function(t){this.children.push(t)},SlideListNode.prototype.hasChildren=function(){return 0<this.children.length},SlideListNode.prototype.toggleExpand=function(){this.hasChildren()&&(this.expanded?this.collapse():this.expand())},SlideListNode.prototype.expand=function(){this.expanded=!0,this.updateDescendants(),$.each(this.link.listitems,function(t,e){e.addClass("open")})},SlideListNode.prototype.collapse=function(t,e){t&&$.each(this.children,function(t,e){e.collapse(!0,!0)}),this.expanded=!1,e||this.updateDescendants(),$.each(this.link.listitems,function(t,e){e.removeClass("open")})},SlideListNode.prototype.show=function(){$.each(this.link.listitems,function(t,e){e.show()})},SlideListNode.prototype.hide=function(){$.each(this.link.listitems,function(t,e){e.hide()})},SlideListNode.prototype.updateDescendants=function(t){var e=t||!this.expanded;$.each(this.children,function(t,i){e?i.hide():i.show(),i.updateDescendants(e)})};var Transition=function(t){this.target=null,this.transition=Transition.TransType.appear,this.duration=750,this.direction=1,this.reverse=this.pan=this.wipe=!1,this.runCount=0,this.hasContext=!1,t&&this.setTarget(t)};Transition.TransType={appear:"appear",fly:"fly",fade:"fade",grow:"grow",spin:"spin"},Transition.Direction={1:{getLeft:function(t){return-t.targetWidth},getTop:function(t,e){return e}},2:{getLeft:function(t){return t.containerWidth},getTop:function(t,e){return e}},4:{getLeft:function(t,e){return e},getTop:function(t){return-t.targetHeight}},8:{getLeft:function(t,e){return e},getTop:function(t){return t.containerHeight}}},Transition.prototype.toString=function(){return"[duration:"+this.duration+", direction:"+this.direction+", type:"+this.transition+"]"},Transition.prototype.setTarget=function(t){this.target=t,this.hasContext||this.sniffContext()},Transition.prototype.sniffContext=function(){if(player.width&&1!=player.width){switch(this.target.objectType){case"Item":this.targetLeft=this.target.x,this.targetTop=this.target.y,this.targetWidth=this.target.width,this.targetHeight=this.target.height,this.containerWidth=player.width,this.containerHeight=player.height;break;case"Layer":this.targetTop=this.targetLeft=0,this.targetWidth=player.width,this.targetHeight=player.height,this.containerWidth=player.width,this.containerHeight=player.height;break;case"Slide":this.targetTop=this.targetLeft=0,this.targetWidth=player.width,this.targetHeight=player.height,this.containerWidth=player.width,this.containerHeight=player.height;break;case"Bounce":this.targetTop=this.targetLeft=0,this.targetWidth=player.width/10,this.targetHeight=player.height/10,this.containerWidth=player.width/10,this.containerHeight=player.height/10}this.hasContext=!0}},Transition.prototype.loadFromXML=function(t,e){e&&this.setTarget(e),this.transition=$(t).attr("transition"),this.animationid=$(t).attr("animationid"),$(t).attr("transduration")?(this.duration=parseInt($(t).attr("transduration")),this.direction=$(t).attr("transdir"),this.wipe="true"==$(t).attr("wipetrans")):(this.duration=parseInt($(t).attr("duration")),this.direction=$(t).attr("direction")),this.reverse="hide"==$(t).get(0).tagName.toLowerCase()},Transition.prototype.getOffscreenPosition=function(){var t=this,e={x:this.targetLeft,y:this.targetTop};return $.each(Transition.Direction,function(i,r){t.direction&parseInt(i)&&(e.x=r.getLeft(t,e.x),e.y=r.getTop(t,e.y))}),e},Transition.prototype.getOffscreenCss=function(t){var e=0,i=0;-1<this.transition.indexOf(Transition.TransType.fly)&&(i=this.getOffscreenPosition(),e=i.x-this.targetLeft,i=i.y-this.targetTop),t&&(e=-e,i=-i),t=0,-1<this.transition.indexOf(Transition.TransType.spin)&&(t=360),this.target&&"Item"==this.target.objectType&&(t+=this.target.rotation);var r=1;this.target&&void 0!=this.target.scale&&(r=this.target.scale),-1<this.transition.indexOf(Transition.TransType.grow)&&(r=.01);var n=1;return-1<this.transition.indexOf(Transition.TransType.fade)&&(n=.02),player.isChrome&&this.target&&this.target.hasDescendantByType&&this.target.hasDescendantByType("video")&&(t=0==t?.02:t),{"-webkit-transform":"translate3d("+e+"px,"+i+"px,0px) scale("+r+") rotate("+t+"deg)","-moz-transform":"translate3d("+e+"px,"+i+"px,0px) scale("+r+") rotate("+t+"deg)","-o-transform":"translate3d("+e+"px,"+i+"px,0px) scale("+r+") rotate("+t+"deg)","-ms-transform":"translate("+e+"px,"+i+"px) scale("+r+") rotate("+t+"deg)",opacity:n}},Transition.prototype.getZeroCss=function(){var t=0;this.target&&"Item"==this.target.objectType&&(t=this.target.rotation);var e=1;return this.target&&void 0!=this.target.scale&&(e=this.target.scale),player.isChrome&&this.target&&this.target.hasDescendantByType&&this.target.hasDescendantByType("video")&&(t=0==t?.02:t),{"-webkit-transform":"translate3d(0px,0px,0px) scale("+e+") rotate("+t+"deg)","-moz-transform":"translate3d(0px,0px,0px) scale("+e+") rotate("+t+"deg)","-o-transform":"translate3d(0px,0px,0px) scale("+e+") rotate("+t+"deg)","-ms-transform":"translate(0px,0px) scale("+e+") rotate("+t+"deg)",opacity:1}},Transition.prototype.getImmediateCss=function(){return{"-webkit-transition-property":"-webkit-transform, opacity","-webkit-transition-duration":"0s","-moz-transition-property":"-moz-transform, opacity","-moz-transition-duration":"0s","-o-transition-property":"-o-transform, opacity","-o-transition-duration":"0s","-ms-transition-property":"-ms-transform, opacity","-ms-transition-duration":"0s"}},Transition.prototype.getTransitionCss=function(t){return t=t||"ease-out",{"-webkit-transition-property":"-webkit-transform, opacity","-webkit-transition-duration":this.duration+"ms","-webkit-transition-timing-function":t,"-moz-transition-property":"-moz-transform, opacity","-moz-transition-duration":this.duration+"ms","-moz-transition-timing-function":t,"-o-transition-property":"-o-transform, opacity","-o-transition-duration":this.duration+"ms","-o-transition-timing-function":t,"-ms-transition-property":"-ms-transform, opacity","-ms-transition-duration":this.duration+"ms","-ms-transition-timing-function":t}},Transition.applyCss=function(t,e){$.each(t,function(t,i){$(e).css(t,i)})},Transition.prototype.applyCss=function(t,e){Transition.applyCss(t,e)},Transition.prototype.apply=function(t,e,i,r){var n=this,a={},s={},e=e||n.target.ref,r=r||"ease-out";this.hasContext||this.sniffContext(),this.reverse||this.wipe?(a=n.getZeroCss(),s=n.getOffscreenCss(!1)):(a=n.getOffscreenCss(!1),s=n.getZeroCss());var o=n.getOffscreenCss(!0);e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),n.applyCss(n.getImmediateCss(),e),n.applyCss(a,e),n.target.runningTransition=n,setTimeout(function(){var a=!1;e.bind("webkitTransitionEnd transitionend oTransitionEnd",function(){n.target.runningTransition=null,e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),t&&!a&&(a=!0,t())}),0<n.duration&&0<e.length&&setTimeout(function(){t&&!a&&n.target.runningTransition==n&&(e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),n.target.runningTransition=null,a=!0,t())},2*n.duration),n.applyCss(n.getTransitionCss(r),e),n.applyCss(s,e),n.pan&&i&&(n.applyCss(n.getTransitionCss(r),i),n.applyCss(o,i)),player.canAnimate&&0!=n.duration&&0!=e.length||!t||(e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),t&&t())},0)},Transition.prototype.applyCustom=function(t){this.target.animations[this.animationid].start(this.target,!1,player.activeTimeline,t)},Transition.bounce=function(t,e){if(player.canAnimate){var i=new Transition({objectType:"Bounce"});i.duration=100,i.direction=e,i.transition=Transition.TransType.fly,$.each(t,function(t,e){i.applyCss(i.getImmediateCss(),e),i.applyCss(i.getZeroCss(),e)}),setTimeout(function(){$.each(t,function(t,e){i.applyCss(i.getTransitionCss(),e),i.applyCss(i.getOffscreenCss(),e),e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),e.bind("webkitTransitionEnd transitionend oTransitionEnd",function(){i.duration=400,e.unbind("webkitTransitionEnd transitionend oTransitionEnd"),i.applyCss(i.getTransitionCss(),e),i.applyCss(i.getZeroCss(),e)})})},0)}},Transition.prototype.convertToAnimation=function(t){if(this.transition==Transition.TransType.custom)return t.animations[this.animationid];if(this.convertedAnimation)return this.convertedAnimation;this.runCount++;var e=new Animation,i=new bwAnimation;if(i.setDuration(this.duration),i.SetEffects(this.transition),i.TransitionIn=!0,i.setStartXPos(t.originalX),i.setStartYPos(t.originalY),i.setStartAlpha(100),i.setStartXScale(1),i.setStartYScale(1),i.setEndXPos(t.originalX),i.setEndYPos(t.originalY),i.setEndAlpha(100),i.setEndRotation(0),i.setEndXScale(1),i.setEndYScale(1),t.animations[e.id]=e,i.getFlyEnabled()){var r=this.direction;r&bwAnimation.TRANS_DIR_LEFT?i.setStartXPos(-t.width):r&bwAnimation.TRANS_DIR_RIGHT&&i.setStartXPos(t.container.width()),r&bwAnimation.TRANS_DIR_TOP?i.setStartYPos(-t.height):r&bwAnimation.TRANS_DIR_BOTTOM&&i.setStartYPos(t.container.height())}return i.getFadeEnabled()&&i.setStartAlpha(0),i.getGrowEnabled()&&(i.setStartXScale(0),i.setStartYScale(0)),i.m_bReverse=this.reverse||this.wipe,e.bwa=i,e.item=t,e.target=t.ref,e.isTransition=!0,e.uniqueID="trans_"+t.getFullObjref()+"_"+Animation.sequence++,e.duration=this.duration,this.convertedAnimation=e};var Animation=function(){this.running=!1,this.startTime=0,this.ms=-1};Animation.sequence=0,Animation.prototype.getAnimationName=function(){return this.uniqueID},Animation.prototype.isTimeWithinAnimation=function(t){return t>=this.startTime&&t<=this.startTime+this.duration},Animation.prototype.isTimeAfterAnimation=function(t){return t>this.startTime+this.duration},Animation.prototype.step=function(t){this.running&&this.target&&this.timeline.visible&&(t-=this.startTime,!(t>this.duration&&this.ended&&!this.persistent))&&(this.ended=!1,this.seek(this.target,this.reverse,t,!0),(this.showOnFirstStep||this.item.showOnFirstStep)&&(player.addToShowQueue(this.item,!0),this.showOnFirstStep=!1,this.item.showOnFirstStep=!1),t>this.duration&&this.end())},Animation.prototype.seek=function(t,e,i){if(t&&this.item.ref&&(t==this.item.ref||t.attr("id")==this.item.ref.attr("id"))&&(this.ms!=i||0==this.ms)&&(i>this.bwa.m_nDuration&&(i=this.bwa.m_nDuration),this.item.ref)){this.ms=i;var e=this.bwa.GetTransformAtTime(i),r=new MatrixTransform,n=i="",a=this.item.rotatexpos,s=this.item.rotateypos;if(this.item.maskTranslate&&(i+=this.item.maskTranslate,n+=this.item.maskTranslateIE),e.scale&&!isNaN(e.scale.x)){var o=1;void 0!==this.item.scale&&1!=this.item.scale&&(o=this.item.scale),r.scale(e.scale.x/100*o,e.scale.y/100*o),i+="scale("+e.scale.x/100*o+","+e.scale.y/100*o+") ",n+="scale("+e.scale.x/100*o+","+e.scale.y/100*o+") "}else void 0!==this.item.scale&&1!=this.item.scale&&(r.scale(this.item.scale,this.item.scale),i+="scale("+this.item.scale+") ",n+="scale("+this.item.scale+") ");e.position&&!isNaN(e.position.x)&&(e.position.x=parseInt(e.position.x),e.position.y=parseInt(e.position.y),this.item)&&(this.item.x=parseInt(e.position.x),this.item.y=parseInt(e.position.y),this.item.ref.css("left",this.item.x+this.item.xoffset),this.item.ref.css("top",this.item.y+this.item.yoffset)),this.item.realRotation=this.item.rotation,isNaN(e.rotation)?0!=this.item.rotation&&(i+="rotate("+this.item.rotation+"deg) ",n+="rotate("+this.item.rotation+"deg) "):(r.rotateDegrees(parseInt(e.rotation)),e.rotation=parseInt(e.rotation),r=parseInt(e.rotation)%360,i+="rotate("+r+"deg) ",n+="rotate("+r+"deg) ",this.item.rotation=r),isNaN(e.alpha)||$(t).css("opacity",e.alpha/100),$(t).css("-webkit-transform-origin",a+void 0+"px "+(s+void 0)+"px"),$(t).css("-webkit-transform",i),$(t).css("-moz-transform-origin",a+void 0+"px "+(s+void 0)+"px"),$(t).css("-moz-transform",i),$(t).css("-ms-transform-origin",a+void 0+"px "+(s+void 0)+"px"),$(t).css("-ms-transform",n),t.hasTransformed=!0,this.item.updateMatrix(),this.item.currentTransform=e,this.item.rotation=this.item.realRotation,this.item.handleVarChanged("animationstep","animationstep")}},Animation.prototype.start=function(t,e,i,r,n){this.timeline=i;var a=i.getAnimationTime();void 0!=n?a=n:player.currentTimelineEvent&&(a=player.currentTimelineEvent.time),a+this.duration>i.duration&&(i.duration=a+this.duration),this.item.transitioning||(this.running&&t==this.target&&e!=this.reverse&&(i=a-this.startTime,i<this.duration&&(a=a-this.duration+i)),this.endOtherAnimationsForItem(this.item),this.target=t,this.reverse=e,this.startTime=a,this.running=!0,this.ended=!1,this.item.currentTransform=null,this.item.animating=!0,this.item.animationEnded=!1,this.isZeroLength?(this.bwa.m_bReverse=this.reverse,this.seek(this.target,this.reverse,0,!0),this.end()):(this.item.justShowed&&(player.removeFromShowQueue(this.item),this.item.ref&&this.item.ref.hide(),this.showOnFirstStep=!0),this.hasRun=!0,player.currentAnimations[this.uniqueID]=this,this.endCallback=r,player.ensureTicking()))},Animation.prototype.finish=function(t){!this.ended&&this.running&&(this.seek(this.target,this.reverse,this.duration,!0),this.end(t))},Animation.prototype.end=function(t){var e=this;this.ended||(this.ended=!0,this.item.animationEnded=!0,e.item.updateMatrixComplete(!0),t||(this.item&&this.item.handleEvent&&this.item.handleEvent("onanimationcomplete",this.reverse,function(t,i,r){return t=$(r.xml).attr("id"),r="true"==$(r.xml).attr("reverse"),e.id==t&&e.reverse==r},!1,!0,!1),this.endCallback&&this.endCallback()))},Animation.prototype.endOtherAnimationsForItem=function(t){var e=this;$.each(player.currentAnimations,function(i,r){r.item==t&&r!=e&&r.finish(!0)})},Animation.getBezierPoint=function(t,e,i,r,n){var t=1-t,a=new function(t,e){return t||(t=0),e||(e=0),{x:t,y:e}};return a.x=e.x*t*t*t+3*r.x*t*t*(1-t)+3*n.x*t*(1-t)*(1-t)+i.x*(1-t)*(1-t)*(1-t),a.y=e.y*t*t*t+3*r.y*t*t*(1-t)+3*n.y*t*(1-t)*(1-t)+i.y*(1-t)*(1-t)*(1-t),a},Animation.EasingLookups={},Animation.getEasingLookup=function(t){function e(t,e,i,r){for(var n=-1,a={},s=0;1>=s;s+=.01)for(var o=Animation.getBezierPoint(s,new Point(0,0),new Point(1,1),new Point(t,e),new Point(i,r)),l=Math.round(100*o.x),h=n+1;l>=h;h++)a[h]=o.y,n=h;return a[0]=0,a[100]=1,a}function i(){for(var t={},e=0;100>=e;e++){var i=e/100,r=void 0;1/2.75>i?r=7.5625*Math.pow(i,2):2/2.75>i?(i-=1.5/2.75,r=7.5625*Math.pow(i,2)+.75):2.5/2.75>i?(i-=2.25/2.75,r=7.5625*Math.pow(i,2)+.9375):(i-=2.625/2.75,r=7.5625*Math.pow(i,2)+.984375),t[e]=r}return t}if(t in Animation.EasingLookups)return Animation.EasingLookups[t];switch(t){case bwTween.EASE_IN:Animation.EasingLookups[t]=e(.42,0,1,1);break;case bwTween.EASE_OUT:Animation.EasingLookups[t]=e(0,0,.58,1);break;case bwTween.EASE_INOUT:Animation.EasingLookups[t]=e(.42,0,.58,1);break;case bwTween.EASE_BOUNCE:Animation.EasingLookups[t]=i();break;default:for(var r=0;100>=r;r++)points[r]=r/100;Animation.EasingLookups[t]=[]}return Animation.EasingLookups[t]},Animation.endForItem=function(t){$.each(player.currentAnimations,function(e,i){i.item==t&&i.end(!0)})},Animation.finishForTimeline=function(t,e){var i=e;$.each(player.currentAnimations,function(r,n){n.timeline==t&&e>=n.startTime&&e<=n.startTime+n.duration&&(i=Math.max(i,n.startTime+n.duration))}),t.currentTime=i},Animation.getEasedPercent=function(t,e){var i=Animation.getEasingLookup(e),r=Math.round(100*t);return i[r]};var BlendMode={NORMAL:1,LAYER:2};bwAnimation.TRANS_APPEAR="appear",bwAnimation.TRANS_FADE="fade",bwAnimation.TRANS_FLY="fly",bwAnimation.TRANS_GROW="grow",bwAnimation.TRANS_SPIN="spin",bwAnimation.TRANS_MASK="mask",bwAnimation.TRANS_INT_FADE=1,bwAnimation.TRANS_INT_FLY=2,bwAnimation.TRANS_INT_GROW=4,bwAnimation.TRANS_INT_SPIN=8,bwAnimation.TRANS_INT_MASK=16,bwAnimation.TRANS_DIR_LEFT=1,bwAnimation.TRANS_DIR_RIGHT=2,bwAnimation.TRANS_DIR_TOP=4,bwAnimation.TRANS_DIR_BOTTOM=8,bwAnimation.EASE_BOUNCE="bounce",bwAnimation.EASE_CIRCULAR="circular",bwAnimation.EASE_CUBIC="cubic",bwAnimation.EASE_EXPONENTIAL="exponetial",bwAnimation.EASE_LINEAR="linear",bwAnimation.EASE_QUADRATIC="quadradic",bwAnimation.EASE_QUARTIC="quartic",bwAnimation.EASE_QUINTIC="quintic",bwAnimation.EASE_SINE="sine",bwAnimation.prototype.getAppear=function(){return 0==this.m_nAnimationType},bwAnimation.prototype.getFlyEnabled=function(){return 0<(this.m_nAnimationType&bwAnimation.TRANS_INT_FLY)},bwAnimation.prototype.getFadeEnabled=function(){return 0<(this.m_nAnimationType&bwAnimation.TRANS_INT_FADE)},bwAnimation.prototype.getGrowEnabled=function(){return 0<(this.m_nAnimationType&bwAnimation.TRANS_INT_GROW)},bwAnimation.prototype.getSpinEnabled=function(){return 0<(this.m_nAnimationType&bwAnimation.TRANS_INT_SPIN)},bwAnimation.prototype.getMaskEnabled=function(){return 0<(this.m_nAnimationType&bwAnimation.TRANS_INT_MASK)},bwAnimation.prototype.SetEffects=function(t){this.m_nAnimationType=0,0<=t.indexOf(bwAnimation.TRANS_FADE)&&(this.m_nAnimationType+=bwAnimation.TRANS_INT_FADE),0<=t.indexOf(bwAnimation.TRANS_FLY)&&(this.m_nAnimationType+=bwAnimation.TRANS_INT_FLY),0<=t.indexOf(bwAnimation.TRANS_GROW)&&(this.m_nAnimationType+=bwAnimation.TRANS_INT_GROW),0<=t.indexOf(bwAnimation.TRANS_SPIN)&&(this.m_nAnimationType+=bwAnimation.TRANS_INT_SPIN),0<=t.indexOf(bwAnimation.TRANS_MASK)&&(this.m_nAnimationType+=bwAnimation.TRANS_INT_MASK),t==bwAnimation.TRANS_APPEAR&&(this.m_nDuration=this.m_nAnimationType=0)},bwAnimation.prototype.getAnimating=function(){return this.m_bAnimating},bwAnimation.prototype.setTarget=function(t){this.m_aoTarget=t},bwAnimation.prototype.getTarget=function(){return this.m_aoTarget},bwAnimation.prototype.getDuration=function(){return this.m_nDuration},bwAnimation.prototype.setDuration=function(t){this.m_nDuration=t},bwAnimation.prototype.getStartXPos=function(){return this.m_nStartX},bwAnimation.prototype.setStartXPos=function(t){this.m_nStartX=t},bwAnimation.prototype.getStartYPos=function(){return this.m_nStartY},bwAnimation.prototype.setStartYPos=function(t){this.m_nStartY=t},bwAnimation.prototype.getEndXPos=function(){return this.m_nEndX},bwAnimation.prototype.setEndXPos=function(t){this.m_nEndX=t},bwAnimation.prototype.getEndYPos=function(){return this.m_nEndY},bwAnimation.prototype.setEndYPos=function(t){this.m_nEndY=t},bwAnimation.prototype.getEndRotation=function(){return this.m_nEndRotation},bwAnimation.prototype.setEndRotation=function(t){this.m_nEndRotation=t},bwAnimation.prototype.getStartXScale=function(){return this.m_nStartScaleX},bwAnimation.prototype.setStartXScale=function(t){this.m_nStartScaleX=t},bwAnimation.prototype.getStartYScale=function(){return this.m_nStartScaleY},bwAnimation.prototype.setStartYScale=function(t){this.m_nStartScaleY=t},bwAnimation.prototype.getEndXScale=function(){return this.m_nEndScaleX},bwAnimation.prototype.setEndXScale=function(t){this.m_nEndScaleX=t},bwAnimation.prototype.getEndYScale=function(){return this.m_nEndScaleY},bwAnimation.prototype.setEndYScale=function(t){this.m_nEndScaleY=t},bwAnimation.prototype.getEndAlpha=function(){return this.m_nEndAlpha},bwAnimation.prototype.setEndAlpha=function(t){this.m_nEndAlpha=t},bwAnimation.prototype.getStartAlpha=function(){return this.m_nStartAlpha},bwAnimation.prototype.setStartAlpha=function(t){this.m_nStartAlpha=t},bwAnimation.prototype.GetTransformAtTime=function(t){var e=null,i=null,r=NaN,n=NaN,t=t/this.m_nDuration;return this.m_bReverse&&(t=1-t),0>t&&(t=0),(t>1||0==this.m_nDuration)&&(t=1),this.m_nCurrentTime>=this.m_nDuration&&(t=1),t=Animation.getEasedPercent(t,bwTween.EASE_INOUT),this.m_nCurXPos=this.m_nEndX,this.m_nCurYPos=this.m_nEndY,this.m_nAnimationType&bwAnimation.TRANS_INT_FADE&&(n=this.m_nStartAlpha+(this.m_nEndAlpha-this.m_nStartAlpha)*t),this.m_nAnimationType&bwAnimation.TRANS_INT_FLY&&(this.m_nCurXPos=this.m_nStartX+(this.m_nEndX-this.m_nStartX)*t,this.m_nCurYPos=this.m_nStartY+(this.m_nEndY-this.m_nStartY)*t,e=new Point(this.m_nCurXPos,this.m_nCurYPos)),this.m_nAnimationType&bwAnimation.TRANS_INT_GROW&&(this.m_nCurXScale=(this.m_nEndScaleX-this.m_nStartScaleX)*t+this.m_nStartScaleX,this.m_nCurYScale=(this.m_nEndScaleY-this.m_nStartScaleY)*t+this.m_nStartScaleY,i=new Point(100*this.m_nCurXScale,100*this.m_nCurYScale)),this.m_nAnimationType&bwAnimation.TRANS_INT_SPIN&&(r=(360*this.m_nSpinCount+this.m_nEndRotation)*t),{position:e,scale:i,rotation:r,alpha:n}},bwAnimation.prototype.getAdjustRotation=function(){return this.m_bAdjustRotation},bwAnimation.prototype.setAdjustRotation=function(t){this.m_bAdjustRotation=t},bwAnimation.prototype.StopAnimation=function(){this.m_bAnimating&&(this.m_bAnimating=!1)},bwAnimation.prototype.PlayAnimation=function(){null!=this.m_aoTarget&&(3735928495==this.m_nEndX&&(this.m_nEndX=this.m_aoTarget.x),3735928495==this.m_nEndY&&(this.m_nEndY=this.m_aoTarget.y),this.m_nStartTime=this.getTimer(),(this.m_bAnimating=!0)&&this.StepAnimation(null))},bwAnimation.prototype.StepAnimation=function(){var t=!1;return this.m_nCurrentTime=this.getTimer()-this.m_nStartTime,this.m_nCurrentTime>=this.m_nDuration&&(t=!0,this.m_nCurrentTime=this.m_nDuration,this.m_bAnimating=!1),this.UpdateTarget(),t},bwAnimation.prototype.Destroy=function(){this.StopAnimation(),this.m_aoTarget=null};var bwTween={EASE_BOUNCE:"bounce",EASE_CIRCULAR:"circular",EASE_CUBIC:"cubic",EASE_EXPONENTIAL:"exponetial",EASE_LINEAR:"linear",EASE_QUADRATIC:"quadradic",EASE_QUARTIC:"quartic",EASE_QUINTIC:"quintic",EASE_SINE:"sine",EASE_IN:"easein",EASE_OUT:"easeout",EASE_INOUT:"easeinout"},Quiz=function(){this.xml="",this.sliderefs=[],this.quizrefs=[],this.constructElement(),this.variables.Score=0,this.attemptCount=this.variables.PercentScore=0,this.m_bCompleted=this.m_bEvaluated=!1};Quiz.prototype=new Element,Quiz.prototype.objectType="Quiz",Quiz.prototype.innerType="Quiz",Quiz.prototype.toBaseData=Element.prototype.toData,Quiz.prototype.toData=function(){var t=this.toBaseData();return 0<this.attemptCount&&(t.attemptCount=this.attemptCount),t},Quiz.prototype.updateBaseFromData=Element.prototype.updateFromData,Quiz.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.attemptCount&&(this.attemptCount=t.attemptCount)},Quiz.prototype.SetResumeData=function(t){this.m_bEvaluated="1"==t.substr(0,1),this.m_bCompleted="1"==t.substr(1,1)},Quiz.prototype.GetResumeData=function(){var t;return t=""+(this.m_bEvaluated?"1":"0"),t+=this.m_bCompleted?"1":"0"},Quiz.prototype.loadFromXML=function(t,e){var i=this;if(this.parent=e,this.children={},this.id=$(t).attr("id"),this.lmstext=$(t).attr("lmstext"),this.issurvey=$(t).attr("issurvey"),this.passpercent=$(t).attr("passpercent"),this.submitall=$(t).attr("submitall"),this.submitunanswered=$(t).attr("submitunanswered"),this.scoretype=$(t).attr("scoretype"),this.variables.PassPercent=this.passpercent,this.variables.PassScore=0,this.loadElementInfoFromXML(t),$(t).children("sliderefs").children("slideref").each(function(t,e){var r=$(e).attr("id");i.sliderefs.push(r),i.parseObjref(r).target.quiz=i}),$(t).children("quizrefs").children("quizref").each(function(t,e){var r={id:$(e).attr("id"),weight:parseInt($(e).attr("weight")),mustpass:"true"==$(e).attr("id")};i.quizrefs.push(r)}),e.g_listQuizzes){var r=new QuizData(this.id,this.lmstext);r.nPassingScore=this.passpercent,e.g_listQuizzes[this.id]=r}},Quiz.prototype.AllQuestionsSubmitted=function(t){if(this.m_bCompleted)return"true";var e=!0;return $.each(this.sliderefs,function(i,r){var n=story.parseObjref(r).target;if(n){var a=function(i){e=e&&i.isAnswered(),t||(e=e&&i.isSubmitted())};"SlideDraw"==n.innerType?$.each(n.children,function(t,e){!e.hasRestoredInteractions&&e.compactResumeData&&e.restoreFromResumeData(e.compactResumeData,!0),a(e)}):a(n)}}),e?"true":"false"},Quiz.prototype.AllQuestionsAnswered=function(){return this.AllQuestionsSubmitted(!0)},Quiz.prototype.QuizComplete=function(){var t=this.m_bCompleted;return this.quizrefs.forEach(function(e){e=story.quizzes[e.id],t=t&&e.QuizComplete()}),t?"true":"false"},Quiz.SEARCH_UNANSWERED="SEARCH_UNANSWERED",Quiz.SEARCH_UNSUBMITTED="SEARCH_UNSUBMITTED",Quiz.SEARCH_VIEWED="SEARCH_VIEWED",Quiz.prototype.findNextSlide=function(t,e){var i=[];$.each(this.sliderefs,function(t,e){var r=story.parseObjref(e).target;r&&("SlideDraw"==r.innerType?$.each(r.children,function(t,e){i.push(e)}):i.push(r))}),e&&i.push(e);for(var r=player.currentWindowSlide||player.currentFramedSlide||player.currentSlide(),n=!1,a=0;a<2*i.length;a++){var s=i[a%i.length];if(n)switch(t){case Quiz.SEARCH_UNANSWERED:if(!s.isAnswered())return s;break;case Quiz.SEARCH_UNSUBMITTED:if(!s.isSubmitted())return s;break;case Quiz.SEARCH_VIEWED:if(s.variables.Visited)return s}else(s===r||a>=i.length-1)&&(n=!0)}return null},Quiz.prototype.setquizcomplete=function(t){t=this.parseObjrefFromXML(t).target,t.m_bCompleted=!0,player.lmsManager.handleQuizComplete(t)},Quiz.prototype.Passed=function(){return this.variables.Score>=this.variables.PassScore?"true":"false"},Quiz.dump=function(){$.each(story.quizzes,function(t,e){$.each(e.sliderefs,function(t,i){var r=story.parseObjref(i).target;if(r){var n=function(t,e){var i=0;0<e.attempts.length&&(i=e.attempts[0].answers.length),console.log(["d:interaction",e.id,e.concatChoices(e.lmsResponses),e.GetResumeData(),e.attempts.length,i,e])};"SlideDraw"==r.innerType&&$.each(r.children,function(t,i){("partial"!=e.scoretype||i.variables.Visited)&&$.each(i.interactions,n)}),("partial"!=e.scoretype||r.variables.Visited)&&$.each(r.interactions,n)}})})};var Answer=function(){this.xml="",this.constructElement()};Answer.prototype=new Element,Answer.prototype.objectType="Answer",Answer.prototype.innerType="Answer",Answer.prototype.loadFromXML=function(t,e){this.parent=e,this.children={},this.id=$(t).attr("id"),this.points=$(t).attr("points"),this.status=$(t).attr("status"),this.actions=$(t).children("actions").children(),this.evaluate=$(t).children("evaluate").children()};var Choice=function(){this.xml="",this.constructElement(),this.selected=!1,this.pairs=[]};Choice.prototype=new Element,Choice.prototype.objectType="Choice",Choice.prototype.innerType="Choice",Choice.prototype.loadFromXML=function(t,e){this.parent=e,this.children={},this.id=$(t).attr("id"),this.lmstext=$(t).attr("lmstext")},Choice.FromParameters=function(t,e,i){var r=new Choice;r.id=t,r.lmstext=e,r.parent=i},Choice.prototype.hasPair=function(t){for(var e=0;e<this.pairs.length;e++)if(this.pairs[e]==t)return!0;return!1},Choice.prototype.findPair=function(t){for(var e=0;e<this.pairs.length;e++)if(this.pairs[e]==t)return t;return null},Choice.prototype.addPair=function(t){this.hasPair(t)||this.pairs.push(t)};var ResponseData=function(t,e,i,r,n,a){this.m_bValid=!0,this.m_bPairResponse=t,this.m_strChoice=e,this.m_strStatement=i||"",e&&0!=this.m_strChoice.length?!this.m_bPairResponse||i&&0!=this.m_strStatement.length||(this.m_bValid=!1):this.m_bValid=!1,
this.lmstext=r,this.statementLMSText=n,this.interaction=a};ResponseData.TYPE_STATEMENTS="statements",ResponseData.TYPE_CHOICES="choices",ResponseData.prototype.IsPair=function(){return this.m_bPairResponse},ResponseData.prototype.ChoiceID=function(){return this.m_strChoice},ResponseData.prototype.StatementID=function(){return this.m_strStatement},ResponseData.prototype.IsValid=function(){return this.m_bValid},ResponseData.prototype.GetResumeData=function(t,e){var i;return i=0+(this.m_bPairResponse?1:0),i+=this.m_bValid?2:0,i=""+bwChunk.UBase10toN(i,1),this.m_bValid&&(i+=this.GetResumeResponseIndex(ResponseData.TYPE_CHOICES,this.m_strChoice,t),this.m_bPairResponse&&(i+=this.GetResumeResponseIndex(ResponseData.TYPE_STATEMENTS,this.m_strStatement,e))),i},ResponseData.prototype.SetResumeData=function(t,e,i){var r=bwChunk.UBaseNto10(t.substr(0,1));this.m_bPairResponse=(1&r)>0,this.m_bValid=(2&r)>0,t=t.substr(1),this.m_bValid&&(t=this.SetResumeResponse(ResponseData.TYPE_CHOICES,t,e),this.m_bPairResponse&&this.SetResumeResponse(ResponseData.TYPE_STATEMENTS,t,i))},ResponseData.prototype.GetResumeResponseIndex=function(t,e,i){var r=e.split("."),n=-1,a="";if(2==r.length&&r[0]==t){var s,t=0;for(s in i){if(i[s].id==r[1]){n=t;break}t++}}return a=n>=0?"0"+bwChunk.UBase10toN(n,2):"1"+bwChunk.CreateChunk(e)},ResponseData.prototype.GetResponseByIndex=function(t,e){var i,r=0;for(i in t){if(r==e)return t[i];r++}return null},ResponseData.prototype.SetResumeResponse=function(t,e,i){var r="0"==e.substr(0,1),n=-1,e=e.substr(1);return r?(n=bwChunk.UBaseNto10(e.substr(0,2)),e=e.substr(2),i=this.GetResponseByIndex(i,n).id,t==ResponseData.TYPE_CHOICES?(this.m_strChoice=t+"."+i,this.lmstext=this.GetLMSText(i)):(this.m_strStatement=t+"."+i,this.statementLMSText=this.GetLMSText(i))):(e=new bwChunk(e),t==ResponseData.TYPE_CHOICES?(this.m_strChoice=e.Data(),this.lmstext=this.GetLMSText(this.m_strChoice)):(this.m_strStatement=e.Data(),this.statementLMSText=this.GetLMSText(this.m_strStatement)),e=e.Remainder()),e},ResponseData.prototype.GetLMSText=function(t){return this.interaction&&(t=this.interaction.children[t])?t.lmstext:""};var Interaction=function(){this.xml="",this.choices={},this.answers={},this.statements={},this.responseActions=[],this.responses={},this.correctResponses={},this.attempts=[],this.variables={},this.lmsResponses=[],this.lmsCorrectResponses=[],this.constructElement(),this.m_bUnanswered=this.m_bAnswered=this.scoreAO=!1,this.m_nUserAnswerIndex=-1};if(Interaction.prototype=new Element,Interaction.prototype.objectType="Interaction",Interaction.prototype.innerType="Interaction",Interaction.prototype.toBaseData=Element.prototype.toData,Interaction.prototype.toData=function(){var t=this.toBaseData();return $.each(this.responses,function(e,i){t.responses||(t.responses={}),t.responses[e]=i.toData()}),0<this.attempts.length&&(t.attempts=this.attempts),t},Interaction.prototype.restoreFromResumeChunk=function(t){var e=t.NextUBase10(2);if(this.m_bAnswered="1"==t.NextString(1),this.m_bUnanswered="1"==t.NextString(1),e>0){var i=t.NextString(1),r=t.NextChunkedBase10(),n=t.NextChunkedBase10();switch(t.NextChunkedBase10(),t="",i){case"0":t="correct";break;case"1":t="incomplete";break;case"2":t="incorrect";break;case"3":t="neutral"}if(this.variables.AttemptCount=e,this.variables.Points=r,this.variables.Status=t,"incomplete"!=this.variables.Status)for(;this.attempts.length<e;)this.attempts.push({time:player.elapsedTime(),isfinal:!0,sent:!1,pointsAwarded:n,result:t,answers:[]})}else{for(e=t.NextUBase10(2),this.lmsResponses=[],i=t.NextString(),t=0;e>t;t++)i=new bwChunk(i),n=new ResponseData(!1,"","","","",this),n.SetResumeData(i.Data(),this.choices,this.statements),this.lmsResponses.push(n),r=this.choices[n.ChoiceID()],n=this.statements[n.StatementID()],r&&(r.selected=!0,this.responses[r.longID]=r,this.m_bUnanswered=!1,n&&(r.addPair(n),n.addPair(r))),i=i.Remainder();this.evaluate(!0,!0,!0,!0)}Interaction.updateScore("from restoreFromResumeChunk")},Interaction.prototype.GetResumeData=function(){var t="",e=this.attempts.length,i=parseInt(this.variables.Points)||0,r=this.variables.Status,t=t+bwChunk.UBase10toN(e,2),t=t+(this.m_bAnswered?"1":"0"),t=t+(this.m_bUnanswered?"1":"0");if(e>0){switch(r){case"correct":t+="0";break;case"incomplete":t+="1";break;case"incorrect":t+="2";break;case"neutral":t+="3"}t+=bwChunk.CreateChunk(bwChunk.Base10toN(i)),e>1&&(i=(e=this.attempts[this.attempts-1])?parseInt(e.pointsAwarded)||0:0),t+=bwChunk.CreateChunk(bwChunk.Base10toN(i)),t+=bwChunk.CreateChunk(bwChunk.Base10toN(this.m_nUserAnswerIndex))}else for(t+=bwChunk.UBase10toN(this.lmsResponses.length,2),e=0;e<this.lmsResponses.length;e++)t+=bwChunk.CreateChunk(this.lmsResponses[e].GetResumeData(this.choices,this.statements));return t},Interaction.prototype.updateBaseFromData=Element.prototype.updateFromData,Interaction.prototype.updateFromData=function(t){this.updateBaseFromData(t),t.responses&&(this.responses={},$.each(t.responses,function(){})),t.attempts&&(this.attempts=t.attempts)},Interaction.prototype.resetBase=Element.prototype.reset,Interaction.prototype.reset=function(){this.resetBase(),this.choices={},this.answers={},this.statements={},this.responseActions=[],this.responses={},this.correctResponses={},this.lmsResponses=[],this.lmsCorrectResponses=[],this.attempts=[],this.variables={},this.loadFromXML(this.xml,this.parent),this.m_nUserAnswerIndex=-1},Interaction.prototype.loadFromXML=function(t,e){var i=this;this.slide=this.parent=e,this.children={},this.xml=t,this.id=$(t).attr("id"),this.lmsid=$(t).attr("lmsid"),this.lmstext=$(t).attr("lmstext"),this.interactionType=$(t).attr("type"),this.maxpoints=$(t).attr("maxpoints"),this.aoinclude=$(t).attr("aoinclude"),this.istracked=$(t).attr("istracked"),this.issurvey="true"==$(t).attr("issurvey"),$(t).children("choices").children("choice").each(function(t,e){var r=new Choice;r.loadFromXML(e,this),r.longID="choices."+r.id,i.choices[r.id]=r,i.children[r.id]=r}),$(t).children("statements").children("statement").each(function(t,e){var r=new Choice;r.loadFromXML(e,this),r.innerType="Statement",r.longID="statements."+r.id,i.statements[r.id]=r,i.children[r.id]=r}),$(t).children("answers").children("answer").each(function(t,e){var r=new Answer;r.loadFromXML(e,this),i.answers[r.id]=r,i.children[r.id]=r}),this.responseActions=$(t).children("response_definition").children("actions").children(),this.variables.AttemptCount=0,this.variableDefaults.AttemptCount=0},Interaction.prototype.evaluate=function(t,e,i,r){var n=this,a=this.slide;this.scoreAO=!e,r||(a.responses={},this.responses={},this.lmsResponses=[]),this.lmsCorrectResponses=[],this.variables.AttemptCount++,this.partialEvaluate&&(this.variables.AttemptCount=1);var s=!0;r||($.each(n.choices,function(t,e){e.selected=!1,e.pairs=[]}),$.each(n.statements,function(t,e){e.pairs=[]}),$.each(this.responseActions,function(t,e){s&&(s=s&&a.runAction(e))}));var o=!1,l=!0,h=0;$.each(this.answers,function(t,e){$.each(e.evaluate,function(){h++})});var p,c=0;for(p in n.responses)c++;this.m_bUnanswered=!0;var d=0;return $.each(this.answers,function(e,r){var p=!0,u=!1,m=0;$.each(r.evaluate,function(){m++});var f=0<parseInt(r.points);$.each(r.evaluate,function(t,e){var i=e.tagName;switch(i){case"other":p=l||o?1==h?!0:!1:!0;break;case"equals":switch(i=$(e).attr("choiceid"),i=n.parseObjref(i).target,p=p&&i.selected,u=u||i.selected,n.interactionType){case"fillin":case"numeric":p=u;break;case"multipleresponse":c!=m&&(p=!1)}f&&n.lmsCorrectResponses.push(new ResponseData(!1,i.id,"",i.lmstext,""));break;case"condition":p=p&&a.evaluateCondition(e,n);break;case"pair":var i=$(e).attr("choiceid"),s=$(e).attr("statementid"),i=n.parseObjref(i).target,s=n.parseObjref(s).target,d=i.hasPair(s);if(d){var y=i.findPair(s),g=0;$.each(r.evaluate,function(t,e){-1<$(e).attr("statementid").indexOf(y.id)&&g++}),d=d&&g==y.pairs.length}p=p&&d,u=u||d,f&&n.lmsCorrectResponses.push(new ResponseData(!0,i.id,s.id,i.lmstext,s.lmstext));break;default:console.error("unknown evaluate operation:",i)}}),p&&(u=!0),u&&(n.m_bUnanswered=!1,n.m_bAnswered=!0),i?(n.partialEvaluate||(n.partialEvaluate={}),n.partialEvaluate.attemptCount=n.variables.AttemptCount,p&&(n.partialEvaluate.status=r.status,n.partialEvaluate.points=r.points,n.m_nUserAnswerIndex=d,o=!0)):p&&(n.variables.Status=r.status,n.variables.Points=r.points,n.m_nUserAnswerIndex=d,t||$.each(r.actions,function(t,e){s&&(s=s&&a.runAction(e))}),o=!0),l=!1,d++}),Interaction.updateScore("from interaction evaluate: "+n.id),i?(c>0&&(this.m_bAnswered=!0),this.variables.AttemptCount--,!0):(o||this.variables.AttemptCount--,this.partialEvaluate=null,this.noteAttempt(),player.lmsManager.handleInteractionEvaluated(this),s)},Interaction.prototype.noteAttempt=function(){var t={time:player.elapsedTime(),isfinal:!0,sent:!1,pointsAwarded:this.variables.Points,result:this.variables.Status,answers:[]};$.each(this.lmsResponses,function(e,i){t.answers.push(i.m_bPairResponse?{statementid:i.statementLMSText,choiceid:i.lmstext}:{choiceid:i.lmstext})}),this.attempts.push(t)},Interaction.prototype.Answered=function(){return this.m_bAnswered?"true":"false"},Interaction.updateScore=function(){$.each(story.quizzes,function(t,e){var i=0,r=0,n=0;$.each(e.sliderefs,function(t,a){var s=story.parseObjref(a).target;if(s){var o=function(t,e){n++,r+=parseInt(e.maxpoints);var a=parseInt(e.variables.Points)||0;i+=a};"SlideDraw"==s.innerType&&$.each(s.children,function(t,i){!i.hasRestoredInteractions&&i.compactResumeData&&i.restoreFromResumeData(i.compactResumeData,!0),("partial"!=e.scoretype||i.variables.Visited)&&$.each(i.interactions,o)}),("partial"!=e.scoretype||s.variables.Visited)&&$.each(s.interactions,o)}}),e.variables.Score=i,e.maxscore=r,e.variables.PercentScore=parseFloat(parseInt(1e4*i/r)/100),isNaN(e.variables.PercentScore)&&(e.variables.PercentScore=0),e.variables.PassScore=Math.ceil(parseFloat(e.variables.PassPercent*r/100)),window&&window.g_oContentResults&&(window.g_oContentResults.nScore=e.variables.PercentScore),e.handleVarChanged(e.getFullVariableRef("Score"),"onvarchanged")}),$.each(story.quizzes,function(t,e){if(0!=e.quizrefs.length){var i=0,r=0;$.each(e.quizrefs,function(t,e){var n=story.parseObjref(e.id).target;n&&!isNaN(n.variables.Score)&&(i+=n.variables.Score,r+=n.maxscore)}),e.variables.Score=i,e.maxscore=r,e.variables.PercentScore=parseFloat(parseInt(1e4*i/r)/100),isNaN(e.variables.PercentScore)&&(e.variables.PercentScore=0),e.variables.PassScore=Math.ceil(parseFloat(e.variables.PassPercent*r/100)),window&&window.g_oContentResults&&(window.g_oContentResults.nScore=e.variables.PercentScore),e.handleVarChanged(e.getFullVariableRef("Score"),"onvarchanged")}})},Interaction.partialEvaluateSlide=function(t){$.each(t.interactions,function(t,e){(!e.variables.Status||"unanswered"==e.variables.Status)&&e.evaluate(!0,!0,!0)})},Interaction.eval_all_unanswered=function(t){var e={},i=function(t){var i=!1;$.each(t.interactions,function(t,e){if(!e.variables.Status||"unanswered"==e.variables.Status)for(e.partialEvaluate||e.evaluate(!0,!0,!0),e.partialEvaluate&&(e.variables.Status=e.partialEvaluate.status,e.variables.Points=e.partialEvaluate.points,e.variables.AttemptCount=e.partialEvaluate.attemptCount),e.variables.Status||(e.variables.Status="unanswered"),i=!0;e.attempts.length<e.variables.AttemptCount;){var r={time:player.elapsedTime(),isfinal:!0,sent:!1,pointsAwarded:e.variables.Points,result:e.variables.Status,answers:[]};e.attempts.push(r)}e.m_bAnswered=!0}),i&&(t.rebuildInteractionData(),e[t.parent.id]=t.parent)};t&&"Quiz"==t.innerType&&(t.m_bEvaluated=!0,$.each(t.sliderefs,function(t,e){var r=story.parseObjref(e).target;r&&("SlideDraw"==r.innerType?$.each(r.children,function(t,e){i(e)}):i(r))}),$.each(e,function(t,e){e.compactResumeData=e.getResumeData()}),Interaction.updateScore("from eval_all_unanswered"))},Interaction.setquizcomplete=function(t){t=story.parseObjrefFromXML(t).target,t.m_bCompleted=!0,player.lmsManager.handleQuizComplete(t)},Scoring.prototype.loadFromXML=function(t,e){var i=this;this.parent=e,this.scorerefs={},this.id=$(t).attr("id"),this.type=$(t).attr("type"),this.passpercent=$(t).attr("passpercent"),this.viewthreshold=parseInt($(t).attr("viewthreshold")),this.passstatus=$(t).attr("passstatus"),this.failstatus=$(t).attr("failstatus"),isNaN(this.viewthreshold)&&(this.viewthreshold=0),$(t).children("scorerefs").children("scoreref").each(function(t,e){var r={};r.type=$(e).attr("type"),r.ref=$(e).attr("ref"),r.weight=$(e).attr("weight"),r.maxvalue=$(e).attr("maxvalue"),r.mustpass=$(e).attr("mustpass"),i.scorerefs[r.ref]=r})},AOClient.prototype.call=function(t,e,i,r){var n="http://articulate.com/KnowledgeFlash/Services/Content/Api/"+t,a=$.parseXML(e),s=this,o=this.endpoint+"?rand="+Math.random();$.ajax({url:o,type:"POST",dataType:"xml",data:a,headers:{SOAPAction:n},processData:!1,contentType:'text/xml; charset="utf-8"',cache:!1,success:function(t,e,r){i&&i(t,e,r)},error:function(){return-1<location.search.indexOf("aodebug="),r&&!window.manuallyClosing&&confirm("Unable to connect to the server.  Please verify you can connect to the internet. Retry?")&&s.call(t,e,i,r),!1}})},AOClient.prototype.wrapWithEnvelope=function(t){return'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>'+t+"</soap:Body></soap:Envelope>"},AOClient.prototype.getVanillaXML=function(t){return this.wrapWithEnvelope("<"+t+' xmlns="http://articulate.com/KnowledgeFlash/Services/Content/Api"><contentUrl>'+escape(location.href)+"</contentUrl></"+t+">")},AOClient.prototype.GetApiVersion=function(){var t=this;this.call("GetApiVersion",this.getVanillaXML("GetApiVersion"),function(e){this.apiVersion=$(e).find("GetApiVersionResult").text(),t.apiVersionReturned=!0})},AOClient.prototype.GetSessionId=function(){var t=this;this.call("GetSessionId",this.getVanillaXML("GetSessionId"),function(e){player.aoSessionID=$(e).find("GetSessionIdResult").text(),t.getSessionIdReturned=!0})},AOClient.prototype.GetResumeInfo=function(){var t=this;this.call("GetResumeInfo",this.getVanillaXML("GetResumeInfo"),function(e){e=$(e).find("GetResumeInfoResult").text(),player.aoResumeData=e,t.getResumeInfoReturned=!0})},AOClient.prototype.RefreshSession=function(){this.call("RefreshSession",this.getVanillaXML("RefreshSession"),function(t){$(t).find("RefreshSessionResult").text()})},AOClient.prototype.SetViewBasedComplete=function(){},AOClient.prototype.SavePlayerData=function(){this.call("SavePlayerData",this.wrapWithEnvelope(story.toAOData()),function(){var t=story.getDescendantsByType("Interaction");$.each(t,function(t,e){$.each(e.attempts,function(t,e){e.sent=!0})})},!0),this.sendcount++},AOClient.prototype.SaveResume=function(){var t="",t=player.useCompactResume?story.toResumeData():JSON.stringify(story.toData(!0));this.call("SaveResume",this.wrapWithEnvelope('<SaveResume xmlns="http://articulate.com/KnowledgeFlash/Services/Content/Api"><contentUrl>'+escape(location.href)+'</contentUrl><playerdata sessionid="string"><resumeData>'+t+"</resumeData></playerdata></SaveResume>"),function(){})},AOClient.prototype.reCapitalize=function(t,e){return $.each(e,function(e,i){t=t.replace(RegExp("<"+i,"ig"),"<"+i),t=t.replace(RegExp("</"+i,"ig"),"</"+i),t=t.replace(RegExp(i+'="',"ig"),i+'="')}),t},AOClient.prototype.handleInteractionEvaluated=function(){(player.isIOS||-1<location.search.indexOf("aoforce=1"))&&player.aoClient.SavePlayerData(!0)},AOClient.prototype.init=function(){var t=this;this.GetApiVersion(),this.GetSessionId(),this.GetResumeInfo(),this.refreshInterval=setInterval(function(){t.RefreshSession()},6e4);var e=!1;$(window).bind("unload beforeunload",function(){e||(t.SavePlayerData(!1),e=!0)})},AOClient.prototype.isReady=function(){return 1==this.apiVersionReturned&&1==this.getSessionIdReturned&&1==this.getResumeInfoReturned?!0:!1},Interaction.prototype.toAOData=function(){var t=this,e=$("<interaction/>");return e.attr("idRef",this.getFullObjref()),e.attr("type",this.interactionType),$.each(this.attempts,function(i,r){var n=$("<attempt/>");switch(n.attr("time",r.time),n.attr("final",r.isfinal),n.attr("sent",r.sent),n.attr("pointsAwarded",r.pointsAwarded),n.attr("result",r.result),t.interactionType){case"fillin":case"numeric":$.each(r.answers,function(t,e){var i=$("<answer/>");i.get(0).innerHTML=e.choiceid,n.append(i)});break;case"matching":case"sequence":$.each(r.answers,function(t,e){var i=$("<answer/>");i.attr("statementid",e.statementid),i.attr("choiceid",e.choiceid),n.append(i)});break;default:$.each(r.answers,function(t,e){var i=$("<answer/>");i.attr("choiceid",e.choiceid),n.append(i)})}e.append(n)}),e},Quiz.prototype.toAOData=function(){var t=$("<quiz/>");t.attr("idRef",this.getFullObjref()),t.attr("score",this.variables.Score),t.attr("possibleScore",this.maxscore),t.attr("duration",player.elapsedTime()),this.status=parseInt(this.variables.Score)>=parseInt(this.variables.PassScore)?story.scoring.passstatus:story.scoring.failstatus,t.attr("status",this.status);var e=$("<interactions/>");return $.each(this.sliderefs,function(t,i){function r(t){$.each(t.interactions,function(t,i){(i.scoreAO||player.forceAO||0<i.attempts.length)&&e.append($(i.toAOData()))})}var n=story.parseObjref(i).target;"SlideDraw"==n.innerType?$.each(n.children,function(t,e){r(e)}):r(n)}),t.append(e),t.get(0).outerHTML},Storyline.prototype.toAOData=function(){var t=$('<SavePlayerData xmlns="http://articulate.com/KnowledgeFlash/Services/Content/Api"/>');t.append($("<contentUrl>"+location.href+"</contentUrl>"));var e=$("<playerdata/>");e.attr("sessionid",player.aoSessionID),e.attr("sendcount",player.aoClient.sendcount);var i=story.toResumeData();e.append($("<resumeData>"+i+"</resumeData>")),$.each(this.allSlides,function(t,e){if(e!=player.currentSlide()&&e.compactResumeData&&!e.hasRestoredInteractions)try{e.restoreFromResumeData(e.compactResumeData,!0)}catch(i){}e.hasRestoredInteractions=!0});var i=$("<results/>"),r=$("<summary/>"),n=$("<quizzes/>"),a=$("<viewdata/>"),s=0,o=0,l=story.scoring.failstatus,h=0,p=0,c=0;$.each(this.quizzes,function(t,e){story.scoring.scorerefs[e.id]&&(s+=parseInt(e.variables.Score),o+=e.maxscore,n.append($(e.toAOData())),l=e.status)}),c=0,$.each(this.allSlides,function(t,e){if(e.trackviews&&(c++,e.variables.Visited)){p++,e.viewedCurrent&&h++;var i=$("<slide/>");i.attr("id",e.getFullObjref()),a.append(i)}}),a.attr("total",c),a.attr("viewed",h),a.attr("viewedcomplete",p),e.append(a);var d=parseFloat(parseInt(1e4*s/o)/100);return isNaN(d)&&(d=0),"view"==story.scoring.type?(0<story.scoring.viewthreshold&&p>=story.scoring.viewthreshold&&(l=story.scoring.passstatus),r.attr("slidesviewed",p),r.attr("slidestotal",c),r.attr("duration",player.elapsedTime()),r.attr("status",l)):"survey"==story.scoring.type?(r.attr("duration",player.elapsedTime()),r.attr("status",l)):(r.attr("score",d),r.attr("possibleScore",100),r.attr("duration",player.elapsedTime()),r.attr("status",l),i.append(n)),i.append(r),e.append(i),t.append(e),player.aoClient.reCapitalize(t.get(0).outerHTML,"SavePlayerData,resumeData,contentUrl,idRef,pointsAwarded,possibleScore".split(","))},LMSClient.prototype.initResume=function(){var t="";return window&&window.lms_DoFSCommand&&(window.hasLMS=!0,window.lmsAPI=parent,!parent.GetDataChunk&&window.GetDataChunk&&(window.lmsAPI=window),window.lmsAPI.GetDataChunk||(window.g_bAPIPresent=!1,window.g_bLMSPresent=window.lmsAPI.IsLmsPresent&&window.lmsAPI.IsLmsPresent()),window.g_bAPIPresent=!0,window.lmsAPI.GetDataChunk||(window.g_bAPIPresent=!1,window.hasLMS=!1,player.hasLMS=!1,player.lmsManager.hasLMS=!1),window.g_bLMSPresent=window.lmsAPI.IsLmsPresent&&window.lmsAPI.IsLmsPresent(),window.g_bAPIPresent&&(t=window.lmsAPI.GetDataChunk("cmi.suspend_data"),window.lmsAPI.g_strResumeData=t,window.g_strResumeData=t,window.LMSCommit(),window.lms_DoFSCommand("BW_InitResume"))),t},LMSClient.prototype.handleInteractionEvaluated=function(t){if("view"!=story.scoring.type){t=t.toLMSData();try{window.lms_DoFSCommand("BW_StoreQuestionResult",t)}catch(e){}window.lms_DoFSCommand("BW_UpdateStatus")}},LMSClient.prototype.handleClosePlayer=function(){try{window.lms_DoFSCommand("BW_ClosePlayer")}catch(t){}},LMSClient.prototype.sendResumeData=function(){if(player.useCompactResume){var t=story.toResumeData();lms_DoFSCommand("BW_SetResumeData",t)}},LMSClient.prototype.reportViewBasedComplete=function(){window.g_oContentResults.nScore=100,window.g_oContentResults.strStatus=story.scoring.passstatus,window.g_oContentResults.strType="view",window.lms_DoFSCommand("BW_UpdateViewStatus",window.g_oContentResults.strStatus+"|~|view")},Interaction.prototype.toLMSData=function(){var t=[],e=this.parent,i=null;if($.each(story.quizzes,function(t,r){$.each(r.sliderefs,function(t,n){var a=story.parseObjref(n).target;a==e&&(i=r),"SlideDraw"==a.innerType&&$.each(a.children,function(t,n){n==e&&(i=r)})})}),!e||!i)return"";for(var r=i.attemptCount,n=parseInt(this.variables.AttemptCount-1),a=0,s=0;s<i.sliderefs.length;s++)-1<i.sliderefs[s].indexOf(e.id)&&(a=s+1);return t.push(i.id),t.push(e.parent.lmsid+"_"+e.lmsid+"_"+this.lmsid+"_"+r+"_"+n),t.push(this.lmsid),t.push(this.interactionType),t.push(this.concatChoices(this.lmsCorrectResponses)),t.push(this.concatChoices(this.lmsResponses)),t.push("0"),t.push(this.variables.Status),t.push(this.variables.Points),t.push(GetTime(new Date)),t.push("1"),t.push(a),t.push(this.lmstext),t.push(i.lmstext),t.push(this.istracked),t.join(window.g_strLDelim||"|~|")},Interaction.prototype.concatChoices=function(t){var e=[],i=window.g_strLInteractionDelim||"|#|";return $.each(t,function(t,i){i.m_bPairResponse&&e.push(i.statementLMSText),e.push(i.lmstext)}),e.join(i)},Quiz.prototype.reportLMSStatus=function(){if("view"!=story.scoring.type&&story.scoring.scorerefs[this.id]){var t=[],e="",e=parseInt(this.variables.Score)>=parseInt(this.variables.PassScore)?story.scoring.passstatus:story.scoring.failstatus,i=100*this.variables.Score/this.maxscore,r=100*this.variables.PassScore/this.maxscore;t.push(e),t.push(i),t.push(0),t.push(100),t.push(r),t.push("quiz"),t=t.join(window.g_strLDelim||"|~|"),window.g_oContentResults.nScore=i,window.g_oContentResults.strStatus=e,window.lms_DoFSCommand("BW_UpdateStatus",t)}},LMSManager.prototype.initResume=function(){return this.hasLMS?player.lmsClient.initResume():void 0},LMSManager.prototype.handleInteractionEvaluated=function(t){this.hasAO?player.aoClient.handleInteractionEvaluated(t):this.hasLMS?player.lmsClient.handleInteractionEvaluated(t):this.hasTinCan&&player.tinCanClient.handleInteractionEvaluated(t)},LMSManager.prototype.handleSlideViewed=function(t){t.trackviews&&(this.viewedSlides[t.id]=!0),t.viewedCurrent=!0;var e=Object.keys(this.viewedSlides).length;0<story.scoring.viewthreshold&&"view"==story.scoring.type&&e>=story.scoring.viewthreshold&&(this.hasAO?(player.aoClient.SetViewBasedComplete(),player.aoClient.SavePlayerData(!0)):this.hasLMS?(console.log("reporting view based completion to LMS"),$.each(story.quizzes,function(){}),player.lmsClient.reportViewBasedComplete(),player.lmsClient.sendResumeData()):this.hasTinCan&&player.tinCanClient.reportViewBasedComplete(e)),this.hasLMS?player.lmsClient.sendResumeData():this.hasAO?player.aoClient.SaveResume():this.hasTinCan&&(player.tinCanClient.handleSlideViewed(t),player.tinCanClient.sendResumeData())},LMSManager.prototype.handleQuizComplete=function(t){this.hasAO&&player.aoClient.SavePlayerData(!0),this.hasLMS&&t.reportLMSStatus(),this.hasTinCan&&player.tinCanClient.reportQuizComplete(t)},LMSManager.prototype.handleClosePlayer=function(){this.hasLMS&&player.lmsClient.handleClosePlayer(),this.hasTinCan&&player.tinCanClient.handleClosePlayer()},LMSManager.prototype.init=function(){globals.bAOSupport||window.g_bAOSupport||player.useAO?(player.aoClient=new AOClient,player.aoClient.init(),this.hasAO=!0):globals.bTinCan||window.g_bTinCan||player.useTinCan?(player.tinCanClient=new TinCanClient,player.tinCanClient.init(),this.hasTinCan=!0):window&&window.lms_DoFSCommand&&(player.lmsClient=new LMSClient,player.hasLMS=!0,window.lmsAPI=parent,!parent.GetDataChunk&&window.GetDataChunk&&(window.lmsAPI=window),window.g_bAPIPresent=!0,window.g_bLMSPresent=window.lmsAPI.IsLmsPresent&&window.lmsAPI.IsLmsPresent(),this.hasLMS=!0)},LMSManager.prototype.isReady=function(){return this.hasAO?player.aoClient.isReady():this.hasTinCan?player.tinCanClient.isReady():!0},window){window.g_oContentResults=new ContentResults,window.g_listQuizzes={};var unloadFired=!1;$(window).bind("unload beforeunload",function(){!unloadFired&&parent.LMSUnload&&(parent.LMSUnload(),unloadFired=!0)})}var TC_PARAM_AUTH="auth",TC_PARAM_REG="registration",TC_PARAM_ACTIVITY_ID="activity_id",TC_PARAM_ACTOR="actor",TC_PARAM_ENDPOINT="endpoint",TC_PARAM_GROUPING="grouping",TC_PARAM_CONTENT_ENDPOINT="content_endpoint",TC_PARAM_CONTENT_TOKEN="content_token",REQ_TYPE_RESUME_SAVE=1,REQ_TYPE_RESUME_RESTORE=2,REQ_TYPE_TRACKING=3;ppTinCanComm.prototype.PostOnClose=function(){for(this.m_bStopPosting=!0;0<this.m_arrTinCanMsgQueue.length;){var t=this.m_arrTinCanMsgQueue.shift();PostSyncRequest(t)}},ppTinCanComm.prototype.GetAuth=function(){return this.m_listParams[TC_PARAM_AUTH]},ppTinCanComm.prototype.GetRegistration=function(){return this.m_listParams[TC_PARAM_REG]},ppTinCanComm.prototype.GetActivityId=function(){return this.m_listParams[TC_PARAM_ACTIVITY_ID]},ppTinCanComm.prototype.GetActor=function(){return this.m_listParams[TC_PARAM_ACTOR]},ppTinCanComm.prototype.GetActorObj=function(){return this.m_jsActor},ppTinCanComm.prototype.GetEndPoint=function(){return this.m_listParams[TC_PARAM_ENDPOINT]},ppTinCanComm.prototype.GetGrouping=function(){return this.m_listParams[TC_PARAM_GROUPING]},ppTinCanComm.prototype.ParseQueryString=function(t){for(var t=t.split("&"),e="",i="",e="",r=0,n=0;n<t.length;n++)switch(e=t[n],r=e.indexOf("="),i=decodeURIComponent(e.substr(0,r)),e=decodeURIComponent(e.substr(r+1)),this.m_listParams[i]=e,i){case TC_PARAM_ACTOR:this.m_jsActor=JSON.parse(e);break;case TC_PARAM_AUTH:case TC_PARAM_GROUPING:case TC_PARAM_ACTIVITY_ID:case TC_PARAM_REG:case TC_PARAM_ENDPOINT:case TC_PARAM_CONTENT_ENDPOINT:case TC_PARAM_CONTENT_TOKEN:break;default:this.m_listCustomParams[i]=e}},ppTinCanComm.prototype.ConvertToPost=function(t,e,i,r,n,a){var s,o="";for(s in n)o+=s+"="+encodeURIComponent(n[s])+"&";0<r.length&&(o+="content="+encodeURIComponent(r)),this.SendRequest(new ppTinCanRequest(t,"POST",o,e+"?method="+i,a))},ppTinCanComm.prototype.GetHeaders=function(){var t={};t.Authorization=this.m_listParams[TC_PARAM_AUTH],t.registration=this.m_listParams[TC_PARAM_REG],t["Content-Type"]="application/json";for(var e in this.m_listCustomParams)t[e]=this.m_listCustomParams[e];return t},ppTinCanComm.prototype.SendRequest=function(t){this.m_bWaitingTinCanResponse||this.m_bStopPosting?this.m_arrTinCanMsgQueue.push(t):this.PostAsyncRequest(t)},ppTinCanComm.prototype.PostAsyncRequest=function(t){try{this.UseXDomainRequest(t.Url)?this.PostXDomainRequest(t,!1):this.PostXmlHttp(t)}catch(e){confirm("Unable to connect to server.  Please verify that you are connected to the internet. Retry?")?(this.m_bWaitingTinCanResponse=!1,this.SendRequest(t)):(this.m_bFatalError=this.m_bStopPosting=!0,this.m_pfnFatalError(0))}},ppTinCanComm.prototype.PostXDomainRequest=function(t,e){var i=new XDomainRequest;if(i.open(t.Method,t.Url),i.TCRequest=t,i.TCComm=this,i.status=0,i.onload=function(){i.status=200,e||this.TCComm.OnSendComplete(i)},i.onerror=function(){i.status=-1,e||this.TCComm.OnSendError(i)},i.send(strData),e)for(var r=(new Date).getTime();5e3>(new Date).getTime()-r&&0==i.status;){var n=new XMLHttpRequest;n.open("GET",window.location+"?"+(new Date).getTime(),!1),n.send(null)}return i.status},ppTinCanComm.prototype.PostXmlHttp=function(t){var e=this.CreateXmlHttp();null!=e&&(this.m_bWaitingTinCanResponse=!0,e.TCRequest=t,e.TCComm=this,e.onreadystatechange=function(){4==e.readyState&&(400<=e.status&&(!this.m_bIE||1223!=e.status)?this.TCComm.OnSendError(e):this.TCComm.OnSendComplete(e))},e.open(t.Method,t.Url,!0),e.send(t.Data))},ppTinCanComm.prototype.OnSendComplete=function(t){null!=t.TCRequest.Callback&&void 0!=t.TCRequest.Callback&&t.TCRequest.Callback(t.responseText),this.m_bWaitingTinCanResponse=!1,0<this.m_arrTinCanMsgQueue.length&&!this.m_bStopPosting&&this.SendRequest(this.m_arrTinCanMsgQueue.shift())},ppTinCanComm.prototype.OnSendError=function(t){t.TCRequest.MessageType==REQ_TYPE_RESUME_RESTORE?(t.TCRequest.Callback(""),this.m_bWaitingTinCanResponse=!1,0<this.m_arrTinCanMsgQueue.length&&!this.m_bStopPosting&&this.SendRequest(this.m_arrTinCanMsgQueue.shift())):confirm("Unable to connect to server.  Please verify that you are connected to the internet. Retry? ")?(this.m_bWaitingTinCanResponse=!1,this.SendRequest(t.TCRequest)):(this.m_bFatalError=this.m_bStopPosting=!0,t.status&&this.m_pfnFatalError(t.status))},ppTinCanComm.prototype.CreateXmlHttp=function(){var t=null,e=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"],i=0;if(window.XMLHttpRequest)try{t=new XMLHttpRequest}catch(r){t=null}if(null==t&&window.ActiveXObject)for(;null==t&&i<e.length;){try{t=new ActiveXObject(e[i])}catch(n){t=null}i++}return t},ppTinCanComm.prototype.PostSyncRequest=function(t){try{var e=0,e=this.UseXDomainRequest(t.Url)?this.PostXDomainRequest(t,!0):this.PostSyncXmlHttp(t);200!=e&&(confirm("Could not save the result data. You may need to login again. Retry?")?this.PostSyncRequest(t):this.m_bFatalError=!0)}catch(i){confirm("Unable to connect to server.  Please verify that you are connected to the internet. Retry?")?this.PostSyncRequest(t):this.m_bFatalError=!0}},ppTinCanComm.prototype.PostSyncXmlHttp=function(t){var e=this.CreateXmlHttp(),i=200;return null!=e&&(e.open(t.Method,t.Url,!1),e.send(t.Data),400<=e.status&&!(this.m_bIE&&1223==e.status)&&(i=-1)),i},ppTinCanComm.prototype.UseXDomainRequest=function(t){var e=!1;if(this.m_bIE){this.CreateXmlHttp();var e=document.createElement("a"),i=document.createElement("a");e.href=t,i.href=window.location,e=e.hostname!=i.hostname||e.protocol!=i.protocol||e.port!=i.port}return e};var TC_DELIM_CHOICE="[,]",TC_DELIM_STATEMENT="[.]";ppTinCanApi.prototype.PostOnClose=function(){this.m_tcComm.PostOnClose()},ppTinCanApi.prototype.RequestResumeData=function(t){var e=this.m_tcComm.GetHeaders();e.activityId=this.m_tcComm.GetActivityId(),e.actor=this.m_tcComm.GetActor(),e.stateId="resume",this.m_tcComm.ConvertToPost(REQ_TYPE_RESUME_RESTORE,this.m_tcComm.GetEndPoint()+"activities/state","GET","",e,t)},ppTinCanApi.prototype.UpdateResumeData=function(t){var e=this.m_tcComm.GetHeaders();e.activityId=this.m_tcComm.GetActivityId(),e.actor=this.m_tcComm.GetActor(),e.stateId="resume",this.m_tcComm.ConvertToPost(REQ_TYPE_RESUME_SAVE,this.m_tcComm.GetEndPoint()+"activities/state","PUT",t,e,null)},ppTinCanApi.prototype.NotifyCourseComplete=function(t,e,i,r){var n={id:this.m_tcComm.GetActivityId()},a="completed";i||(a=e?"passed":"failed"),n={verb:a,object:n,context:this.GetContext(this.m_tcComm.GetActivityId())},n.result=i?{duration:this.ConvertMSToISO(r)}:{score:{scaled:t/100},success:e?"true":"false",duration:this.ConvertMSToISO(r)},this.PutStatement(n,REQ_TYPE_TRACKING)},ppTinCanApi.prototype.NotifyQuizComplete=function(t,e,i,r,n,a){var s={id:r},o="completed";a||(o=n?"passed":"failed"),r={verb:o,object:s,context:this.GetContext(r)},a||(r.result={score:{scaled:t/100,raw:e,min:0,max:i},success:n?"true":"false"}),this.PutStatement(r,REQ_TYPE_TRACKING)},ppTinCanApi.prototype.NotifyCourseStarted=function(){this.PutStatement({verb:"attempted",object:{id:this.m_tcComm.GetActivityId()},context:this.GetContext(this.m_tcComm.GetActivityId())},REQ_TYPE_TRACKING)},ppTinCanApi.prototype.NotifyViewedComplete=function(t,e){var i={id:this.m_tcComm.GetActivityId()},r={completion:!0,duration:this.ConvertMSToISO(e),extensions:{viewcount:t}};this.PutStatement({verb:"completed",
object:i,result:r,context:this.GetContext(this.m_tcComm.GetActivityId())},REQ_TYPE_TRACKING)},ppTinCanApi.prototype.NotifySlideViewed=function(t){this.PutStatement({verb:"experienced",object:{id:t},context:this.GetContext(this.m_tcComm.GetActivityId())},REQ_TYPE_TRACKING)},ppTinCanApi.prototype.LogQuestion=function(t,e,i,r,n,a,s,o){"likert"==n?this.LogLikertQuestion(t,e,i,r):this.LogNormalQuestion(t,e,i,r,n,a,s,o)},ppTinCanApi.prototype.LogLikertQuestion=function(t,e,i,r){if(null!=r&&0<r.length)for(var n=null,a=0,a=0;a<r.length;a++){var n=r[a],s={id:e+"."+i+"."+this.GetSimpleId(n.Statement)},n={response:this.GetSimpleId(n.Choice)};this.PutStatement({verb:"answered",object:s,result:n,context:this.GetContext(t)},REQ_TYPE_TRACKING)}},ppTinCanApi.prototype.LogNormalQuestion=function(t,e,i,r,n,a,s,o){var l="",n=this.NormalizeType(n),h=0,p=null;if(null!=r&&0<r.length)switch(n){case"fill-in":case"numeric":for(h=0;h<r.length;h++)p=r[h],h>0&&(l+=TC_DELIM_CHOICE),l+=p.Choice;break;case"sequencing":case"true-false":case"choice":for(h=0;h<r.length;h++)p=r[h],h>0&&(l+=TC_DELIM_CHOICE),l+=this.GetSimpleId(p.Choice);break;case"matching":for(h=0;h<r.length;h++)p=r[h],h>0&&(l+=TC_DELIM_CHOICE),l+=this.GetSimpleId(p.Statement)+TC_DELIM_STATEMENT+this.GetSimpleId(p.Choice)}e={id:e+"."+i},l={response:l},a||(l.success=s,l.score={raw:o}),this.PutStatement({verb:"answered",object:e,result:l,context:this.GetContext(t)},REQ_TYPE_TRACKING)},ppTinCanApi.prototype.PutStatement=function(t){t.actor=this.m_tcComm.GetActorObj();var e=this.m_tcComm.GetHeaders();e.statementId=this.GetUUID(),this.m_tcComm.ConvertToPost(REQ_TYPE_TRACKING,this.m_tcComm.GetEndPoint()+"statements/","PUT",JSON.stringify(t),e,null)},ppTinCanApi.prototype.GetContext=function(t){return{contextActivities:{grouping:{id:this.m_tcComm.GetActivityId()},parent:{id:t}},registration:this.m_tcComm.GetRegistration()}},ppTinCanApi.prototype.GetSimpleId=function(t){var e=t.lastIndexOf(".");return e>=0&&(t=t.substr(e+1)),t},ppTinCanApi.prototype.NormalizeType=function(t){var e="";switch(t){case"truefalse":e="true-false";break;case"wordbank":case"hotspot":case"multiplechoice":case"multipleresponse":e="choice";break;case"essay":case"fillin":case"numeric":e="fill-in";break;case"matching":e="matching";break;case"sequence":e="sequencing";break;case"likert":e="likert"}return e},ppTinCanApi.prototype.GetUUID=function(){var t;return t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/x/g,function(){return Math.floor(16*Math.random()).toString(16)}),t=t.replace(/y/g,(Math.floor(4*Math.random())+8).toString(16))},ppTinCanApi.prototype.ConvertMSToISO=function(t){var e="P",t=Math.floor(t/10),i=0,r=0,n=0,n=Math.floor(t/864e4),t=t-864e4*n,r=Math.floor(t/36e4),t=t-36e4*r,i=Math.floor(t/6e3);return n>0&&(e+=n+"D"),e+"T"+(r+"H")+(i+"M")+((t-6e3*i)/100+"S")},TinCanClient.prototype.GetResumeData=function(){var t=this;this.api.RequestResumeData(function(e){player.tinCanResumeData=e,t.getResumeDataReturned=!0})},TinCanClient.prototype.SetViewBasedComplete=function(){},TinCanClient.prototype.SavePlayerData=function(){},TinCanClient.prototype.handleSlideViewed=function(t){this.api.NotifySlideViewed(t.id)},TinCanClient.prototype.handleInteractionEvaluated=function(t){var e=t.parent,i=e.quiz,r=$.map(t.lmsResponses,function(t){return t.IsPair()?new ppResponsePair(t.ChoiceID(),t.StatementID()):new ppResponsePair(t.ChoiceID(),"")}),n="correct"==t.variables.Status;switch(t.interactionType){case"likert":return void this.api.LogLikertQuestion(i.id,e.id,t.id,r);case"essay":case"fillin":case"numeric":r=[new ppResponsePair(t.lmsResponses[0].lmstext)]}this.api.LogNormalQuestion(i.id,e.id,t.id,r,t.interactionType,"true"==t.issurvey,n,t.variables.Points)},TinCanClient.prototype.reportViewBasedComplete=function(t){this.api.NotifyViewedComplete(t,new Date-this.startTime)},TinCanClient.prototype.reportQuizComplete=function(t){var e=this,i=t.variables.Score>=t.variables.PassScore;this.api.NotifyQuizComplete(t.variables.PercentScore,t.variables.Score,t.maxscore,t.id,i,"true"==t.issurvey);var r=new Date-this.startTime;$.each(story.scoring.scorerefs,function(n,a){var s=story.parseObjref(a.ref);s&&s.target&&s.target.id==t.id&&e.api.NotifyCourseComplete(t.variables.PercentScore,i,"true"==t.issurvey,r)})},TinCanClient.prototype.sendResumeData=function(){if(player.useCompactResume){var t=story.toResumeData();""!=t&&this.api.UpdateResumeData(t)}},TinCanClient.prototype.init=function(){var t=this,e=document.location.search.substr(1);t.startTime=new Date,this.api=new ppTinCanApi(e),this.GetResumeData(),this.api.NotifyCourseStarted();var i=!1;$(window).bind("unload beforeunload",function(){i||(t.api.PostOnClose(),i=!0)})},TinCanClient.prototype.isReady=function(){return this.getResumeDataReturned},bwUtils={DEFAULT_STATE:"_default"},bwChunk.EMPTY_CHUNK="0",bwChunk.BASE_NUMBER=64,bwChunk.BASE_POW=6,bwChunk.m_arr10to64="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$".split(","),bwChunk.m_o64to10={v0:0,v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8,v9:9,va:10,vb:11,vc:12,vd:13,ve:14,vf:15,vg:16,vh:17,vi:18,vj:19,vk:20,vl:21,vm:22,vn:23,vo:24,vp:25,vq:26,vr:27,vs:28,vt:29,vu:30,vv:31,vw:32,vx:33,vy:34,vz:35,vA:36,vB:37,vC:38,vD:39,vE:40,vF:41,vG:42,vH:43,vI:44,vJ:45,vK:46,vL:47,vM:48,vN:49,vO:50,vP:51,vQ:52,vR:53,vS:54,vT:55,vU:56,vV:57,vW:58,vX:59,vY:60,vZ:61,v_:62,v$:63},bwChunk.prototype.ChunkData=function(){return this.m_strChunkData},bwChunk.prototype.Remainder=function(){return this.m_strRemainder},bwChunk.prototype.Length=function(){return this.m_nLength},bwChunk.prototype.Data=function(){return this.m_strData},bwChunk.prototype.NextChunk=function(){return new bwChunk(this.Remainder())},bwChunk.prototype.Skip=function(t){this.m_nOffset+=t},bwChunk.prototype.NextString=function(t){t||(t=this.m_nLength);var e=this.m_strData.substr(this.m_nOffset,t);return this.m_nOffset+=t,e},bwChunk.prototype.NextBase10=function(t){var e=bwChunk.BaseNto10(this.m_strData.substr(this.m_nOffset,t));return this.m_nOffset+=t,e},bwChunk.prototype.NextUBase10=function(t){var e=bwChunk.UBaseNto10(this.m_strData.substr(this.m_nOffset,t));return this.m_nOffset+=t,e},bwChunk.prototype.NextChunkedBase10=function(){var t=new bwChunk(this.m_strData.substr(this.m_nOffset)),e=t.Length(),t=bwChunk.BaseNto10(t.Data(),t.Length());return this.m_nOffset+=e,t},bwChunk.prototype.NextChunkedUBase10=function(){var t=new bwChunk(this.m_strData.substr(this.m_nOffset)),e=t.Length(),t=bwChunk.UBaseNto10(t.Data(),t.Length());return this.m_nOffset+=e,t},bwChunk.prototype.IsEmpty=function(){return""==this.Data()},bwChunk.prototype.EOF=function(){return this.m_nOffset>=this.m_strData.length},bwChunk.CreateChunk=function(t){var e=t.length,i=bwChunk.UBase10toN(e),r="";return r=e>63?"~"+i.length+i+t:i+t},bwChunk.UBase10toN=function(t,e){void 0==e&&(e=-1);for(var i=parseInt(t),r=0,n="",a=!0;i>0||a;)a=!1,r=i&bwChunk.BASE_NUMBER-1,n+=bwChunk.m_arr10to64[r],i>>=bwChunk.BASE_POW;for(;n.length<e;)n+="0";return n},bwChunk.UBaseNto10=function(t){for(var e=0,i="",r=0;r<t.length;r++)i="v"+t.charAt(r),e+=parseInt(bwChunk.m_o64to10[i])<<bwChunk.BASE_POW*r;return e},bwChunk.Base10toN=function(t,e){void 0==e&&(e=-1);for(var i=parseInt(t),r=0,n="",a=!0,s=0>i,r=1;Math.pow(bwChunk.BASE_NUMBER,r)/2<=Math.abs(t);)r++;if(r>e&&(e=r),s){for(r=0;-i>=Math.pow(bwChunk.BASE_NUMBER,r)/2;)r++;i=Math.pow(bwChunk.BASE_NUMBER,r)+i}for(;i>0||a;)a=!1,r=i&bwChunk.BASE_NUMBER-1,n+=bwChunk.m_arr10to64[r],i>>=bwChunk.BASE_POW;for(;n.length<e;)n+=s?"$":"0";return n},bwChunk.BaseNto10=function(t){for(var e=0,i="",r=0;r<t.length;r++)i="v"+t.charAt(r),e+=parseInt(bwChunk.m_o64to10[i])<<bwChunk.BASE_POW*r;return t=Math.pow(bwChunk.BASE_NUMBER,t.length)/2,e>=t&&(e-=2*t),e},bwChunk.GlobalReplace=function(t,e,i){return e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),t.replace(RegExp(e,"g"),i)},bwChunk.GlobalUnReplace=function(t,e,i){return bwChunk.GlobalReplace(t,i,e)},bwChunk.StringEncodings=[["^","^0"],["&","^1"],["'","^2"],["+","^3"],[String.fromCharCode(10),"^4"],[String.fromCharCode(13),"^5"],["?","^6"],[",","^7"],["%","^8"],["\\","^9"],['"',"^A"],["‘","^B"],["’","^C"],["“","^D"],["”","^E"]],bwChunk.EncodeString=function(t){return $.each(bwChunk.StringEncodings,function(e,i){t=bwChunk.GlobalReplace(t,i[0],i[1])}),t},bwChunk.DecodeString=function(t){return $.each(bwChunk.StringEncodings,function(e,i){t=bwChunk.GlobalReplace(t,i[1],i[0])}),t},PathLib.prototype.loadFromXML=function(t){var e=this;this.xml=t,this.id=$(t).attr("id"),this.paths={},$(t).children("path").each(function(t,i){e.paths[$(i).attr("i")]=$(i).attr("p")})},PathLib.getPath=function(t,e){return story.pathlibs[t]&&story.pathlibs[t].paths[e]?story.pathlibs[t].paths[e]:""},PathLib.getPathFromXML=function(t){return PathLib.getPath($(t).attr("l"),$(t).attr("i"))},BezierPath.nCr=function(t,e){for(var i=1,r=1;e>=r;r++)i*=(t+1-r)/r;return i},BezierPath.prototype.setPoints=function(t){t[0].time=0,t[t.length-1].time=100,this.points=t},BezierPath.prototype.loadFromXML=function(t,e){var i=[];$(t).find("segment").children().each(function(t,r){var n=parseInt($(r).attr("x"))-e.x+e.xoffset,a=parseInt($(r).attr("y"))-e.y+e.yoffset;i.push({x:n,y:a})}),this.setPoints(i),this.duration=$(t).attr("duration"),this.easing=$(t).attr("easing"),this.easingdir=$(t).attr("easingdir")},BezierPath.prototype.getXYAtTime=function(t){var e=this.points;if(t<e[0].time)return e[0];if(t>e[e.length-1].time)return e[e.length-1];for(var i=0,r=e.length-1,n=1;n<e.length;n++){var a=e[n];if(t<a.time){r=n;break}void 0!=a.time&&(i=n)}for(var s=r-i,n=e[i].time,t=(t-n)/(e[r].time-n),o=r=0,n=0;s>=n;n++)var a=e[i+n],l=BezierPath.nCr(s,n)*Math.pow(1-t,s-n)*Math.pow(t,n),r=r+l*a.x,o=o+l*a.y;return{x:parseInt(r),y:parseInt(o)}},BezierPath.EasingSteps=[0,15,23.75,32.5,41.25,50,58.75,67.5,76.25,85,100],BezierPath.DirectSteps=[0,10,20,30,40,50,60,70,80,90,100],BezierPath.prototype.toKeyFrames=function(){var t="linear"!=this.easing,e="",i=BezierPath.DirectSteps;t&&(i=BezierPath.DirectSteps);for(var r=0;r<BezierPath.DirectSteps.length;r++){var n=i[r],a=this.getXYAtTime(BezierPath.DirectSteps[r]),s="linear";0==r&&t?s="ease-in":r==BezierPath.DirectSteps.length-2&&t&&(s="ease-out"),block=n+"% {-webkit-transform: translateX("+a.x+"px) translateY("+a.y+"px);-webkit-animation-timing-function:"+s+";}",e+=block+"\r\n"}return"{"+e+"}"};var ZoomPan=function(){this.target=null,this.duration=750};ZoomPan.prototype.loadFromXML=function(t){this.lastx=parseInt($(t).attr("lastx")),this.lasty=parseInt($(t).attr("lasty")),this.lastwidth=parseInt($(t).attr("lastwidth")),this.lastheight=parseInt($(t).attr("lastheight")),this.xpos=parseInt($(t).attr("xpos")),this.ypos=parseInt($(t).attr("ypos")),this.width=parseInt($(t).attr("width")),this.height=parseInt($(t).attr("height")),this.duration=parseInt($(t).attr("duration")),this.staticimage=$(t).attr("staticimage")},ZoomPan.prototype.getZoomModifier=function(){return player.currentWindow?player.currentWindow.zoomModifier:1},ZoomPan.prototype.getStartCss=function(){var t=player.width/this.lastwidth,t=t*this.getZoomModifier(),e=this.lastx*t,i=this.lasty*t,r="translate3d("+-e+"px,"+-i+"px,0px) scale("+t+") rotate(0deg)";return 0==e&&0==i&&1==t&&(r=""),{"-webkit-transition-property":"","-webkit-transition-duration":"0s","-webkit-transform-origin":"top left","-webkit-transition-timing-function":"ease-in","-webkit-transform":r,"-moz-transition-property":"","-moz-transition-duration":"0s","-moz-transform-origin":"top left","-moz-transition-timing-function":"ease-in","-moz-transform":r,"-ms-transition-property":"","-ms-transition-duration":"0s","-ms-transform-origin":"top left","-ms-transition-timing-function":"ease-in","-ms-transform":"translate("+-e+"px,"+-i+"px) scale("+t+") rotate(0deg)"}},ZoomPan.prototype.getFinishCss=function(){var t=player.width/this.width,t=t*this.getZoomModifier(),e=this.xpos*t,i=this.ypos*t;this.zoomParams={scale:t,scaledx:e,scaledy:i};var r="translate3d("+-e+"px,"+-i+"px,0px) scale("+t+") rotate(0deg)";return 0==e&&0==i&&1==t&&(r=""),player.currentWindow&&(this.zoomParams.scale/=player.currentWindow.zoomModifier),{"-webkit-transition-property":"-webkit-transform, opacity","-webkit-transition-duration":this.duration+"ms","-webkit-transform-origin":"top left","-webkit-transition-timing-function":"ease-in","-webkit-transform":r,"-moz-transition-property":"-moz-transform, opacity","-moz-transition-duration":this.duration+"ms","-moz-transform-origin":"top left","-moz-transition-timing-function":"ease-in","-moz-transform":r,"-ms-transition-property":"-ms-transform, opacity","-ms-transition-duration":this.duration+"ms","-ms-transform-origin":"top left","-ms-transition-timing-function":"ease-in","-ms-transform":"translate("+-e+"px,"+-i+"px) scale("+t+") rotate(0deg)"}},ZoomPan.prototype.applyCss=function(t,e){$.each(t,function(t,i){$(e).css(t,i)})},ZoomPan.prototype.apply=function(t){var e=this;e.applyCss(e.getStartCss(),t),setTimeout(function(){e.applyCss(e.getFinishCss(),t),player.zoomParams=e.zoomParams},0)};var swipe={swiping:!1,animating:!1,moved:!1,x:0,y:0,vx:0,vy:0,downX:0,downY:0,lastX:0,lastY:0,startTime:0,lastTime:0,quick:200,normal:300,modes:{follow:"follow",none:"none"}};swipe.parseEventCoords=function(t){if(t.originalEvent.touches?0<t.originalEvent.touches.length?(swipe.x=t.originalEvent.touches[0].pageX,swipe.y=t.originalEvent.touches[0].pageY):(swipe.x=t.originalEvent.changedTouches[0].pageX,swipe.y=t.originalEvent.changedTouches[0].pageY):(swipe.x=t.pageX,swipe.y=t.pageY),!t.frameScaled){swipe.rawX=swipe.x,swipe.rawY=swipe.y;var e=$(".framewrap").offset(),i=swipe.y-e.top;swipe.x=parseInt((swipe.x-e.left)/player.frameScale+e.left),swipe.y=parseInt(i/player.frameScale+e.top)}t.frameScaled=!0},swipe.sniff=function(t,e){if(t.originalEvent||(t.originalEvent=t),swipe.lastX=swipe.x,swipe.lastY=swipe.y,swipe.parseEventCoords(t),swipe.deltaX=swipe.x-swipe.downX,swipe.deltaY=swipe.y-swipe.downY,swipe.deltaX*=1/player.currentZoom(),swipe.deltay*=1/player.currentZoom(),e){var i=new Date-swipe.lastTime;swipe.vx=(swipe.x-swipe.lastX)/i/player.currentZoom(),swipe.vy=(swipe.y-swipe.lastY)/i/player.currentZoom()}swipe.lastTime=new Date,(10<Math.abs(swipe.deltaX)||10<Math.abs(swipe.deltaY))&&(swipe.moved=!0)},swipe.getSlideCoords=function(t){if(t=t||player.currentSlide(),!t.ref)return{x:0,y:0};var t=t.ref.offset(),e=$(".framewrap").offset();return t.left=(t.left-e.left)/player.frameScale+e.left,t.top=(t.top-e.top)/player.frameScale+e.top,e=(swipe.x-t.left)/player.currentZoom(),t=(swipe.y-t.top)/player.currentZoom(),player.zoomParams&&(e/=player.zoomParams.scale,t/=player.zoomParams.scale),1!=player.windowZoomModifier&&(e*=player.frameScale,t*=player.frameScale),{x:parseInt(e),y:parseInt(t)}},swipe.noteDownCoords=function(){swipe.downX=swipe.x,swipe.downY=swipe.y,swipe.moved=!1,swipe.startTime=new Date},swipe.hasMoved=function(t){if(t)return swipe.x!=swipe.downX||swipe.y!=swipe.downY;var t=Math.abs(swipe.x-swipe.downX),e=Math.abs(swipe.y-swipe.downY);return t>3||e>3},swipe.start=function(t){player.showingInterstitial||(swipe.animating&&swipe.applyCallback(),swipe.sniff(t,!1),swipe.downX=swipe.x,swipe.downY=swipe.y,swipe.swiping=!0,swipe.moved=!1,swipe.startTime=new Date)},swipe.move=function(t){"follow"!=player.swipeMode?swipe.moved=!0:swipe.swiping&&(swipe.sniff(t,!0),swipe.apply(swipe.deltaX,0))},swipe.end=function(t){if("follow"==player.swipeMode)if(swipe.animating)swipe.swiping=!1;else if(swipe.swiping){swipe.sniff(t,!1),swipe.swiping=!1;var t=1e3>new Date-swipe.startTime,e=1<Math.abs(swipe.vx);swipe.deltaX>.5*player.width?swipe.prev(swipe.normal):swipe.deltaX<.5*-player.width?swipe.next(swipe.normal):t&&100<swipe.deltaX&&2<Math.abs(swipe.deltaX/swipe.deltaY)?swipe.prev(swipe.quick):t&&-100>swipe.deltaX&&2<Math.abs(swipe.deltaX/swipe.deltaY)?swipe.next(swipe.quick):e&&10<swipe.deltaX&&2<Math.abs(swipe.deltaX/swipe.deltaY)?swipe.prev(swipe.quick):e&&-10>swipe.deltaX&&2<Math.abs(swipe.deltaX/swipe.deltaY)?swipe.next(swipe.quick):(swipe.apply(0,300),(!t||!(-100>swipe.deltaY&&.5>Math.abs(swipe.deltaX/swipe.deltaY)))&&t&&100<swipe.deltaY&&Math.abs(swipe.deltaX/swipe.deltaY)),swipe.moved=!1}else swipe.apply(0,0)},swipe.cancel=function(){swipe.swiping=!1,swipe.animating=!1,swipe.moved=!1,swipe.apply(0,0)},swipe.cancelTap=function(){setTimeout(function(){player.justTapped=!1},0)},swipe.next=function(t){t=t||swipe.normal,swipe.cancelTap(),player.slideIndex==$(".slide").length-1?swipe.apply(0,t):(player.unblock(),player.prepAudio(player.slideIndex+1),swipe.animating=!0,swipe.applyCallback=function(){swipe.animating&&(player.showNextSlide(),swipe.animating=!1)},swipe.apply(-player.width,t,function(){swipe.applyCallback()}))},swipe.prev=function(t){t=t||swipe.normal,swipe.cancelTap(),0==player.slideIndex?swipe.apply(0,t):(player.unblock(),player.prepAudio(player.slideIndex-1),swipe.animating=!0,swipe.applyCallback=function(){swipe.animating&&(player.showPreviousSlide(),swipe.animating=!1)},swipe.apply(player.width,t,function(){swipe.applyCallback()}))},swipe.applyCallback=function(){},swipe.apply=function(t,e,i){$(".slide").css("-webkit-transition-property","-webkit-transform"),$(".slide").css("-webkit-transition-duration",e+"ms"),$(".slide.prev").css("-webkit-transform","translate3d("+(t-player.width)+"px,0px,0px) scale(1.0)"),$(".slide.in").css("-webkit-transform","translate3d("+t+"px,0px,0px) scale(1.0)"),$(".slide.next").css("-webkit-transform","translate3d("+(t+player.width)+"px,0px,0px) scale(1.0)"),i&&($(".slide.in").unbind("webkitTransitionEnd"),$(".slide.in").bind("webkitTransitionEnd",function(){$(".slide.in").unbind("webkitTransitionEnd"),i()}))},swipe.undo=function(){setTimeout(function(){swipe.swiping||swipe.apply(0,300)},1e3)},swipe.setSlideIndex=function(t){player.slideIndex=t;var e=$(".slide");e.removeClass("in out next prev before after"),t>0&&($(e[t-1]).addClass("prev"),player.slideIndex--,story.allSlides[player.slideIndex].update(0,!0),player.slideIndex++),$(e[t]).addClass("in"),t<story.allSlides.length-1&&($(e[t+1]).addClass("next"),player.slideIndex++,story.allSlides[player.slideIndex].update(0,!0),player.slideIndex--),swipe.apply(0,0)},swipe.init=function(){$(document.body).bind("mousedown",function(t){swipe.start(t)}),$(document.body).bind("touchstart",function(t){swipe.start(t)}),$(document.body).bind("mousemove",function(t){swipe.swiping&&(swipe.move(t),t.preventDefault())}),$(document.body).bind("touchmove",function(t){swipe.move(t),t.preventDefault()}),$(document.body).bind("mouseup",function(t){swipe.end(t)}),$(document.body).bind("touchend",function(t){swipe.end(t)}),$(document.body).bind("dragstart",function(t){t.preventDefault()}),player.useSwipeJiggle&&(swipe.jiggleInterval=setInterval(function(){swipe.swiping||swipe.animating||(swipe.jiggleDelta=0==swipe.jiggleDelta?1:0,swipe.apply(swipe.jiggleDelta,0))},100)),player.showInstrumentation&&(swipe.lastJiggle=new Date,swipe.jiggleInterval=setInterval(function(){if(!swipe.swiping&&!swipe.animating){var t=new Date-swipe.lastJiggle;t>200&&(player.mediaMonitor||(player.mediaMonitor=$("<div class='narrowmonitor'></div>"),$(document.body).append(player.mediaMonitor)),player.mediaMonitor.html(t+"<br>"+player.mediaMonitor.html())),player.useSwipeJiggle&&(swipe.jiggleDelta=0==swipe.jiggleDelta?1:0,swipe.apply(swipe.jiggleDelta,0)),swipe.lastJiggle=new Date}},10))},BitMask.showDebug=!1,BitMask.debugOnly=!1,BitMask.max=function(t,e){return t>e?t:e},BitMask.min=function(t,e){return e>t?t:e},BitMask.prototype.loadFromImageUrl=function(t,e){var i=this,r=new Image;r.onload=function(){i.loadFromImage(r),e&&e(r)},r.src=t},BitMask.prototype.loadFromImage=function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height,this.width=t.width,this.height=t.height,e=e.getContext("2d"),e.drawImage(t,0,0),this.loadFromContext(e,t.width,t.height)},BitMask.prototype.loadFromContext=function(t){this.pixels=[];for(var t=t.getImageData(0,0,this.width,this.height).data,e=0,i=0;i<this.height;i++){for(var r=[],n=0;n<this.width;n++)r.push(0!=t[e]||0!=t[e+1]||0!=t[e+2]||1<t[e+3]),e+=4;this.pixels.push(r)}},BitMask.prototype.loadFromRLE=function(t){this.pixels=[];var e=t.indexOf("X")>t.indexOf("O");-1==t.indexOf("O")&&(e=!1);for(var t=t.replace(/O/gi,"X").split("X"),i=[],r=0;r<t.length;r++){var n=parseInt(t[r],16);for(isNaN(n)&&(n=0),e=!e;n>=0;)i.length>this.sourceWidth-1&&(this.pixels.push(i),i=[]),i.push(e),n--}this.pixels.push(i),(this.sourceWidth!=this.width||this.sourceHeight!=this.height)&&this.fixScale()},BitMask.prototype.fixScale=function(){for(var t=[],e=0;e<this.height;e++){for(var i=this.pixels[parseInt(e*this.sourceHeight/this.height)],r=[],n=0;n<this.width;n++){var a=parseInt(n*this.sourceWidth/this.width);r[n]=i[a]}t[e]=r}this.pixels=t},BitMask.prototype.resize=function(t,e,i,r){for(var n=0;n<this.height&&n<this.pixels.length;n++){for(var a=0;i>a;a++)this.pixels[n].unshift(0),this.pixels[n].push(0);for(;this.pixels[n].length<t;)this.pixels[n].push(0)}for(this.pixels[this.pixels.length-1].length<this.width&&this.pixels.pop(),i=[],a=0;t>a;a++)i.push(0);for(n=0;r>n;n++)this.pixels.unshift(i),this.pixels.push(i);for(;this.pixels.length<e;)this.pixels.push(i);this.width=t,this.height=e},BitMask.prototype.testOverlap=function(t,e,i,r){var n=this.width>e&&t.width>-e&&this.height>i&&t.height>-i;return!n||this.isOpaque&&t.isOpaque?n:this.testPixelOverlap(t,e,i,r)},BitMask.prototype.testPixelOverlap=function(t,e,i,r){var e=parseInt(e),i=parseInt(i),n=0,a=BitMask.min(t.width+e,this.width);e>0&&(n=e,a=BitMask.min(this.width,this.width+e));var s=BitMask.min(a-n,t.width),o=0,l=BitMask.min(t.height+i,this.height);i>0&&(o=i,a=BitMask.min(this.height,this.height+i)),a=BitMask.min(l-o,t.height),BitMask.showDebug&&(BitMask.testCanvas||(BitMask.testCanvas=$("<canvas id='test' width='1000' height='1000' style='position:absolute;z-index:200;left:0px;top:0px;'></canvas>"),$(document.body).append(BitMask.testCanvas),BitMask.testContext=BitMask.testCanvas.get(0).getContext("2d"),BitMask.testContext.fillStyle="rgba(255,255,0,0.5)"),BitMask.testCanvas.show(),clearTimeout(BitMask.testCanvasClear),BitMask.testCanvasClear=setTimeout(function(){BitMask.testCanvas.hide()},1e3)),BitMask.showDebug&&(BitMask.testContext.fillStyle="rgba(255,255,0,0.5)",BitMask.testContext.clearRect(0,0,1e3,1e3),BitMask.testContext.fillRect(n,o,s,a)),l=parseInt(10*Math.random())+30,BitMask.debugOnly&&(l=1);for(var h=0,p=o;o+a>p;p++){for(h=n+h;n+s>h;h+=l){var c=this.isPointActive(h,p),d=t.isPointActive(h-e,p-i);if(c&&d&&(c=r&&r(h,p),BitMask.showDebug&&(c?(BitMask.testContext.fillStyle="rgba(255,0,0,0.9)",BitMask.testContext.fillRect(h-1,p-1,2,2)):(BitMask.testContext.fillStyle="rgba(0,255,0,0.9)",BitMask.testContext.fillRect(h-2,p-2,4,4))),!c&&!BitMask.debugOnly))return!0}h=h%s%l}return!1},BitMask.prototype.isPointActive=function(t,e){return this.isOpaque?!0:(t=parseInt(t),e=parseInt(e),0>t||t>=this.width||0>e||e>=this.height||e>=this.pixels.length||t>=this.pixels[e].length?!1:this.pixels[e][t])},BitMask.prototype.drawDebug=function(t){if(!this.isOpaque)if(t=t.getContext("2d"),this.isOpaque)t.fillStyle="#f00",t.fillRect(0,0,this.width,this.height);else for(var e=0;e<this.height&&e<this.pixels.length;e++)for(var i=0;i<this.width&&i<this.pixels[e].length;i++)t.fillStyle=this.pixels[e][i]?"#00f":"#000",t.fillRect(i,e,1,1)};var ResumeParser=function(){};ResumeParser.dump=function(t,e){for(var e=e||0,i=new bwChunk(t),r=0;e>r;r++);i.Data()&&ResumeParser.dump(i.Data(),e+1),i.Remainder()&&ResumeParser.dump(i.Remainder(),e)};var ProgressBar=function(t,e,i){this.container=t||$(document.body),this.ref=e,this.draggable=i,this.dragging=!1,this.index=0,this.zoomModifier=this.count=1,this.onDragUpdate=null,this.ref||this.createRef(),i&&this.bindDragEvents()};ProgressBar.prototype.createRef=function(){return this.ref?!1:(this.ref=$('<div class="progress-container"><div class="progress-bar"></div></div>'),this.container.append(this.ref),!0)},ProgressBar.prototype.show=function(){this.ref.show()},ProgressBar.prototype.hide=function(){this.ref.hide()},ProgressBar.prototype.update=function(){if(player.currentWindow&&player.currentWindow.progressBar&&this==player.progressBar)player.currentWindow.progressBar.update();else{var t=parseFloat(100*(this.index/this.count));t>100&&(t=100);var e=t+"%";this.ref.children(".progress-bar").css("width",e),this.ref.children(".seek_bar_fill").css("width",e),this.ref.children(".seek_bar_progress").css("left",e),this.index==this.count||100==t?this.ref.children().addClass("full"):this.ref.children().removeClass("full")}},ProgressBar.prototype.bindDragEvents=function(){var t=this;t.dragging=!1;var e=function(e){if(t.dragging){var i=t.ref.offset().left,r=t.ref.width()*t.zoomModifier;swipe.parseEventCoords(e),e=(swipe.x-i)/r,0>e&&(e=0),e>1&&(e=1),t.onDragUpdate&&t.onDragUpdate(e)}},i=function(i){t.dragging&&(e(i),t.dragging=!1,t.wasPlaying&&(player.play(),player.activeTimeline!=player&&player.activeTimeline.play&&player.activeTimeline.play()))};$(this.ref).bind("mousedown touchstart",function(i){t.dragging=!0,t.wasPlaying=player.playing,e(i),t.wasPlaying&&player.activeTimeline.pause()}),$(window).bind("mousemove touchmove",e),$(this.ref).bind("mouseup touchend",i),$(document.body).bind("mouseup touchend",i),$(window).bind("mouseup touchend",i)},ProgressBar.getCurrentProgressBar=function(){return player.currentWindow&&player.currentWindow.progressBar?player.currentWindow.progressBar:player.progressBar};var VolumeSlider=function(t){this.button=t,this.visible=this.dragging=!1,this.volume=80,this.onDragUpdate=null,this.createRef(),this.bindDragEvents(),VolumeSlider.sliderList.push(this)};VolumeSlider.sliderList=[],VolumeSlider.prototype.createRef=function(){this.button.find(".volume-slider").remove(),this.ref=$('<div class="volume-slider"><div class="volume-handle"></div></div>'),this.handle=this.ref.children().first(),this.icon=this.button.children().first(),this.button.prepend(this.ref)},VolumeSlider.prototype.toggle=function(){this.visible?this.hide():this.show()},VolumeSlider.prototype.show=function(){this.button.addClass("volume-open"),this.visible=!0},VolumeSlider.prototype.hide=function(){this.button.removeClass("volume-open"),this.visible=this.dragging=!1},VolumeSlider.prototype.setVolume=function(t){this.volume=t,this.update()},VolumeSlider.prototype.update=function(){this.handle.css("top",parseInt(100-this.volume)+"%")},VolumeSlider.prototype.bindDragEvents=function(){var t=this;t.dragging=!1;var e=function(e){if(t.dragging){var i=t.ref.offset().top,r=t.ref.height();swipe.parseEventCoords(e),e=1-(swipe.rawY-i)/r,0>e&&(e=0),e>1&&(e=1),t.volume=parseInt(100*e),t.update(),t.onDragUpdate&&t.onDragUpdate(e),$.each(VolumeSlider.sliderList,function(e,i){i!=t&&(i.volume=t.volume,i.update())})}},i=function(i){return t.dragging&&(e(i),i=t.dragging,t.dragging=!1,i)?!1:void 0};$(this.ref).bind("mousedown touchstart",function(i){t.dragging=!0,e(i)}),$(window).bind("mousemove touchmove",e),$(this.ref).bind("mouseup touchend",i),$(document.body).bind("mouseup touchend",i),$(window).bind("mouseup touchend",i),this.button.bind("click",function(e){return t.toggle(),MouseEvents.processHideables(e),!1}),MouseEvents.addHideable(".volume-slider",".volume-slider,.icon.volume",function(){t.hide()})},ppRect.prototype.GetWidth=function(){return this.right-this.left},ppRect.prototype.GetHeight=function(){return this.bottom-this.top},ppRect.prototype.Clone=function(){return new ppRect(this.left,this.top,this.right,this.bottom)},ppRect.prototype.Translate=function(t,e){this.left+=t,this.right+=t,this.top+=e,this.bottom+=e},ppRect.prototype.Widen=function(t,e){this.left-=t,this.right+=t,this.top-=e,this.bottom+=e},ppRect.prototype.AddRect=function(t){this.left>t.left&&(this.left=t.left),this.right<t.right&&(this.right=t.right),this.top>t.top&&(this.top=t.top),this.bottom<t.bottom&&(this.bottom=t.bottom)},ppRect.prototype.RotateRect=function(t){var t=t*Math.PI/180,e=this.GetWidth(),i=this.GetHeight(),r=Math.cos(t),n=Math.sin(t),t=0*r+0*n,a=-0*n+0*r,s=e*r+0*n,o=e*n+0*r,l=e*r-i*n,h=e*n+i*r,e=0*r-i*n,n=-0*n+i*r,i=Math.min(a,o,h,n),r=Math.min(t,s,l,e),a=Math.max(a,o,h,n),t=Math.max(t,s,l,e);return console.warn(r+", "+t+" : "+i+", "+a),new ppRect(r,i,t,a)},window.ppFudge=.5,ppGraphics.prototype.Destroy=function(){},ppGraphics.prototype.GetOffset=function(){return this.m_ptOffset},ppGraphics.prototype.ResizeCanvas=function(t,e,i){function r(t,e,i,r,n){var a=(i-t.width)/2,s=(r-t.height)/2,o=e.getImageData(0,0,t.width,t.height);t.width=i,t.height=r,n?e.putImageData(o,a,s):e.putImageData(o,0,0)}r(this.m_oFillCanvas,this.m_oFillContext,t,e,i),r(this.m_oStrokeCanvas,this.m_oStrokeContext,t,e,i)},ppGraphics.prototype.ResizeCanvasBox=function(t){function e(t,e,r){var n=Math.min(r.left,0),a=Math.min(r.top,0),s=Math.max(r.right,t.width),r=Math.max(r.bottom,t.height),o=e.getImageData(0,0,t.width,t.height);t.width=s,t.height=r,i.m_nWidth=Math.max(i.m_nWidth,t.width),i.m_nHeight=Math.max(i.m_nHeight,t.height),e.putImageData(o,-n,-a)}var i=this;e(this.m_oFillCanvas,this.m_oFillContext,t),e(this.m_oStrokeCanvas,this.m_oStrokeContext,t)},ppGraphics.prototype.DumpDebugCanvas=function(){var t=document.createElement("canvas");t.width=this.m_nWidth,t.height=this.m_nHeight;var e=t.getContext("2d"),i=this.m_oFillContext.getImageData(0,0,t.width,t.height);e.putImageData(i,0,0),t.style.border="dashed 1px blue",document.body.appendChild(t),document.body.style.backgroundColor="red"},ppGraphics.prototype.GetFinalCanvas=function(t){null==t&&(t=!1);var e=new ppRect(0,0,this.m_nWidth,this.m_nHeight);if(!t)for(var i=null,i=null,r=0,n=0,a=0;a<this.m_arrShadows.length;a++)i=this.m_arrShadows[a],i.bInner?this.DrawInnerShadow(i):(this.DrawShadow(i),r=(this.m_nWidth-i.canvas.width)/2,n=(this.m_nHeight-i.canvas.height)/2,i.nXPos=r+i.nXOffset,i.nYPos=n+i.nYOffset,i=new ppRect(i.nXPos,i.nYPos,i.nXPos+i.canvas.width,i.nYPos+i.canvas.height),e.AddRect(i));if(this.finalCanvas=document.createElement("canvas"),r=this.finalCanvas.getContext("2d"),!t&&this.m_bHasShadow)for(this.m_nWidth=e.GetWidth(),this.m_nHeight=e.GetHeight(),this.m_ptOffset.x=-e.left,this.m_ptOffset.y=-e.top,this.finalCanvas.width=this.m_nWidth,this.finalCanvas.height=this.m_nHeight,a=0;a<this.m_arrShadows.length;a++)i=this.m_arrShadows[a],i.bInner||(r.drawImage(i.canvas,i.nXPos-e.left,i.nYPos-e.top),i.canvas.width=1,i.canvas.height=1);else this.finalCanvas.width=this.m_nWidth,this.finalCanvas.height=this.m_nHeight;for(r.drawImage(this.m_oFillCanvas,-e.left,-e.top),t||(this.m_oFillCanvas.width=1,this.m_oFillCanvas.height=1,this.m_oFillCanvas=null),a=0;a<this.m_arrStrokeCanvases.length;a++)r.drawImage(this.m_arrStrokeCanvases[a],-e.left,-e.top),t||(this.m_arrStrokeCanvases[a].width=1,this.m_arrStrokeCanvases[a].height=1,this.m_arrStrokeCanvases[a]=null);if(!t&&this.m_bHasInnerShadow){for(r.save(),a=0;a<this.m_arrShadows.length;a++)i=this.m_arrShadows[a],i.bInner&&(r.shadowOffsetX=i.nXOffset,r.shadowOffsetY=i.nYOffset,r.shadowBlur=i.nBlur,r.shadowColor=ppArt.GetColor(i.nColor,i.nAlpha),r.globalCompositeOperation="source-atop",r.drawImage(i.canvas,-10,-10),i.canvas.width=1,i.canvas.height=1);r.restore()}return this.finalCanvas},ppGraphics.prototype.AddImage=function(t,e,i,r,n,a){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),(0==this.m_oFillCanvas.width||0==this.m_oFillCanvas.height)&&(this.m_oFillCanvas.width=t.width*r,this.m_oFillCanvas.height=t.height*n,this.m_oStrokeCanvas.width=this.m_oFillCanvas.width,this.m_oStrokeCanvas.height=this.m_oFillCanvas.height,this.m_nWidth=this.m_oFillCanvas.width,this.m_nHeight=this.m_oFillCanvas.height);var s=t.naturalWidth||t.width,o=t.naturalHeight||t.height;this.m_oFillCanvas.width<Math.ceil(s*r)+e+(this.m_nXOffset+ppArt.currentFudge)&&(this.m_oFillCanvas.width=Math.ceil(s*r)+e+(this.m_nXOffset+ppArt.currentFudge),this.m_nWidth=this.m_oStrokeCanvas.width=this.m_oFillCanvas.width),this.m_oFillCanvas.height<Math.ceil(o*n)+i+(this.m_nYOffset+ppArt.currentFudge)&&(this.m_oFillCanvas.height=Math.ceil(o*n)+i+(this.m_nYOffset+ppArt.currentFudge),
this.m_nHeight=this.m_oStrokeCanvas.height=this.m_oFillCanvas.height),this.m_bFillStarted=!1,this.m_oFillContext.beginPath(),this.m_oFillContext.globalAlpha=a,e-=ppArt.currentFudge,i-=ppArt.currentFudge,this.m_oFillContext.drawImage(t,0,0,s,o,e+(this.m_nXOffset+ppArt.currentFudge),i+(this.m_nYOffset+ppArt.currentFudge),Math.ceil(s*r),Math.ceil(o*n)),this.m_oFillContext.globalAlpha=1},ppGraphics.prototype.StartSolidFill=function(t,e){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_oFillContext.beginPath(),this.m_oFillContext.fillStyle=ppArt.GetColor(t,e),this.m_bFillStarted=!0},ppGraphics.prototype.StartGradientFill=function(t){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_oFillContext.beginPath(),this.m_oFillContext.fillStyle=t,this.m_bFillStarted=!0},ppGraphics.prototype.EndFill=function(){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_bFillStarted=!1},ppGraphics.prototype.StartImageFill=function(t){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_oFillContext.beginPath(),this.m_oFillContext.fillStyle=t,this.m_bFillStarted=!0},ppGraphics.prototype.StartRotatedImageFill=function(t,e,i,r,n,a){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_nFillRotation=e,this.m_nFillXPos=i,this.m_nFillYPos=r,this.m_nFillScaleX=n,this.m_nFillScaleY=a,this.m_bRotatedFill=!0,this.m_oFillContext.beginPath(),this.m_oFillContext.fillStyle=t,this.m_bFillStarted=!0},ppGraphics.prototype.SetLineStyle=function(t,e,i,r,n){this.CreateNewStrokeCanvas(),this.m_bStrokeStarted=!0,this.strokeStyle=ppArt.GetColor(e,i),this.lineWidth=t,this.lineJoin=r,this.lineCap=n,t%2>0&&(ppArt.currentFudge=window.ppFudge),this.m_oStrokeContext.strokeStyle=this.strokeStyle,this.m_oStrokeContext.lineWidth=this.lineWidth,this.m_oStrokeContext.lineJoin=this.lineJoin},ppGraphics.prototype.SetGradientLineStyle=function(t,e,i,r){this.CreateNewStrokeCanvas(),this.m_bStrokeStarted=!0,this.strokeStyle=e,this.lineWidth=t,this.lineJoin=i,this.lineCap=r,t%2>0&&(ppArt.currentFudge=window.ppFudge),this.m_oStrokeContext.strokeStyle=e,this.m_oStrokeContext.lineWidth=this.lineWidth,this.m_oStrokeContext.lineJoin=this.lineJoin,this.m_bStrokeStarted=!0},ppGraphics.prototype.ClearLineStyle=function(){this.CreateNewStrokeCanvas(),this.m_bStrokeStarted=!1},ppGraphics.prototype.CreateNewStrokeCanvas=function(){ppArt.currentFudge=0,1==this.m_bLineDrawn&&(this.m_bStrokeStarted&&this.m_oStrokeContext.stroke(),this.m_oStrokeContext.beginPath(),this.m_bLineDrawn=!1)},ppGraphics.prototype.AddShadow=function(t,e,i,r,n,a,s,o,l){var h={};h.nXOffset=t,h.nYOffset=e,h.nBlur=i,h.nColor=r,h.nAlpha=n,h.nScale=a,h.nStrength=s,h.nQuality=o,h.bInner=l,this.m_arrShadows.push(h)},ppGraphics.prototype.DrawShadow=function(t){var e=t.nBlur,i=t.nScale,r=this.GetFinalCanvas(!0),n=document.createElement("canvas"),a=n.getContext("2d");for(n.height=2*r.height*i+4*e,n.width=r.width*i+2*e,a.shadowOffsetX=0,a.shadowOffsetY=r.height*i+2*e,a.shadowBlur=e,a.shadowColor=ppArt.GetColor(t.nColor,t.nAlpha*(1+(t.nStrength-1)/2)),a.drawImage(r,0,0,r.width,r.height,e,e,r.width*i,r.height*i),t.canvas=document.createElement("canvas"),t.context=t.canvas.getContext("2d"),this.m_bHasShadow=!0,t.canvas.height=r.height*i+2*e,t.canvas.width=r.width*i+2*e,t.context.drawImage(n,0,r.height*i+2*e,n.width,n.height-(r.height*i+2*e),0,0,n.width,n.height-(r.height*i+2*e)),a=1;a<t.nStrength;a++)t.context.drawImage(n,0,r.height*i+2*e,n.width,n.height-(r.height*i+2*e),0,0,n.width,n.height-(r.height*i+2*e));n.width=1,n.height=1,r.width=1,r.height=1},ppGraphics.prototype.DrawInnerShadow=function(t){var e=this.GetFinalCanvas(!0);this.m_bHasInnerShadow=!0,t.canvas=document.createElement("canvas"),t.canvas.width=e.width+20,t.canvas.height=e.height+20,t.context=t.canvas.getContext("2d"),t.context.fillStyle=ppArt.GetColor(t.nColor,t.nAlpha),t.context.moveTo(0,0),t.context.lineTo(t.canvas.width,0),t.context.lineTo(t.canvas.width,t.canvas.height),t.context.lineTo(0,t.canvas.height),t.context.lineTo(0,0),t.context.fill(),t.context.globalCompositeOperation="destination-out",t.context.drawImage(e,10,10),t.context.globalCompositeOperation="source-over",e.width=1,e.height=1},ppGraphics.prototype.fill=function(){this.m_bFillStarted&&this.FillContext(this.m_oFillContext),this.m_oFillContext.beginPath()},ppGraphics.prototype.FillContext=function(t){t.save(),t.translate(this.m_nXOffset+ppArt.currentFudge,this.m_nYOffset+ppArt.currentFudge),this.m_bRotatedFill&&(t.scale(this.m_nFillScaleX,this.m_nFillScaleY),t.translate(this.m_nFillXPos,this.m_nFillYPos),t.rotate(this.m_nFillRotation)),t.fill(),this.m_bRotatedFill=!1,t.restore()},ppGraphics.prototype.stroke=function(){this.m_bStrokeStarted&&this.m_oStrokeContext.stroke()},ppGraphics.prototype.beginPath=function(){this.m_oFillContext.beginPath(),this.m_oStrokeContext.beginPath(),this.m_bLineDrawn=this.m_bFillStarted=this.m_bStrokeStarted=!1},ppGraphics.prototype.closePath=function(){this.m_oFillContext.closePath(),this.m_oStrokeContext.closePath(),this.m_oFillContext.drawImage(this.m_oStrokeCanvas,0,0),this.m_oStrokeContext.clearRect(0,0,this.m_oStrokeCanvas.width,this.m_oStrokeCanvas.height)},ppGraphics.prototype.lineTo=function(t,e){this.m_bForMask&&(t=Math.round(t),e=Math.round(e)),this.m_bFillStarted&&this.m_oFillContext.lineTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge)),this.m_bStrokeStarted&&(this.m_bLineDrawn=!0,this.m_oStrokeContext.lineTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge))),this.m_nCurXPos=t+(this.m_nXOffset+ppArt.currentFudge),this.m_nCurYPos=e+(this.m_nYOffset+ppArt.currentFudge)},ppGraphics.prototype.moveTo=function(t,e){this.m_bForMask&&(t=Math.round(t),e=Math.round(e)),this.m_oFillContext.moveTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge)),this.m_oStrokeContext.moveTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge)),this.m_nCurXPos=t+(this.m_nXOffset+ppArt.currentFudge),this.m_nCurYPos=e+(this.m_nYOffset+ppArt.currentFudge)},ppGraphics.prototype.bezierCurveTo=function(t,e,i,r,n,a){this.m_bForMask&&(t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),n=Math.round(n),a=Math.round(a)),this.m_bFillStarted&&this.m_oFillContext.bezierCurveTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge),i+(this.m_nXOffset+ppArt.currentFudge),r+(this.m_nYOffset+ppArt.currentFudge),n+(this.m_nXOffset+ppArt.currentFudge),a+(this.m_nYOffset+ppArt.currentFudge)),this.m_bStrokeStarted&&(this.m_bLineDrawn=!0,this.m_oStrokeContext.bezierCurveTo(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge),i+(this.m_nXOffset+ppArt.currentFudge),r+(this.m_nYOffset+ppArt.currentFudge),n+(this.m_nXOffset+ppArt.currentFudge),a+(this.m_nYOffset+ppArt.currentFudge))),this.m_nCurXPos=n+(this.m_nXOffset+ppArt.currentFudge),this.m_nCurYPos=a+(this.m_nYOffset+ppArt.currentFudge)},ppGraphics.prototype.createLinearGradient=function(t,e,i,r){return this.m_oFillContext.createLinearGradient(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge),i+(this.m_nXOffset+ppArt.currentFudge),r+(this.m_nYOffset+ppArt.currentFudge))},ppGraphics.prototype.createRadialGradient=function(t,e,i,r,n,a){return this.m_oFillContext.createRadialGradient(t+(this.m_nXOffset+ppArt.currentFudge),e+(this.m_nYOffset+ppArt.currentFudge),i,r+(this.m_nXOffset+ppArt.currentFudge),n+(this.m_nYOffset+ppArt.currentFudge),a)},ppGraphics.prototype.createPattern=function(t,e){return this.m_oFillContext.createPattern(t,e)};var ppArt={CMD_CREATE_SHAPE:"0",CMD_CREATE_MASK:"1",CMD_END_PATH:"2",CMD_CLOSE_PATH:"3",CMD_ADD_TEXT:"4",CMD_ADD_IMAGE:"5",CMD_ROTATION_DATA:"6",CMD_START_SOLID_FILL:"A",CMD_START_GRADIENT_FILL:"B",CMD_START_BITMAP_FILL:"C",CMD_START_SLIDEBG_FILL:"D",CMD_END_FILL:"E",CMD_START_BITMAP_TILE_FILL:"F",CMD_REPEAT_FILL:"G",CMD_LINE_STYLE:"N",CMD_GRADIENT_LINE_STYLE:"O",CMD_CLEAR_LINE_STYLE:"P",CMD_REPEAT_LINE_STYLE:"Q",CMD_DEFAULT_HOT:"Z",CMD_DRAW_ARC:"a",CMD_DRAW_ELLIPSE:"b",CMD_DRAW_RECTANGLE:"c",CMD_DRAW_LINE:"d",CMD_DRAW_LINES:"e",CMD_DRAW_POLYGON:"f",CMD_DRAW_CURVE:"g",CMD_DRAW_CLOSED_CURVE:"h",CMD_DRAW_TEXT:"i",CMD_DRAW_SHADOW:"t",CMD_DRAW_SHAPE_SHADOW:"u",CMD_DRAW_REFLECTION:"v",CMD_SOFTEN_EDGES:"w",CMD_DRAW_PERSPECTIVE_SHADOW:"x",LINE_CAP_SQUARE:1,LINE_CAP_FLAT:2,LINE_CAP_ROUND:4,LINE_JOIN_ROUND:8,LINE_JOIN_BEVEL:16,LINE_JOIN_MITER:32,DEGREE_MULTIPLIER:2*Math.PI/360,BASE_NUMBER:64,BASE_POW:6,m_strPath:"",m_nPos:0,m_bPathStarted:!1,m_bShapeStarted:!1,m_bReverseCurve:!1,m_bResetReverse:!1,m_nStartX:0,m_nStartY:0,m_nCurX:0,m_nCurY:0,m_arrGraphics:null,m_listTextOffsets:null,m_arrShadows:null,m_oGraphics:null,m_bDebug:!1,m_nReflectionIndex:-1,m_nLastLineStyle:-1,m_nLastFill:-1,m_nLineWidth:0,rectRotated:null,polyRotated:null,m_nRotationDistance:0,m_o64to10:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35,A:36,B:37,C:38,D:39,E:40,F:41,G:42,H:43,I:44,J:45,K:46,L:47,M:48,N:49,O:50,P:51,Q:52,R:53,S:54,T:55,U:56,V:57,W:58,X:59,Y:60,Z:61,_:62,$:63},UBaseNto10:function(t,e){for(var i=0,r=0,n=t;t+e>n;n++)i+=this.m_o64to10[this.m_strPath.charAt(this.m_nPos+n)]<<this.BASE_POW*r,r++;return i},BaseNto10:function(t,e){for(var i=0,r=0,n=t;t+e>n;n++)i+=this.m_o64to10[this.m_strPath.charAt(this.m_nPos+n)]<<this.BASE_POW*r,r++;return i-2047},FBaseNto10:function(t,e){var i=0,i=0,r=this.UBaseNto10(t+2,e-2);return"00"==this.m_strPath.substr(t+this.m_nPos,2)?i=-r/4095:(i=this.BaseNto10(t,2),i+=r/4095),Math.round(1e3*i)/1e3},GetColor:function(t,e){void 0==e&&(e=100);var i;return i=e/100,0==i&&(i=.01),"rgba("+(t>>16)+","+(t>>8&255)+","+(255&t)+", "+i+")"},GetCommandDescription:function(t){var e="Unknown: "+t;switch(t){case this.CMD_ROTATION_DATA:e="CMD_ROTATION_DATA";break;case this.CMD_DRAW_TEXT:e="CMD_DRAW_TEXT";break;case this.CMD_DEFAULT_HOT:e="CMD_DEFAULT_HOT";break;case this.CMD_DRAW_LINE:e="CMD_DRAW_LINE";break;case this.CMD_DRAW_LINES:e="CMD_DRAW_LINES";break;case this.CMD_DRAW_POLYGON:e="CMD_DRAW_POLYGON";break;case this.CMD_DRAW_CURVE:e="CMD_DRAW_CURVE";break;case this.CMD_DRAW_CLOSED_CURVE:e="**** implement CMD_DRAW_CLOSED_CURVE";break;case this.CMD_ADD_TEXT:e="CMD_ADD_TEXT";break;case this.CMD_ADD_IMAGE:e="CMD_ADD_IMAGE";break;case this.CMD_END_PATH:e="CMD_END_PATH";break;case this.CMD_CLOSE_PATH:e="CMD_CLOSE_PATH";break;case this.CMD_CREATE_SHAPE:e="**** implement CMD_CREATE_SHAPE";break;case this.CMD_CREATE_MASK:e="CMD_CREATE_MASK";break;case this.CMD_LINE_STYLE:e="CMD_LINE_STYLE";break;case this.CMD_GRADIENT_LINE_STYLE:e="**** implement CMD_GRADIENT_LINE_STYLE";break;case this.CMD_CLEAR_LINE_STYLE:e="CMD_CLEAR_LINE_STYLE";break;case this.CMD_REPEAT_LINE_STYLE:e="**** implement CMD_REPEAT_LINE_STYLE";break;case this.CMD_START_SLIDEBG_FILL:e="**** implement CMD_START_SLIDEBG_FILL";break;case this.CMD_START_BITMAP_FILL:e="**** implement CMD_START_BITMAP_FILL";break;case this.CMD_START_BITMAP_TILE_FILL:e="CMD_START_BITMAP_TILE_FILL";break;case this.CMD_START_GRADIENT_FILL:e="CMD_START_GRADIENT_FILL";break;case this.CMD_START_SOLID_FILL:e="CMD_START_SOLID_FILL";break;case this.CMD_END_FILL:e="CMD_END_FILL";break;case this.CMD_REPEAT_FILL:e="**** implement CMD_REPEAT_FILL";break;case this.CMD_DRAW_ELLIPSE:e="CMD_DRAW_ELLIPSE";break;case this.CMD_DRAW_RECTANGLE:e="CMD_DRAW_RECTANGLE";break;case this.CMD_DRAW_SHADOW:e="CMD_DRAW_SHADOW";break;case this.CMD_DRAW_ARC:case this.CMD_DRAW_SHAPE_SHADOW:e="**** implement CMD_DRAW_SHAPE_SHADOW";break;case this.CMD_DRAW_PERSPECTIVE_SHADOW:e="**** implement CMD_DRAW_PERSPECTIVE_SHADOW";break;case this.CMD_SOFTEN_EDGES:e="CMD_SOFTEN_EDGES";break;case this.CMD_DRAW_REFLECTION:e="CMD_DRAW_REFLECTION"}return e},m_arrColors:[16711680,16776960,16777215,65280,65535,255,16711935,0],m_nCurColor:0,DrawVector:function(t,e,i,r,n,a){if(null!=this.m_arrGraphics)for(var s=0;s<this.m_arrGraphics.length;s++)this.m_arrGraphics[s].Destroy();this.m_arrGraphics=[],this.m_listTextOffsets={},t.rectShape||(t.rectShape=new ppRect(-1,-1,t.m_nWidth+1,t.m_nHeight+1)),this.rectShape=t.rectShape,this.m_nRotation=t.rotation,this.m_oGraphics=new ppGraphics(t.rectShape),this.m_arrGraphics.push(this.m_oGraphics),this.m_nPos=0,this.m_bShapeStarted=this.m_bPathStarted=!1,this.m_nReflectionIndex=-1,this.m_bResetReverse=this.m_bReverseCurve=!1,this.m_arrShadows=null,this.DrawPath(e,0,0,i,r,n,a),e=t.canvas.getContext("2d"),e.save();for(var o=[],a=null,n=r=0,i={x:0,y:0},s=0;s<this.m_arrGraphics.length;s++){if(1==this.m_arrGraphics.length&&null!=this.m_arrShadows){for(var l=this.m_arrGraphics[0],a=null,h=0;h<this.m_arrShadows.length;h++)a=this.m_arrShadows[h],l.AddShadow(a.nXOffset,a.nYOffset,a.nBlurX,a.nColor,a.nAlpha,a.nScale,a.nStrength,a.nQuality,a.bInner);this.m_arrShadows=null}a={},a.canvas=this.m_arrGraphics[s].GetFinalCanvas(),a.offset=this.m_arrGraphics[s].GetOffset(),a.width=this.m_oGraphics.m_nWidth,a.height=this.m_oGraphics.m_nHeight,r<a.canvas.height&&(r=a.canvas.height),n<a.canvas.width&&(n=a.canvas.width),o.push(a),i.x<o[s].offset.x&&(i.x=o[s].offset.x),i.y<o[s].offset.y&&(i.y=o[s].offset.y)}if(a=null,1==o.length)a=o[0].canvas,i=o[0].offset;else for(a=document.createElement("canvas"),a.width=n,a.height=r,l=a.getContext("2d"),s=0;s<o.length;s++)l.drawImage(o[s].canvas,i.x-o[s].offset.x,i.y-o[s].offset.y);if(null!=this.m_arrShadows){for(l=new ppGraphics(new ppRect(0,0,n,r)),l.AddImage(a,0,0,1,1,100),s=0;s<this.m_arrShadows.length;s++)a=this.m_arrShadows[s],l.AddShadow(a.nXOffset,a.nYOffset,a.nBlurX,a.nColor,a.nAlpha,a.nScale,a.nStrength,a.nQuality,a.bInner);a=l.GetFinalCanvas(),n=a.width,r=a.height,s=l.GetOffset(),0<s.x&&(i.x+=s.x),0<s.y&&(i.y+=s.y)}s=new ppRect(0,0,n,r),r=new ppRect(0,0,n,r),n={x:0,y:0},0<=this.m_nReflectionIndex&&(this.m_nPos=this.m_nReflectionIndex,this.AdjustReflectionBounds(s,n,t.rectShape,this.rectRotated,t.rotation,t.rotatexpos,t.rotateypos,this.m_nRotationDistance)),t.canvas.width=s.GetWidth(),t.canvas.height=s.GetHeight(),e.drawImage(a,0,0,r.right,r.bottom,n.x,n.y,r.right,r.bottom),e.restore(),0<=this.m_nReflectionIndex&&(this.m_nPos=this.m_nReflectionIndex,this.DrawReflection(e,t.canvas,t.rectShape,n,this.rectRotated,this.polyRotated,t.rotation,t.rotatexpos,t.rotateypos,this.m_nRotationDistance)),t.m_nXOffset=t.rectShape.left-(n.x+i.x),t.m_nYOffset=t.rectShape.top-(n.y+i.y);for(var p in this.m_listTextOffsets)this.m_listTextOffsets[p].x+=n.x+i.x,this.m_listTextOffsets[p].y+=n.y+i.y;-1<location.search.indexOf("info=1")&&e.fillRect(t.rectShape.left,t.rectShape.top,t.rectShape.left+10,t.rectShape.top+10)},DrawPath:function(t,e,i,r,n,a,s){for(this.m_strPath=t,this.m_oGraphics.beginPath();this.m_nPos<this.m_strPath.length;)t=this.m_strPath.charAt(this.m_nPos),this.m_nPos++,this.m_bResetReverse&&(this.m_bReverseCurve=!1),this.m_bResetReverse=!0,this.ExecuteCmd(t,e,i,r,n,a,s);this.m_oGraphics.fill(),this.m_oGraphics.stroke()},ExecuteCmd:function(t,e,i,r,n,a,s){switch(t){case this.CMD_ROTATION_DATA:this.m_nPos+=this.StoreRotationData();break;case this.CMD_CREATE_SHAPE:e=this.m_nPos,this.m_oGraphics.fill(),this.m_oGraphics.stroke(),this.m_oGraphics=new ppGraphics(this.rectShape),this.m_arrGraphics.push(this.m_oGraphics),this.m_nPos=e+1;break;case this.CMD_END_PATH:this.m_oGraphics.fill(),this.m_oGraphics.stroke(),this.m_bPathStarted=this.m_bShapeStarted=!1,this.m_nCurY=this.m_nCurX=0;break;case this.CMD_CLOSE_PATH:this.m_bResetReverse=!1,this.m_oGraphics.lineTo(this.m_nStartX,this.m_nStartY),this.m_oGraphics.closePath(),this.m_bShapeStarted=!0,this.m_bPathStarted=!1,this.m_nCurY=this.m_nCurX=0;break;case this.CMD_ADD_IMAGE:this.m_nPos+=this.AddImage(e,i,a);break;case this.CMD_START_SOLID_FILL:this.m_nLastFill=this.m_nPos-1,this.m_nPos+=this.StartSolidFill();break;case this.CMD_START_GRADIENT_FILL:this.m_nLastFill=this.m_nPos-1,this.m_oGraphics.fill(),this.m_nPos+=this.StartGradientFill(e,i);break;case this.CMD_START_BITMAP_FILL:this.m_nLastFill=this.m_nPos-1,this.m_oGraphics.fill(),this.m_nPos+=this.StartBitmapFill(e,i,a);break;case this.CMD_START_SLIDEBG_FILL:this.m_nLastFill=this.m_nPos-1,this.m_oGraphics.fill(),this.StartSlideBgFill();break;case this.CMD_END_FILL:this.m_oGraphics.EndFill();break;case this.CMD_START_BITMAP_TILE_FILL:this.m_nLastFill=this.m_nPos-1,this.m_nPos+=this.StartBitmapTileFill(e,i,a);break;case this.CMD_REPEAT_FILL:t=this.m_nPos,this.m_nPos=this.m_nLastFill,s=this.m_strPath.charAt(this.m_nPos),this.m_nPos++,this.ExecuteCmd(s,e,i,r,n,a),this.m_nPos=t;break;case this.CMD_LINE_STYLE:this.m_nLastLineStyle=this.m_nPos-1,this.m_nPos+=this.SetLineStyle();break;case this.CMD_GRADIENT_LINE_STYLE:this.m_nLastLineStyle=this.m_nPos-1,this.m_nPos+=this.SetGradientLineStyle();break;case this.CMD_CLEAR_LINE_STYLE:this.m_nLineWidth=0,this.m_oGraphics.ClearLineStyle();break;case this.CMD_REPEAT_LINE_STYLE:t=this.m_nPos,this.m_nPos=this.m_nLastLineStyle,s=this.m_strPath.charAt(this.m_nPos),this.m_nPos++,this.ExecuteCmd(s,e,i,r,n,a),this.m_nPos=t;break;case this.CMD_DEFAULT_HOT:this.item&&(this.item.vectorHot=!0);break;case this.CMD_DRAW_ELLIPSE:this.m_nPos+=this.DrawEllipse(e,i),this.m_oGraphics.closePath(),this.m_bPathStarted=!1;break;case this.CMD_DRAW_RECTANGLE:this.m_nPos+=this.DrawRectangle(e,i),this.m_oGraphics.closePath(),this.m_bPathStarted=!1;break;case this.CMD_DRAW_LINE:this.m_nPos+=this.DrawLine(e,i);break;case this.CMD_DRAW_LINES:this.m_nPos+=this.DrawLines(e,i);break;case this.CMD_DRAW_POLYGON:this.m_nPos+=this.DrawPolygon(e,i),this.m_oGraphics.closePath(),this.m_bPathStarted=!1;break;case this.CMD_DRAW_CURVE:this.m_bResetReverse=!1,this.m_nPos+=this.DrawCurve(e,i);break;case this.CMD_DRAW_CLOSED_CURVE:this.m_bResetReverse=!1,this.m_nPos+=this.DrawCurve(e,i),this.m_oGraphics.closePath(),this.m_bPathStarted=!1;break;case this.CMD_DRAW_SHADOW:this.m_nPos+=this.DrawGlobalShadow();break;case this.CMD_DRAW_SHAPE_SHADOW:this.m_nPos+=this.DrawShadow();break;case this.CMD_DRAW_REFLECTION:this.m_nReflectionIndex=this.m_nPos,this.m_nPos+=12;break;case this.CMD_DRAW_PERSPECTIVE_SHADOW:this.m_nPos+=37;break;case this.CMD_DRAW_TEXT:this.m_nPos+=this.DrawVectorText(e,i,n);break;case this.CMD_ADD_TEXT:this.m_nPos+=this.AddText(e,i,r,n,s)}},GetGradientLine:function(t,e,i,r,n){for(var a=!1;n>=180;)n-=180,a=!a;var n=n*Math.PI/180,s=0,o=0,i=i/2,r=r/2;return n<=Math.atan2(r,i)?(s=i,o=Math.tan(n)*i):n<=Math.PI/2?(s=Math.tan(Math.PI/2-n)*r,o=r):n<=Math.PI/2+Math.atan2(i,r)?(s=Math.tan(Math.PI/2-n)*r,o=r):n<=Math.PI&&(s=-i,o=Math.tan(n)*-i),a&&(s=-s,o=-o),{x1:t+i-s,y1:e+r-o,x2:t+i+s,y2:e+r+o}},StartGradientFill:function(){var t=this.UBaseNto10(0,1),e=this.BaseNto10(1,2),i=this.BaseNto10(3,2),r=this.BaseNto10(5,2),n=this.BaseNto10(7,2),a=360*this.UBaseNto10(9,2)/4095,s=this.UBaseNto10(11,1);if(2==t?(t=r,r>n&&(t=n),e=this.m_oGraphics.createRadialGradient(e+r/2,i+n/2,0,e+r/2,i+n/2,t/2)):(e=this.GetGradientLine(e,i,r,n,a),e=this.m_oGraphics.createLinearGradient(e.x1,e.y1,e.x2,e.y2)),null!=e){for(var o=12,t=-1,a=0;s>a;a++)i=this.UBaseNto10(o,4),o+=4,r=this.UBaseNto10(o,2),o+=2,n=this.UBaseNto10(o,2),o+=2,n!=t&&e.addColorStop(n/255,this.GetColor(i,r)),t=n;this.m_oGraphics.StartGradientFill(e)}return o},SetGradientLineStyle:function(){var t=this.UBaseNto10(0,2),e=this.UBaseNto10(2,1),i=this.UBaseNto10(3,1),r=this.BaseNto10(4,2),n=this.BaseNto10(6,2),a=this.BaseNto10(8,2),s=this.BaseNto10(10,2),o=360*this.UBaseNto10(12,2)/4095,l=this.UBaseNto10(14,1),h="round",p="round";if(e&this.LINE_CAP_FLAT?h="butt":e&this.LINE_CAP_ROUND?h="round":e&this.LINE_CAP_SQUARE&&(h="square"),e&this.LINE_JOIN_BEVEL?p="bevel":e&this.LINE_JOIN_MITER?p="miter":e&this.LINE_JOIN_ROUND&&(p="round"),e=15,2==i?(i=a,a>s&&(i=s),r=this.m_oGraphics.createRadialGradient(r+a/2,n+s/2,0,r+a/2,n+s/2,i/2)):(r=this.GetGradientLine(r,n,a,s,o),r=this.m_oGraphics.createLinearGradient(r.x1,r.y1,r.x2,r.y2)),null!=r){for(i=0;l>i;i++)n=this.UBaseNto10(e,4),e+=4,a=this.UBaseNto10(e,2),e+=2,s=this.UBaseNto10(e,2),e+=2,r.addColorStop(s/255,this.GetColor(n,a));this.m_oGraphics.SetGradientLineStyle(t,r,p,h)}return e},SetLineStyle:function(){var t=this.UBaseNto10(0,2),e=this.UBaseNto10(2,4),i=this.UBaseNto10(6,2),r=this.UBaseNto10(8,1),n="round",a="round";return 0==t&&(t=1e-4),this.m_nLineWidth=t,r&this.LINE_CAP_FLAT?n="butt":r&this.LINE_CAP_ROUND?n="round":r&this.LINE_CAP_SQUARE&&(n="square"),r&this.LINE_JOIN_BEVEL?a="bevel":r&this.LINE_JOIN_MITER?a="miter":r&this.LINE_JOIN_ROUND&&(a="round"),this.m_oGraphics.SetLineStyle(t,e,i,a,n),9},AdjustShadowBounds:function(t){var e=this.FBaseNto10(0,4),i=this.FBaseNto10(4,4)-this.m_nRotation,r=this.UBaseNto10(14,2);this.UBaseNto10(16,2);var n=this.FBaseNto10(22,4),a=this.rectShape.GetWidth(),r=r+(a*n-a)/2,n={x:0,y:0},a=e*Math.cos(i*this.DEGREE_MULTIPLIER),i=e*Math.sin(i*this.DEGREE_MULTIPLIER),e=Math.floor(t.left+a-r),a=Math.ceil(t.right+a+r),s=Math.floor(t.top+i-r),r=Math.ceil(t.bottom+i+r);return e<t.left&&(t.left=e,n.x=-e),s<t.top&&(t.top=s,n.y=-s),a>t.right&&(t.right=a),r>t.bottom&&(t.bottom=r),n},DrawGlobalShadow:function(){null==this.m_arrShadows&&(this.m_arrShadows=[]);var t=this.FBaseNto10(0,4),e=this.FBaseNto10(4,4)-this.m_nRotation,i=this.UBaseNto10(8,4),r=this.UBaseNto10(12,2),n=this.UBaseNto10(14,2);this.UBaseNto10(16,2);var a=this.UBaseNto10(18,2),s=this.UBaseNto10(20,1),o="1"==this.m_strPath.substr(this.m_nPos+21,1),l=this.FBaseNto10(22,4),h=t*Math.cos(e*this.DEGREE_MULTIPLIER),t=t*Math.sin(e*this.DEGREE_MULTIPLIER),e={};return e.nXOffset=h,e.nYOffset=t,e.nBlurX=n,e.nColor=i,e.nAlpha=r,e.nScale=l,e.nStrength=a,e.nQuality=s,e.bInner=o,this.m_arrShadows.push(e),26},DrawShadow:function(){var t=this.FBaseNto10(0,4),e=this.FBaseNto10(4,4)-this.m_nRotation,i=this.UBaseNto10(8,4),r=this.UBaseNto10(12,2),n=this.UBaseNto10(14,2);this.UBaseNto10(16,2);var a=this.UBaseNto10(18,2),s=this.UBaseNto10(20,1),o="1"==this.m_strPath.substr(this.m_nPos+21,1),l=this.FBaseNto10(22,4),h=t*Math.cos(e*this.DEGREE_MULTIPLIER),t=t*Math.sin(e*this.DEGREE_MULTIPLIER);return this.m_oGraphics.AddShadow(h,t,n,i,r,l,a,s,o),26},StoreRotationData:function(){return this.m_nRotationDistance=this.BaseNto10(0,2),this.rectRotated=new ppRect(this.BaseNto10(2,2),this.BaseNto10(4,2),this.BaseNto10(6,2),this.BaseNto10(8,2)),this.polyRotated=[{x:this.BaseNto10(10,2),y:this.BaseNto10(12,2)},{x:this.BaseNto10(14,2),y:this.BaseNto10(16,2)},{x:this.BaseNto10(18,2),y:this.BaseNto10(20,2)},{x:this.BaseNto10(22,2),y:this.BaseNto10(24,2)}],0==this.rectRotated.left&&0==this.rectRotated.right&&0==this.rectRotated.top&&0==this.rectRotated.bottom&&(this.rectRotated=this.rectShape.Clone(),this.polyRotated=[{x:this.rectShape.left-10,y:this.rectShape.top-10},{x:this.rectShape.right+10,y:this.rectShape.top-10},{x:this.rectShape.right+10,y:this.rectShape.bottom+10},{x:this.rectShape.left-10,y:this.rectShape.bottom+10}]),26},AdjustReflectionBounds:function(t,e,i,r,n,a,s,o){var l=this.UBaseNto10(0,2);if(0<this.UBaseNto10(10,2)/100){var h=0,p=0,c=i.bottom;0!=n&&(h=(o+l/2)/Math.sin(n*this.DEGREE_MULTIPLIER),p=h*Math.cos(2*n*this.DEGREE_MULTIPLIER),c=h*Math.sin(2*n*this.DEGREE_MULTIPLIER)),o=i.left+Math.sin(2*n*this.DEGREE_MULTIPLIER)*i.left,i=i.top+Math.cos(2*n*this.DEGREE_MULTIPLIER)*i.left,a=a+h-p-(a-r.left)-o,s=s+c-(s-r.top)-i,c=r.GetWidth()-o,p=r.GetHeight()-i,r=Math.floor(a),h=Math.floor(s),c=Math.ceil(a+c),s=Math.ceil(s+p),t.left>r&&(e.x=-r,t.left=r),t.top>h&&(e.y=-h,t.top=h),t.bottom<s&&(t.bottom=s),t.right<c&&(t.right=c)}},DrawReflection:function(t,e,i,r,n,a,s,o,l,h){var p=this.UBaseNto10(0,2),c=[this.UBaseNto10(2,2),this.UBaseNto10(4,2)],d=[this.UBaseNto10(6,2)/100,this.UBaseNto10(8,2)/100],u=this.UBaseNto10(10,2)/100;if(u>0){var m=document.createElement("canvas");m.style.border="red 1px dashed",m.width=n.GetWidth(),m.height=n.GetHeight();var f=m.getContext("2d");f.save(),f.translate(o-n.left,i.GetHeight()-(l-i.top)-(i.bottom-n.bottom)),f.scale(1,-1),f.rotate(2*s*this.DEGREE_MULTIPLIER),f.translate(-(o-i.left),-(l-i.top)),f.drawImage(e,r.x,r.y,e.width-r.x,e.height-r.y,0,0,e.width-r.x,e.height-r.y),f.restore(),Math.sqrt((a[3].x-a[0].x)*(a[3].x-a[0].x)+(a[3].y-a[0].y)*(a[3].y-a[0].y)),e=f.createLinearGradient(a[0].x,a[0].y,a[3].x,a[3].y),f.save(),e.addColorStop(c[0]/255,"rgba(255, 255, 255, "+(1-d[0])+")"),e.addColorStop(c[1]/255*u,"rgba(255, 255, 255, "+(1-d[1])+")"),e.addColorStop(c[1]/255*u+1e-4,"rgba(255, 255, 255, 100)"),f.fillStyle=e,f.globalCompositeOperation="destination-out",f.moveTo(a[0].x,a[0].y),f.lineTo(a[1].x,a[1].y),f.lineTo(a[2].x,a[2].y),f.lineTo(a[3].x,a[3].y),f.lineTo(a[0].x,a[0].y),f.fill(),c=a=0,d=this.rectShape.bottom+p,0!=s&&(a=(h+p/2)/Math.sin(s*this.DEGREE_MULTIPLIER),c=a*Math.cos(2*s*this.DEGREE_MULTIPLIER),d=a*Math.sin(2*s*this.DEGREE_MULTIPLIER)),t.drawImage(m,0,0,m.width,m.height,a+r.x+o-i.left-c-(o+i.left-n.left)+i.left,r.y+l-i.top+d-(i.GetHeight()-l-(i.bottom-n.bottom)),m.width,m.height),m.width=1,m.height=1}return 12},StartSlideBgFill:function(){var t=this.item.slide;if(this.item.layer&&(t=this.item.layer),this.item.matrix&&t&&t.background){var e=this.item.matrix.unTransformPoint(0,0),i=document.createElement("canvas");i.width=this.item.slide.width,i.height=this.item.slide.height;var r=i.getContext("2d");r.translate(e.x,e.y),t.background.drawCanvas(r,this.item.slide,!0,!1),this.m_oGraphics.StartImageFill(this.m_oGraphics.createPattern(i,"no-repeat"))}},StartBitmapFill:function(t,e,i){var r=this.m_strPath.substr(this.m_nPos,2);this.BaseNto10(2,2),this.BaseNto10(4,2);var n=this.BaseNto10(6,2),a=this.BaseNto10(8,2),t=this.BaseNto10(10,2),e=this.BaseNto10(12,2),s=this.FBaseNto10(14,4),o=this.FBaseNto10(18,4),l=360*this.UBaseNto10(22,2)/4095;this.UBaseNto10(24,2);var h=i.GetImage(r),i=h.imgNode,r=document.createElement("canvas");return r.width=n,r.height=a,n=r.getContext("2d"),s=h.nWidth*s/i.naturalWidth,o=h.nHeight*o/i.naturalHeight,a=i.naturalWidth*s/2,h=i.naturalHeight*o/2,n.translate(a+t,h+e),n.rotate(l*this.DEGREE_MULTIPLIER),n.translate(-a,-h),n.scale(s,o),n.drawImage(i,0,0),this.m_oGraphics.StartImageFill(this.m_oGraphics.createPattern(r,"no-repeat")),r.width=1,r.height=1,26},StartBitmapTileFill:function(t,e,i){var r=this.m_strPath.substr(this.m_nPos,2),t=this.BaseNto10(2,2)+t,e=this.BaseNto10(4,2)+e,n=this.FBaseNto10(6,4),a=this.FBaseNto10(10,4),s=360*this.UBaseNto10(14,2)/4095;this.UBaseNto10(16,2);var o,l=this.UBaseNto10(18,1),h=i.GetImage(r),i=h.imgNode,r=h.nWidth*n/i.naturalWidth,a=h.nHeight*a/i.naturalHeight;switch(l){case 0:o=document.createElement("canvas"),o.width=i.naturalWidth,o.height=i.naturalHeight,l=o.getContext("2d"),l.drawImage(i,0,0);break;case 1:o=document.createElement("canvas"),o.width=2*i.naturalWidth,o.height=i.naturalHeight,l=o.getContext("2d"),l.drawImage(i,0,0),l.save(),l.translate(i.naturalWidth,0),l.scale(-1,1),l.drawImage(i,-i.naturalWidth,0),l.restore();break;case 2:o=document.createElement("canvas"),o.width=i.naturalWidth,o.height=2*i.naturalHeight,l=o.getContext("2d"),l.drawImage(i,0,0),l.save(),l.translate(0,i.naturalHeight),l.scale(1,-1),l.drawImage(i,0,-i.naturalHeight),l.restore();break;case 4:o=document.createElement("canvas"),o.width=2*i.naturalWidth,o.height=2*i.naturalHeight,l=o.getContext("2d"),l.drawImage(i,0,0),l.save(),l.translate(0,i.naturalHeight),l.scale(1,-1),l.drawImage(i,0,-i.naturalHeight),l.restore(),l.save(),l.translate(i.naturalWidth,0),l.scale(-1,1),l.drawImage(i,-i.naturalWidth,0),l.restore(),l.save(),l.translate(i.naturalWidth,i.naturalHeight),l.scale(-1,-1),l.drawImage(i,-i.naturalWidth,-i.naturalHeight),l.restore()}return this.m_oGraphics.StartRotatedImageFill(this.m_oGraphics.createPattern(o,"repeat"),s*this.DEGREE_MULTIPLIER,t,e,r,a),o.width=1,o.height=1,19},AddImage:function(t,e,i){var r=this.m_strPath.substr(this.m_nPos,2),t=this.FBaseNto10(2,4)+t,e=this.FBaseNto10(6,4)+e,n=this.FBaseNto10(10,4),a=this.FBaseNto10(14,4),s=this.UBaseNto10(18,2)/100;return ppDebug.debug_trace(r+": "+t+", "+e+" :: "+n+", "+a+" :: Alpha = "+s),i=i.GetImage(r),r=i.imgNode,n=Math.round(1e3*(i.nWidth*n/r.naturalWidth))/1e3,a=Math.round(1e3*(i.nHeight*a/r.naturalHeight))/1e3,this.m_oGraphics.AddImage(r,t+i.nDX,e+i.nDY,n,a,s),20},StartSolidFill:function(){var t=this.UBaseNto10(0,4),e=this.UBaseNto10(4,2);return this.m_oGraphics.StartSolidFill(t,e),6},AddText:function(t,e,i,r,n){var a=this.m_strPath.substr(this.m_nPos,2),s=this.BaseNto10(2,2),o=this.BaseNto10(4,2),l=this.FBaseNto10(6,4);this.m_strPath.substr(this.m_nPos+10,1);var h=i.GetPathById(a,n),p=this.m_nPos,c=this.m_strPath;return this.m_nPos=0,this.m_strPath=h,this.m_oGraphics.stroke(),this.m_oGraphics.fill(),this.m_listTextOffsets[a]={id:a,x:s+t,y:o+e},this.item.textOffset={x:0,y:0},0!=l&&(this.m_oGraphics.m_oStrokeContext.save(),this.m_oGraphics.m_oFillContext.save(),a=this.item.getAABB_simple(l,!0),(0>a.top||0>a.left||a.right>this.m_oGraphics.m_oFillCanvas.width||a.bottom>this.m_oGraphics.m_oFillCanvas.height)&&(a.bottom+=Math.max(a.bottom-this.m_oGraphics.m_oFillCanvas.height,0),a.right+=Math.max(a.right-this.m_oGraphics.m_oFillCanvas.width,0),this.item.textOffset.x=Math.min(a.left,0),this.item.textOffset.y=Math.min(a.top,0),this.item.textOffset.box=a,this.m_oGraphics.ResizeCanvasBox(a),this.m_oGraphics.m_oFillContext.translate(-this.item.textOffset.x,-this.item.textOffset.y),this.m_oGraphics.m_oStrokeContext.translate(-this.item.textOffset.x,-this.item.textOffset.y)),this.m_oGraphics.m_oFillContext.translate(s,o),this.m_oGraphics.m_oFillContext.rotate(l*Math.PI/180),this.m_oGraphics.m_oFillContext.translate(-s,-o),this.m_oGraphics.m_oStrokeContext.translate(s,o),this.m_oGraphics.m_oStrokeContext.rotate(l*Math.PI/180),this.m_oGraphics.m_oStrokeContext.translate(-s,-o)),this.DrawPath(h,s+t,o+e,i,r,n),0!=l&&(this.m_oGraphics.m_oFillContext.restore(),this.m_oGraphics.m_oStrokeContext.restore()),this.m_nPos=p,this.m_strPath=c,11},DrawPolygon:function(t,e){var i=this.UBaseNto10(0,2),r=this.FBaseNto10(2,4)+t,n=this.FBaseNto10(6,4)+e,a=r,s=n;this.m_oGraphics.moveTo(a,s);for(var o=10,l=1;i>l;l++)r=this.FBaseNto10(o,4)+t,o+=4,n=this.FBaseNto10(o,4)+e,o+=4,this.m_oGraphics.lineTo(r,n);return this.m_oGraphics.lineTo(a,s),o},DrawLine:function(t,e){var i=this.FBaseNto10(0,4)+t,r=this.FBaseNto10(4,4)+e,n=this.FBaseNto10(8,4)+t,a=this.FBaseNto10(12,4)+e;return this.m_bPathStarted?this.m_oGraphics.lineTo(i,r):(this.m_bPathStarted=!0,this.m_oGraphics.moveTo(i,r),this.m_nStartX=i,this.m_nStartY=r),this.m_oGraphics.lineTo(n,a),this.m_nCurX=n,this.m_nCurY=a,16},DrawLines:function(t,e){var i=this.UBaseNto10(0,2),r=this.FBaseNto10(2,4)+t,n=this.FBaseNto10(6,4)+e;this.m_bPathStarted?this.m_oGraphics.lineTo(r,n):(this.m_bPathStarted=!0,this.m_oGraphics.moveTo(r,n),this.m_nStartX=r,this.m_nStartY=n);for(var a=10,s=1;i>s;s++)r=this.FBaseNto10(a,4)+t,a+=4,n=this.FBaseNto10(a,4)+e,a+=4,this.m_oGraphics.lineTo(r,n);return this.m_nCurX=r,this.m_nCurY=n,a},DrawCurve:function(t,e){var i,r,n,a,s,o,l=(this.UBaseNto10(0,2)-1)/3,h=this.FBaseNto10(2,4)+t,p=this.FBaseNto10(6,4)+e,c=0;if(this.m_bReverseCurve){for(var d=this.m_nCurX,u=this.m_nCurY,m=!1,f=[],y=10,c=0;l>c;c++)i={},i.nControlAX=this.FBaseNto10(y,4)+t,y+=4,i.nControlAY=this.FBaseNto10(y,4)+e,y+=4,i.nControlBX=this.FBaseNto10(y,4)+t,y+=4,i.nControlBY=this.FBaseNto10(y,4)+e,y+=4,i.nX=this.FBaseNto10(y,4)+t,y+=4,i.nY=this.FBaseNto10(y,4)+e,y+=4,f.push(i);for(this.m_bPathStarted?(this.m_oGraphics.moveTo(i.nX,i.nY),m=!0):(this.m_bPathStarted=!0,this.m_oGraphics.moveTo(i.nX,i.nY),this.m_nStartX=i.nX,this.m_nStartY=i.nY),this.m_nCurX=i.nX,this.m_nCurY=i.nY,c=f.length-1;c>=0;c--)i=f[c].nControlAX,r=f[c].nControlAY,n=f[c].nControlBX,a=f[c].nControlBY,0!=c?(s=f[c-1].nX,o=f[c-1].nY):(s=h,o=p),this.m_oGraphics.bezierCurveTo(n,a,i,r,s,o);m&&this.m_oGraphics.lineTo(d,u),this.m_oGraphics.moveTo(this.m_nCurX,this.m_nCurY)}else for(this.m_bPathStarted?this.m_oGraphics.lineTo(h,p):(this.m_bPathStarted=!0,this.m_oGraphics.moveTo(h,p),this.m_nStartX=h,this.m_nStartY=p),this.m_nCurX=h,this.m_nCurY=p,y=10,c=0;l>c;c++)i=this.FBaseNto10(y,4)+t,
y+=4,r=this.FBaseNto10(y,4)+e,y+=4,n=this.FBaseNto10(y,4)+t,y+=4,a=this.FBaseNto10(y,4)+e,y+=4,s=this.FBaseNto10(y,4)+t,y+=4,o=this.FBaseNto10(y,4)+e,y+=4,this.m_oGraphics.bezierCurveTo(i,r,n,a,s,o),this.m_nCurX=s,this.m_nCurY=o;return y},DrawRectangle:function(t,e){var i=this.FBaseNto10(0,4)+t,r=this.FBaseNto10(4,4)+e,n=this.FBaseNto10(8,4),a=this.FBaseNto10(12,4);return this.m_oGraphics.m_bFillStarted||this.m_oGraphics.m_bStrokeStarted||(this.m_oGraphics.m_bFillStarted=!0,this.m_oGraphics.m_oFillContext.beginPath(),this.m_oGraphics.m_oFillContext.fillStyle="rgba(0,0,0,0.004)"),this.m_oGraphics.moveTo(i,r),this.m_oGraphics.lineTo(i+n,r),this.m_oGraphics.lineTo(i+n,r+a),this.m_oGraphics.lineTo(i,r+a),this.m_oGraphics.lineTo(i,r),16},DrawVectorText:function(t,e){(this.m_bPathStarted||this.m_bShapeStarted)&&(this.m_oGraphics.fill(),this.m_oGraphics.stroke(),this.m_bShapeStarted=this.m_bPathStarted=!1);for(var i=0,r=this.m_strPath.substr(this.m_nPos,2),i=i+2,n=this.FBaseNto10(i,4),i=i+4,a=this.UBaseNto10(i,4),i=i+4,s=this.UBaseNto10(i,1),i=i+1,o=this.UBaseNto10(i,2),i=i+2,l=[],h=null,p=0;o>p;p++)h={},h.CharCount=this.UBaseNto10(i,2),i+=2,h.XPos=this.FBaseNto10(i,4),i+=4,h.YPos=this.FBaseNto10(i,4),i+=4,l.push(h);for(var c,d=0,u=0,m=0,f=0,p=0;p<l.length;p++){h=l[p],o=h.XPos+t+this.m_oGraphics.m_nXOffset-.5,c=h.YPos+e+this.m_oGraphics.m_nYOffset-.5;for(var y=0;y<h.CharCount;y++){if(d=this.FBaseNto10(i,4),i+=4,u=this.UBaseNto10(i,s),i+=s,this.m_oGraphics.beginPath(),this.m_oGraphics.SetLineStyle(1,16711680,100,"round"),""!=r){var g=g_listFonts[r];this.m_oGraphics.StartSolidFill(a,255),g.DrawGlyph(u,this.m_oGraphics.m_oFillContext,o,c,n),this.m_oGraphics.fill()}else ppDebug.debug_trace("Could not find the font with id: "+r);o+=d}o>m&&(m=o),c>f&&(f=c)}return this.m_oGraphics.beginPath(),i},DrawEllipse:function(t,e){var i=this.FBaseNto10(0,4)+t,r=this.FBaseNto10(4,4)+e,n=this.FBaseNto10(8,4),a=this.FBaseNto10(12,4),s=.5522848*(n/2),o=.5522848*(a/2),l=i+n,h=r+a,n=i+n/2,a=r+a/2;return this.m_oGraphics.moveTo(i,a),this.m_oGraphics.bezierCurveTo(i,a-o,n-s,r,n,r),this.m_oGraphics.bezierCurveTo(n+s,r,l,a-o,l,a),this.m_oGraphics.bezierCurveTo(l,a+o,n+s,h,n,h),this.m_oGraphics.bezierCurveTo(n-s,h,i,a+o,i,a),16}},g_listFonts={};ppFont.prototype.LoadFontXML=function(){var t;window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("MSXML2.XMLHTTP")),t.oOwner=this,this.m_xmlRequest=t,t.onreadystatechange=function(){4==t.readyState&&this.oOwner.OnReady(t.responseXML)},t.open("GET",this.m_strFileName,!0),t.send(null)},ppFont.prototype.GetGlyphData=function(t){var e="";return null!=this.m_xmlData[t]?e=this.GetAttrStr(this.m_xmlData[t],"p"):ppDebug.debug_error("Glyph index out of range"),e},ppFont.prototype.GetAttrStr=function(t,e){return t.attributes.getNamedItem(e).value},ppFont.prototype.DrawGlyph=function(t,e,i,r,n){var a=this.m_listGlyphs[t];null==a&&(this.CreateGlyphData(t),a=this.m_listGlyphs[t]);for(var s=a.length,o=0;s>o;o++)switch(t=a[o],t.cmd){case 0:e.quadraticCurveTo(n*t.x1+i,n*t.y1+r,n*t.x2+i,n*t.y2+r);break;case 1:e.lineTo(n*t.x1+i,n*t.y1+r);break;case 2:e.moveTo(n*t.x1+i,n*t.y1+r)}},ppFont.prototype.CreateGlyphData=function(t){this.m_strPath=this.GetGlyphData(t),this.m_nPos=0;var e=this.m_strPath.charAt(this.m_nPos);this.m_nPos++;var i="",r=[];for(this.m_listGlyphs[t]=r;this.m_nPos<this.m_strPath.length;)switch(i=this.m_strPath.charAt(this.m_nPos),this.m_nPos++,i){case this.CMD_CURVE:r.push(new ppGlyphCmd(0,this.BaseNto10(0,2),this.BaseNto10(2,2),this.BaseNto10(4,2),this.BaseNto10(6,2))),this.m_nPos+=8;break;case this.CMD_LINE:r.push(new ppGlyphCmd(1,this.BaseNto10(0,2),this.BaseNto10(2,2))),this.m_nPos+=4;break;case this.CMD_MOVE:r.push(new ppGlyphCmd(2,this.BaseNto10(0,2),this.BaseNto10(2,2))),this.m_nPos+=4;break;case this.CMD_CURVE_E:r.push(new ppGlyphCmd(0,this.BaseNto10(0,3),this.BaseNto10(3,3),this.BaseNto10(6,3),this.BaseNto10(9,3))),this.m_nPos+=12;break;case this.CMD_LINE_E:r.push(new ppGlyphCmd(1,this.BaseNto10(0,3),this.BaseNto10(3,3),0,0)),this.m_nPos+=6;break;case this.CMD_MOVE_E:r.push(new ppGlyphCmd(2,this.BaseNto10(0,3),this.BaseNto10(3,3),0,0)),this.m_nPos+=6;break;default:this.m_nPos--,e==this.CMD_CURVE?(r.push(new ppGlyphCmd(0,this.BaseNto10(0,2),this.BaseNto10(2,2),this.BaseNto10(4,2),this.BaseNto10(6,2))),this.m_nPos+=8):(r.push(new ppGlyphCmd(1,this.BaseNto10(0,2),this.BaseNto10(2,2))),this.m_nPos+=4)}},ppFont.prototype.UBaseNto10=function(t,e){for(var i=0,r="",n=0,a=t;t+e>a;a++)r="v"+this.m_strPath.charAt(this.m_nPos+a),i+=parseInt(this.m_o64to10[r])<<this.BASE_POW*n,n++;return i},ppFont.prototype.BaseNto10=function(t,e){var i=2047;return 3==e&&(i=131071),this.UBaseNto10(t,e)-i},ppFontLib.prototype.CreateFonts=function(t){null!=this.m_strFontUrl&&0<this.m_strFontUrl.length?AddFont(this.m_strBasePath+this.m_strFontUrl,t):t()},ppTextLib.prototype.GetPathById=function(t,e){var i="",r="";if(this.m_bHasXML)try{for(var n=0;n<this.m_xmlData.length;n++)if(i=this.m_xmlData[n].attributes.getNamedItem("id").value,i==t){if(i=!1,null!=e)for(var a=this.m_xmlData[n].getElementsByTagName("link"),s=0;s<a.length;s++)if(strCurLinkId=a[s].attributes.getNamedItem("id").value,strCurLinkId==e){var i=!0,o=a[s].getElementsByTagName("pr");a[s].getElementsByTagName("path"),r=0<o.length?PathLib.getPathFromXML(o[0]):a[s].getElementsByTagName("path")[0].firstChild.nodeValue;break}i||(o=this.m_xmlData[n].getElementsByTagName("pr"),this.m_xmlData[n].getElementsByTagName("path"),r=0<o.length?PathLib.getPathFromXML(o[0]):this.m_xmlData[n].getElementsByTagName("path")[0].firstChild.nodeValue);break}}catch(l){ppDebug.debug_trace("Text data is null");try{r=this.m_xmlData[0].getElementsByTagName("path")[0].firstChild.nodeValue,ppDebug.debug_trace("  fell back on path: "+r)}catch(h){r=""}}return r},ppImageLib.prototype.AddImage=function(t,e,i,r,n,a,s){var o={};return o.Id=t,o.strType=e,o.imgNode=i,o.nWidth=Number(r),o.nHeight=Number(n),o.nDX=Number(a),o.nDY=Number(s),this.m_listImages[t]=o,this.m_nCount++,o},ppImageLib.prototype.GetImage=function(t){return this.m_listImages[t]},ppImageLib.prototype.Destroy=function(){for(var t in this.m_listImages)ppDebug.debug_trace("Destroy: "+this.m_listImages[t].Id),this.m_listImages[t].imgNode=null,this.m_listImages[t]=null;this.m_listImages=null};var Frame=function(){this.control_layouts={},this.ready=!1,this.options={},this.colorGroups={},this.sidebarItems={},this.visibleSidebarItems={},this.hasLinksRight=this.hasLinksLeft=!1,this.defaultControlLayout=null,this.hasBottomBar=!1,this.controlOptions={}};Frame.controlMap={},Frame.iconSrc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANYAAAAQCAYAAABqUoGHAAAI0klEQVRoQ+1aV6gUSxCtBf1QEBVEBRUTiAExYvwwJ8woigEDigkxYkAxY0DMghmzoJgwICYMCAbEiAERc0YUERFBoV6dfttNT+/M7MzsvQ/h7fzcuTM9XdVVdapOV2+K8lfeAv8TC6xevZovXbpE3759MysuVaoU9erVi4YPH56Ka4aJEyfy2rVrfb+LPVlc4fnxeQvkaAF2vndjNtt7unv3Lg8dOpTu3bsXqEq9evVo165dVL9+/UiYkPkY4+XKAytHB+c/T2gBBCE+lexOUiEiBa4lKhtwQt9LdWKA5tWrV9SzZ08aNmwYdDDTv3z5knbu3EmXL1+mypUrK/Bl09ECVTxg7dixQykbpTyOGTPGLKxs2bLUqFEjLMAYz35frlw5atKkCXXt2tX3ve23TZs2pfS3uLffffr0iefNm6ceue9sefY7/bxz584o/WZuN1ZsubVq1SIp9xm6wgFwVNDVtm1b6tevX2gAhdn4+/fvPGHCBLp9+zaVKVOGunTpQtOmTVPz+dnk9evXvGTJEmMP0Y2XLl1q1CtdujS1bNmSunXr5mt3UCGxi3l38eJFPnDggPkeNrl//z5v2LBBPYMNT58+Hbh+1ycyUMUIAhp+mzx5chxw5QQsARUDLOJHADtQbqtWrRjgkr8AmccW9kIBwnSl0o/NWFkbL1iwQP2fIQgOF0Cpj+Q+K7jatGmjeKt7gceWLFkyJZdrGDWUmZXsKlWqsF+Q4n2FChX4/fv3JNyYJk2aZHSdOnUqr1q1CkFGGzdu9KxhwIABvH//fiVD3mGMet+pUyc+e/YsHTlyhHr37p0Kk3v48GHu27evR88TJ05wjx49zLOgdWEA5Pfv3z/QiWE2fvDgAdetWzfDntpeWq7+HwMBJFmP0U2yMFetWjVjjtq1a9PDhw//dbzll/bt29O5c+eMvt27d+eTJ0+a7yFLgpOFJlGxYsVo79691KdPn4z59QNbt/QzTwyggqxZs4YkdqIALDGwbDujMomNAuWhssGGiFsn7n3j11p8ygIUxmYCy1YEH4KXCjpDF6+BhSAeNGgQdejQgW7cuEE1atSgJ0+eGGDB2PI/16xZU+m0ePFimjVrlglwZEAJfo8smZPHjRtH5cuXpw8fPph3OijevHlDFStWDASWDeAgYPnJxXcNGzbkO3fuACAAilnHtWvXqFmzZkbm7t27FX9HJZZ1RwkU2FXzc2UL25GtW7dWmXPkyJG0detWNd/58+dZgt8DiKjAwrhHjx5xnTp1lKyghGfP5yYNF1g/f/4065TqzFLhCNVs7NixQev3DU5QM9DDsIAXlRMDS1ehKHGc9oMqKtDr2LFjei1ZgZXWEeMzgeWCKlvp1Ii1gYXqIIHHLVq0MNnTzbASgHzz5s1IwLIzq3b8jx8/uESJEmZ+N23qirVo0SKaM2eOcpzQqlRcYP3584eLFi2qpp8yZQqhQgqVIqlcnuBJAizMme4oGfU1uIS2MYJfqB8tX748I1DjViy30n38+JGEkptEkQ4iunXrFpKJAaFN9woLWFg86CFiTVMo159JgSXrYgGHmc4Bi48YlXTY2n/lDiwXVFEooB+w4IwhQ4bQlStXqHnz5nT16lXjQAQKuC7oGC6XClavXt0stnjx4iScXi1MKh8/ffrUZMS5c+cyQDN+/Hhav359RuBpYG3btk1lfS0rCFhBcvHd/PnzwZmNXj4Uh5ICy86QWgDsDhshGeCCbitXrvTsWeMCC3M8e/ZMzQf6dujQIU/lQwWGrwYOHEj79u1LjRgxgrdv304XLlwg7BW1/WwqWFAVy47ukKqSqGIBJNgvwZ6gnmAB2ZoSaX20vNyBZVMTIBZ7pqhtx6A9lpsptRHBYwGUIkWKKMX99jrYY2hg6cDFdy9evEgJx+dfv36BGoIihgLr69evNH36dFqxYoUCdLY9li0XugkNZnSR9FXQwEIbWKifOVfRwYVqtm7dOiPXpplxgWUH76hRo2jz5s0ZlNKeM+i+sIHlNg0svRMBC99jr5meNxvdVOIKvGJh0qTg0sCS/ZIq640bN/ZsSrWjfv/+rTLm8ePHCcEkvNwDrKC9DnQLcrYdNPrerliSfU3F7Nixoy+wositVq0aPX/+3LdKJq1YQaCy1ySdPp49e7Z6hE6UsAHPnlWPxVwNGjQw1cVuXuhkIPScUZ2kY0ejR4/2zCNMg8+cOUPYs1aqVEl1xiS5esYUJrDSVDCooiQGll98hD3TzM0BedY9VtbmRRJwuXssV3EbFMgIaP3icqlgWIBL0LAEDy1btoxmzpyJDiE6hb4bZRdYkvkZjosLLDkS4FOnTqmNLDbm0qFUer99+xb3OTUvooBK21EDAmufMWOGCXbsUyWJKT0kqan2OiiPzJ3yA5ZUXtUw0baz/SK0j9u1a6feoVuHdUuLv9CBFfFQ9j8Bln3eFbYVchtPyPvaV6HtdvvDkPJs8BMHWPhIzmX4y5cv2L/gTMN0BQcPHuzB5J49e4zCdvsbgz5//ox5IgHLrni4d9vtfnKFjyuKZicAqRYsOhHO6uQcLSdg6W4V5nf3FhLcLN1TdEjp8ePHtGXLFqWHtMlJ2uUpOR/jgwcPqmfYa757905VIVxC80jongdYWB/mAxBxSYeRBEQZlc/uBPq19guyYsU8z0oMLLuFjgSJxOK3z7J/mZE+owzt7iY+II5zUh4XWLIxZqFoJmjDzpNspPk53oPE9D9uxcJjCU4W+qNGRDnH0rJ0R1HL0c/RUJBOoTJ+EioIh6OK4nKPMzQts9cmlQrV2jhbjjQYALEvaXWjsqoxQedYCxcuRKfUt22v2/xNmzal69evZ4wpKGCFBbifP+VZYmBhPpsdoEIioeMcU8sC/ZMDa7XPjdNfyP+kKcBbf/tj/JoCv7qQDmlg9owy5m9YJ4IQB7QI6oiHwrbaOQELE9kdwiB7xOwcqmnS4PL1T2jJ+xucktfhf2+BnIGlwXX06FEFbvuXPqB+6SoWtR0fySF5YEUyU35Q3gLxLPAPX1/vay7xMHUAAAAASUVORK5CYII=",Frame.prototype.loadFromXML=function(t){var e=this;e.xml=t,this.defaultLayoutName=$(t).find("bwFrame").attr("default_layout"),this.textdirection=$(t).find("bwFrame").attr("textdirection"),this.parseOptionGroups(t),this.parseColorSchemes(t),this.applyColorSchemes(),$(t).find("control_layouts").children("control_layout").each(function(t,i){var r={controls:{}},n=$(i).attr("name");$(i).children("control").each(function(t,e){r.controls[$(e).attr("name")]="true"==$(e).attr("enabled")}),e.control_layouts[n]=r,e.defaultControlLayout||(e.defaultControlLayout=r)}),Frame.controlMap={previous:$("#control-previous"),next:$("#control-next"),finish:$("#control-finish"),submit:$("#control-submit"),submitall:$("#control-submitall"),volume:$("#control-volume"),seekbar:$("#control-progress,#progressbar"),replay:$(".icon.restart"),pauseplay:$("#control-pauseplay"),resources:$(".tab.resources,.label.resources"),glossary:$(".tab.glossary,.label.glossary"),transcript:$(".tab.transcript,.label.transcript"),outline:$(".tab.outline,.label.outline"),search:$(".label.outline")},player.slideList=new SlideList,Frame.navLinks=this.parseNavLinks($(t).children().children("nav_data").children("outline")),player.slideList.build(Frame.navLinks,null,null,null,player.slideList.tree),player.slideList.build(Frame.navLinks,$("#slide_list_portrait")),this.ready=!0},Frame.prototype.parseNavLinks=function(t){var e=this,i=[],r=0;return $(t).children("links").children("slidelink,slidedrawref").each(function(t,n){var a={type:n.tagName,slideid:$(n).attr("slideid"),drawid:$(n).attr("drawid"),displaytext:$(n).attr("displaytext"),expand:"true"==$(n).attr("expand")};"slidedrawref"!=a.type||a.displaytext||(a.displaytext="Draw from Question Bank "+ ++r),0<$(n).children("links").length&&(a.links=e.parseNavLinks(n)),i.push(a);var s=story.parseObjref(a.slideid).target;s&&s.navLinks&&s.navLinks.push(a)}),i},Frame.prototype.setVisibility=function(t,e){e||t.hide()},Frame.prototype.parseOptionGroups=function(t){var e=this;$(t).children().children("control_options").children("optiongroups").children("optiongroup").each(function(t,i){var r=$(i).attr("name");e.parseOptions(i,r)}),e.options.title_enabled||e.options.sidebar_enabled||e.cant_hide_topbar||(e.top_bar_hidden=!0),e.top_bar_hidden&&$(".top_bar").hide(),$("#menu_tabs li:first-child span").addClass("active"),$("#menu_container>ul:first-child, #menu_container>div:first-child").addClass("active")},Frame.prototype.parseOptions=function(t,e){var i=this;$(t).children("options").children().each(function(t,r){$(r).get(0);var n=$(r).attr("name"),a=$(r).attr("value"),s="true"==a;switch(i.options[n]=a,("true"==a||"false"==a)&&(i.options[n]=s),n){case"title_enabled":i.setVisibility($("#storytitle"),s);break;case"title_text":story.title=a,$("#storytitle").text(a),document.title=a;break;case"logo_enabled":s&&($(".landscape_menu").removeClass("no_logo"),$(".logo_background").show());break;case"logo_url":i.logoRef=$("<img/>"),0<$(r).find("property[name='width']").length?(i.options.logo_width=parseInt($(r).find("property[name='width']").attr("value")),i.options.logo_height=parseInt($(r).find("property[name='height']").attr("value")),i.logoRef.css("width",i.options.logo_width),i.logoRef.css("height",i.options.logo_height)):i.logoRef.bind("load",function(){i.options.logo_width=i.logoRef.height(),i.options.logo_height=i.logoRef.height(),i.updateLayout()}),$(".logo_background").append(i.logoRef),i.logoSrc&&i.logoRef.attr("src",i.logoSrc);break;case"html5_logo_url":i.logoSrc=player.basepath+a,i.logoRef&&i.logoRef.attr("src",i.logoSrc);break;case"sidebar_enabled":player.forceMenu||(i.setVisibility($("#control-menu"),s),i.setVisibility($("#portrait_menu"),s),i.setVisibility($(".landscape_menu"),s));break;case"sidebarpos":$(".landscape_menu").addClass(a);break;case"tabs":$(r).children("listitems").children("listitem").each(function(t,e){var r=$(e).attr("name"),n="true"==$(e).attr("value"),a=$(e).attr("group");if(n)switch(n=function(t,e,r,n){i.addTopTab(t,e,r,n)},"sidebar"==a&&(n=function(t,e,r,n){i.addSideTab(t,e,r,n)},i.sidebarItems[r]=!0),r){case"outline":n(a,"Menu",$("#slide_list"),r);break;case"glossary":i.glossaryPanel=new GlossaryPanel,i.glossaryPanel.loadFromXML($(i.xml).find("glossary_data").first()),n(a,"Glossary",i.glossaryPanel.ref,r);break;case"resources":i.resourcesPanel=new ResourcesPanel,i.resourcesPanel.loadFromXML($(i.xml).find("resource_data").first()),n(a,"Resources",i.resourcesPanel.ref,r);break;case"transcript":i.transcriptPanel=new TranscriptPanel,i.transcriptPanel.loadFromXML($(i.xml).find("transcript_data").first()),n(a,"Notes",i.transcriptPanel.ref,r);break;case"customlink":var s=$(e).find("property[name='title']").attr("value"),o=$(e).find("property[name='data']").attr("value");n(a,s,o,r)}});break;case"wraplistitems":s&&$(".framewrap").addClass("wraplistitems");break;case"seekbar":s||($(".player_controls").css("display","none!important"),$("#control-progress").css("display","none"));break;case"bottombar_enabled":i.setVisibility($(".bottom_bar"),s),i.setVisibility($("#controls"),s),s&&(i.hasBottomBar=!0)}i.parseOptions(r,e)})},Frame.prototype.addTopTab=function(t,e,i,r){var n=this;if("customlink"==r)return n.addTopLink(t,e,i);n.top_bar_hidden=!1,n.cant_hide_topbar=!0;var a=$('<div class="toptab"><span class="label '+r+'">'+e+'</span><div class="menu_container"></div></div>');a.children(".menu_container").append(i),"linkright"==t?($("#toplinks_right").prepend(a),n.hasLinksRight=!0):($("#toplinks_left").append(a),n.hasLinksLeft=!0),a.children("span").first().bind("click",function(t){return a.hasClass("active")?a.removeClass("active"):(MouseEvents.processHideables(t),$("#topbar .active").removeClass("active"),a.addClass("active"),n.registeredTopBar||(MouseEvents.addHideable(".toptab.active",".toptab .menu_container, #frameswitch",function(){$(".toptab.active").removeClass("active")}),n.registeredTopBar=!0)),!1})},Frame.prototype.addSideTab=function(t,e,i,r){t=$('<li><span class="left label '+r+'">'+e+"</span></li>"),$("#menu_tabs").append(t),$("#menu_container").append(i);var n=t.children("span").first();t.bind("click",function(){return $("#topbar .active").removeClass("active"),$("#menu_tabs .active").removeClass("active"),$("#menu_container .active").removeClass("active"),n.addClass("active"),i.addClass("active"),!1})},Frame.prototype.addTopLink=function(t,e,i){e=$('<div class="toptab customlink"><span class="label '+name+'">'+e+"</span></div>"),"linkright"==t?($("#toplinks_right").prepend(e),this.hasLinksRight=!0):($("#toplinks_left").append(e),this.hasLinksLeft=!0),e.children("span").first().bind("click",function(){return story.handleEvent("onobjectevent",i,null,!1,!1,!0),!1})},Frame.prototype.parseColorSchemes=function(t){var e=this;$(t).children().children("colorschemes").children("colorscheme").children("color_group").each(function(t,i){var r=$(i).attr("name");e.parseColorGroup(i,r)})},Frame.prototype.parseColorGroup=function(t,e){var i={};$(t).children("group_colors").children("color").each(function(t,e){var r=$(e).attr("name"),n=new Background;n.loadFromXML($(e),"fill"),i[r]=n}),this.colorGroups[e]=i},Frame.prototype.applyColorSchemes=function(){if(!player.noframe&&!player.noframecolor&&($.each(story.children,function(t,e){if("Window"==e.innerType&&"LightboxWnd"!=e.id&&"LightboxControlsWnd"!=e.id&&e.ref&&player.frame.colorGroups.window&&player.frame.colorGroups.window.bg)try{e.ref.css("background-color",player.frame.colorGroups.window.bg.toCssString()),e.ref.css("color",player.frame.colorGroups.window.text.toCssString()),e.ref.find("h1").css("color",player.frame.colorGroups.window.text.toCssString()),e.ref.css("border-color",player.frame.colorGroups.window.divb.toCssString()),e.ref.find("hr").css("border-color",player.frame.colorGroups.window.divb.toCssString())}catch(i){}}),player.isHTML5)){var t=new CustomStyleSheet,e=function(e,i,r){if(player.frame.colorGroups[e]&&player.frame.colorGroups[e][i]){var n=player.frame.colorGroups[e][i].toCssString(),e=player.frame.colorGroups[e][i].toColorString();t.add(r,"background",e),t.add(r,"background",n),t.add(r,"background",n.replace("-webkit","-moz")),t.add(r,"background",n.replace("-webkit","-ms")),(player.isIE8||player.isIE9)&&n.indexOf("progid")}},i=function(e,i,r){if(player.frame.colorGroups[e]&&player.frame.colorGroups[e][i]){var n=player.frame.colorGroups[e][i];switch(n.backgroundType){case"fill":t.add(r,"border-color",n.stops[0].color),1<n.stops.length&&player.frame.colorGroups[e][i].toCssString()}}},r=function(e,i,r,n,a,s){if(player.frame.colorGroups[e]&&player.frame.colorGroups[e][i])switch(e=player.frame.colorGroups[e][i],e.backgroundType){case"fill":e=e.toColorString(),s&&(e=s+e),a&&(e+=a),t.add(r,n,e)}};e("base","bg","#slidebg"),e("base","slide_bg",".framewrap,.bg"),e("base","slide_bg",".window.LightboxControlsWnd"),e("base","menu_shade",".landscape_menu"),i("base","border",".framewrap"),i("base","border",".landscape_menu"),r("base","text","a,body","color"),e("button","btn_bg",".controlbar-button"),i("button","btn_border",".controlbar-button"),r("button","btn_glow",".controlbar-button.right","box-shadow"," 0px 0px 1px 1px"),player.isIOS||e("button","btn_hover",".controlbar-button.right:hover"),e("button","btn_down",".controlbar-button.right.pressed"),e("seekcontrol","seek_bg","#progressbar"),e("seekcontrol","seek_position",".progress-bar"),i("seekcontrol","seek_border","#progressbar,.progress-bar"),e("seekcontrol","bg","#control-progress"),i("seekcontrol","border","#control-progress"),e("volume","thumb_bg",".volume-handle"),e("volume","slider_bg",".volume-slider"),i("volume","thumb_border",".volume-handle"),i("volume","slider_border",".volume-slider"),r("volume","thumb_inner",".volume-handle","-webkit-box-shadow"," 0px 0px 1px 1px","inset "),r("volume","thumb_inner",".volume-handle","-moz-box-shadow"," 0px 0px 1px 1px","inset "),r("volume","thumb_inner",".volume-handle","-ms-box-shadow"," 0px 0px 1px 1px","inset "),r("volume","thumb_inner",".volume-handle","box-shadow"," 0px 0px 1px 1px","inset "),e("menu","bg",".menu_container"),r("listitem","text","ul.menu_list a","color"),r("listitem","text","ul.slidelist li","color"),player.isIOS||(e("listitem","hover","li.has_children.open li>a:hover"),e("listitem","hover","ul.slidelist li:hover")),e("listitem","selected","ul.menu_list li.selected, ul.menu_list li.selected > a, ul.menu_list li.selected > a:hover"),e("listitem","selected","ul.slidelist li.selected, ul.slidelist li.selected > a:hover"),r("listitem","lines","ul.menu_list>li","border-top-color"),r("listitem","lines","ul.slidelist li.divider","border-bottom-color"),r("listitem","viewed","ul.menu_list li.visited > a","color"),r("listitem","viewed","ul.slidelist li.visited","color"),r("listitem","selected_text","ul.menu_list li.selected > a","color"),r("listitem","selected_text","ul.slidelist li.selected","color"),r("listitem","text","ul.menu_list li.has_children > span","border-left-color"),r("listitem","text","ul.menu_list li.has_children.open > span","border-top-color"),r("listitem","text","ul.slidelist li>span","border-left-color"),r("listitem","text","ul.slidelist li.open>span","border-top-color"),e("tabs","bg","ul.menu_nav li span.active, .toptab.active>span"),r("tabs","text","ul.menu_nav li span","color"),r("tabs","selected","ul.menu_nav li span.active, .toptab.active>span","color"),i("window","divb",".toptab.active>span,.toptab .menu_container"),i("window","divb",".resources_container hr"),r("menu","shadow",".toptab .menu_container","-webkit-box-shadow"," 0px 0px 20px"),r("menu","shadow",".toptab .menu_container","-moz-box-shadow"," 0px 0px 20px"),r("menu","shadow",".toptab .menu_container","-ms-box-shadow"," 0px 0px 20px"),r("menu","shadow",".toptab .menu_container","box-shadow"," 0px 0px 20px"),e("glossary","bg",".glossary_section"),e("tabs","bg",".glossary_section_header"),player.isIOS||e("glossary","hover",".glossary_section li:hover"),e("glossary","selected",".glossary_section li.active"),r("glossary","selected",".glossary_section li.active","color"),r("glossary","diva",".glossary_section_header, .glossary_section:first-child","border-bottom-color"),r("glossary","divc",".glossary_section_header","border-top-color"),e("logo","bg",".logo_background"),player.frame.colorGroups.button&&player.frame.colorGroups.button.btn_icon_color&&(e=player.frame.colorGroups.button.btn_text_shadow.stops[0],i=player.frame.colorGroups.seekcontrol.btn_icon_hover.stops[0],this.prepIconSprite(".controlbar-button .icon",player.frame.colorGroups.button.btn_icon_color.stops[0],e,t),player.isIOS||this.prepIconSprite("#control-progress .icon:hover",i,e,t),r("button","btn_icon_color",".controlbar-button .label","color"),r("button","btn_text_shadow",".controlbar-button .label","text-shadow","","0px 1px 1px ")),t.build()}},Frame.parseRGB=function(t){return t=t.replace("#",""),[parseInt(t.substr(0,2),16),parseInt(t.substr(2,2),16),parseInt(t.substr(4,2),16)]},Frame.prototype.prepIconSprite=function(t,e,i,r){var n=Frame.parseRGB(e.rawcolor),a=Frame.parseRGB(i.rawcolor);n.push(e.alpha),a.push(i.alpha);var s=new Image;$(s).bind("load",function(){var e=document.createElement("canvas");e.width=230,e.height=16;var i=e.getContext("2d");i.drawImage(s,0,0);for(var o=i.getImageData(0,0,e.width,e.height),l=0;l<o.data.length-4;l+=4){var h=o.data[l];0!=o.data[l+3]&&(o.data[l]=n[0],o.data[l+1]=n[1],o.data[l+2]=n[2],o.data[l+3]=255-h)}i.clearRect(o,0,0,e.width,e.height),i.putImageData(o,0,0),i.shadowColor="rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")",i.shadowOffsetX=0,i.shadowOffsetY=1,i.shadowBlur=1,i.clearRect(o,0,0,e.width,e.height),i.drawImage(e,0,0),e=e.toDataURL("image/png"),r&&r.add(t,"background-image","url("+e+")"),r.build()}),s.src=Frame.iconSrc},Frame.prototype.set_window_control_layout=function(t){Frame.windowControlMap={previous:$(".window.LightboxControlsWnd #control-previous"),next:$(".window.LightboxControlsWnd #control-next"),submit:$(".window.LightboxControlsWnd #control-submit"),volume:$(".window.LightboxControlsWnd #control-volume"),seekbar:$(".window.LightboxControlsWnd #control-progress"),replay:$(".window.LightboxControlsWnd .icon.restart"),pauseplay:$(".window.LightboxControlsWnd #control-pauseplay"),resources:$(".label.resources"),glossary:$(".label.glossary"),transcript:$(".window.LightboxControlsWnd #TODO-resources"),outline:$(".window.LightboxControlsWnd #TODO-resources"),search:$(".window.LightboxControlsWnd #TODO-resources")},player.currentWindow&&this.set_frame_layout(t,Frame.windowControlMap)},Frame.prototype.set_frame_layout=function(t,e){var e=e||Frame.controlMap,i=ProgressBar.getCurrentProgressBar().ref.parent().parent(),r=this,n=$(t).attr("name");if(r.currentLayoutName=n,n=r.control_layouts[n],n||(n=r.control_layouts[r.defaultLayoutName],r.currentLayoutName=r.defaultLayoutName),n||(n=r.defaultControlLayout),n){r.updateTextLabels(),this.options.forceseekbar&&(n.controls.seekbar=!0,n.controls.pauseplay=!0,n.controls.replay=!0);var a=0,s=!1;if(r.visibleSidebarItems={},$.each(n.controls,function(t,i){var n=e[t];n&&(i?(n.show(),("previous"==t||"next"==t||"submit"==t)&&a++,"volume"==t&&(s=!0)):n.hide()),i&&r.sidebarItems[t]&&(r.visibleSidebarItems[t]=!0)}),this.reorient(!0),player.isHTML5){var o=30+7*a;$.each(["#control-previous","#control-next","#control-submit"],function(t,e){var i=$(e);"block"==i.css("display")&&(o+=i.get(0).offsetWidth)}),s&&(o+=40),n=this.availableWidth-o,i.find("#control-progress").css("width",n),i.find("#control-progress .progress-container").css("width",n-59)}i=$(".landscape_menu #menu_tabs>li>span"),3==i.length?(i.css("width","59px"),i.last().css("width","60px")):3<i.length&&$("ul.menu_nav li span").css("padding","0px 4px"),this.updateLayout()}},Frame.prototype.isSidebarVisible=function(){for(key in this.visibleSidebarItems)return!0;return!1},Frame.prototype.ensureHasActiveSidebarItem=function(){var t=null,e=null,i=!1;for(key in this.visibleSidebarItems){var r=Frame.controlMap[key];t||(t=r),r.hasClass("active")&&(e=r),i=i||r.hasClass("active")}t&&!i?t.click():e&&e.click()},Frame.prototype.initOrientation=function(){this.updateLayout()},Frame.prototype.reorient=function(t){1!=player.width&&this.updateLayout(t)},Frame.prototype.updateLayout=function(){this.updateFrameLayout(),this.updatePlayerLayout()},Frame.prototype.updatePlayerLayout=function(){if(1==player.width&&player.detectSize(),$("#loadingSpinner").css("left",Math.floor(window.innerWidth/2)-50),$("#loadingSpinner").css("top",Math.floor(window.innerHeight/2)-50),$(".blocked").css("left",Math.floor(window.innerWidth/2)-50),$(".blocked").css("top",Math.floor(window.innerHeight/2)-50),!player.noframe){var t=player.frame.top_bar_hidden?0:33;player.frame.top_bar_hidden?$("#topbar").addClass("empty"):this.options.title_enabled?($("#storytitle").removeClass("alone"),$(".toptab").removeClass("alone"),$(".toptab").removeClass("notitle"),$("#topbar").removeClass("empty"),this.hasLinksLeft&&this.hasLinksRight||(!this.hasLinksLeft||this.hasLinksRight)&&(!this.hasLinksLeft&&this.hasLinksRight?($("#storytitle").addClass("alone"),$(".toptab").addClass("alone")):!this.hasLinksLeft&&!this.hasLinksRight&&(t=10))):($("#storytitle").removeClass("alone"),$(".toptab").removeClass("alone"),$("#topbar").removeClass("empty"),$(".toptab").addClass("notitle"),t=10,!this.hasLinksLeft&&!this.hasLinksRight&&(t=-10,$("#topbar").addClass("empty")));var e=player.frame.options.sidebar_enabled&&this.isSidebarVisible();player.frame.ensureHasActiveSidebarItem();var i=player.frame.bottom_bar_hidden||!player.frame.hasBottomBar?0:41,r=e?239:0,r=e?240:0,n="left"==player.frame.options.sidebarpos?r:0,a=this.containerHeight,s=this.containerWidth-r-20+1,i=a-t-i-20+1;this.availableWidth=s,this.availableHeight=i;var o="left"==player.frame.options.sidebarpos?0:s+20,r="left"==player.frame.options.sidebarpos?r+10:10;$(".landscape_menu").css("left",o),$("#controls").css("left",r),$("#controls").css("width",s),this.setVisibility($("#controls"),this.hasBottomBar),$("#topbar").css("left",r),$("#topbar").css("width",s),$(".toptab .menu_container").css("height",parseInt(.8*i));var l=s/i,r=10,o=n+10-1,a=a-20+2,h=0;player.frame.options.logo_enabled&&(h=player.frame.options.logo_height+20+10),h=a-h-25,$(".landscape_menu .menu_container").css("height",h+"px"),player.aspectRatio>l?(s=(i-1*player.height)/2,s>0&&(r=s+10+2)):(s=(s-1*player.width)/2,s>0&&(o=s+n+10)),t="#slideframe{margin-left:"+o+"px!important;margin-top:"+r+"px!important;top:"+t+"px!important;}#slideframe, .slide{width:"+player.width+"px;height:"+player.height+"px;}.landscape_menu{height: "+a+"px;}.landscape_menu{display: "+(e?"block":"none")+";}.interstitial{height:"+window.innerHeight+"px;}",player.frame.options.seekbar||(t+=".player_controls{display:none!important;}"),player.rotateLandscapeStyleSheet||(player.rotateLandscapeStyleSheet=document.createElement("style"),document.body.appendChild(player.rotateLandscapeStyleSheet)),player.rotateLandscapeStyleSheet.innerHTML=t,player.landscapeScale=1,player.zoom=1}},Frame.prototype.updateFrameLayout=function(){if(!player.isIOS){var t=window.innerWidth,e=window.innerHeight,i=story.frameWidth-2,r=story.frameHeight-2,n=1;player.scaleToFit&&(n=story.frameWidth/story.frameHeight>t/e?t/story.frameWidth:e/story.frameHeight,$("document.body").css("overflow","hidden")),e=parseInt((e-r*n)/2-1),0>e&&(e=0),t=parseInt((t-i*n)/2-1),0>t&&(t=0),this.containerWidth=i,this.containerHeight=r,this.containerLeft=t,this.containerTop=e,this.aspectRatio=i/r,$(".framewrap").css("width",i),$(".framewrap").css("height",r),$(".framewrap").css("top",e),$(".framewrap").css("left",t),i=".framewrap{-webkit-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+n+");-moz-transform-origin:top left;-moz-transform:translate3d(0px,0px,0px) scale("+n+");-ms-transform-origin:top left;-ms-transform:translate(0px,0px) scale("+n+");}",player.frameLandscapeStyleSheet||(player.frameLandscapeStyleSheet=document.createElement("style"),document.body.appendChild(player.frameLandscapeStyleSheet)),player.frameLandscapeStyleSheet.innerHTML=i,player.frameScale=n}},Frame.prototype.updateTextLabels=function(){$(this.xml).find("string_table").first().children("string").each(function(t,e){var i=$(e).attr("id"),r=$(e).text(),e=$(".label."+i);0<e.length&&(e.text(r),e.parent().hasClass("controlbar-button")&&(i=player.isIOS?.88:.9,i=e.get(0).offsetWidth*(1-i),0!=i&&e.css("margin-right",-i+"px")))})},Frame.prototype.debugTopNav=function(){var t=this;this.topNavSelector=$("<div class='topnavselector'></div>"),$(document.body).append(this.topNavSelector);var e=function(e){var i=$("<input id='box_"+e+"' type='checkbox'><label for='box_"+e+"'>"+e+"</label>");i.first()[0].checked=player.frame[e],i.click(function(){var t=i.first()[0].checked;player.frame[e]=t,player.frame.updateLayout()}),t.topNavSelector.append(i)};e("top_bar_hidden"),e("hasLinksLeft"),e("hasLinksRight"),$("#topbar").css("background-color","aqua"),$("#toplinks_right").css("background-color","yellow"),$("#toplinks_left").css("background-color","orange"),$("#topbar > #storytitle").css("background-color","lime")},Frame.prototype.setControlEnabled=function(t,e){var i=Frame.controlMap[t];i&&(e?i.removeClass("disabled"):i.addClass("disabled"))},Frame.findCurrentFrame=function(){var t=null;if(self!=top&&!player.isCrossDomainFrame)try{$.each(top.document.getElementsByTagName("iframe"),function(e,i){i.contentWindow==self&&(t=i)}),$.each(top.document.getElementsByTagName("frame"),function(e,i){i.contentWindow==self&&(t=i)})}catch(e){}return t},ResourcesPanel.prototype.loadFromXML=function(t){var e=this;this.xml=t,this.description=$(t).attr("description"),this.resources=[],$(t).children("resources").children("resource").each(function(t,i){var r={};r.url=$(i).attr("url"),r.image=player.basepath+$(i).attr("image"),r.title=$(i).attr("title"),e.resources.push(r)}),this.createRef()},ResourcesPanel.prototype.createRef=function(){if(this.ref)return!1;var t=$("<div class='resources_container'></div>");t.append($("<div class='resources_description'>"+this.description+"</div>")),t.append($("<hr/>"));var e=$("<ul></ul>");return $.each(this.resources,function(t,i){var r=$("<li><a href='"+i.url+"' target='_blank'><img src='"+i.image+"' class='resources_icon'/>"+i.title+"</a></li>");
e.append(r)}),t.append(e),this.ref=t,!0},GlossaryPanel.prototype.loadFromXML=function(t){var e=this;this.xml=t,this.terms=[],$(t).children("terms").children("term").each(function(t,i){var r={};r.title=$(i).attr("title"),r.definition=$(i).text(),e.terms.push(r)}),this.createRef()},GlossaryPanel.prototype.createRef=function(){if(this.ref)return!1;var t=$("<div class='glossary_container'></div>"),e=$("<div id='glossaryscroll' class='glossary_section scrollarea'></div>");e.append($("<div class='glossary_section_header label terms'>Terms</div>"));var i=$("<ul></ul>");return $.each(this.terms,function(t,e){var r=$("<li><a href='javascript:void(null);' >"+e.title+"</a></li>");r.click(function(){$(".definitiontext").hide(),$(".glossary_container .active").removeClass("active"),e.defref&&(r.addClass("active"),e.defref.show())}),i.append(r)}),e.append(i),t.append(e),e=$("<div class='glossary_section'></div>"),e.append($("<div class='glossary_section_header label definition'>Definition</div>")),$.each(this.terms,function(t,i){var r=$("<div class='definitiontext'>"+i.definition+"</div>");i.defref=r,e.append(r)}),t.append(e),this.ref=t,!0},TranscriptPanel.prototype.loadFromXML=function(t){var e=this;this.xml=t,this.transcripts=[],$(t).children("slidetranscripts").children("slidetranscript").each(function(t,i){var r={};r.slideid=$(i).attr("slideid"),r.slidebank="true"==$(i).attr("slidebank"),r.content=$(i).text(),e.transcripts.push(r);var n=story.parseObjref(r.slideid).target;n.transcript=r,r.show=function(){e.titleref.html(n.title),$(".transcript_content").hide(),r.contentref&&r.contentref.show()}}),this.createRef()},TranscriptPanel.prototype.createRef=function(){if(this.ref)return!1;var t=$("<div class='transcript_container'></div>");return this.titleref=$("<div class='transcript_title'></div>"),t.append(this.titleref),$.each(this.transcripts,function(e,i){var r=$("<div class='transcript_content'><hr/>"+i.content+"</div>");i.contentref=r,t.append(r)}),this.ref=t,!0},CustomStyleSheet.prototype.add=function(t,e,i){if(this.ruleLookup[t])this.ruleLookup[t].add(e,i);else{var r=new StyleRule(t);r.add(e,i),this.ruleLookup[t]=r,this.rules.push(r)}},CustomStyleSheet.prototype.build=function(){this.sheet||(this.sheet=document.createElement("style"),document.body.appendChild(this.sheet));var t="";$.each(this.rules,function(e,i){t+=i.toString()}),this.sheet.innerHTML=t},StyleRule.prototype.add=function(t,e){this.attributes.push({name:t,value:e})},StyleRule.prototype.toString=function(){var t=this.selector+"\r\n{\r\n";return $.each(this.attributes,function(e,i){t+="	"+i.name+": "+i.value+";\r\n"}),t+="}\r\n\r\n"};var MouseEvents={hideables:[]};MouseEvents.addHideable=function(t,e,i){MouseEvents.hideables.push({selector:t,exclude:e,callback:i})},MouseEvents.processHideables=function(t){$.each(MouseEvents.hideables,function(e,i){!(i.exclude&&t&&t.target&&0<$(t.target).closest(i.exclude).length||!$.each($(i.selector),function(t,e){i.callback($(e))}))})},MouseEvents.init=function(){var t=function(t){return null!=t.dropArea};player.allowRightClick||$(window).bind("contextmenu",function(){return!1});var e=player.isIOS?"touchstart":"mousedown",i=player.isIOS?"touchend":"mouseup",r=player.isIOS?"touchmove":"mousemove";$(window).bind(e,function(t){if(player.lastEvent=t,player.currentSlide()){swipe.parseEventCoords(t);var e=swipe.getSlideCoords(player.currentSlide());return player.currentSlide().deepEach(function(t,i){var r=!1;i.button&&(r=i.button.testOver(e.x,e.y)),!(player.modalLayer&&player.modalLayer!=i.layer||r||"true"==i.variables._disabled||null==i.isPointActive||!i.hasEvent("onclickoutside")||i.testOver(e.x,e.y)&&i.isPointActive(e.x,e.y)&&!i.isPointObscured(e.x,e.y)||!i.handleEvent("onclickoutside",null,null,!1,!1,!0))},function(t){return t.visible||"ShuffleGroup"==t.innerType}),!0}}),$(window).bind("click",function(t){MouseEvents.processHideables(t)}),$(document.body).bind(e,function(t){if(player.lastEvent=t,player.currentSlide()&&player.currentSlide().ref){swipe.parseEventCoords(t);var e=swipe.getSlideCoords(player.currentSlide());swipe.noteDownCoords();var i=!1;player.currentSlide().deepEach(function(r,n){i||player.modalLayer&&player.modalLayer!=n.layer||"true"==n.variables._disabled||!n.visible||!(n.hasEvent("onpress")||n.hasEvent("onrelease")||n.hasEvent("onlink")||n.isDragItem||player.canChangeMonitoringItem)||!n.isPointActive(e.x,e.y)||n.isPointObscured(e.x,e.y)||(n.isDragItem?(n.mousedown(t),i=!0):n.hasEvent("onpress")&&(n.handleEvent("onpress",null,null,!1,!1,!0),i=!0),n.hasEvent("onrelease")&&n.ref&&n.ref.addClass("hasmousedown"),$.each(n.children,function(t,e){e.hasEvent("onrelease")&&e.ref&&e.ref.addClass("hasmousedown")}),player.canChangeMonitoringItem&&player.updateItemInfo(n)),n.clickFocus&&n.testOver(e.x,e.y)&&!n.isPointObscured(e.x,e.y)&&(i=!0,setTimeout(function(){n.input&&n.input.get&&n.input.get(0)?n.input.get(0).focus():n.select&&n.select.get&&n.select.get(0)&&n.select.get(0).focus()},0))},function(t){return t.visible||"ShuffleGroup"==t.innerType})}}),$(document.body).bind(i,function(e){player.lastEvent=e;var i=swipe.hasMoved();if(player.currentSlide()&&player.currentSlide().ref){swipe.parseEventCoords(e);var r=swipe.getSlideCoords(player.currentSlide()),n=!1;player.currentSlide().deepEach(function(e,a){n||player.modalLayer&&player.modalLayer!=a.layer||"true"==a.variables._disabled||!a.visible||!a.hasEvent("onrelease")&&!a.hasEvent("onlinkrelease")||!(!i||a.ref&&a.ref.hasClass("hasmousedown"))||!a.isPointActive(r.x,r.y)||a.isPointObscured(r.x,r.y,null,t)||(n=!0,a.handleEvent("onrelease",null,null,!1,!1,!0),a.hasEvent("onlinkrelease")&&$.each(a.links,function(t,e){e.handleIfOver("onlinkrelease",r,!1)}),a.prepDownstreamMedia(),n=!0)},function(t){return t.visible||"ShuffleGroup"==t.innerType}),!n&&player.currentSlide().testOver(r.x,r.y)&&player.currentSlide().handleEvent("onclickoutsideobjects",null,null,!1,!1,!0),$(".hasmousedown").removeClass("hasmousedown")}}),$(".menu_container").bind("mouseup",function(){return!1}),$(document.body).bind(r,function(e){if(player.lastEvent=e,player.currentSlide()&&player.currentSlide().ref){swipe.parseEventCoords(e);var i=swipe.getSlideCoords(player.currentSlide());player.followMouseCursor&&(player.mouseFollowDiv||(player.mouseFollowDiv=$("<div class='mousecursorfollow'></div>")),player.currentSlide().ref.append(player.mouseFollowDiv),player.mouseFollowDiv.css("left",i.x),player.mouseFollowDiv.css("top",i.y-5)),player.currentSlide().deepEach(function(r,n){if(!n.isMouseOver||player.modalLayer&&player.modalLayer!=n.layer||"true"==n.variables._disabled||!n.isPointActive||0!=n.dragX||0!=n.dragY||!(n.hasEvent("onrollout")||n.hasEvent("onpress")||n.hasEvent("onrelease")||n.hasEvent("ondoubleclick",!0)||n.hasEvent("onlinkrelease",!0)||n.isDragItem)||n.isPointActive(i.x,i.y)&&!n.isPointObscured(i.x,i.y,null,t)||(n.isMouseOver=!1,n.hasEvent("onrollout")&&n.handleEvent("onrollout",null,null,!1,!1,!0),$(e.target).removeClass("pointercursor"),n.hasEvent("onlinkrelease")&&$.each(n.links,function(t,e){e.render("onrollout")})),(!n.isMouseOver||n.hasEvent("onlinkrelease",!0))&&(!player.modalLayer||player.modalLayer==n.layer)&&(n.hasEvent("onrollover",!0)||n.hasEvent("onpress",!0)||n.hasEvent("onrelease",!0)||n.hasEvent("ondoubleclick",!0)||n.hasEvent("onlinkrelease",!0)||n.isDragItem)&&"true"!=n.variables._disabled&&n.isPointActive&&n.isPointActive(i.x,i.y)&&!n.isPointObscured(i.x,i.y,null,t))if(n.isMouseOver=!0,n.hasEvent("onrollover")&&n.handleEvent("onrollover",null,null,!1,!1,!0),n.hasEvent("onlinkrelease")){var a=!1;$.each(n.links,function(t,e){e.handleIfOver("onrollover",i,!0)&&(a=!0),e.handleIfOut("onrollout",i)}),a?$(e.target).addClass("pointercursor"):$(e.target).removeClass("pointercursor")}else $(e.target).addClass("pointercursor")},function(t){return t.visible||"ShuffleGroup"==t.innerType})}})};var playerDiagnostics={};playerDiagnostics.init=function(){$.each(location.search.split("&"),function(t,e){var i=unescape(e.replace("?","")).split("=");switch(i[0].toLowerCase()){case"controls":player.showControls=!0,player.swipeMode="none",player.animations="all";break;case"seek":setTimeout(function(){player.frame.options.forceseekbar=!0,player.frame.options.seekbar=!0,player.frame.set_frame_layout()},400);break;case"anim":player.animations=i[1];break;case"page":player.paging=i[1];break;case"zoom":player.tapZoomEnabled=!0;break;case"lockzoom":player.lockzoom=!player.lockzoom;break;case"scale":player.scaleToFit=!player.scaleToFit;break;case"swipe":player.swipeMode=i[1];break;case"rightclick":player.allowRightClick=!player.allowRightClick;break;case"menu":player.forceMenu=!0;break;case"jiggle":player.useSwipeJiggle=!0;break;case"simplezoom":player.useSimpleZoom=!0;break;case"framecount":player.showFrameCount=!0;break;case"heartbeat":setInterval(function(){$(".framewrap").hide(),player.uselessOffsetHeight=$(".framewrap").get(0).offsetHeight,$(".framewrap").show()},i[1]||1e3);break;case"noimg":player.noImg=!0;break;case"bak":player.backOnly=!0;break;case"simplify":player.simplifySlides=!1;break;case"preload":player.preload=!0;break;case"nopreload":player.neverPreload=!0;break;case"canvasdebug":player.canvasDebug=!0;break;case"ppfudge":window.ppFudge=parseFloat(i[1]);break;case"nocanvas":player.useCanvas=!1,player.renderVectorShapes=!1,player.renderVectorsAsSVG=!1;break;case"safecanvas":player.useSafeCanvas=!0;break;case"basiccanvas":ppArt=ppArtBasic;break;case"oldnav":player.simplenav=!1;break;case"compact":player.useCompactResume=!player.useCompactResume;break;case"svg":player.useCanvas=!0,player.renderVectorShapes=!0,player.renderVectorsAsSVG=!0;break;case"logging":window.EventLogger.logging=!window.EventLogger.logging;break;case"console":console.suppress=!console.suppress;break;case"trace":trace.suppress=!trace.suppress;break;case"noconsole":console.suppress=!0;break;case"datestamp":var r=$("<div class='datestamp'>"+window.buildDate+"<div>");r.click(function(){alert(window.buildDate)}),$(document.body).append(r);break;case"silent":Audio.setSilentMode();break;case"media":player.showMediaMonitor=!0,setInterval(playerDiagnostics.updateMediaMonitor,100);break;case"medialist":var n=$("<div class='medialist'></div>");$(document.body).append(n),setTimeout(function(){story.xml.find("video").find("videodata").each(function(t,e){n.append("<a href='"+player.basepath+$(e).attr("url")+"' target='_blank'>"+$(e).attr("url")+"</a><br>")})},2e3);break;case"timelines":playerDiagnostics.setupTimelineMonitor();break;case"resources":playerDiagnostics.setupResourceList();break;case"monitor":player.showInstrumentation=!0;break;case"follow":player.followMouseCursor=!0;break;case"info":player.showItemInfo=!0,player.canChangeMonitoringItem=!0,player.originalMonitoringItemID=i[1],setInterval(player.updateItemInfo,1e3),setTimeout(function(){var t=story.findDescendantById(i[1]);t&&player.updateItemInfo(t)},1e3),$(".framewrap").addClass("info");break;case"placeholder":player.usePlaceholderVideo=!0;break;case"novideo":player.noVideo=!0;break;case"noaudiocache":player.noAudioCache=!0;break;case"filter":console.filter=i[1];break;case"overlap":player.showDebugOverlap=!0,BitMask.showDebug=!0;break;case"persist":player.showDebugOverlapPersistent=!0;break;case"overlapdebug":player.showDebugOverlap=!0,BitMask.showDebug=!0,BitMask.debugOnly=!0;break;case"matrixdebug":player.showMatrixDebug=!0;break;case"maskdebug":player.drawMaskDebugShapes=!0;break;case"maskimage":player.useMaskImage=!0;break;case"maskcanvas":player.useMaskCanvas=!0;break;case"backcanvas":player.useBackgroundCanvasWorkaround=!0;break;case"dumpcanvas":player.dumpCanvas=!0,player.canvasCommandLog=[];break;case"linkareas":player.showLinkAreas=!0;break;case"maximize":player.canMaximize=!0,player.maximized=!0;break;case"stresstest":playerDiagnostics.setupStressTest();break;case"navtest":setTimeout(function(){player.frame.debugTopNav()},1e3);break;case"nointervals":player.nointervals=!0;break;case"noframe":player.noframe=!0;break;case"noframecolor":player.noframecolor=!0;case"novectorimage":player.suppressVectorImage=!0;break;case"bgcolor":globals.strBgColor="#"+i[1],$(document.body).css("background","#"+i[1]);break;case"slidescale":player.forceSlideScale=parseFloat(i[1]);break;case"resumedata":player.overrideResumeData=i[1];break;case"suppresscapture":player.suppressCaptureAnimations=!player.suppressCaptureAnimations;break;case"active":player.useActiveTimeline=!player.useActiveTimeline;break;case"iosplayer":player.simulateIOSPlayer=!player.simulateIOSPlayer;break;case"logactivity":player.logActivity=!player.logActivity;break;case"history":playerDiagnostics.setupHistoryDebug()}})},playerDiagnostics.setupStressTest=function(){var t=$("<a style='position:absolute;left:0px;top:10px;z-index:10000;background-color:#fff'>stress single</a>");t.click(function(){var e=0,i=player.currentSlide(),r=i.container,n=function(){setTimeout(function(){i.destroyRef(),setTimeout(function(){i.createRef(r),n()},50)},50),e++,t.html(e)};n()}),$(document.body).append(t);var e=$("<a style='position:absolute;left:0px;top:50px;z-index:10000;background-color:#fff'>stress cycle</a>");e.click(function(){var t=0,i=function(){setTimeout(function(){player.showSlideIndex((player.slideIndex+1)%story.allSlides.length,null,!0,function(){i()})},1e3),t++,e.html(t)};i()}),$(document.body).append(e)},playerDiagnostics.updateMediaMonitor=function(){if(player.showMediaMonitor){player.mediaMonitor||(player.mediaMonitor=$("<div class='monitor'>hey</div>"),$(document.body).append(player.mediaMonitor)),player.mediaMonitor.empty(),$.each(story.allSlides,function(t,e){player.mediaMonitor.append("<h2>"+e.title+"</h2>");var i=$("<ul></ul>");$.each(e.resources,function(t,e){if(("audio"==e.item.type||"video"==e.item.type)&&e.item.ref){var r=$("<li>"+e.prepared+", "+e.item.ref.get(0).networkState+", "+e.item.ref.get(0).readyState+", "+e.item.ref.get(0).paused+", "+e.item.ref.get(0).ended+", "+e.item.ref.get(0).error+", "+e.item.ref.get(0).currentTime+", "+e.src+"</li>");!e.item.ref.get(0).paused&&!e.item.ref.get(0).ended&&r.css("background-color","yellow"),e.item.getFullObjref()==player.nextPreparedClipID&&r.css("color","green"),player.currentClip&&e.item.ref&&player.currentClip==e.item.ref.get(0)&&r.css("text-decoration","underline"),i.append(r)}}),player.mediaMonitor.append(i)});var t=$("<ul></ul>");$.each(Video.refStore,function(e,i){var r=$("<li>"+e+", "+i.get(0).networkState+", "+i.get(0).readyState+", "+i.get(0).paused+", "+i.get(0).ended+", "+i.get(0).error+", "+i.get(0).currentTime+", "+i.get(0).src+"</li>");t.append(r)}),player.mediaMonitor.append(t)}},playerDiagnostics.setupTimelineMonitor=function(){var t=$("<ul class='timerlist'></ul>"),e=function(e,i,r){e=$("<li class='t"+e+"'>"+e+": <b>"+i+"</b> ("+r+")</li>"),t.append(e)};$(document.body).append(t),setInterval(function(){t.empty(),e("active",player.activeTimeline.currentTime,player.activeTimeline.id),e("player",player.currentTime,""),e("slide",player.currentSlide().currentTime,player.currentSlide().id),player.currentFramedSlide&&e("slideFrame",player.currentFramedSlide.currentTime,player.currentFramedSlide.id),player.currentWindowSlide&&e("window",player.currentWindowSlide.currentTime,player.currentWindowSlide.id),e("animation",player.getAnimationTime(),"");var i=function(t){t&&t.deepEach(function(t,i){"Layer"==i.innerType&&e("layer",i.currentTime,i.id)})};i(player.currentSlide()),i(player.currentWindowSlide),i(player.currentFramedSlide)},100)},playerDiagnostics.setupResourceList=function(){var t=$("<ul class='resourcelist'></ul>");$(document.body).append(t),setInterval(function(){t.empty();var e=$("<li class='ttotal'>total: <b>"+Resource.TotalPixels+"</b> ("+Resource.LoadedImageCount+")</li>");t.append(e)},100)},playerDiagnostics.setupHistoryDebug=function(){var t=$("<ul class='historylist'></ul>"),e=function(e,i,r){e=$("<li class='t"+e+"'>"+e+": <b>"+i+"</b> ("+r+")</li>"),t.append(e)};$(document.body).append(t),setInterval(function(){t.empty(),player.history.forEach(function(t){e("player",t,story.allSlides[t].id)}),player.currentWindow&&player.currentWindow.history.forEach(function(t){e("window",t,story.allSlides[t].id)})},100)};var player={slideIndex:0,currentTime:0,animationTime:0,interval:null,showingInterstitial:!0,ready:!1,fontready:!1,playing:!1,paused:!0,blocked:!1,playall:!1,autoplay:!0,autoplaySlides:!0,loopable:!1,simplenav:!0,visible:!0,mediaCount:0,loadedMediaCount:0,deferredLoadingIndex:0,width:1,height:1,aspectRatio:720/540,windowZoomModifier:1,transitionSeconds:.4,maxTransitionSeconds:1.2,clipVolume:1,progressBar:null,zoomed:!1,basepath:"",currentClip:null,currentClipStartTime:0,currentAnimations:{},showControls:!1,slideList:null,fileList:null,swipeMode:"follow",useCanvas:!0,useCompactResume:!0,simplifySlides:!0,suppressCaptureAnimations:!1,hasUserScript:!1,startTime:new Date,useActiveTimeline:!0,simulateIOSPlayer:!1,logActivity:!1,frameCount:0,renderedFrameCount:0,fontlib:null,textlib:null,history:[],windowStack:[],renderQueue:[],showQueue:[],webAudioClips:{},listSlidesViewed:{},listSlidesViewedComplete:{},completeSlidesViewed:0,currentSlidesViewed:0,totalViewSlides:0,allowTouchMove:!1},g_oFontLib;player.TICK_DURATION=30,player.isIOS=-1<navigator.userAgent.indexOf("AppleWebKit/")&&-1<navigator.userAgent.indexOf("Mobile/"),player.isIPhone=/iP(hone|od)/.test(navigator.platform),player.isIOSFrame=!1,player.isWebKit=-1<navigator.userAgent.indexOf("AppleWebKit/"),player.canAnimate=-1<navigator.userAgent.indexOf("AppleWebKit/"),player.isIE=-1<navigator.userAgent.indexOf("MSIE "),player.isIE8=player.isIE&&-1<navigator.appVersion.indexOf("MSIE 8"),player.isIE9=player.isIE&&-1<navigator.appVersion.indexOf("MSIE 9"),player.isFF=-1<navigator.userAgent.indexOf("Firefox/"),player.isChrome=-1<navigator.userAgent.indexOf("Chrome/"),player.isMac=-1<navigator.userAgent.indexOf("Macintosh;"),player.isCrossDomainFrame=!1,player.isAndroid=-1<navigator.userAgent.indexOf("Android"),player.isIOS=player.isIOS||player.isAndroid,player.isCrossDomainFrame=!1;try{player.isCrossDomainFrame=void 0==top.location.href}catch(e$$56){player.isCrossDomainFrame=!0}if(self!=top&&!player.isCrossDomainFrame){var meta=$('<meta name="viewport" id="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>');try{top.document.getElementsByTagName("head")[0].appendChild(meta.get(0))}catch(e$$57){player.isCrossDomainFrame=!0}}player.activeTimeline=player,player.getIOSversion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(t[1]||7,10),parseInt(t[2]||0,10),parseInt(t[3]||0,10)]}return[7,0,0]},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),player.getAnimationTime=function(){return player.animationTime},player.tick=function(){this.bTicked=!0,player.frameCount++;var t=new Date,e=t-player.lastRenderTime;window.requestAnimFrame(player.tick),e<.75*player.TICK_DURATION||(player.renderedFrameCount++,player.lastRenderTime=new Date,player.currentTickDuration=player.TICK_DURATION,e>.5*player.TICK_DURATION&&e<4*player.TICK_DURATION&&(player.currentTickDuration=e),player.tickAnimations(),ProgressBar.getCurrentProgressBar().dragging&&player.currentClip?player.currentClip.currentTime=(player.activeTimeline.currentTime-player.currentClipStartTime)/1e3:(player.blocked||player.currentSlide()&&player.currentSlide().tickLayers(),player.updateControls(),player.playing?(player.currentTime+=player.currentTickDuration,player.activeTimeline!=player&&"Slide"==player.activeTimeline.innerType&&player.activeTimeline.tick(),t-=player.frameRateZeroTime,player.showFrameCount&&!isNaN(t)&&(player.frameCounter||(player.frameCounter=$("<div class='framecounter'></div>"),$(document.body).append(player.frameCounter)),t=parseInt(1e3*(player.renderedFrameCount/t)),player.frameCounter.text(t+" "+e),player.frameCounter.css("color",player.currentTickDuration==e?"green":"red"),player.currentTickDuration!=e&&console.log("long tick",player.currentTickDuration,e)),player.correctMedia(),player.update(),player.currentSlide()!=player.activeTimeline&&(player.currentSlide().currentTime=player.currentTime)):player.currentSlide()&&player.currentSlide().updateLayers()))},player.tickAnimations=function(){function t(t){if(!t.steppedThisTick){var e=!0,i=null,r=null;$.each(t.animations,function(n,a){if(a.running){var s=a.timeline.getAnimationTime()-a.startTime;s>=0&&s<=a.duration&&(a.step(a.timeline.getAnimationTime()),t.steppedThisTick=!0),e=e&&0>s,(!i||a.startTime<i.startTime)&&(i=a),(!r||a.startTime+a.duration>r.startTime+r.duration)&&(r=a)}}),!t.steppedThisTick&&i&&r&&(e?i.step(i.timeline.getAnimationTime()):r.step(r.timeline.getAnimationTime())),t.steppedThisTick=!0}}player.animationTime+=player.currentTickDuration,$.each(player.currentAnimations,function(e,i){i.item.destroyed&&delete player.currentAnimations[e],i.item.steppedThisTick=!1,!i.item.steppedThisTick&&i.isTimeWithinAnimation(i.timeline.getAnimationTime())?(i.step(i.timeline.getAnimationTime()),i.item.steppedThisTick=!0):i.ended||i.item.steppedThisTick||!i.isTimeAfterAnimation(i.timeline.getAnimationTime())?t(i.item):(i.step(i.timeline.getAnimationTime()),i.item.steppedThisTick=!0)})},player.updateControls=function(){var t=$(".controlbar-button").find(".pause"),e=$(".controlbar-button").find(".play");player.activeTimeline.paused&&(t=$(".controlbar-button").find(".play"),e=$(".controlbar-button").find(".pause")),e.hide(),t.show()},player.correctMedia=function(){},player.update=function(t){function e(t){var e=(Math.floor(t/1e3)%60+100+"").substr(1,2),i=Math.floor(t/1e3/60),r="";return 0>t&&(e=(Math.floor(t/1e3)%60-100+"").substr(2,2),i=Math.ceil(t/1e3/60),r="-"),r+Math.abs(i)+":"+e}player.activeTimeline==player&&(ProgressBar.getCurrentProgressBar().index=player.activeTimeline.currentTime,ProgressBar.getCurrentProgressBar().count=player.currentSlide().duration,ProgressBar.getCurrentProgressBar().update(),player.paused?($(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".pause").hide(),$(".controlbar-button").find(".play").show()):($(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".play").hide(),$(".controlbar-button").find(".pause").show())),player.currentSlide().update(player.currentTime,!1,t),$(".time_elapsed").text(e(player.currentTime)),$(".time_remaining").text(e(player.currentTime-player.currentSlide().duration))},player.wait=function(){$(".toolbar-button").find(".wait").parent().show(),$(".toolbar-button").find(".play").parent().hide(),$(".toolbar-button").find(".pause").parent().hide()},player.showSlideID=function(t,e,i){if(t=story.parseObjref(t).target,t==player.currentSlide())return!1;if("Scene"==t.innerType&&(t=story.parseObjref(t.startingslide).target),"SlideDraw"==t.innerType)t.showFirst();else{if(isNaN(t.slideIndex))return!1;player.showSlideIndex(t.slideIndex,null,e,i)}return!0},player.showSlideIndex=function(t,e,i,r){var n=story.allSlides[t];player.currentSlide().handleEvent("onbeforeslidejump",null,null,!1,!0),StoryEvent.cancelEvent||(n.loadContentFromXML(),player.prepAudio(t),n.blockAndLoad(function(){player.frame.setControlEnabled("previous",!0),player.frame.setControlEnabled("next",!0),player.frame.setControlEnabled("submit",!0),player.loadingSpinner.hide(),null!=player.currentWindow&&(player.previousWindow=player.currentWindow),player.currentWindow=null,DragItem.cancelDrag();var e=player.currentSlide().slideIndex;if(t!=e){player.currentSlide().saveIfNecessary(),i&&-1==player.currentSlide().parent.id.indexOf("MsgScene")&&(player.currentWindow?player.currentWindow.history.push(e):player.history.push(e)),player.activeTimeline=player,player.setSlideIndex(t),player.onSelectSlide&&player.onSelectSlide(story.allSlides[t]),player.isIOSFrame&&($("#slideframe").css("-webkit-box-shadow","0 0 30px rgba(0,0,0,0.35)"),$("#slideframe").css("-moz-box-shadow","0 0 30px rgba(0,0,0,0.35)"),$("#slideframe").css("-ms-box-shadow","0 0 30px rgba(0,0,0,0.35)"),$("#slideframe").css("box-shadow","0 0 30px rgba(0,0,0,0.35)")),story.saveToLocalStorage(),player.currentSlide().deferredFrameLayoutXML&&player.currentSlide().set_frame_layout(n.deferredFrameLayoutXML);var a=0;player.neverPreload||setTimeout(function(){20<a++||n.slideIndex+1<story.allSlides.length&&story.allSlides[n.slideIndex+1].loadContentFromXML()},2e3)}r&&r()}))},player.showNextSlide=function(){if(player.slideIndex==story.allSlides.length-1)return Transition.bounce([$(".slide.in")],1),!1;if($(".icon.next-slide").hasClass("disabled"))return!1;for(var t=(player.slideIndex+1)%story.allSlides.length;t!=player.slideIndex;t=(t+1)%story.allSlides.length)if(story.allSlides[t].active){player.showSlideIndex(t,2,!0);break}},player.showPreviousSlide=function(){if(player.slideIndex==story.startingSlideIndex)return Transition.bounce([$(".slide.in")],2),!1;if($(".icon.previous-slide").hasClass("disabled"))return!1;for(var t=(player.slideIndex+story.allSlides.length-1)%story.allSlides.length;t!=player.slideIndex;t=(t+story.allSlides.length-1)%story.allSlides.length)if(story.allSlides[t]&&story.allSlides[t].active){player.showSlideIndex(t,1,!0);break}},player.setSlideIndex=function(t,e){if(player.zoomed&&player.tapZoom(),MouseEvents.processHideables(),clearTimeout(player.mediaTimeout),player.blockedOn=null,player.unblock(),player.pause(!1,!0),!isNaN(t)){var i=player.currentSlide();player.slideIndex=t,player.currentTime=0,player.currentTime=player.currentSlide().currentTime,player.activeTimeline=player,player.currentSlide()&&(player.currentSlide().resetInteractions(),player.currentSlide().variables.Visited=!0,player.currentSlide().viewedCurrent=!0,player.lmsManager.handleSlideViewed(player.currentSlide()),player.slideList.markVisited(i),player.currentSlide().currentTime=0,player.currentSlide().show(player.autoplaySlides,e,function(){i.slideIndex!=player.currentSlide().slideIndex&&i.reduce(),i.resetSlide(!1,!0),player.hideInactiveSlides(),i.unloadContent()}),i.handleEvent("ontransitionout",null,null,!1,!0),i.deepEach(function(t,e){e.handleEvent&&e.handleEvent("ontransitionout",null,null,!1,!0)}),i.variables.WindowId="_frame",player.currentSlide().variables.WindowId="_frame"),player.loopable||($(".icon.disabled").removeClass("disabled"),player.slideIndex==story.startingSlideIndex&&$(".icon.previous-slide").addClass("disabled"),player.slideIndex==story.allSlides.length-1&&$(".icon.next-slide").addClass("disabled")),$(".item").css("-webkit-animation-name",""),$(".item").css("-webkit-animation-duration","0s"),$("ul.menu_list li").removeClass("selected locked"),$("ul.slidelist li").removeClass("selected locked"),$(".controlbar-button.right,#control-submitall").removeClass("locked"),$(".toptab.customlink").removeClass("locked"),$(".progress-container").removeClass("locked");var r=player.currentSlide();r.slideBank&&0==r.navLinks.length&&(r=r.slideBank),$.each(r.navLinks,function(t,e){$.each(e.listitems,function(t,e){e.addClass("selected")})}),player.slideList.collapseSections(player.currentSlide()),r.slidelock&&($("ul.menu_list li").addClass("locked"),$("ul.slidelist li").addClass("locked"),$(".controlbar-button.right,#control-submitall").addClass("locked"),$(".toptab.customlink").addClass("locked"),$(".progress-container").addClass("locked")),player.slideList.scrollSelectedIntoView()}},player.restoreViewedState=function(t){t.variables.Visited=!0,this.listSlidesViewed[t.getFullObjref()]=!0,this.listSlidesViewedComplete[t.slideIndex]=!0},player.calculateTotalViewSlides=function(){for(var t={},e=this.totalViewSlides=0;e<story.allSlides.length;e++){var i=story.allSlides[e];i.trackviews&&(""!=i.viewgroupid?null==t[i.viewgroupid]&&(t[i.viewgroupid]=!0,this.totalViewSlides++):this.totalViewSlides++)}},player.hideInactiveSlides=function(t){var e=player.currentSlide();$.each(story.allSlides,function(t,i){i.slideIndex!=e.slideIndex&&(i.hide(),i.unloadContent())}),t&&t()},player.currentSlide=function(){return 0==story.allSlides.length?null:player.currentWindow?player.currentWindowSlide:story.allSlides[player.slideIndex]},player.currentZoom=function(){return player.zoom*player.windowZoomModifier},player.elapsedTime=function(){return new Date-player.startTime},player.addToRenderQueue=function(t){0>this.renderQueue.indexOf(t)&&(this.renderQueue.push(t),player.scheduleShowQueueFlush())},player.addToShowQueue=function(t,e){!t.animating||t.animationEnded||e?0>this.showQueue.indexOf(t)&&(this.showQueue.push(t),player.scheduleShowQueueFlush()):t.showOnFirstStep=!0},player.removeFromShowQueue=function(t){t=this.showQueue.indexOf(t),t>=0&&this.showQueue.splice(t,1)},player.scheduleShowQueueFlush=function(){this.renderTimer?this.renderTimer.style.opacity="1":player.flushShowQueues()},player.flushShowQueues=function(){if(Math.random(),0<player.renderQueue.length||0<player.showQueue.length){var t=[];player.bTicked=!1;for(var e=0;e<player.showQueue.length;e++){var i=player.showQueue[e];0>player.renderQueue.indexOf(i)?i.ref&&i.ref.show():t.push(i)}for(e=0;e<player.renderQueue.length;e++)player.renderQueue[e].renderOnUpdate();player.renderQueue=[],player.showQueue=t,0<t.length&&player.scheduleShowQueueFlush()}},player.ensureTicking=function(){player.nointervals||player.interval||(player.interval=!0,player.frameRateZeroTime=new Date,player.tick(),player.zeroTime=new Date)},player.play=function(t,e,i){(t=player.currentSlide())&&(player.interval&&player.playing&&!player.paused||(t.currentTime>=t.duration&&!e&&player.restart(),player.interval&&window.clearInterval(player.interval),player.playing=!0,player.paused=!1,player.nointervals||(player.interval=setInterval(player.tick,player.TICK_DURATION)),player.zeroTime=new Date,player.showControls&&player.frame.hasBottomBar&&$("#controls").show(),i||player.currentSlide().clips.forEach(function(t){t.m_bResumeOnSeek&&!t.layer&&(player.currentClipStartTime=t.lastStartTime,player.currentClipSyncToTimeline=!0,player.currentClip=t,t.playClip())&&(t.m_bResumeOnSeek=!1)})),$(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".play").hide(),$(".controlbar-button").find(".pause").show(),$(".play_button").removeClass("play"),$(".play_button").addClass("pause"),$(document.body).removeClass("paused"),player.onPlay&&player.onPlay())},player.pause=function(t,e,i){player.unblock(),player.playing=!1,player.paused=!0,$.each(player.currentSlide().clips,function(r,n){!e&&t&&n.layered||(e||n.syncToTimeline)&&(n.syncToTimeline&&n.getIsPlaying()&&(n.m_bResumeOnSeek=!0),n.pauseClip(i),player.scheduledMediaSrc==n.content.src&&(clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=null))}),player.useActiveTimeline&&$.each(player.currentSlide().children,function(i,r){"Layer"==r.innerType&&(e||!t)&&r.pause()}),$(".controlbar-button").find(".wait").hide(),$(".controlbar-button").find(".pause").hide(),$(".controlbar-button").find(".play").show()},player.pauseClips=function(){clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=null,$.each(player.currentSlide().clips,function(t,e){e.getIsPlaying()&&e.syncToTimeline&&(e.m_bResumeOnSeek=!0),e.pauseClip(),player.scheduledMediaSrc==e.content.src&&(clearTimeout(player.mediaTimeout),player.scheduledMediaSrc=null)}),$("audio,video").each(function(t,e){e.get&&e.get(0)&&e.get(0).pause&&e.get(0).pause()}),$.each(player.webAudioClips,function(t,e){e.pauseClip()})},player.block=function(){player.blocknotice||(player.blocknotice=$('<div class="blocked">loading...</div>'),$(".blocked").css("left",Math.floor(window.innerWidth/2)-50),$(".blocked").css("top",Math.floor(window.innerHeight/2)-50),$(document.body).append(player.blocknotice)),player.blocknotice.show(),player.playing=!1,player.blocked=!0,clearTimeout(player.blockedTimeout),player.hasWebAudio||(player.blockedTimeout=setTimeout(function(){player.blocked&&(player.currentSlide().currentIndex+=1,
player.unblock())},4e3))},player.unblock=function(t){clearTimeout(player.blockedTimeout),$(".blocked").hide(),!player.interval||player.paused||t||(player.playing=!0,player.blockedOn&&player.blockedOn.playClip()),player.blocked=!1,player.blockedOn=null},player.restart=function(){player.currentSlide().resume||(player.currentTime=0,player.update(player.currentTime),player.currentSlide().resetSlide(),player.pause(),player.play())},player.initLoadQueue=function(){player.slideLoadQueue=[],player.slideLoadQueue.processing=!0,player.slideLoadQueueExhausted=!1;for(var t=0;t<story.allSlides.length;t++)player.slideLoadQueue.push(t);player.slideLoadQueue.promote=function(t){if(t=player.slideLoadQueue.indexOf(t),t>0)for(t=player.slideLoadQueue.splice(t,player.slideLoadQueue.length-t);t.length;)player.slideLoadQueue.unshift(t.pop());player.slideLoadQueue.restart()},player.slideLoadQueue.restart=function(){(player.slideLoadQueueExhausted||!player.slideLoadQueue.processing)&&(player.slideLoadQueue.processing=!0,player.slideLoadQueueExhausted=!1,player.loadResourcesForNextSlide())},player.slideLoadQueue.promote(story.startingSlideIndex)},player.loadResourcesForNextSlide=function(){slideIndex=player.slideLoadQueue.shift(),void 0!=slideIndex?player.loadResources(slideIndex):player.slideLoadQueueExhausted=!0},player.loadResources=function(t){0>t||t>story.allSlides.length||player.loadResourcesForSlide(story.allSlides[t])},player.loadResourcesForSlide=function(t){player.slideLoadQueue.processing=!0;var e=0,i=function(){var i=t.resources.length,r=0;$.each(t.resources,function(n,a){r=player.simplifySlides&&a.item.canSimplify||a.item.deferLoading?r+10:r+100,setTimeout(function(){a.load(n,function(){++e>=i&&(t.ready=!0,slideIndex==story.startingSlideIndex)&&(player.ready=!0)},!0)},r)})};player.simplifySlides?t.simplify(i):i(),0==t.resources.length&&(t.ready=!0,slideIndex==story.startingSlideIndex&&(player.ready=!0),player.loadResourcesForNextSlide())},player.unloadResources=function(){$.each(story.allSlides,function(t,e){(t<player.slideIndex-1||t>player.slideIndex+1)&&$.each(e.resources,function(t,e){e.unload()})})},player.prepAudio=function(t){if(!Resource.justPrepped){Resource.justPrepped=!0,setTimeout(function(){Resource.justPrepped=!1},100);var e=!1;$.each(story.allSlides[t].resources,function(t,i){"audio"!=i.item.type&&"video"!=i.item.type||e||i.prepared||(i.prep(function(){}),e=!0)})}},player.onLoadedData=function(){player.loadedMediaCount++,player.loadedMediaCount==player.mediaCount&&(player.pause(),$("#slideframe").css("-webkit-transition-property","opacity"),$("#slideframe").css("-webkit-transition-duration","1s"),$("#slideframe").css("opacity","1.0"),player.showSlideID(story.startingslide))},player.reorient=function(t){player.frame.reorient(t)},player.detectSize=function(){story.allSlides.forEach(function(t){1==player.width&&-1==t.id.indexOf("Prompt")&&(player.width=t.width,player.height=t.height,player.aspectRatio=t.aspectRatio)})},player.maximize=function(t){t&&!player.maximized?(player.width/=2,player.height/=2,player.reorient(!0)):!t&&player.maximized&&(player.width*=2,player.height*=2,player.reorient(!0)),player.maximized=t},player.revealPostInterstitial=function(){SlideDraw.populateDraws(),$("#slideframe").css("-webkit-transition-property","opacity"),$("#slideframe").css("-webkit-transition-duration","1s"),$("#slideframe").css("opacity","1.0"),$(".launch").remove(),player.showSlideID(story.startingslide);var t=story.parseObjref(story.startingslide).target;"Scene"==t.innerType&&(t=story.parseObjref(t.startingslide).target),"SlideDraw"==t.innerType&&(t=t.getFirstSlide()),t&&t.prepDownstreamMedia&&t.prepDownstreamMedia(),player.reorient(!0),player.showControls&&$("#controls").show(),setTimeout(function(){player.showingInterstitial=!1},500),$(".interstitial").hide(),player.playButton.hide(),Audio.iOSPrepare&&Audio.iOSPrepare()},player.showInterstitial=function(){player.showIOSLaunch()},player.addDiagnosticButton=function(t,e){var i=$('<div class="diagnosticbutton">'+t+"</div>");i.click(e),$("#topbar").append(i)},player.sniffParameters=function(){$.each(location.search.split("&"),function(t,e){var i=unescape(e.replace("?","")).split("=");switch(i[0].toLowerCase()){case"name":player.storyName=i[1],player.basepath="/UserData/Upload/"+i[1]+"/";break;case"usexml":player.loadFromScript=!1;break;case"contentfolder":window.globals.strContentFolder=i[1];break;case"lms":player.useLMS=!0;break;case"ao":window.globals.bAOSupport=!0,window.g_bAOSupport=!0,player.useAO=!0,player.forceAO=!0;break;case"tincan":window.globals.bTinCan=!0,window.g_bTinCan=!0,player.useTinCan=!0}})},player.loadFonts=function(t){player.fontlib=new ppFontLib(player.basepath,$(t).find("bwContent").attr("iosfonts")),g_oFontLib=player.fontlib,player.fontlib.CreateFonts(function(){player.fontready=!0})},player.parseFrameData=function(t){player.frame.loadFromXML($(t)),player.slideList.refresh(),player.frame.initOrientation()},player.loadFrame=function(){if(player.frameData)player.parseFrameData(player.frameData);else if(player.loadFromScript){player.parseDataOnLoad=!0;var t=$("<script></script>");t.attr("src",player.basepath+"story_content/frame.js"),$(document.body).append(t),setTimeout(function(){player.createdFrameData||(player.loadFromScript=!1,player.loadFrame(),$(document.body).append($("<div class='framefailed'></div>")))},5e3)}else t="?random="+Math.random(),$.ajax({url:player.basepath+"story_content/frame.xml"+t,dataType:"xml",cache:!1,success:function(t){player.parseFrameData(t)},error:function(){player.frame.ready=!0}})},player.loadUserScript=function(){"file:"!==location.protocol&&$.ajax({url:player.basepath+"story_content/user.js",dataType:"script",cache:!1})},player.loadMasks=function(){player.maskData?player.parseMaskData(player.maskData):player.loadFromScript&&(player.parseDataOnLoad=!0)},player.parseMaskData=function(t){player.bitmasks={},$(t).find("maskdata").each(function(t,e){var i=$(e).attr("i"),r=$(e).attr("m");player.bitmasks[i]=r})},player.load=function(t){if(player.isIOSFrame&&(480>=window.innerWidth||480>=window.innerHeight)){$(".interstitial").show(),$(".wrap").hide(),$(".loading").hide(),$(".interstitial_play").hide(),$(".wrap").remove(),$(".loading").remove(),$(".interstitial_play").remove();var e=$("<div class='incompatible'><h1>Not yet</h1>Small device support is coming soon.</div>");$(document.body).append(e)}else player.parseStoryData=function(e){if("string"==typeof e){var i,e=e.replace(/[\u000a\u000b\u000c\u000d\u0085\u2028\u2029]/g,""),e=e.replace(/&#x[0-8bcef];/gi,"");-1<location.search.indexOf("dumpxml=1")&&console.log(e),window.ActiveXObject?(i=new ActiveXObject("Microsoft.XMLDOM"),i.loadXML(e)):i=(new DOMParser).parseFromString(e,"text/xml"),e=i}$(e).find("fontlib")&&0>location.search.indexOf("nocanvas")&&(player.useCanvas=!0,player.renderVectorShapes=!0,player.renderVectorsAsSVG=!1),story.loadFromXML($(e)),player.loadFrame(),player.loadMasks(),player.initLoadQueue(),player.loadResourcesForNextSlide(),player.loadFonts($(e)),window.ExecuteScript||(window.ExecuteScript=function(){},player.loadUserScript());var r=player.lmsManager.initResume(),n=setInterval(function(){if(player.ready&&player.frame.ready&&player.fontready&&0==story.pendingSceneCount&&player.lmsManager.isReady()){if(player.loadingSpinner.hide(),player.pause(),window.clearInterval(n),player.showControls&&$("#controls").show(),!player.frame.defaultLayoutName){var i=$(e).find("set_frame_layout").first().attr("name");i&&(player.frame.defaultLayoutName=i)}player.frame.set_frame_layout(),player.frame.updateLayout(),player.frame.set_frame_layout();var i=player.hasLMS&&story.resumeLMS||player.lmsManager.hasAO&&player.aoResumeData&&story.resumeLMS||player.lmsManager.hasTinCan&&player.tinCanResumeData&&story.resumeLMS||!player.hasLMS&&!player.lmsManager.hasAO&&story.resumeFlash,a="";if(player.overrideResumeData&&(a=player.overrideResumeData),player.hasLMS&&story.resumeLMS?(a=r,player.overrideResumeData&&(a=player.overrideResumeData)):player.lmsManager.hasAO&&player.aoResumeData&&story.resumeLMS?a=player.aoResumeData:player.lmsManager.hasTinCan&&player.tinCanResumeData&&story.resumeLMS?a=player.tinCanResumeData:story.resumeFlash&&(a=localStorageAlias[story.resumeID],player.overrideResumeData)&&(a=player.overrideResumeData),player.hasLMS&&!a&&story.resumeFlash?(a=localStorageAlias[story.resumeID],player.overrideResumeData&&(a=player.overrideResumeData)):player.lmsManager.hasAO&&!a&&story.resumeFlash?(a=localStorageAlias[story.resumeID],player.overrideResumeData&&(a=player.overrideResumeData)):player.lmsManager.hasTinCan&&!a&&story.resumeFlash?(a=localStorageAlias[story.resumeID],player.overrideResumeData&&(a=player.overrideResumeData)):player.lmsManager.hasAO||player.lmsManager.hasTinCan||player.hasLMS||(a=localStorageAlias[story.resumeID],!player.overrideResumeData)||(a=player.overrideResumeData),(player.resumeData=a)&&i&&!story.resumePrompt){if(player.overrideResumeData&&(a=player.overrideResumeData),player.useCompactResume)try{resumeSuccess=story.updateFromCompactData(a)}catch(s){}else try{story.updateFromData(JSON.parse(a))}catch(o){}player.isIOS&&player.showInterstitial()}if(player.automate)setTimeout(function(){player.revealPostInterstitial(),player.automate()},1);else if(a&&story.resumePrompt){if(i=story.parseObjref(story.resumeWindow).target,a=story.parseObjref(story.resumeSlideID).target,player.isIOSFrame){var l=new ResumePrompt;l.loadFromXML(i.xml),l.createRef(),story.children[i.id]=l,l.showSlide(a)}else i.showSlide(a);$(".interstitial").hide(),$("#slideframe").css("opacity","1.0"),$("#control-progress").hide(),player.reorient(!0)}else player.isIOS?player.showInterstitial():setTimeout(function(){player.simulateIOSPlayer?player.showInterstitial():player.revealPostInterstitial()},1);t&&t()}},100)},player.storyData?player.parseStoryData(player.storyData):player.loadFromScript?(player.parseDataOnLoad=!0,e=$("<script></script>"),e.attr("src",player.basepath+"mobile/data.js"),$(document.body).append(e),setTimeout(function(){player.createdStoryData||($(document.body).append($("<div class='datafailed'></div>")),player.loadFromScript=!1,player.load())},5e3)):$.ajax({url:player.basepath+"story_content/data.xml",dataType:"xml",cache:!1,success:function(t){player.parseStoryData(t)},error:function(t,e){alert("Error loading "+player.basepath+"story_content/data.xml: "+e)}})},player.tapPause=function(){player.hasReleasedFinger=!1,player.pausenotice||(player.pausenotice=$('<div class="interstitial light"></div><div class="pausemessage"></div>'),$(document.body).append(player.pausenotice),player.pausenotice.bind("click touchstart mousedown",function(){player.hasReleasedFinger&&(player.showingInterstitial=!1,player.pausenotice.hide(),player.play(!0)),player.hasReleasedFinger=!0})),player.showingInterstitial=!0,player.pause(),player.pausenotice.show(),player.hasReleasedFinger=!1,swipe.cancel()},player.tapZoom=function(t){var e=player.currentSlide().ref;if(player.zoomed)e.css("-webkit-transition-property","none"),e.css("-webkit-transition-duration","0s"),e.css("zoom",1),e.css("-webkit-transform",player.lastSlideTransform),e.css("width","720px"),e.css("height","540px"),setTimeout(function(){e.css("-webkit-transition-property","-webkit-transform"),e.css("-webkit-transition-duration","0.4s"),e.css("-webkit-transform-origin","top left"),e.css("-webkit-transform","translate3d(0px,0px,0px) scale(1.0)")},0);else{if(!t)return;var i=e.offset(),r=$("#slideframe").css("zoom"),n=(t.originalEvent.changedTouches[0].pageY-i.top)/r,a=parseInt((t.originalEvent.changedTouches[0].pageX-i.left)/r/2),s=parseInt(n/2),t="scale(2.0) translate3d(-"+a+"px,-"+s+"px,0px) ";e.css("-webkit-transition-property","-webkit-transform"),e.css("-webkit-transition-duration","0.4s"),e.css("-webkit-transform-origin","top left"),e.css("-webkit-transform",t),e.css("width","1440px"),e.css("height","1080px"),player.lastSlideTransform=t,setTimeout(function(){player.zoomed&&(e.css("-webkit-transition-property","none"),e.css("-webkit-transition-duration","0s"),e.css("zoom",2),e.css("-webkit-transform","translate3d(-"+a+"px,-"+s+"px,0px)"))},400)}player.zoomed=!player.zoomed},player.updateItemInfo=function(t){if(player.showItemInfo)if(player.itemInfoMonitor||(player.itemInfoMonitor=$("<div class='monitor'></div>"),$(document.body).append(player.itemInfoMonitor)),player.canChangeMonitoringItem&&t&&(player.monitoringItem=t||player.monitoringItem,player.canChangeMonitoringItem=!1),t=player.monitoringItem,player.itemInfoMonitor.empty(),player.itemInfoMonitor.append($("<p>currentTime:"+player.currentTime+", currentLayerTime: "+player.currentLayerTime+"</p>")),t){$(".item.monitoring").removeClass("monitoring"),t.ref&&t.ref.addClass("monitoring");var e=$("<h2>"+t.id+"</h2>");e.bind("click",function(){alert(t.id)}),player.itemInfoMonitor.append(e),player.itemInfoMonitor.append($("<h3>"+t.innerType+" (visible:"+t.visible+")</h3>")),player.itemInfoMonitor.append($("<p>x: "+t.x+" y: "+t.y+" w: "+t.width+" h: "+t.height+" z: "+t.depth+" xoff: "+t.xoffset+" yoff: "+t.yoffset+" dragX: "+t.dragX+" dragY: "+t.dragY+" ox: "+t.originalX+" oy: "+t.originalY+" sx: "+t.shuffleX+" sy: "+t.shuffleY+" vis: "+t.visible+" </p>")),e=$("<a>toggle&nbsp;</a>"),e.click(function(){t.visible?t.hide():t.show()}),player.itemInfoMonitor.append(e),e=$("<a>&nbsp;render</a>"),e.click(function(){t.render(t.lastRenderedState,!0,null,"info pane")}),player.itemInfoMonitor.append(e),t.content&&player.itemInfoMonitor.append($("<span>"+t.content.src+"</span>")),e=function(t,e){if(t){var i=$("<table></table>");$.each(t,function(t,r){var n=r;e&&(n="function"==typeof e?e(t,r):r[e]),n=$("<tr><td>"+t+":</td><td>"+n+"</td></tr>"),i.append(n)}),player.itemInfoMonitor.append(i)}},player.itemInfoMonitor.append("<p/><a href='javascript:void(null);' onclick='player.monitoringItem=null;player.canChangeMonitoringItem=true;player.updateItemInfo();'>change</a>"),player.monitoringItem.parent&&player.itemInfoMonitor.append("(<a href='javascript:void(null);' onclick='player.monitoringItem=player.monitoringItem.parent;player.updateItemInfo();'>parent</a>)"),player.itemInfoMonitor.append("<p/><a href='javascript:void(null);' onclick='player.monitoringItem=null;player.canChangeMonitoringItem=true;player.updateItemInfo(player.currentSlide());'>slide</a>");var i=$("<a href='javascript:void(null);'>log</a>");if(i.click(function(){console.log(t)}),player.itemInfoMonitor.append("<p/>"),player.itemInfoMonitor.append(i),e(t.variables),e(t.children,function(t,e){return"<a href='javascript:void(null);' onclick='player.monitoringItem=player.monitoringItem.children[\""+e.id+"\"];player.updateItemInfo();'>_"+e.innerType+"_</a>"}),e(t.events,"trigger"),e(t.states),e(t.actionGroups),player.logActivity?e(t.log):t.content?(player.itemInfoMonitor.append($("<span onclick='alert(this.innerHTML)'>"+t.content.path+"</span><br/>")),t.content.src&&t.content.src!=Element.PixelSrc?player.itemInfoMonitor.append($("<img src='"+t.content.src+"' style='opacity:0.8;border:solid 1px green'>")):player.itemInfoMonitor.append($("<span>NO IMAGE</span>")),t.canvas&&t.canvas.toDataURL&&0==location.href.indexOf("http")&&(e=t.canvas.toDataURL("image/png"),player.itemInfoMonitor.append($("<img src='"+e+"' style='opacity:0.8;border:solid 1px yellow'>")))):player.itemInfoMonitor.append($("NO CONTENT")),t.bitMask&&player.showDebugOverlap){var r=function(t){var e=$("<canvas></canvas>");e.attr("width",t.width),e.attr("height",t.height),e.css("position","relative"),player.itemInfoMonitor.append(e),t.drawDebug(e.get(0))};r(t.bitMask),t.stateMasks&&$.each(t.stateMasks,function(t,e){r(e)})}else player.itemInfoMonitor.append($("NO BITMASK"))}else player.itemInfoMonitor.append($("<h2>select an item to monitor</h2>"))};var story,tq;$("#loadingSpinner").css("left",Math.floor(window.innerWidth/2)-50),$("#loadingSpinner").css("top",Math.floor(window.innerHeight/2)-50),$(".blocked").css("left",Math.floor(window.innerWidth/2)-50),$(".blocked").css("top",Math.floor(window.innerHeight/2)-50),$(document).ready(function(){if(window.WebKitMutationObserver&&(player.renderTimer=document.createElement("DIV"),player.renderTimer.id="renderer",player.renderTimer.style.position="absolute",player.renderTimer.style.visibility="hidden",document.body.appendChild(player.renderTimer),player.renderTimer.observer=new WebKitMutationObserver(function(t){t.forEach(player.flushShowQueues)}),player.renderTimer.observer.observe(player.renderTimer,{attributes:!0,subtree:!1}),player.renderTimer.style.opacity="1"),player.iosVersion=player.getIOSversion(),player.iPhoneiOS7Greater=7<=player.iosVersion[0]&&player.isIPhone,player.loadingSpinner=$("#loadingSpinner"),player.playButton=$("#playButton"),player.container=$("#slidecontainer"),story=new Storyline(player.container),player.frame=new Frame,player.showControls=!0,player.swipeMode="none",player.simplifySlides=!1,player.loadFromScript=!0,player.lockzoom=!1,player.startTime=new Date,player.sniffParameters(),playerDiagnostics.init(),player.lmsManager=new LMSManager,player.lmsManager.init(),player.initIOS&&player.initIOS(),player.load(),"follow"!=player.swipeMode){if($(".submit-slide").parent().bind("click",function(){player.currentWindow||0<$(".modalfence:visible").length||story.handleEvent("onobjectevent","submit_pressed",null,!1,!1,!0)}),$(".next-slide").parent().bind("click",function(){story.handleEvent("onobjectevent","next_pressed",null,!1,!1,!0)}),$(".previous-slide").parent().bind("click",function(){story.handleEvent("onobjectevent","prev_pressed",null,!1,!1,!0)}),player.isIOS){var t=function(){player.currentSlide().hasSimpleNavigation&&player.pause()};$(".next-slide").parent().bind("touchend",t),$(".previous-slide").parent().bind("touchend",t)}$("#control-menu").bind("click",function(){player.slideList.toggle()}),$(".button,.controlbar-button").bind("mousedown touchstart",function(){$(this).addClass("pressed")}),$(".button,.controlbar-button").bind("mouseup mouseout touchend",function(){$(this).removeClass("pressed")})}else console.log("swipe.init()");$("#control-pauseplay .play").bind("click",function(){player.activeTimeline.play(!1,!1,!1)}),$("#control-pauseplay .pause").bind("click",function(){player.activeTimeline.pause(!1,!0,!1)}),player.volumeSlider=new VolumeSlider($("#control-volume")),player.volumeSlider.onDragUpdate=function(t){$("audio,video").each(function(e,i){i.volume=Math.min(t*player.clipVolume,1)}),Audio.setMasterVolume&&Audio.setMasterVolume(t)},"all"==player.paging&&$(document.body).bind("tap",function(t){!player.showingInterstitial&&!player.zoomed&&(t=t.originalEvent.touches?t.originalEvent.changedTouches[0].pageX:t.pageX,t<.1*window.innerWidth?player.showPreviousSlide():t>.9*window.innerWidth&&player.showNextSlide())}),$(document.body).bind("touchstart",function(t){t&&t.originalEvent&&t.originalEvent.touches&&1==t.originalEvent.touches.length&&(player.touchStart={left:t.originalEvent.touches[0].pageX,top:t.originalEvent.touches[0].pageY},player.touchFlickDirection=null,player.startMatrix=player.currentSlide()&&player.currentSlide().ref?new WebKitCSSMatrix(window.getComputedStyle(player.currentSlide().ref.get(0)).webkitTransform):new WebKitCSSMatrix)}),$(document.body).bind("gesturechange",function(){}),$(document.body).bind("touchmove",function(t){if(player.tapZoomEnabled&&player.zoomed&&1==t.originalEvent.touches.length){player.justTapped=!1;var e=t.originalEvent.touches[0],i=parseInt(e.pageX-player.touchStart.left),r=parseInt(e.pageY-player.touchStart.top),e=player.startMatrix.translate(i,r,0);0<e.e&&(e.e=0),0<e.f&&(e.f=0),e.e<-player.width&&(e.e=-player.width),e.f<-player.height&&(e.f=-player.height),player.currentSlide().ref.css("-webkit-transform",e)}if(i=t.originalEvent.touches,2!=i.length)return player.allowTouchMove&&!player.showingInterstitial?!0:!1;for(r=!1,e=t.target;!r&&e;){if(r=$(e).hasClass("scrollarea"),(inSlideList=$(e).hasClass("slidelist"))&&2==i.length)return!0;if(r&&player.touchStart)return i=parseInt(t.originalEvent.touches[0].pageX-player.touchStart.left),r=parseInt(t.originalEvent.touches[0].pageY-player.touchStart.top),player.touchFlickDirection||(player.touchFlickDirection=Math.abs(i)>Math.abs(r)?"horizontal":"vertical"),"horizontal"==player.touchFlickDirection||0>=e.scrollTop&&r>0||e.scrollTop>=e.scrollHeight-e.offsetHeight&&0>r?!1:!0;e=e.parentNode}return 1==player.isFramedOffset}),$(window).bind("scroll",function(){return!1}),$(window).unbind("keydown"),$(window).bind("keydown",function(t){var e,i=player.currentSlide();if(i){var r=t.keyCode,n=String.fromCharCode(t.keyCode);(90<t.keyCode||!/\w/.test(n))&&(r=-1),story.properties.LastKeyCode=r,story.properties.LastKeyCodeString=n,setTimeout(function(){player.modalLayer&&player.modalLayer.visible&&(i=player.modalLayer),e=i.handleEvent("onkeypress",t,null,!1,!0,!0)&&e,e=i.handleEvent("onanykeypress",t,null,!1,!0,!0)&&e,i.deepEach(function(i,r){r.handleEvent&&(e=r.handleEvent("onkeypress",t,null,!1,!0,!0)&&e,e=r.handleEvent("onanykeypress",t,null,!1,!0,!0)&&e)})},0)}return 13==t.keyCode?t.target&&t.target.item&&t.target.item.content&&t.target.item.content.multiline?!0:!1:void 0}),MouseEvents.init(),player.progressBar=new ProgressBar(null,$("#progressbar"),!0),player.progressBar.onDragUpdate=function(t){var e=player.activeTimeline==player?player.currentSlide().duration:player.activeTimeline.duration;player.activeTimeline.currentTime=parseInt(e*t),player.activeTimeline==player&&player.currentClip&&player.currentTime>player.currentClipStartTime&&player.currentTime<1e3*player.currentClip.duration+player.currentClipStartTime&&(player.currentClip.currentTime=(player.currentTime-player.currentClipStartTime)/1e3),player.activeTimeline.update(!0)},player.lastOrientation=-1,!player.nointervals&&player.isIOS&&setInterval(function(){player.frame.reorient()},100),player.frame.reorient(!0),player.isIOS||($(window).bind("resize",function(){player.reorient(!0)}),$(document.body).bind("dragstart",function(t){t.preventDefault()}))}),player.forceRepaint=function(){$(".framewrap").hide(),player.uselessOffsetHeight=$(".framewrap").get(0).offsetHeight,$(".framewrap").show()},player.initGlobals=function(){$(document.body).css("background-color",globals.strBgColor),player.scaleToFit="noscale"!=globals.strScale},player.restrictUnsupportedBrowsers=function(){},window.CreateData=function(t,e){if(e=e||"storyData","string"==typeof t){t=t.replace(/[\u000a\u000b\u000c\u000d\u0085\u2028\u2029]/g,""),t=t.replace(/&#x[0-8bcef];/gi,""),-1<location.search.indexOf("dumpxml=1")&&console.log(t);var i;window.ActiveXObject?(i=new ActiveXObject("Microsoft.XMLDOM"),i.loadXML(t)):i=(new DOMParser).parseFromString(t,"text/xml"),t=i}player[e]=t,player.parseDataOnLoad&&"storyData"==e&&(player.createdStoryData=!0,player.parseStoryData(player.storyData))},window.CreateFrameData=function(t){player.createdFrameData=!0,CreateData(t,"frameData"),player.parseDataOnLoad&&player.parseFrameData(player.frameData)},window.CreateMaskData=function(t){player.createdMaskData=!0,CreateData(t,"maskData"),player.parseDataOnLoad&&player.parseMaskData(player.maskData)},window.GetPlayer=function(){return player},player.GetVar=function(t){return story.extractVariable(t)},player.SetVar=function(t,e){story.setVariable(t,e)},window.player=player,window.$=$,window.story=story;var IE6=!1;if(window.IE6=!1,window.IE6=!1,!window.g_bWarnOnCommitFail){var g_bWarnOnCommitFail=!1;window.g_bWarnOnCommitFail=!1,window.g_bWarnOnCommitFail=!1}if(window.localStorageAlias=window.localStorage,document.all&&!window.localStorage&&(window.localStorageAlias={},window.localStorageAlias.removeItem=function(){}),player.meta={title:"",description:"",thumburl:""},player.initIOS=function(){},(player.isIOS||-1<location.search.indexOf("iosplayer=1"))&&(player.initIOS=function(){player.loadMetaData()},player.loadMetaData=function(){var t="?random="+Math.random();$.ajax({url:player.basepath+"meta.xml"+t,dataType:"xml",cache:!1,success:function(t){player.parseMetaData(t)},error:function(){}})},player.parseMetaData=function(t){t=$(t).children("meta").children("project"),player.meta.title=t.attr("title"),player.meta.thumburl=t.attr("thumburl"),player.meta.description=t.children("description").text(),player.populateIOSLaunch()},player.showIOSLaunch=function(){if(player.launch=$('<div class="launch">&nbsp;<div class="launchwrap"><div class="container"><div class="launch_meta"><h1/><p/><a class="button"" title="play">Play</a></div><div class="screenshot"><img/></div></div></div></div>'),$(document.body).prepend(player.launch),player.launch.show(),player.launch.find("a").first().click(player.revealPostInterstitial),player.populateIOSLaunch(),500>window.innerWidth){var t=player.launch.find(".screenshot"),e=player.launch.find("h1"),i=player.launch.find(".container"),r=function(){var r=window.orientation/180==parseInt(window.orientation/180);player.isCrossDomainFrame||(r=top.window.orientation/180==parseInt(top.window.orientation/180)),r?t.insertAfter(e):i.append(t)};window.addEventListener("orientationchange",r),r()}},player.populateIOSLaunch=function(){player.launch&&(player.launch.find("h1").text(player.meta.title),player.launch.find("p").first().text(player.meta.description),player.launch.find("img").first().attr("src",player.basepath+player.meta.thumburl))}),player.isFramed=top!=self,player.isFramed){var myFrame=Frame.findCurrentFrame();myFrame&&(player.isFramedOffset=0<myFrame.offsetWidth||0<myFrame.offsetHeight)}if((player.isIOS||-1<location.search.indexOf("iosorient=1"))&&(Frame.prototype.initOrientation=function(){var t=player.isCrossDomainFrame?window.orientation:top.window.orientation,e=t/180==parseInt(t/180);if(self!=top&&!player.isCrossDomainFrame){try{var i=top.document.createElement("meta");i.setAttribute("id","viewport"),i.setAttribute("name","viewport"),i.setAttribute("content","width=device-width, user-scalable=yes"),top.document.getElementsByTagName("head")[0].appendChild(i),e&&$(document.body).addClass("portrait")}catch(r){}top.window.scrollTo(0,0)}window.scrollTo(0,0),player.iPhoneiOS7Greater&&($(document.body).bind("touchstart",function(){player.frame.touchStarted=!0}),$(document.body).bind("touchend",function(){player.frame.touchStarted=!1}));var n=e?window.innerHeight:window.innerWidth,a=e?window.innerWidth:window.innerHeight,i=e?window.innerWidth:window.innerHeight,t=e?window.innerHeight:window.innerWidth;player.isCrossDomainFrame||(n=e?top.window.innerHeight:top.window.innerWidth,a=e?top.window.innerWidth:top.window.innerHeight,i=e?top.window.innerWidth:top.window.innerHeight,t=e?top.window.innerHeight:top.window.innerWidth);var s=story.frameWidth-2,o=story.frameHeight-2;this.containerWidth=s,this.containerHeight=o,$(".framewrap").css("width",s),$(".framewrap").css("height",o);var l=window.screen.width,h=window.screen.height;player.isAndroid||e||(l=window.screen.height,h=window.screen.width);var p=h-window.innerHeight;e?(t=h-p,i=l,a=l-p,n=h):(a=h-p,n=l,t=l-p,i=h),e=1,e=s/o>n/a?n/s:a/o,this.aspectRatio=s/o,l=parseInt((a-o*e)/2-1),0>l&&(l=0),h=parseInt((n-s*e)/2-1),0>h&&(h=0),this.containerLeftLandscape=h,this.containerTopLandscape=l,l="top:"+l+"px!important; left:"+h+"px!important;",player.iPhoneiOS7Greater&&(l=""),n=".framewrap{-webkit-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+e+");width:"+s+"px;height:"+o+"px;"+l+".interstitial{height:"+a+"px;width:"+n+"px;}}",player.landscapeFrameScale=e,e=1,e=s/o>i/t?i/s:t/o,l=parseInt((t-o*e)/2-1),0>l&&(l=0),h=parseInt((i-s*e)/2-1),0>h&&(h=0),this.containerLeftPortrait=h,this.containerTopPortrait=l,a="top:"+l+"px!important; left:"+h+"px!important;",player.iPhoneiOS7Greater&&(a=""),i=".framewrap{-webkit-transform-origin:top left;-moz-transform-origin:top left;-ms-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+e+");-moz-transform:translate3d(0px,0px,0px) scale("+e+");-ms-transform:translate(0px,0px) scale("+e+");width:"+s+"px;height:"+o+"px;"+a+".interstitial{height:"+t+"px;width:"+i+"px;}}",player.rotatePortraitStyleSheet=document.createElement("style"),player.rotatePortraitStyleSheet.innerHTML=i,document.body.appendChild(player.rotatePortraitStyleSheet),player.portraitFrameScale=e,player.frameLandscapeStyleSheet=document.createElement("style"),player.frameLandscapeStyleSheet.media="only screen and (max-device-width: 1024px) and (orientation:landscape)",player.frameLandscapeStyleSheet.innerHTML=n,document.body.appendChild(player.frameLandscapeStyleSheet),self!=top&&(i=i.replace("framewrap","portrait .framewrap").replace("interstitial","portrait .interstitial"),player.rotatePortraitFramedStyleSheet=document.createElement("style"),player.rotatePortraitFramedStyleSheet.innerHTML=i,document.body.appendChild(player.rotatePortraitFramedStyleSheet))},Frame.prototype.reorient=function(t){if(player.iPhoneiOS7Greater)this.reorientiOS7();else if($("#loadingSpinner").css("left",Math.floor(window.innerWidth/2)-50),$("#loadingSpinner").css("top",Math.floor(window.innerHeight/2)-50),$(".blocked").css("left",Math.floor(window.innerWidth/2)-50),$(".blocked").css("top",Math.floor(window.innerHeight/2)-50),1==player.width)player.detectSize();else{var e=player.isCrossDomainFrame?window.orientation:top.window.orientation,i=e/180==parseInt(e/180);(t||e!=player.lastOrientation)&&(window.scrollTo(0,0),player.isCrossDomainFrame||top.window.scrollTo(0,0),i?(player.frameScale=player.portraitFrameScale,$(document.body).addClass("portrait")):(player.frameScale=player.landscapeFrameScale,$(document.body).removeClass("portrait")),player.lastOrientation=e)}},Frame.prototype.reorientiOS7=function(){if(!player.frame.touchStarted){var t=player.isCrossDomainFrame?window.orientation:top.window.orientation;if(player.lastHeight!=window.innerHeight||t!=player.lastOrientation){player.lastHeight=window.innerHeight,player.lastOrientation=t;var e=0,i=0,r=1;(r=t/180!=parseInt(t/180))&&window.innerHeight!=screen.width?(player.allowTouchMove||(player.allowTouchMove=!0,player.scrollDiv||(player.scrollDiv=document.createElement("div"),player.scrollDiv.style.position="absolute",player.scrollDiv.style.visibility="visible",player.scrollDiv.style.width="1px",player.scrollDiv.style.height=screen.width+40+"px"),document.body.appendChild(player.scrollDiv)),r=window.innerHeight/story.frameHeight,e=(screen.height-story.frameWidth*r)/2,i=0):(player.allowTouchMove&&(player.allowTouchMove=!1,player.scrollDiv&&player.scrollDiv.parentNode&&document.body.removeChild(player.scrollDiv)),r?(r=screen.height/story.frameWidth,t=window.innerHeight/story.frameHeight,r>t&&(r=t),e=(screen.height-story.frameWidth*r)/2,i=0):(r=window.innerWidth/story.frameWidth,e=0,i=(window.innerHeight-story.frameHeight*r)/2)),$(".framewrap").css("-webkit-transform","translate3d("+e+"px, "+i+"px, 0px) scale("+r+")"),player.frameScale=r,player.frame.containerLeft=e,player.frame.containerTop=i,window.scrollTo(0,0),player.isCrossDomainFrame||top.window.scrollTo(0,0)}}}),-1<location.search.indexOf("iosmarker=1")&&(player.isIOSMarkers=!0),(player.isIOS||player.isIOSMarkers)&&(ExpandingLabel.prototype.togglecontent=function(){this.visible=!this.visible,this.variables.Expanded=this.visible.toString(),this.visible?($(".above").removeClass("above"),$(".showing").removeClass("showing"),this.hideOthers(),this.showContent=!0,this.render(null,!0,this.width,this.height),this.show(),this.ref.addClass("above showing"),this.button.ref.addClass("above showing"),this.bringtofront(),this.button.bringtofront(),this.handleEvent("onobjectevent","contentin",null,!1,!1,!0)):(this.hide(),$(".above").removeClass("above"),this.handleEvent("onobjectevent","contentout",null,!1,!1,!0))},ExpandingLabel.prototype.hidecomplete=function(){this.variables.Expanded="false",this.hide(),$(".above").removeClass("above")},ExpandingLabel.prototype.showtitle=function(){},ExpandingLabel.prototype.hidetitle=function(){}),player.forceBitMaskTesting=-1<location.search.indexOf("&pixel="),player.isLocalFileSystem="file:"==window.location.protocol,
player.usePixelTesting=(player.isIOS||!player.isLocalFileSystem)&&!player.forceBitMaskTesting,player.usePixelTesting&&(VectorShape.prototype.isPointActive=function(t,e){if(!this.visible||!this.vectorHot)return!1;var i=this.getCanvasPoint(t,e);return 0>=i.x||0>=i.y||i.x>=this.canvas.width||i.y>=this.canvas.height?!1:0!=this.context.getImageData(i.x,i.y,1,1).data[3]},StageItem.prototype.testOverlap=function(t){if(0<$(".modalfence:visible").length)return!1;var e=this;if("ItemGroup"==t.innerType||"StateGroup"==t.innerType){var i=!1;return $.each(t.children,function(t,r){i=i||e.testOverlap(r)}),i}if("ItemGroup"==e.innerType||"StateGroup"==e.innerType)return i=!1,$.each(e.children,function(r,n){n.testOverlap&&(n.setElementProperty("dragX",e.dragX,!0),n.setElementProperty("dragY",e.dragY,!0),i=i||n.testOverlap(t))}),i;var r=this.getAABB(),n=t.getAABB(),i=!0;return(r.right<n.left||r.left>n.right||r.bottom<n.top||r.top>n.bottom)&&(i=!1),this.isRotated?i&&this.testRotatedOverlap(t):i&&this.testPixelOverlap&&t.testPixelOverlap?this.testPixelOverlap(t):i},VectorShape.prototype.testPixelOverlap=function(t){player.showDebugOverlap&&(player.testCanvas||(player.testCanvas=$("<canvas id='test' width='1000' height='1000' style='position:absolute;z-index:200;left:0px;top:0px;'></canvas>"),$("#slideframe").append(player.testCanvas),player.testContext=player.testCanvas.get(0).getContext("2d"),player.testContext.fillStyle="rgba(255,255,0,0.5)"),player.testCanvas.show(),clearTimeout(player.testCanvasClear),player.testCanvasClear=setTimeout(function(){player.testCanvas.hide()},1e3));var e=this.slideX()+this.dragX,i=this.slideY()+this.dragY,r=0,n=0,a=0,s=0;if(t.slideX()>e?(r=t.slideX(),n=e+this.width):(r=e,n=t.slideX()+t.width),t.slideY()>i?(a=t.slideY(),s=i+this.height):(a=i,s=t.slideY()+t.height),e=n-r,i=s-a,!(0>=e||0>=i)){!player.showDebugOverlap||console.filter&&this.id!=console.filter&&t.id!=console.filter||(player.testContext.fillStyle="rgba(255,255,0,0.5)",player.testContext.clearRect(0,0,1e3,1e3),player.testContext.fillRect(r,a,e,i));for(var i=this.getCanvasPoint(r,a),i=this.context.getImageData(i.x,i.y,n-r,s-a).data,o=t.getCanvasPoint(r,a),n=t.context.getImageData(o.x,o.y,n-r,s-a).data,s=0;s<i.length-4;s+=256)if(0!=i[s+3]&&0!=n[s+3]){var o=r+s/4%e,l=a+Math.floor(s/4/e),h=t.isPointObscured(o,l,this,function(t){return t.dropArea});if(!player.showDebugOverlap||console.filter&&this.id!=console.filter&&t.id!=console.filter||(h?(player.testContext.fillStyle="rgba(255,0,0,0.9)",player.testContext.fillRect(o-1,l-1,2,2)):(player.testContext.fillStyle="rgba(0,255,0,0.9)",player.testContext.fillRect(o-2,l-2,4,4))),!h)return!0}return!1}}),-1<location.search.indexOf("iosscroll=1")&&(player.isIOSScroll=!0),window.webkitAudioContext&&!player.isLocalFileSystem&&-1==location.search.indexOf("nowebaudio=1"))try{player.audioContext=new webkitAudioContext,player.hasWebAudio=!0}catch(e$$61){}player.audioContext&&(Audio.masterVolume=.8,Audio.playbackStates={UNSCHEDULED:0,SCHEDULED:1,PLAYING:2,FINISHED:3},Audio.prototype.loadClip=function(){var t=this;t.source=null;var e=t.content.src;player.noAudioCache&&(e+="?rand="+Math.random());var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer";var r=function(){player.blocked&&player.blockedOn==t&&(player.currentSlide().currentIndex+=1,t.canPlayThrough=!0,player.unblock())};i.onload=function(){player.audioContext.decodeAudioData(i.response,function(e){t.buffer=e,t.canPlayThrough=!0,t.prepared=!0,r()},function(){t.failedLoad=!0,r()})},i.onerror=function(){r()},i.send(),this.loadStarted=!0},Audio.prototype.createRef=function(){return this.loadStarted?!1:(this.loadClip(),player.webAudioClips[this.getFullObjref()]=this,this.currentTime=0,!0)},Audio.prototype.prep=function(){},Audio.prototype.playClip=function(){var t=this;if(this.failedLoad||this.slide!=player.currentSlide())return!1;if(!this.prepared)return player.block(),player.blockedOn=this,!1;if(this.source)try{this.source.noteOff(0)}catch(e){}var i=this.layer?this.layer:player.activeTimeline;return!isNaN(player.currentClipStartTime)&&(!isNaN(this.lastStartTime)&&this.m_bResumeOnSeek&&this.syncToTimeline||player.currentClipSyncToTimeline&&player.currentClip==this)&&(this.currentTime=(i.currentTime-player.currentClipStartTime)/1e3),0>this.currentTime||1e3*this.currentTime>=this.content.duration?!1:(this.syncToTimeline=!(StoryEvent.currentEvent&&StoryEvent.currentEvent.isUserInitiated)||player.currentClipSyncToTimeline&&player.currentClip==this,this.lastStartTime=isNaN(player.currentClipStartTime)?player.activeTimeline.currentTime:player.currentClipStartTime,this.source=player.audioContext.createBufferSource(),this.source.buffer=this.buffer,this.volume=player.audioContext.createGainNode(),this.source.connect(this.volume),this.volume.connect(player.audioContext.destination),this.volume.gain.value=Audio.masterVolume*player.clipVolume,0==this.currentTime?this.source.noteOn(0):this.source.noteGrainOn(0,this.currentTime,this.content.duration/1e3-this.currentTime),this.playing=!0,this.interval&&window.clearInterval(this.interval),this.interval=window.setInterval(function(){t.source.playbackState==Audio.playbackStates.FINISHED&&(window.clearInterval(t.interval),t.playing)&&(t.handleEvent("onmediacomplete"),t.playing=!1,t.m_bResumeOnSeek=!0)},10),!0)},Audio.prototype.pauseClip=function(t){if(this.source){this.interval&&window.clearInterval(this.interval);try{this.source.noteOff(0)}catch(e){}this.playing&&t&&(this.handleEvent("onmediacomplete"),this.playing=!1),this.playing=!1}},Audio.prototype.getScheduled=function(){return this.scheduled},Audio.prototype.setScheduled=function(t){this.scheduled=t},Audio.prototype.setCurrentTime=function(t){this.currentTime=t},Audio.prototype.getClip=function(){return this.propertyInterval||(this.propertyInterval=setInterval(function(){},200)),this},Audio.prototype.getIsPlaying=function(){return this.playing},Audio.prototype.mediaReady=function(){return this.failedLoad?!0:this.prepared},Audio.iOSPrepare=function(){var t=player.audioContext.createOscillator();t.type=0;var e=player.audioContext.createGainNode();t.connect(e),e.connect(player.audioContext.destination),e.gain.value=0,t.noteOn(0);try{t.noteOff(0)}catch(i){}},Audio.setMasterVolume=function(t){Audio.masterVolume=t,$.each(player.webAudioClips,function(t,e){e.volume&&(e.volume.gain.value=Audio.masterVolume*player.clipVolume)})});